var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,s){return t&&eachProp(t,function(t,n){(i||!hasProp(e,n))&&(s&&"string"!=typeof t?(e[n]||(e[n]={}),mixin(e[n],t,i,s)):e[n]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,s){var n=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=s,i&&(n.originalError=i),n}function newContext(e){function t(e){var t,i;for(t=0;e[t];t+=1)if(i=e[t],"."===i)e.splice(t,1),t-=1;else if(".."===i){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,s){var n,a,o,r,l,h,d,c,u,p,f,g=i&&i.split("/"),m=g,v=x.map,b=v&&v["*"];if(e&&"."===e.charAt(0)&&(i?(m=getOwn(x.pkgs,i)?g=[i]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),a=getOwn(x.pkgs,n=e[0]),e=e.join("/"),a&&e===n+"/"+a.main&&(e=n)):0===e.indexOf("./")&&(e=e.substring(2))),s&&v&&(g||b)){for(r=e.split("/"),l=r.length;l>0;l-=1){if(d=r.slice(0,l).join("/"),g)for(h=g.length;h>0;h-=1)if(o=getOwn(v,g.slice(0,h).join("/")),o&&(o=getOwn(o,d))){c=o,u=l;break}if(c)break;!p&&b&&getOwn(b,d)&&(p=getOwn(b,d),f=l)}!c&&p&&(c=p,u=f),c&&(r.splice(0,u,c),e=r.join("/"))}return e}function s(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function n(e){var t=getOwn(x.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function a(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function o(e,t,s,n){var o,r,l,h,d=null,c=t?t.name:null,u=e,p=!0,f="";return e||(p=!1,e="_@r"+(P+=1)),h=a(e),d=h[0],e=h[1],d&&(d=i(d,c,n),r=getOwn(A,d)),e&&(d?f=r&&r.normalize?r.normalize(e,function(e){return i(e,c,n)}):i(e,c,n):(f=i(e,c,n),h=a(f),d=h[0],f=h[1],s=!0,o=w.nameToUrl(f))),l=!d||r||s?"":"_unnormalized"+(I+=1),{prefix:d,name:f,parentMap:t,unnormalized:!!l,url:o,originalName:u,isDefine:p,id:(d?d+"!"+f:f)+l}}function r(e){var t=e.id,i=getOwn(S,t);return i||(i=S[t]=new w.Module(e)),i}function l(e,t,i){var s=e.id,n=getOwn(S,s);!hasProp(A,s)||n&&!n.defineEmitComplete?(n=r(e),n.error&&"error"===t?i(n.error):n.on(t,i)):"defined"===t&&i(A[s])}function h(e,t){var i=e.requireModules,s=!1;t?t(e):(each(i,function(t){var i=getOwn(S,t);i&&(i.error=e,i.events.error&&(s=!0,i.emit("error",e)))}),s||req.onError(e))}function d(){globalDefQueue.length&&(apsp.apply($,[$.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(e){delete S[e],delete k[e]}function u(e,t,i){var s=e.map.id;e.error?e.emit("error",e.error):(t[s]=!0,each(e.depMaps,function(s,n){var a=s.id,o=getOwn(S,a);!o||e.depMatched[n]||i[a]||(getOwn(t,a)?(e.defineDep(n,A[a]),e.check()):u(o,t,i))}),i[s]=!0)}function p(){var e,t,i,a,o=1e3*x.waitSeconds,r=o&&w.startTime+o<(new Date).getTime(),l=[],d=[],c=!1,f=!0;if(!b){if(b=!0,eachProp(k,function(i){if(e=i.map,t=e.id,i.enabled&&(e.isDefine||d.push(i),!i.error))if(!i.inited&&r)n(t)?(a=!0,c=!0):(l.push(t),s(t));else if(!i.inited&&i.fetched&&e.isDefine&&(c=!0,!e.prefix))return f=!1}),r&&l.length)return i=makeError("timeout","Load timeout for modules: "+l,null,l),i.contextName=w.contextName,h(i);f&&each(d,function(e){u(e,{},{})}),r&&!a||!c||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,p()},50)),b=!1}}function f(e){hasProp(A,e[0])||r(o(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,s){e.detachEvent&&!isOpera?s&&e.detachEvent(s,t):e.removeEventListener(i,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(d();$.length;){if(e=$.shift(),null===e[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var b,y,w,_,C,x={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},S={},k={},T={},$=[],A={},D={},P=1,I=1;return _={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,i=getOwn(x.pkgs,e.map.id);return t=i?getOwn(x.config,e.map.id+"/"+i.main):getOwn(x.config,e.map.id),t||{}},exports:A[e.map.id]}}},y=function(e){this.events=getOwn(T,e.id)||{},this.map=e,this.shim=getOwn(x.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,i,s){s=s||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;D[e]||(D[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,s=this.depExports,n=this.exports,a=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(a)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=w.execCb(i,a,s,n)}catch(o){e=o}else n=w.execCb(i,a,s,n);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?n=t.exports:void 0===n&&this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",h(this.error=e)}else n=a;this.exports=n,this.map.isDefine&&!this.ignore&&(A[i]=n,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,s=o(e.prefix);this.depMaps.push(s),l(s,"defined",bind(this,function(s){var n,a,d,u=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(s.normalize&&(u=s.normalize(u,function(e){return i(e,p,!0)})||""),a=o(e.prefix+"!"+u,this.map.parentMap),l(a,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),d=getOwn(S,a.id),void(d&&(this.depMaps.push(a),this.events.error&&d.on("error",bind(this,function(e){this.emit("error",e)})),d.enable()))):(n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),n.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(S,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&c(e.map.id)}),h(e)}),n.fromText=bind(this,function(i,s){var a=e.name,l=o(a),d=useInteractive;s&&(i=s),d&&(useInteractive=!1),r(l),hasProp(x.config,t)&&(x.config[a]=x.config[t]);try{req.exec(i)}catch(c){return h(makeError("fromtexteval","fromText eval for "+t+" failed: "+c,c,[t]))}d&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(a),f([a],n)}),void s.load(e.name,f,n,x))})),w.enable(s,this),this.pluginMaps[s.id]=s},enable:function(){k[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,s,n;if("string"==typeof e){if(e=o(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(_,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",bind(this,this.errback))}i=e.id,s=S[i],hasProp(_,i)||!s||s.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(S,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:x,contextName:e,registry:S,defined:A,urlFetched:D,defQueue:$,Module:y,makeModuleMap:o,nextTick:req.nextTick,onError:h,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=x.pkgs,i=x.shim,s={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){s[t]?"map"===t?(x.map||(x.map={}),mixin(x[t],e,!0,!0)):mixin(x[t],e,!0):x[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),i[t]=e}),x.shim=i),e.packages&&(each(e.packages,function(e){var i;e="string"==typeof e?{name:e}:e,i=e.location,t[e.name]={name:e.name,location:i||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),x.pkgs=t),eachProp(S,function(e,t){e.inited||e.map.unnormalized||(e.map=o(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function a(i,s,l){var d,c,u;return n.enableBuildCallback&&s&&isFunction(s)&&(s.__requireJsBuild=!0),"string"==typeof i?isFunction(s)?h(makeError("requireargs","Invalid require call"),l):t&&hasProp(_,i)?_[i](S[t.id]):req.get?req.get(w,i,t,a):(c=o(i,t,!1,!0),d=c.id,hasProp(A,d)?A[d]:h(makeError("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),u=r(o(null,t)),u.skipMap=n.skipMap,u.init(i,s,l,{enabled:!0}),p()}),a)}return n=n||{},mixin(a,{isBrowser:isBrowser,toUrl:function(e){var s,n=e.lastIndexOf("."),a=e.split("/")[0],o="."===a||".."===a;return-1!==n&&(!o||n>1)&&(s=e.substring(n,e.length),e=e.substring(0,n)),w.nameToUrl(i(e,t&&t.id,!0),s,!0)},defined:function(e){return hasProp(A,o(e,t,!1,!0).id)},specified:function(e){return e=o(e,t,!1,!0).id,hasProp(A,e)||hasProp(S,e)}}),t||(a.undef=function(e){d();var i=o(e,t,!0),n=getOwn(S,e);s(e),delete A[e],delete D[i.url],delete T[e],n&&(n.events.defined&&(T[e]=n.events),c(e))}),a},enable:function(e){var t=getOwn(S,e.id);t&&r(e).enable()},completeLoad:function(e){var t,i,s,a=getOwn(x.shim,e)||{},o=a.exports;for(d();$.length;){if(i=$.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(s=getOwn(S,e),!t&&!hasProp(A,e)&&s&&!s.inited){if(!(!x.enforceDefine||o&&getGlobal(o)))return n(e)?void 0:h(makeError("nodefine","No define call for "+e,null,[e]));f([e,a.deps||[],a.exportsFn])}p()},nameToUrl:function(e,t,i){var s,n,a,o,r,l,h,d,c;if(req.jsExtRegExp.test(e))d=e+(t||"");else{for(s=x.paths,n=x.pkgs,r=e.split("/"),l=r.length;l>0;l-=1){if(h=r.slice(0,l).join("/"),a=getOwn(n,h),c=getOwn(s,h)){isArray(c)&&(c=c[0]),r.splice(0,l,c);break}if(a){o=e===a.name?a.location+"/"+a.main:a.location,r.splice(0,l,o);break}}d=r.join("/"),d+=t||(/^data\:|\?/.test(d)||i?"":".js"),d=("/"===d.charAt(0)||d.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+d}return x.urlArgs?d+((-1===d.indexOf("?")?"?":"&")+x.urlArgs):d},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,i,s){return t.apply(s,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return n(t.id)?void 0:h(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,s){var n,a,o=defContextName;return isArray(e)||"string"==typeof e||(a=e,isArray(t)?(e=t,t=i,i=s):e=[]),a&&a.context&&(o=a.context),n=getOwn(contexts,o),n||(n=contexts[o]=req.s.newContext(o)),a&&n.configure(a),n.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,i){var s,n=e&&e.config||{};if(isBrowser)return s=req.createNode(n,t,i),s.setAttribute("data-requirecontext",e.contextName),s.setAttribute("data-requiremodule",t),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",e.onScriptLoad,!1),s.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",e.onScriptLoad)),s.src=i,currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{importScripts(i),e.completeLoad(t)}catch(a){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,a,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,i){var s,n;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript(),s&&(e||(e=s.getAttribute("data-requiremodule")),n=contexts[s.getAttribute("data-requirecontext")])),(n?n.defQueue:globalDefQueue).push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("libs/require/require",function(){}),define("main.min",function(){}),function(){if(!window.console||!window.console.log){var e={};e.log=e.error=e.info=e.debug=e.warn=e.trace=e.dir=e.dirxml=e.time=e.timeEnd=e.assert=e.profile=function(){},window.console=e}window.console.group&&window.console.groupCollapsed&&window.console.groupEnd||(window.console.groupCollapsed=window.console.group=function(e){window.console.log(e)},window.console.groupEnd=function(){})}(),define("console.setup",function(){}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=Q.type(e);return"function"===i||Q.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function s(e,t,i){if(Q.isFunction(t))return Q.grep(e,function(e,s){return!!t.call(e,s,e)!==i});if(t.nodeType)return Q.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(rt.test(t))return Q.filter(t,e,i);t=Q.filter(t,e)}return Q.grep(e,function(e){return V.call(t,e)>=0!==i})}function n(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e){var t=ft[e]={};return Q.each(e.match(pt)||[],function(e,i){t[i]=!0}),t}function o(){K.removeEventListener("DOMContentLoaded",o,!1),e.removeEventListener("load",o,!1),Q.ready()}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+r.uid++}function l(e,t,i){var s;if(void 0===i&&1===e.nodeType)if(s="data-"+t.replace(wt,"-$1").toLowerCase(),i=e.getAttribute(s),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:yt.test(i)?Q.parseJSON(i):i}catch(n){}bt.set(e,t,i)}else i=void 0;return i}function h(){return!0}function d(){return!1}function c(){try{return K.activeElement}catch(e){}}function u(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Nt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i=0,s=e.length;s>i;i++)vt.set(e[i],"globalEval",!t||vt.get(t[i],"globalEval"))}function m(e,t){var i,s,n,a,o,r,l,h;if(1===t.nodeType){if(vt.hasData(e)&&(a=vt.access(e),o=vt.set(t,a),h=a.events)){delete o.handle,o.events={};for(n in h)for(i=0,s=h[n].length;s>i;i++)Q.event.add(t,n,h[n][i])}bt.hasData(e)&&(r=bt.access(e),l=Q.extend({},r),bt.set(t,l))}}function v(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],i):i}function b(e,t){var i=t.nodeName.toLowerCase();"input"===i&&St.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function y(t,i){var s,n=Q(i.createElement(t)).appendTo(i.body),a=e.getDefaultComputedStyle&&(s=e.getDefaultComputedStyle(n[0]))?s.display:Q.css(n[0],"display");return n.detach(),a}function w(e){var t=K,i=zt[e];return i||(i=y(e,t),"none"!==i&&i||(Ot=(Ot||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Ot[0].contentDocument,t.write(),t.close(),i=y(e,t),Ot.detach()),zt[e]=i),i}function _(e,t,i){var s,n,a,o,r=e.style;return i=i||Ut(e),i&&(o=i.getPropertyValue(t)||i[t]),i&&(""!==o||Q.contains(e.ownerDocument,e)||(o=Q.style(e,t)),Ht.test(o)&&jt.test(t)&&(s=r.width,n=r.minWidth,a=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=i.width,r.width=s,r.minWidth=n,r.maxWidth=a)),void 0!==o?o+"":o}function C(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function x(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),s=t,n=Xt.length;n--;)if(t=Xt[n]+i,t in e)return t;return s}function S(e,t,i){var s=qt.exec(t);return s?Math.max(0,s[1]-(i||0))+(s[2]||"px"):t}function k(e,t,i,s,n){for(var a=i===(s?"border":"content")?4:"width"===t?1:0,o=0;4>a;a+=2)"margin"===i&&(o+=Q.css(e,i+Ct[a],!0,n)),s?("content"===i&&(o-=Q.css(e,"padding"+Ct[a],!0,n)),"margin"!==i&&(o-=Q.css(e,"border"+Ct[a]+"Width",!0,n))):(o+=Q.css(e,"padding"+Ct[a],!0,n),"padding"!==i&&(o+=Q.css(e,"border"+Ct[a]+"Width",!0,n)));return o}function T(e,t,i){var s=!0,n="width"===t?e.offsetWidth:e.offsetHeight,a=Ut(e),o="border-box"===Q.css(e,"boxSizing",!1,a);if(0>=n||null==n){if(n=_(e,t,a),(0>n||null==n)&&(n=e.style[t]),Ht.test(n))return n;s=o&&(Z.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+k(e,t,i||(o?"border":"content"),s,a)+"px"}function $(e,t){for(var i,s,n,a=[],o=0,r=e.length;r>o;o++)s=e[o],s.style&&(a[o]=vt.get(s,"olddisplay"),i=s.style.display,t?(a[o]||"none"!==i||(s.style.display=""),""===s.style.display&&xt(s)&&(a[o]=vt.access(s,"olddisplay",w(s.nodeName)))):(n=xt(s),"none"===i&&n||vt.set(s,"olddisplay",n?i:Q.css(s,"display"))));for(o=0;r>o;o++)s=e[o],s.style&&(t&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=t?a[o]||"":"none"));return e}function A(e,t,i,s,n){return new A.prototype.init(e,t,i,s,n)}function D(){return setTimeout(function(){Zt=void 0}),Zt=Q.now()}function P(e,t){var i,s=0,n={height:e};for(t=t?1:0;4>s;s+=2-t)i=Ct[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function I(e,t,i){for(var s,n=(ii[t]||[]).concat(ii["*"]),a=0,o=n.length;o>a;a++)if(s=n[a].call(i,t,e))return s}function M(e,t,i){var s,n,a,o,r,l,h,d,c=this,u={},p=e.style,f=e.nodeType&&xt(e),g=vt.get(e,"fxshow");i.queue||(r=Q._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,c.always(function(){c.always(function(){r.unqueued--,Q.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],h=Q.css(e,"display"),d="none"===h?vt.get(e,"olddisplay")||w(e.nodeName):h,"inline"===d&&"none"===Q.css(e,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(s in t)if(n=t[s],Jt.exec(n)){if(delete t[s],a=a||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!g||void 0===g[s])continue;f=!0}u[s]=g&&g[s]||Q.style(e,s)}else h=void 0;if(Q.isEmptyObject(u))"inline"===("none"===h?w(e.nodeName):h)&&(p.display=h);else{g?"hidden"in g&&(f=g.hidden):g=vt.access(e,"fxshow",{}),a&&(g.hidden=!f),f?Q(e).show():c.done(function(){Q(e).hide()}),c.done(function(){var t;vt.remove(e,"fxshow");for(t in u)Q.style(e,t,u[t])});for(s in u)o=I(f?g[s]:0,s,c),s in g||(g[s]=o.start,f&&(o.end=o.start,o.start="width"===s||"height"===s?1:0))}}function L(e,t){var i,s,n,a,o;for(i in e)if(s=Q.camelCase(i),n=t[s],a=e[i],Q.isArray(a)&&(n=a[1],a=e[i]=a[0]),i!==s&&(e[s]=a,delete e[i]),o=Q.cssHooks[s],o&&"expand"in o){a=o.expand(a),delete e[s];for(i in a)i in e||(e[i]=a[i],t[i]=n)}else t[s]=n}function E(e,t,i){var s,n,a=0,o=ti.length,r=Q.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Zt||D(),i=Math.max(0,h.startTime+h.duration-t),s=i/h.duration||0,a=1-s,o=0,l=h.tweens.length;l>o;o++)h.tweens[o].run(a);return r.notifyWith(e,[h,a,i]),1>a&&l?i:(r.resolveWith(e,[h]),!1)},h=r.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Zt||D(),duration:i.duration,tweens:[],createTween:function(t,i){var s=Q.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(s),s},stop:function(t){var i=0,s=t?h.tweens.length:0;if(n)return this;for(n=!0;s>i;i++)h.tweens[i].run(1);return t?r.resolveWith(e,[h,t]):r.rejectWith(e,[h,t]),this}}),d=h.props;for(L(d,h.opts.specialEasing);o>a;a++)if(s=ti[a].call(h,e,d,h.opts))return s;return Q.map(d,I,h),Q.isFunction(h.opts.start)&&h.opts.start.call(e,h),Q.fx.timer(Q.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function F(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var s,n=0,a=t.toLowerCase().match(pt)||[];if(Q.isFunction(i))for(;s=a[n++];)"+"===s[0]?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(i)):(e[s]=e[s]||[]).push(i)}}function N(e,t,i,s){function n(r){var l;return a[r]=!0,Q.each(e[r]||[],function(e,r){var h=r(t,i,s);return"string"!=typeof h||o||a[h]?o?!(l=h):void 0:(t.dataTypes.unshift(h),n(h),!1)}),l}var a={},o=e===yi;return n(t.dataTypes[0])||!a["*"]&&n("*")}function R(e,t){var i,s,n=Q.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:s||(s={}))[i]=t[i]);return s&&Q.extend(!0,e,s),e}function B(e,t,i){for(var s,n,a,o,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(n in r)if(r[n]&&r[n].test(s)){l.unshift(n);break}if(l[0]in i)a=l[0];else{for(n in i){if(!l[0]||e.converters[n+" "+l[0]]){a=n;break}o||(o=n)}a=a||o}return a?(a!==l[0]&&l.unshift(a),i[a]):void 0}function O(e,t,i,s){var n,a,o,r,l,h={},d=e.dataTypes.slice();if(d[1])for(o in e.converters)h[o.toLowerCase()]=e.converters[o];for(a=d.shift();a;)if(e.responseFields[a]&&(i[e.responseFields[a]]=t),!l&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=d.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(o=h[l+" "+a]||h["* "+a],!o)for(n in h)if(r=n.split(" "),r[1]===a&&(o=h[l+" "+r[0]]||h["* "+r[0]])){o===!0?o=h[n]:h[n]!==!0&&(a=r[0],d.unshift(r[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}function z(e,t,i,s){var n;if(Q.isArray(t))Q.each(t,function(t,n){i||Si.test(e)?s(e,n):z(e+"["+("object"==typeof n?t:"")+"]",n,i,s)});else if(i||"object"!==Q.type(t))s(e,t);else for(n in t)z(e+"["+n+"]",t[n],i,s)}function j(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var H=[],U=H.slice,W=H.concat,q=H.push,V=H.indexOf,G={},Y=G.toString,X=G.hasOwnProperty,Z={},K=e.document,J="2.1.4",Q=function(e,t){return new Q.fn.init(e,t)},et=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,tt=/^-ms-/,it=/-([\da-z])/gi,st=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jquery:J,constructor:Q,selector:"",length:0,toArray:function(){return U.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:U.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(U.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:H.sort,splice:H.splice},Q.extend=Q.fn.extend=function(){var e,t,i,s,n,a,o=arguments[0]||{},r=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[r]||{},r++),"object"==typeof o||Q.isFunction(o)||(o={}),r===l&&(o=this,r--);l>r;r++)if(null!=(e=arguments[r]))for(t in e)i=o[t],s=e[t],o!==s&&(h&&s&&(Q.isPlainObject(s)||(n=Q.isArray(s)))?(n?(n=!1,a=i&&Q.isArray(i)?i:[]):a=i&&Q.isPlainObject(i)?i:{},o[t]=Q.extend(h,a,s)):void 0!==s&&(o[t]=s));return o},Q.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Q.type(e)||e.nodeType||Q.isWindow(e)?!1:e.constructor&&!X.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Q.trim(e),e&&(1===e.indexOf("use strict")?(t=K.createElement("script"),t.text=e,K.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(tt,"ms-").replace(it,st)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,s){var n,a=0,o=e.length,r=i(e);if(s){if(r)for(;o>a&&(n=t.apply(e[a],s),n!==!1);a++);else for(a in e)if(n=t.apply(e[a],s),n===!1)break}else if(r)for(;o>a&&(n=t.call(e[a],a,e[a]),n!==!1);a++);else for(a in e)if(n=t.call(e[a],a,e[a]),n===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(et,"")},makeArray:function(e,t){var s=t||[];return null!=e&&(i(Object(e))?Q.merge(s,"string"==typeof e?[e]:e):q.call(s,e)),s},inArray:function(e,t,i){return null==t?-1:V.call(t,e,i)},merge:function(e,t){for(var i=+t.length,s=0,n=e.length;i>s;s++)e[n++]=t[s];return e.length=n,e},grep:function(e,t,i){for(var s,n=[],a=0,o=e.length,r=!i;o>a;a++)s=!t(e[a],a),s!==r&&n.push(e[a]);return n},map:function(e,t,s){var n,a=0,o=e.length,r=i(e),l=[];if(r)for(;o>a;a++)n=t(e[a],a,s),null!=n&&l.push(n);else for(a in e)n=t(e[a],a,s),null!=n&&l.push(n);return W.apply([],l)},guid:1,proxy:function(e,t){var i,s,n;return"string"==typeof t&&(i=e[t],t=e,e=i),Q.isFunction(e)?(s=U.call(arguments,2),n=function(){return e.apply(t||this,s.concat(U.call(arguments)))},n.guid=e.guid=e.guid||Q.guid++,n):void 0},now:Date.now,support:Z}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()});var nt=function(e){function t(e,t,i,s){var n,a,o,r,l,h,c,p,f,g;if((t?t.ownerDocument||t:z)!==M&&I(t),t=t||M,i=i||[],r=t.nodeType,"string"!=typeof e||!e||1!==r&&9!==r&&11!==r)return i;if(!s&&E){if(11!==r&&(n=bt.exec(e)))if(o=n[1]){if(9===r){if(a=t.getElementById(o),!a||!a.parentNode)return i;if(a.id===o)return i.push(a),i}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(o))&&B(t,a)&&a.id===o)return i.push(a),i}else{if(n[2])return J.apply(i,t.getElementsByTagName(e)),i;if((o=n[3])&&_.getElementsByClassName)return J.apply(i,t.getElementsByClassName(o)),i}if(_.qsa&&(!F||!F.test(e))){if(p=c=O,f=t,g=1!==r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(h=k(e),(c=t.getAttribute("id"))?p=c.replace(wt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+u(h[l]);f=yt.test(e)&&d(t.parentNode)||t,g=h.join(",")}if(g)try{return J.apply(i,f.querySelectorAll(g)),i}catch(m){}finally{c||t.removeAttribute("id")}}}return $(e.replace(lt,"$1"),t,i,s)}function i(){function e(i,s){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=s}var t=[];return e}function s(e){return e[O]=!0,e}function n(e){var t=M.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var i=e.split("|"),s=e.length;s--;)C.attrHandle[i[s]]=t}function o(e,t){var i=t&&e,s=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();
return("input"===i||"button"===i)&&t.type===e}}function h(e){return s(function(t){return t=+t,s(function(i,s){for(var n,a=e([],i.length,t),o=a.length;o--;)i[n=a[o]]&&(i[n]=!(s[n]=i[n]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function c(){}function u(e){for(var t=0,i=e.length,s="";i>t;t++)s+=e[t].value;return s}function p(e,t,i){var s=t.dir,n=i&&"parentNode"===s,a=H++;return t.first?function(t,i,a){for(;t=t[s];)if(1===t.nodeType||n)return e(t,i,a)}:function(t,i,o){var r,l,h=[j,a];if(o){for(;t=t[s];)if((1===t.nodeType||n)&&e(t,i,o))return!0}else for(;t=t[s];)if(1===t.nodeType||n){if(l=t[O]||(t[O]={}),(r=l[s])&&r[0]===j&&r[1]===a)return h[2]=r[2];if(l[s]=h,h[2]=e(t,i,o))return!0}}}function f(e){return e.length>1?function(t,i,s){for(var n=e.length;n--;)if(!e[n](t,i,s))return!1;return!0}:e[0]}function g(e,i,s){for(var n=0,a=i.length;a>n;n++)t(e,i[n],s);return s}function m(e,t,i,s,n){for(var a,o=[],r=0,l=e.length,h=null!=t;l>r;r++)(a=e[r])&&(!i||i(a,s,n))&&(o.push(a),h&&t.push(r));return o}function v(e,t,i,n,a,o){return n&&!n[O]&&(n=v(n)),a&&!a[O]&&(a=v(a,o)),s(function(s,o,r,l){var h,d,c,u=[],p=[],f=o.length,v=s||g(t||"*",r.nodeType?[r]:r,[]),b=!e||!s&&t?v:m(v,u,e,r,l),y=i?a||(s?e:f||n)?[]:o:b;if(i&&i(b,y,r,l),n)for(h=m(y,p),n(h,[],r,l),d=h.length;d--;)(c=h[d])&&(y[p[d]]=!(b[p[d]]=c));if(s){if(a||e){if(a){for(h=[],d=y.length;d--;)(c=y[d])&&h.push(b[d]=c);a(null,y=[],h,l)}for(d=y.length;d--;)(c=y[d])&&(h=a?et(s,c):u[d])>-1&&(s[h]=!(o[h]=c))}}else y=m(y===o?y.splice(f,y.length):y),a?a(null,o,y,l):J.apply(o,y)})}function b(e){for(var t,i,s,n=e.length,a=C.relative[e[0].type],o=a||C.relative[" "],r=a?1:0,l=p(function(e){return e===t},o,!0),h=p(function(e){return et(t,e)>-1},o,!0),d=[function(e,i,s){var n=!a&&(s||i!==A)||((t=i).nodeType?l(e,i,s):h(e,i,s));return t=null,n}];n>r;r++)if(i=C.relative[e[r].type])d=[p(f(d),i)];else{if(i=C.filter[e[r].type].apply(null,e[r].matches),i[O]){for(s=++r;n>s&&!C.relative[e[s].type];s++);return v(r>1&&f(d),r>1&&u(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(lt,"$1"),i,s>r&&b(e.slice(r,s)),n>s&&b(e=e.slice(s)),n>s&&u(e))}d.push(i)}return f(d)}function y(e,i){var n=i.length>0,a=e.length>0,o=function(s,o,r,l,h){var d,c,u,p=0,f="0",g=s&&[],v=[],b=A,y=s||a&&C.find.TAG("*",h),w=j+=null==b?1:Math.random()||.1,_=y.length;for(h&&(A=o!==M&&o);f!==_&&null!=(d=y[f]);f++){if(a&&d){for(c=0;u=e[c++];)if(u(d,o,r)){l.push(d);break}h&&(j=w)}n&&((d=!u&&d)&&p--,s&&g.push(d))}if(p+=f,n&&f!==p){for(c=0;u=i[c++];)u(g,v,o,r);if(s){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=Z.call(l));v=m(v)}J.apply(l,v),h&&!s&&v.length>0&&p+i.length>1&&t.uniqueSort(l)}return h&&(j=w,A=b),g};return n?s(o):o}var w,_,C,x,S,k,T,$,A,D,P,I,M,L,E,F,N,R,B,O="sizzle"+1*new Date,z=e.document,j=0,H=0,U=i(),W=i(),q=i(),V=function(e,t){return e===t&&(P=!0),0},G=1<<31,Y={}.hasOwnProperty,X=[],Z=X.pop,K=X.push,J=X.push,Q=X.slice,et=function(e,t){for(var i=0,s=e.length;s>i;i++)if(e[i]===t)return i;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=st.replace("w","w#"),at="\\["+it+"*("+st+")(?:"+it+"*([*^$|!~]?=)"+it+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+nt+"))|)"+it+"*\\]",ot=":("+st+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+at+")*)|.*)\\)|)",rt=new RegExp(it+"+","g"),lt=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ht=new RegExp("^"+it+"*,"+it+"*"),dt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ct=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),ut=new RegExp(ot),pt=new RegExp("^"+nt+"$"),ft={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+at),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},gt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,wt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),Ct=function(e,t,i){var s="0x"+t-65536;return s!==s||i?t:0>s?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)},xt=function(){I()};try{J.apply(X=Q.call(z.childNodes),z.childNodes),X[z.childNodes.length].nodeType}catch(St){J={apply:X.length?function(e,t){K.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,s=0;e[i++]=t[s++];);e.length=i-1}}}_=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,i,s=e?e.ownerDocument||e:z;return s!==M&&9===s.nodeType&&s.documentElement?(M=s,L=s.documentElement,i=s.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",xt,!1):i.attachEvent&&i.attachEvent("onunload",xt)),E=!S(s),_.attributes=n(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=n(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=vt.test(s.getElementsByClassName),_.getById=n(function(e){return L.appendChild(e).id=O,!s.getElementsByName||!s.getElementsByName(O).length}),_.getById?(C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(_t,Ct);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(_t,Ct);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,s=[],n=0,a=t.getElementsByTagName(e);if("*"===e){for(;i=a[n++];)1===i.nodeType&&s.push(i);return s}return a},C.find.CLASS=_.getElementsByClassName&&function(e,t){return E?t.getElementsByClassName(e):void 0},N=[],F=[],(_.qsa=vt.test(s.querySelectorAll))&&(n(function(e){L.appendChild(e).innerHTML="<a id='"+O+"'></a><select id='"+O+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&F.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||F.push("\\["+it+"*(?:value|"+tt+")"),e.querySelectorAll("[id~="+O+"-]").length||F.push("~="),e.querySelectorAll(":checked").length||F.push(":checked"),e.querySelectorAll("a#"+O+"+*").length||F.push(".#.+[+~]")}),n(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&F.push("name"+it+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(_.matchesSelector=vt.test(R=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&n(function(e){_.disconnectedMatch=R.call(e,"div"),R.call(e,"[s!='']:x"),N.push("!=",ot)}),F=F.length&&new RegExp(F.join("|")),N=N.length&&new RegExp(N.join("|")),t=vt.test(L.compareDocumentPosition),B=t||vt.test(L.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,s=t&&t.parentNode;return e===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):e.compareDocumentPosition&&16&e.compareDocumentPosition(s)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return P=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===s||e.ownerDocument===z&&B(z,e)?-1:t===s||t.ownerDocument===z&&B(z,t)?1:D?et(D,e)-et(D,t):0:4&i?-1:1)}:function(e,t){if(e===t)return P=!0,0;var i,n=0,a=e.parentNode,r=t.parentNode,l=[e],h=[t];if(!a||!r)return e===s?-1:t===s?1:a?-1:r?1:D?et(D,e)-et(D,t):0;if(a===r)return o(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)h.unshift(i);for(;l[n]===h[n];)n++;return n?o(l[n],h[n]):l[n]===z?-1:h[n]===z?1:0},s):M},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==M&&I(e),i=i.replace(ct,"='$1']"),!(!_.matchesSelector||!E||N&&N.test(i)||F&&F.test(i)))try{var s=R.call(e,i);if(s||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(n){}return t(i,M,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==M&&I(e),B(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==M&&I(e);var i=C.attrHandle[t.toLowerCase()],s=i&&Y.call(C.attrHandle,t.toLowerCase())?i(e,t,!E):void 0;return void 0!==s?s:_.attributes||!E?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],s=0,n=0;if(P=!_.detectDuplicates,D=!_.sortStable&&e.slice(0),e.sort(V),P){for(;t=e[n++];)t===e[n]&&(s=i.push(n));for(;s--;)e.splice(i[s],1)}return D=null,e},x=t.getText=function(e){var t,i="",s=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=x(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[s++];)i+=x(t);return i},C=t.selectors={cacheLength:50,createPseudo:s,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_t,Ct),e[3]=(e[3]||e[4]||e[5]||"").replace(_t,Ct),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&ut.test(i)&&(t=k(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_t,Ct).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&U(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,s){return function(n){var a=t.attr(n,e);return null==a?"!="===i:i?(a+="","="===i?a===s:"!="===i?a!==s:"^="===i?s&&0===a.indexOf(s):"*="===i?s&&a.indexOf(s)>-1:"$="===i?s&&a.slice(-s.length)===s:"~="===i?(" "+a.replace(rt," ")+" ").indexOf(s)>-1:"|="===i?a===s||a.slice(0,s.length+1)===s+"-":!1):!0}},CHILD:function(e,t,i,s,n){var a="nth"!==e.slice(0,3),o="last"!==e.slice(-4),r="of-type"===t;return 1===s&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,d,c,u,p,f,g=a!==o?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r;if(m){if(a){for(;g;){for(c=t;c=c[g];)if(r?c.nodeName.toLowerCase()===v:1===c.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&b){for(d=m[O]||(m[O]={}),h=d[e]||[],p=h[0]===j&&h[1],u=h[0]===j&&h[2],c=p&&m.childNodes[p];c=++p&&c&&c[g]||(u=p=0)||f.pop();)if(1===c.nodeType&&++u&&c===t){d[e]=[j,p,u];break}}else if(b&&(h=(t[O]||(t[O]={}))[e])&&h[0]===j)u=h[1];else for(;(c=++p&&c&&c[g]||(u=p=0)||f.pop())&&((r?c.nodeName.toLowerCase()!==v:1!==c.nodeType)||!++u||(b&&((c[O]||(c[O]={}))[e]=[j,u]),c!==t)););return u-=n,u===s||u%s===0&&u/s>=0}}},PSEUDO:function(e,i){var n,a=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return a[O]?a(i):a.length>1?(n=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?s(function(e,t){for(var s,n=a(e,i),o=n.length;o--;)s=et(e,n[o]),e[s]=!(t[s]=n[o])}):function(e){return a(e,0,n)}):a}},pseudos:{not:s(function(e){var t=[],i=[],n=T(e.replace(lt,"$1"));return n[O]?s(function(e,t,i,s){for(var a,o=n(e,null,s,[]),r=e.length;r--;)(a=o[r])&&(e[r]=!(t[r]=a))}):function(e,s,a){return t[0]=e,n(t,null,a,i),t[0]=null,!i.pop()}}),has:s(function(e){return function(i){return t(e,i).length>0}}),contains:s(function(e){return e=e.replace(_t,Ct),function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),lang:s(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_t,Ct).toLowerCase(),function(t){var i;do if(i=E?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return mt.test(e.nodeName)},input:function(e){return gt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:h(function(){return[0]}),last:h(function(e,t){return[t-1]}),eq:h(function(e,t,i){return[0>i?i+t:i]}),even:h(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:h(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:h(function(e,t,i){for(var s=0>i?i+t:i;--s>=0;)e.push(s);return e}),gt:h(function(e,t,i){for(var s=0>i?i+t:i;++s<t;)e.push(s);return e})}},C.pseudos.nth=C.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[w]=r(w);for(w in{submit:!0,reset:!0})C.pseudos[w]=l(w);return c.prototype=C.filters=C.pseudos,C.setFilters=new c,k=t.tokenize=function(e,i){var s,n,a,o,r,l,h,d=W[e+" "];if(d)return i?0:d.slice(0);for(r=e,l=[],h=C.preFilter;r;){(!s||(n=ht.exec(r)))&&(n&&(r=r.slice(n[0].length)||r),l.push(a=[])),s=!1,(n=dt.exec(r))&&(s=n.shift(),a.push({value:s,type:n[0].replace(lt," ")}),r=r.slice(s.length));for(o in C.filter)!(n=ft[o].exec(r))||h[o]&&!(n=h[o](n))||(s=n.shift(),a.push({value:s,type:o,matches:n}),r=r.slice(s.length));if(!s)break}return i?r.length:r?t.error(e):W(e,l).slice(0)},T=t.compile=function(e,t){var i,s=[],n=[],a=q[e+" "];if(!a){for(t||(t=k(e)),i=t.length;i--;)a=b(t[i]),a[O]?s.push(a):n.push(a);a=q(e,y(n,s)),a.selector=e}return a},$=t.select=function(e,t,i,s){var n,a,o,r,l,h="function"==typeof e&&e,c=!s&&k(e=h.selector||e);if(i=i||[],1===c.length){if(a=c[0]=c[0].slice(0),a.length>2&&"ID"===(o=a[0]).type&&_.getById&&9===t.nodeType&&E&&C.relative[a[1].type]){if(t=(C.find.ID(o.matches[0].replace(_t,Ct),t)||[])[0],!t)return i;h&&(t=t.parentNode),e=e.slice(a.shift().value.length)}for(n=ft.needsContext.test(e)?0:a.length;n--&&(o=a[n],!C.relative[r=o.type]);)if((l=C.find[r])&&(s=l(o.matches[0].replace(_t,Ct),yt.test(a[0].type)&&d(t.parentNode)||t))){if(a.splice(n,1),e=s.length&&u(a),!e)return J.apply(i,s),i;break}}return(h||T(e,c))(s,t,!E,i,yt.test(e)&&d(t.parentNode)||t),i},_.sortStable=O.split("").sort(V).join("")===O,_.detectDuplicates=!!P,I(),_.sortDetached=n(function(e){return 1&e.compareDocumentPosition(M.createElement("div"))}),n(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&n(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),n(function(e){return null==e.getAttribute("disabled")})||a(tt,function(e,t,i){var s;return i?void 0:e[t]===!0?t.toLowerCase():(s=e.getAttributeNode(t))&&s.specified?s.value:null}),t}(e);Q.find=nt,Q.expr=nt.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=nt.uniqueSort,Q.text=nt.getText,Q.isXMLDoc=nt.isXML,Q.contains=nt.contains;var at=Q.expr.match.needsContext,ot=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rt=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,i){var s=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===s.nodeType?Q.find.matchesSelector(s,e)?[s]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))},Q.fn.extend({find:function(e){var t,i=this.length,s=[],n=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;i>t;t++)if(Q.contains(n[t],this))return!0}));for(t=0;i>t;t++)Q.find(e,n[t],s);return s=this.pushStack(i>1?Q.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(e){return this.pushStack(s(this,e||[],!1))},not:function(e){return this.pushStack(s(this,e||[],!0))},is:function(e){return!!s(this,"string"==typeof e&&at.test(e)?Q(e):e||[],!1).length}});var lt,ht=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,dt=Q.fn.init=function(e,t){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ht.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||lt).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Q?t[0]:t,Q.merge(this,Q.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:K,!0)),ot.test(i[1])&&Q.isPlainObject(t))for(i in t)Q.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return s=K.getElementById(i[2]),s&&s.parentNode&&(this.length=1,this[0]=s),this.context=K,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Q.isFunction(e)?"undefined"!=typeof lt.ready?lt.ready(e):e(Q):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))};dt.prototype=Q.fn,lt=Q(K);var ct=/^(?:parents|prev(?:Until|All))/,ut={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,i){for(var s=[],n=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&Q(e).is(i))break;s.push(e)}return s},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Q.fn.extend({has:function(e){var t=Q(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,s=0,n=this.length,a=[],o=at.test(e)||"string"!=typeof e?Q(e,t||this.context):0;n>s;s++)for(i=this[s];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,e))){a.push(i);break}return this.pushStack(a.length>1?Q.unique(a):a)},index:function(e){return e?"string"==typeof e?V.call(Q(e),this[0]):V.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Q.dir(e,"parentNode",i)},next:function(e){return n(e,"nextSibling")},prev:function(e){return n(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Q.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Q.dir(e,"previousSibling",i)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(i,s){var n=Q.map(this,t,i);return"Until"!==e.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=Q.filter(s,n)),this.length>1&&(ut[e]||Q.unique(n),ct.test(e)&&n.reverse()),this.pushStack(n)}});var pt=/\S+/g,ft={};Q.Callbacks=function(e){e="string"==typeof e?ft[e]||a(e):Q.extend({},e);var t,i,s,n,o,r,l=[],h=!e.once&&[],d=function(a){for(t=e.memory&&a,i=!0,r=n||0,n=0,o=l.length,s=!0;l&&o>r;r++)if(l[r].apply(a[0],a[1])===!1&&e.stopOnFalse){t=!1;break}s=!1,l&&(h?h.length&&d(h.shift()):t?l=[]:c.disable())},c={add:function(){if(l){var i=l.length;!function a(t){Q.each(t,function(t,i){var s=Q.type(i);"function"===s?e.unique&&c.has(i)||l.push(i):i&&i.length&&"string"!==s&&a(i)})}(arguments),s?o=l.length:t&&(n=i,d(t))}return this},remove:function(){return l&&Q.each(arguments,function(e,t){for(var i;(i=Q.inArray(t,l,i))>-1;)l.splice(i,1),s&&(o>=i&&o--,r>=i&&r--)}),this},has:function(e){return e?Q.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=h=t=void 0,this},disabled:function(){return!l},lock:function(){return h=void 0,t||c.disable(),this},locked:function(){return!h},fireWith:function(e,t){return!l||i&&!h||(t=t||[],t=[e,t.slice?t.slice():t],s?h.push(t):d(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(i){Q.each(t,function(t,a){var o=Q.isFunction(e[t])&&e[t];n[a[1]](function(){var e=o&&o.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a[0]+"With"](this===s?i.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,s):s}},n={};return s.pipe=s.then,Q.each(t,function(e,a){var o=a[2],r=a[3];s[a[1]]=o.add,r&&o.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),n[a[0]]=function(){return n[a[0]+"With"](this===n?s:this,arguments),this},n[a[0]+"With"]=o.fireWith}),s.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,s,n=0,a=U.call(arguments),o=a.length,r=1!==o||e&&Q.isFunction(e.promise)?o:0,l=1===r?e:Q.Deferred(),h=function(e,i,s){return function(n){i[e]=this,s[e]=arguments.length>1?U.call(arguments):n,s===t?l.notifyWith(i,s):--r||l.resolveWith(i,s)}};if(o>1)for(t=new Array(o),i=new Array(o),s=new Array(o);o>n;n++)a[n]&&Q.isFunction(a[n].promise)?a[n].promise().done(h(n,s,a)).fail(l.reject).progress(h(n,i,t)):--r;return r||l.resolveWith(s,a),l.promise()}});var gt;Q.fn.ready=function(e){return Q.ready.promise().done(e),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){(e===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,e!==!0&&--Q.readyWait>0||(gt.resolveWith(K,[Q]),Q.fn.triggerHandler&&(Q(K).triggerHandler("ready"),Q(K).off("ready"))))}}),Q.ready.promise=function(t){return gt||(gt=Q.Deferred(),"complete"===K.readyState?setTimeout(Q.ready):(K.addEventListener("DOMContentLoaded",o,!1),e.addEventListener("load",o,!1))),gt.promise(t)},Q.ready.promise();var mt=Q.access=function(e,t,i,s,n,a,o){var r=0,l=e.length,h=null==i;if("object"===Q.type(i)){n=!0;for(r in i)Q.access(e,t,r,i[r],!0,a,o)}else if(void 0!==s&&(n=!0,Q.isFunction(s)||(o=!0),h&&(o?(t.call(e,s),t=null):(h=t,t=function(e,t,i){return h.call(Q(e),i)})),t))for(;l>r;r++)t(e[r],i,o?s:s.call(e[r],r,t(e[r],i)));return n?e:h?t.call(e):l?t(e[0],i):a};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},r.uid=1,r.accepts=Q.acceptData,r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=r.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(s){t[this.expando]=i,Q.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var s,n=this.key(e),a=this.cache[n];if("string"==typeof t)a[t]=i;else if(Q.isEmptyObject(a))Q.extend(this.cache[n],t);else for(s in t)a[s]=t[s];return a},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var s;return void 0===t||t&&"string"==typeof t&&void 0===i?(s=this.get(e,t),void 0!==s?s:this.get(e,Q.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,s,n,a=this.key(e),o=this.cache[a];if(void 0===t)this.cache[a]={};else{Q.isArray(t)?s=t.concat(t.map(Q.camelCase)):(n=Q.camelCase(t),t in o?s=[t,n]:(s=n,s=s in o?[s]:s.match(pt)||[])),i=s.length;for(;i--;)delete o[s[i]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var vt=new r,bt=new r,yt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,wt=/([A-Z])/g;Q.extend({hasData:function(e){return bt.hasData(e)||vt.hasData(e)},data:function(e,t,i){return bt.access(e,t,i)},removeData:function(e,t){bt.remove(e,t)},_data:function(e,t,i){return vt.access(e,t,i)},_removeData:function(e,t){vt.remove(e,t)}}),Q.fn.extend({data:function(e,t){var i,s,n,a=this[0],o=a&&a.attributes;if(void 0===e){if(this.length&&(n=bt.get(a),1===a.nodeType&&!vt.get(a,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&(s=o[i].name,0===s.indexOf("data-")&&(s=Q.camelCase(s.slice(5)),l(a,s,n[s])));vt.set(a,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each(function(){bt.set(this,e)}):mt(this,function(t){var i,s=Q.camelCase(e);if(a&&void 0===t){if(i=bt.get(a,e),void 0!==i)return i;if(i=bt.get(a,s),void 0!==i)return i;if(i=l(a,s,void 0),void 0!==i)return i}else this.each(function(){var i=bt.get(this,s);bt.set(this,s,t),-1!==e.indexOf("-")&&void 0!==i&&bt.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){bt.remove(this,e)})}}),Q.extend({queue:function(e,t,i){var s;return e?(t=(t||"fx")+"queue",s=vt.get(e,t),i&&(!s||Q.isArray(i)?s=vt.access(e,t,Q.makeArray(i)):s.push(i)),s||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Q.queue(e,t),s=i.length,n=i.shift(),a=Q._queueHooks(e,t),o=function(){Q.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===t&&i.unshift("inprogress"),delete a.stop,n.call(e,o,a)),!s&&a&&a.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return vt.get(e,i)||vt.access(e,i,{empty:Q.Callbacks("once memory").add(function(){vt.remove(e,[t+"queue",i])})})}}),Q.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Q.queue(this[0],e):void 0===t?this:this.each(function(){var i=Q.queue(this,e,t);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,s=1,n=Q.Deferred(),a=this,o=this.length,r=function(){--s||n.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)i=vt.get(a[o],e+"queueHooks"),i&&i.empty&&(s++,i.empty.add(r));return r(),n.promise(t)}});var _t=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=["Top","Right","Bottom","Left"],xt=function(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},St=/^(?:checkbox|radio)$/i;!function(){var e=K.createDocumentFragment(),t=e.appendChild(K.createElement("div")),i=K.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),Z.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var kt="undefined";Z.focusinBubbles="onfocusin"in e;var Tt=/^key/,$t=/^(?:mouse|pointer|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,Dt=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,i,s,n){var a,o,r,l,h,d,c,u,p,f,g,m=vt.get(e);if(m)for(i.handler&&(a=i,i=a.handler,n=a.selector),i.guid||(i.guid=Q.guid++),(l=m.events)||(l=m.events={}),(o=m.handle)||(o=m.handle=function(t){return typeof Q!==kt&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pt)||[""],h=t.length;h--;)r=Dt.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p&&(c=Q.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,c=Q.event.special[p]||{},d=Q.extend({type:p,origType:g,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&Q.expr.match.needsContext.test(n),namespace:f.join(".")},a),(u=l[p])||(u=l[p]=[],u.delegateCount=0,c.setup&&c.setup.call(e,s,f,o)!==!1||e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),n?u.splice(u.delegateCount++,0,d):u.push(d),Q.event.global[p]=!0)},remove:function(e,t,i,s,n){var a,o,r,l,h,d,c,u,p,f,g,m=vt.hasData(e)&&vt.get(e);if(m&&(l=m.events)){for(t=(t||"").match(pt)||[""],h=t.length;h--;)if(r=Dt.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p){for(c=Q.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,u=l[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=a=u.length;a--;)d=u[a],!n&&g!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||s&&s!==d.selector&&("**"!==s||!d.selector)||(u.splice(a,1),d.selector&&u.delegateCount--,c.remove&&c.remove.call(e,d));o&&!u.length&&(c.teardown&&c.teardown.call(e,f,m.handle)!==!1||Q.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)Q.event.remove(e,p+t[h],i,s,!0);Q.isEmptyObject(l)&&(delete m.handle,vt.remove(e,"events"))}},trigger:function(t,i,s,n){var a,o,r,l,h,d,c,u=[s||K],p=X.call(t,"type")?t.type:t,f=X.call(t,"namespace")?t.namespace.split("."):[];if(o=r=s=s||K,3!==s.nodeType&&8!==s.nodeType&&!At.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),h=p.indexOf(":")<0&&"on"+p,t=t[Q.expando]?t:new Q.Event(p,"object"==typeof t&&t),t.isTrigger=n?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=s),i=null==i?[t]:Q.makeArray(i,[t]),c=Q.event.special[p]||{},n||!c.trigger||c.trigger.apply(s,i)!==!1)){if(!n&&!c.noBubble&&!Q.isWindow(s)){for(l=c.delegateType||p,At.test(l+p)||(o=o.parentNode);o;o=o.parentNode)u.push(o),r=o;r===(s.ownerDocument||K)&&u.push(r.defaultView||r.parentWindow||e)}for(a=0;(o=u[a++])&&!t.isPropagationStopped();)t.type=a>1?l:c.bindType||p,d=(vt.get(o,"events")||{})[t.type]&&vt.get(o,"handle"),d&&d.apply(o,i),d=h&&o[h],d&&d.apply&&Q.acceptData(o)&&(t.result=d.apply(o,i),t.result===!1&&t.preventDefault());return t.type=p,n||t.isDefaultPrevented()||c._default&&c._default.apply(u.pop(),i)!==!1||!Q.acceptData(s)||h&&Q.isFunction(s[p])&&!Q.isWindow(s)&&(r=s[h],r&&(s[h]=null),Q.event.triggered=p,s[p](),Q.event.triggered=void 0,r&&(s[h]=r)),t.result}},dispatch:function(e){e=Q.event.fix(e);var t,i,s,n,a,o=[],r=U.call(arguments),l=(vt.get(this,"events")||{})[e.type]||[],h=Q.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,e)!==!1){for(o=Q.event.handlers.call(this,e,l),t=0;(n=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=n.elem,i=0;(a=n.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,s=((Q.event.special[a.origType]||{}).handle||a.handler).apply(n.elem,r),void 0!==s&&(e.result=s)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,s,n,a,o=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(s=[],i=0;r>i;i++)a=t[i],n=a.selector+" ",void 0===s[n]&&(s[n]=a.needsContext?Q(n,this).index(l)>=0:Q.find(n,this,null,[l]).length),s[n]&&s.push(a);
s.length&&o.push({elem:l,handlers:s})}return r<t.length&&o.push({elem:this,handlers:t.slice(r)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,s,n,a=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||K,s=i.documentElement,n=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,i,s,n=e.type,a=e,o=this.fixHooks[n];for(o||(this.fixHooks[n]=o=$t.test(n)?this.mouseHooks:Tt.test(n)?this.keyHooks:{}),s=o.props?this.props.concat(o.props):this.props,e=new Q.Event(a),t=s.length;t--;)i=s[t],e[i]=a[i];return e.target||(e.target=K),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,a):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==c()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,s){var n=Q.extend(new Q.Event,i,{type:e,isSimulated:!0,originalEvent:{}});s?Q.event.trigger(n,null,t):Q.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Q.Event=function(e,t){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?h:d):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(e,t)},Q.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=h,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,s=this,n=e.relatedTarget,a=e.handleObj;return(!n||n!==s&&!Q.contains(s,n))&&(e.type=a.origType,i=a.handler.apply(this,arguments),e.type=t),i}}}),Z.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var s=this.ownerDocument||this,n=vt.access(s,t);n||s.addEventListener(e,i,!0),vt.access(s,t,(n||0)+1)},teardown:function(){var s=this.ownerDocument||this,n=vt.access(s,t)-1;n?vt.access(s,t,n):(s.removeEventListener(e,i,!0),vt.remove(s,t))}}}),Q.fn.extend({on:function(e,t,i,s,n){var a,o;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(o in e)this.on(o,t,i,e[o],n);return this}if(null==i&&null==s?(s=t,i=t=void 0):null==s&&("string"==typeof t?(s=i,i=void 0):(s=i,i=t,t=void 0)),s===!1)s=d;else if(!s)return this;return 1===n&&(a=s,s=function(e){return Q().off(e),a.apply(this,arguments)},s.guid=a.guid||(a.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,s,i,t)})},one:function(e,t,i,s){return this.on(e,t,i,s,1)},off:function(e,t,i){var s,n;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,Q(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=d),this.each(function(){Q.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Q.event.trigger(e,t,i,!0):void 0}});var Pt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,It=/<([\w:]+)/,Mt=/<|&#?\w+;/,Lt=/<(?:script|style|link)/i,Et=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^$|\/(?:java|ecma)script/i,Nt=/^true\/(.*)/,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Bt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Bt.optgroup=Bt.option,Bt.tbody=Bt.tfoot=Bt.colgroup=Bt.caption=Bt.thead,Bt.th=Bt.td,Q.extend({clone:function(e,t,i){var s,n,a,o,r=e.cloneNode(!0),l=Q.contains(e.ownerDocument,e);if(!(Z.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(o=v(r),a=v(e),s=0,n=a.length;n>s;s++)b(a[s],o[s]);if(t)if(i)for(a=a||v(e),o=o||v(r),s=0,n=a.length;n>s;s++)m(a[s],o[s]);else m(e,r);return o=v(r,"script"),o.length>0&&g(o,!l&&v(e,"script")),r},buildFragment:function(e,t,i,s){for(var n,a,o,r,l,h,d=t.createDocumentFragment(),c=[],u=0,p=e.length;p>u;u++)if(n=e[u],n||0===n)if("object"===Q.type(n))Q.merge(c,n.nodeType?[n]:n);else if(Mt.test(n)){for(a=a||d.appendChild(t.createElement("div")),o=(It.exec(n)||["",""])[1].toLowerCase(),r=Bt[o]||Bt._default,a.innerHTML=r[1]+n.replace(Pt,"<$1></$2>")+r[2],h=r[0];h--;)a=a.lastChild;Q.merge(c,a.childNodes),a=d.firstChild,a.textContent=""}else c.push(t.createTextNode(n));for(d.textContent="",u=0;n=c[u++];)if((!s||-1===Q.inArray(n,s))&&(l=Q.contains(n.ownerDocument,n),a=v(d.appendChild(n),"script"),l&&g(a),i))for(h=0;n=a[h++];)Ft.test(n.type||"")&&i.push(n);return d},cleanData:function(e){for(var t,i,s,n,a=Q.event.special,o=0;void 0!==(i=e[o]);o++){if(Q.acceptData(i)&&(n=i[vt.expando],n&&(t=vt.cache[n]))){if(t.events)for(s in t.events)a[s]?Q.event.remove(i,s):Q.removeEvent(i,s,t.handle);vt.cache[n]&&delete vt.cache[n]}delete bt.cache[i[bt.expando]]}}}),Q.fn.extend({text:function(e){return mt(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,s=e?Q.filter(e,this):this,n=0;null!=(i=s[n]);n++)t||1!==i.nodeType||Q.cleanData(v(i)),i.parentNode&&(t&&Q.contains(i.ownerDocument,i)&&g(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Q.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return mt(this,function(e){var t=this[0]||{},i=0,s=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Lt.test(e)&&!Bt[(It.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pt,"<$1></$2>");try{for(;s>i;i++)t=this[i]||{},1===t.nodeType&&(Q.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(n){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Q.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=W.apply([],e);var i,s,n,a,o,r,l=0,h=this.length,d=this,c=h-1,u=e[0],g=Q.isFunction(u);if(g||h>1&&"string"==typeof u&&!Z.checkClone&&Et.test(u))return this.each(function(i){var s=d.eq(i);g&&(e[0]=u.call(this,i,s.html())),s.domManip(e,t)});if(h&&(i=Q.buildFragment(e,this[0].ownerDocument,!1,this),s=i.firstChild,1===i.childNodes.length&&(i=s),s)){for(n=Q.map(v(i,"script"),p),a=n.length;h>l;l++)o=i,l!==c&&(o=Q.clone(o,!0,!0),a&&Q.merge(n,v(o,"script"))),t.call(this[l],o,l);if(a)for(r=n[n.length-1].ownerDocument,Q.map(n,f),l=0;a>l;l++)o=n[l],Ft.test(o.type||"")&&!vt.access(o,"globalEval")&&Q.contains(r,o)&&(o.src?Q._evalUrl&&Q._evalUrl(o.src):Q.globalEval(o.textContent.replace(Rt,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var i,s=[],n=Q(e),a=n.length-1,o=0;a>=o;o++)i=o===a?this:this.clone(!0),Q(n[o])[t](i),q.apply(s,i.get());return this.pushStack(s)}});var Ot,zt={},jt=/^margin/,Ht=new RegExp("^("+_t+")(?!px)[a-z%]+$","i"),Ut=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",n.appendChild(a);var t=e.getComputedStyle(o,null);i="1%"!==t.top,s="4px"===t.width,n.removeChild(a)}var i,s,n=K.documentElement,a=K.createElement("div"),o=K.createElement("div");o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===o.style.backgroundClip,a.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",a.appendChild(o),e.getComputedStyle&&Q.extend(Z,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==s&&t(),s},reliableMarginRight:function(){var t,i=o.appendChild(K.createElement("div"));return i.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",o.style.width="1px",n.appendChild(a),t=!parseFloat(e.getComputedStyle(i,null).marginRight),n.removeChild(a),o.removeChild(i),t}}))}(),Q.swap=function(e,t,i,s){var n,a,o={};for(a in t)o[a]=e.style[a],e.style[a]=t[a];n=i.apply(e,s||[]);for(a in t)e.style[a]=o[a];return n};var Wt=/^(none|table(?!-c[ea]).+)/,qt=new RegExp("^("+_t+")(.*)$","i"),Vt=new RegExp("^([+-])=("+_t+")","i"),Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=_(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,a,o,r=Q.camelCase(t),l=e.style;return t=Q.cssProps[r]||(Q.cssProps[r]=x(l,r)),o=Q.cssHooks[t]||Q.cssHooks[r],void 0===i?o&&"get"in o&&void 0!==(n=o.get(e,!1,s))?n:l[t]:(a=typeof i,"string"===a&&(n=Vt.exec(i))&&(i=(n[1]+1)*n[2]+parseFloat(Q.css(e,t)),a="number"),null!=i&&i===i&&("number"!==a||Q.cssNumber[r]||(i+="px"),Z.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(i=o.set(e,i,s))||(l[t]=i)),void 0)}},css:function(e,t,i,s){var n,a,o,r=Q.camelCase(t);return t=Q.cssProps[r]||(Q.cssProps[r]=x(e.style,r)),o=Q.cssHooks[t]||Q.cssHooks[r],o&&"get"in o&&(n=o.get(e,!0,i)),void 0===n&&(n=_(e,t,s)),"normal"===n&&t in Yt&&(n=Yt[t]),""===i||i?(a=parseFloat(n),i===!0||Q.isNumeric(a)?a||0:n):n}}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,i,s){return i?Wt.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,Gt,function(){return T(e,t,s)}):T(e,t,s):void 0},set:function(e,i,s){var n=s&&Ut(e);return S(e,i,s?k(e,t,s,"border-box"===Q.css(e,"boxSizing",!1,n),n):0)}}}),Q.cssHooks.marginRight=C(Z.reliableMarginRight,function(e,t){return t?Q.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(i){for(var s=0,n={},a="string"==typeof i?i.split(" "):[i];4>s;s++)n[e+Ct[s]+t]=a[s]||a[s-2]||a[0];return n}},jt.test(e)||(Q.cssHooks[e+t].set=S)}),Q.fn.extend({css:function(e,t){return mt(this,function(e,t,i){var s,n,a={},o=0;if(Q.isArray(t)){for(s=Ut(e),n=t.length;n>o;o++)a[t[o]]=Q.css(e,t[o],!1,s);return a}return void 0!==i?Q.style(e,t,i):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return $(this,!0)},hide:function(){return $(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){xt(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=A,A.prototype={constructor:A,init:function(e,t,i,s,n,a){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=s,this.unit=a||(Q.cssNumber[i]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,i=A.propHooks[this.prop];return this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.fx=A.prototype.init,Q.fx.step={};var Zt,Kt,Jt=/^(?:toggle|show|hide)$/,Qt=new RegExp("^(?:([+-])=|)("+_t+")([a-z%]*)$","i"),ei=/queueHooks$/,ti=[M],ii={"*":[function(e,t){var i=this.createTween(e,t),s=i.cur(),n=Qt.exec(t),a=n&&n[3]||(Q.cssNumber[e]?"":"px"),o=(Q.cssNumber[e]||"px"!==a&&+s)&&Qt.exec(Q.css(i.elem,e)),r=1,l=20;if(o&&o[3]!==a){a=a||o[3],n=n||[],o=+s||1;do r=r||".5",o/=r,Q.style(i.elem,e,o+a);while(r!==(r=i.cur()/s)&&1!==r&&--l)}return n&&(o=i.start=+o||+s||0,i.unit=a,i.end=n[1]?o+(n[1]+1)*n[2]:+n[2]),i}]};Q.Animation=Q.extend(E,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,s=0,n=e.length;n>s;s++)i=e[s],ii[i]=ii[i]||[],ii[i].unshift(t)},prefilter:function(e,t){t?ti.unshift(e):ti.push(e)}}),Q.speed=function(e,t,i){var s=e&&"object"==typeof e?Q.extend({},e):{complete:i||!i&&t||Q.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Q.isFunction(t)&&t};return s.duration=Q.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in Q.fx.speeds?Q.fx.speeds[s.duration]:Q.fx.speeds._default,(null==s.queue||s.queue===!0)&&(s.queue="fx"),s.old=s.complete,s.complete=function(){Q.isFunction(s.old)&&s.old.call(this),s.queue&&Q.dequeue(this,s.queue)},s},Q.fn.extend({fadeTo:function(e,t,i,s){return this.filter(xt).css("opacity",0).show().end().animate({opacity:t},e,i,s)},animate:function(e,t,i,s){var n=Q.isEmptyObject(e),a=Q.speed(t,i,s),o=function(){var t=E(this,Q.extend({},e),a);(n||vt.get(this,"finish"))&&t.stop(!0)};return o.finish=o,n||a.queue===!1?this.each(o):this.queue(a.queue,o)},stop:function(e,t,i){var s=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",a=Q.timers,o=vt.get(this);if(n)o[n]&&o[n].stop&&s(o[n]);else for(n in o)o[n]&&o[n].stop&&ei.test(n)&&s(o[n]);for(n=a.length;n--;)a[n].elem!==this||null!=e&&a[n].queue!==e||(a[n].anim.stop(i),t=!1,a.splice(n,1));(t||!i)&&Q.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=vt.get(this),s=i[e+"queue"],n=i[e+"queueHooks"],a=Q.timers,o=s?s.length:0;for(i.finish=!0,Q.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;o>t;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(e,t){var i=Q.fn[t];Q.fn[t]=function(e,s,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(P(t,!0),e,s,n)}}),Q.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,i,s){return this.animate(t,e,i,s)}}),Q.timers=[],Q.fx.tick=function(){var e,t=0,i=Q.timers;for(Zt=Q.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Q.fx.stop(),Zt=void 0},Q.fx.timer=function(e){Q.timers.push(e),e()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Kt||(Kt=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Kt),Kt=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var s=setTimeout(t,e);i.stop=function(){clearTimeout(s)}})},function(){var e=K.createElement("input"),t=K.createElement("select"),i=t.appendChild(K.createElement("option"));e.type="checkbox",Z.checkOn=""!==e.value,Z.optSelected=i.selected,t.disabled=!0,Z.optDisabled=!i.disabled,e=K.createElement("input"),e.value="t",e.type="radio",Z.radioValue="t"===e.value}();var si,ni,ai=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return mt(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}}),Q.extend({attr:function(e,t,i){var s,n,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===kt?Q.prop(e,t,i):(1===a&&Q.isXMLDoc(e)||(t=t.toLowerCase(),s=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?ni:si)),void 0===i?s&&"get"in s&&null!==(n=s.get(e,t))?n:(n=Q.find.attr(e,t),null==n?void 0:n):null!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:(e.setAttribute(t,i+""),i):void Q.removeAttr(e,t))},removeAttr:function(e,t){var i,s,n=0,a=t&&t.match(pt);if(a&&1===e.nodeType)for(;i=a[n++];)s=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(e[s]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!Z.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),ni={set:function(e,t,i){return t===!1?Q.removeAttr(e,i):e.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var i=ai[t]||Q.find.attr;ai[t]=function(e,t,s){var n,a;return s||(a=ai[t],ai[t]=n,n=null!=i(e,t,s)?t.toLowerCase():null,ai[t]=a),n}});var oi=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return mt(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}}),Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var s,n,a,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return a=1!==o||!Q.isXMLDoc(e),a&&(t=Q.propFix[t]||t,n=Q.propHooks[t]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:e[t]=i:n&&"get"in n&&null!==(s=n.get(e,t))?s:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||oi.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Z.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var ri=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,i,s,n,a,o,r="string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pt)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ri," "):" ")){for(a=0;n=t[a++];)s.indexOf(" "+n+" ")<0&&(s+=n+" ");o=Q.trim(s),i.className!==o&&(i.className=o)}return this},removeClass:function(e){var t,i,s,n,a,o,r=0===arguments.length||"string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pt)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ri," "):"")){for(a=0;n=t[a++];)for(;s.indexOf(" "+n+" ")>=0;)s=s.replace(" "+n+" "," ");o=e?Q.trim(s):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(Q.isFunction(e)?function(i){Q(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,s=0,n=Q(this),a=e.match(pt)||[];t=a[s++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else(i===kt||"boolean"===i)&&(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,s=this.length;s>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ri," ").indexOf(t)>=0)return!0;return!1}});var li=/\r/g;Q.fn.extend({val:function(e){var t,i,s,n=this[0];{if(arguments.length)return s=Q.isFunction(e),this.each(function(i){var n;1===this.nodeType&&(n=s?e.call(this,i,Q(this).val()):e,null==n?n="":"number"==typeof n?n+="":Q.isArray(n)&&(n=Q.map(n,function(e){return null==e?"":e+""})),t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))});if(n)return t=Q.valHooks[n.type]||Q.valHooks[n.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(n,"value"))?i:(i=n.value,"string"==typeof i?i.replace(li,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,i,s=e.options,n=e.selectedIndex,a="select-one"===e.type||0>n,o=a?null:[],r=a?n+1:s.length,l=0>n?r:a?n:0;r>l;l++)if(i=s[l],!(!i.selected&&l!==n||(Z.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(t=Q(i).val(),a)return t;o.push(t)}return o},set:function(e,t){for(var i,s,n=e.options,a=Q.makeArray(t),o=n.length;o--;)s=n[o],(s.selected=Q.inArray(s.value,a)>=0)&&(i=!0);return i||(e.selectedIndex=-1),a}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}},Z.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,s){return this.on(t,e,i,s)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var hi=Q.now(),di=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")},Q.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(s){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+e),t};var ci=/#.*$/,ui=/([?&])_=[^&]*/,pi=/^(.*?):[ \t]*([^\r\n]*)$/gm,fi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gi=/^(?:GET|HEAD)$/,mi=/^\/\//,vi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bi={},yi={},wi="*/".concat("*"),_i=e.location.href,Ci=vi.exec(_i.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_i,type:"GET",isLocal:fi.test(Ci[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?R(R(e,Q.ajaxSettings),t):R(Q.ajaxSettings,e)},ajaxPrefilter:F(bi),ajaxTransport:F(yi),ajax:function(e,t){function i(e,t,i,o){var l,d,v,b,w,C=t;2!==y&&(y=2,r&&clearTimeout(r),s=void 0,a=o||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(b=B(c,_,i)),b=O(c,b,_,l),l?(c.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(Q.lastModified[n]=w),w=_.getResponseHeader("etag"),w&&(Q.etag[n]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,d=b.data,v=b.error,l=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),_.status=e,_.statusText=(t||C)+"",l?f.resolveWith(u,[d,C,_]):f.rejectWith(u,[_,C,v]),_.statusCode(m),m=void 0,h&&p.trigger(l?"ajaxSuccess":"ajaxError",[_,c,l?d:v]),g.fireWith(u,[_,C]),h&&(p.trigger("ajaxComplete",[_,c]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var s,n,a,o,r,l,h,d,c=Q.ajaxSetup({},t),u=c.context||c,p=c.context&&(u.nodeType||u.jquery)?Q(u):Q.event,f=Q.Deferred(),g=Q.Callbacks("once memory"),m=c.statusCode||{},v={},b={},y=0,w="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!o)for(o={};t=pi.exec(a);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return y||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)m[t]=[m[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||w;return s&&s.abort(t),i(0,t),this}};if(f.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,c.url=((e||c.url||_i)+"").replace(ci,"").replace(mi,Ci[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=Q.trim(c.dataType||"*").toLowerCase().match(pt)||[""],null==c.crossDomain&&(l=vi.exec(c.url.toLowerCase()),c.crossDomain=!(!l||l[1]===Ci[1]&&l[2]===Ci[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Ci[3]||("http:"===Ci[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=Q.param(c.data,c.traditional)),N(bi,c,t,_),2===y)return _;h=Q.event&&c.global,h&&0===Q.active++&&Q.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!gi.test(c.type),n=c.url,c.hasContent||(c.data&&(n=c.url+=(di.test(n)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=ui.test(n)?n.replace(ui,"$1_="+hi++):n+(di.test(n)?"&":"?")+"_="+hi++)),c.ifModified&&(Q.lastModified[n]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[n]),Q.etag[n]&&_.setRequestHeader("If-None-Match",Q.etag[n])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",c.contentType),_.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+wi+"; q=0.01":""):c.accepts["*"]);for(d in c.headers)_.setRequestHeader(d,c.headers[d]);if(c.beforeSend&&(c.beforeSend.call(u,_,c)===!1||2===y))return _.abort();w="abort";for(d in{success:1,error:1,complete:1})_[d](c[d]);if(s=N(yi,c,t,_)){_.readyState=1,h&&p.trigger("ajaxSend",[_,c]),c.async&&c.timeout>0&&(r=setTimeout(function(){_.abort("timeout")},c.timeout));try{y=1,s.send(v,i)}catch(C){if(!(2>y))throw C;i(-1,C)}}else i(-1,"No Transport");return _},getJSON:function(e,t,i){return Q.get(e,t,i,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}}),Q.each(["get","post"],function(e,t){Q[t]=function(e,i,s,n){return Q.isFunction(i)&&(n=n||s,s=i,i=void 0),Q.ajax({url:e,type:t,dataType:n,data:i,success:s})}}),Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Q.fn.extend({wrapAll:function(e){var t;return Q.isFunction(e)?this.each(function(t){Q(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Q(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Q.isFunction(e)?function(t){Q(this).wrapInner(e.call(this,t))}:function(){var t=Q(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(i){Q(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var xi=/%20/g,Si=/\[\]$/,ki=/\r?\n/g,Ti=/^(?:submit|button|image|reset|file)$/i,$i=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var i,s=[],n=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){n(this.name,this.value)});else for(i in e)z(i,e[i],t,n);return s.join("&").replace(xi,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&$i.test(this.nodeName)&&!Ti.test(e)&&(this.checked||!St.test(e))}).map(function(e,t){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(e){return{name:t.name,value:e.replace(ki,"\r\n")}}):{name:t.name,value:i.replace(ki,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Ai=0,Di={},Pi={0:200,1223:204},Ii=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Di)Di[e]()}),Z.cors=!!Ii&&"withCredentials"in Ii,Z.ajax=Ii=!!Ii,Q.ajaxTransport(function(e){var t;return Z.cors||Ii&&!e.crossDomain?{send:function(i,s){var n,a=e.xhr(),o=++Ai;if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(n in e.xhrFields)a[n]=e.xhrFields[n];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(n in i)a.setRequestHeader(n,i[n]);t=function(e){return function(){t&&(delete Di[o],t=a.onload=a.onerror=null,"abort"===e?a.abort():"error"===e?s(a.status,a.statusText):s(Pi[a.status]||a.status,a.statusText,"string"==typeof a.responseText?{text:a.responseText}:void 0,a.getAllResponseHeaders()))}},a.onload=t(),a.onerror=t("error"),t=Di[o]=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(r){if(t)throw r
}},abort:function(){t&&t()}}:void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(s,n){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&n("error"===e.type?404:200,e.type)}),K.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Mi=[],Li=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mi.pop()||Q.expando+"_"+hi++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(t,i,s){var n,a,o,r=t.jsonp!==!1&&(Li.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Li.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Li,"$1"+n):t.jsonp!==!1&&(t.url+=(di.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return o||Q.error(n+" was not called"),o[0]},t.dataTypes[0]="json",a=e[n],e[n]=function(){o=arguments},s.always(function(){e[n]=a,t[n]&&(t.jsonpCallback=i.jsonpCallback,Mi.push(n)),o&&Q.isFunction(a)&&a(o[0]),o=a=void 0}),"script"):void 0}),Q.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||K;var s=ot.exec(e),n=!i&&[];return s?[t.createElement(s[1])]:(s=Q.buildFragment([e],t,n),n&&n.length&&Q(n).remove(),Q.merge([],s.childNodes))};var Ei=Q.fn.load;Q.fn.load=function(e,t,i){if("string"!=typeof e&&Ei)return Ei.apply(this,arguments);var s,n,a,o=this,r=e.indexOf(" ");return r>=0&&(s=Q.trim(e.slice(r)),e=e.slice(0,r)),Q.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(n="POST"),o.length>0&&Q.ajax({url:e,type:n,dataType:"html",data:t}).done(function(e){a=arguments,o.html(s?Q("<div>").append(Q.parseHTML(e)).find(s):e)}).complete(i&&function(e,t){o.each(i,a||[e.responseText,t,e])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Fi=e.document.documentElement;Q.offset={setOffset:function(e,t,i){var s,n,a,o,r,l,h,d=Q.css(e,"position"),c=Q(e),u={};"static"===d&&(e.style.position="relative"),r=c.offset(),a=Q.css(e,"top"),l=Q.css(e,"left"),h=("absolute"===d||"fixed"===d)&&(a+l).indexOf("auto")>-1,h?(s=c.position(),o=s.top,n=s.left):(o=parseFloat(a)||0,n=parseFloat(l)||0),Q.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(u.top=t.top-r.top+o),null!=t.left&&(u.left=t.left-r.left+n),"using"in t?t.using.call(e,u):c.css(u)}},Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,i,s=this[0],n={top:0,left:0},a=s&&s.ownerDocument;if(a)return t=a.documentElement,Q.contains(t,s)?(typeof s.getBoundingClientRect!==kt&&(n=s.getBoundingClientRect()),i=j(a),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n},position:function(){if(this[0]){var e,t,i=this[0],s={top:0,left:0};return"fixed"===Q.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Q.nodeName(e[0],"html")||(s=e.offset()),s.top+=Q.css(e[0],"borderTopWidth",!0),s.left+=Q.css(e[0],"borderLeftWidth",!0)),{top:t.top-s.top-Q.css(i,"marginTop",!0),left:t.left-s.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Fi;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Fi})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var s="pageYOffset"===i;Q.fn[t]=function(n){return mt(this,function(t,n,a){var o=j(t);return void 0===a?o?o[i]:t[n]:void(o?o.scrollTo(s?e.pageXOffset:a,s?a:e.pageYOffset):t[n]=a)},t,n,arguments.length,null)}}),Q.each(["top","left"],function(e,t){Q.cssHooks[t]=C(Z.pixelPosition,function(e,i){return i?(i=_(e,t),Ht.test(i)?Q(e).position()[t]+"px":i):void 0})}),Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,s){Q.fn[s]=function(s,n){var a=arguments.length&&(i||"boolean"!=typeof s),o=i||(s===!0||n===!0?"margin":"border");return mt(this,function(t,i,s){var n;return Q.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])):void 0===s?Q.css(t,i,o):Q.style(t,i,s,o)},t,a?s:void 0,a,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Ni=e.jQuery,Ri=e.$;return Q.noConflict=function(t){return e.$===Q&&(e.$=Ri),t&&e.jQuery===Q&&(e.jQuery=Ni),Q},typeof t===kt&&(e.jQuery=e.$=Q),Q}),define("jquery_modern",function(){}),function(){var e=this,t=e._,i={},s=Array.prototype,n=Object.prototype,a=Function.prototype,o=s.push,r=s.slice,l=s.concat,h=n.toString,d=n.hasOwnProperty,c=s.forEach,u=s.map,p=s.reduce,f=s.reduceRight,g=s.filter,m=s.every,v=s.some,b=s.indexOf,y=s.lastIndexOf,w=Array.isArray,_=Object.keys,C=a.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var S=x.each=x.forEach=function(e,t,s){if(null!=e)if(c&&e.forEach===c)e.forEach(t,s);else if(e.length===+e.length){for(var n=0,a=e.length;a>n;n++)if(t.call(s,e[n],n,e)===i)return}else for(var o in e)if(x.has(e,o)&&t.call(s,e[o],o,e)===i)return};x.map=x.collect=function(e,t,i){var s=[];return null==e?s:u&&e.map===u?e.map(t,i):(S(e,function(e,n,a){s[s.length]=t.call(i,e,n,a)}),s)};var k="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,s){var n=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return s&&(t=x.bind(t,s)),n?e.reduce(t,i):e.reduce(t);if(S(e,function(e,a,o){n?i=t.call(s,i,e,a,o):(i=e,n=!0)}),!n)throw new TypeError(k);return i},x.reduceRight=x.foldr=function(e,t,i,s){var n=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return s&&(t=x.bind(t,s)),n?e.reduceRight(t,i):e.reduceRight(t);var a=e.length;if(a!==+a){var o=x.keys(e);a=o.length}if(S(e,function(r,l,h){l=o?o[--a]:--a,n?i=t.call(s,i,e[l],l,h):(i=e[l],n=!0)}),!n)throw new TypeError(k);return i},x.find=x.detect=function(e,t,i){var s;return T(e,function(e,n,a){return t.call(i,e,n,a)?(s=e,!0):void 0}),s},x.filter=x.select=function(e,t,i){var s=[];return null==e?s:g&&e.filter===g?e.filter(t,i):(S(e,function(e,n,a){t.call(i,e,n,a)&&(s[s.length]=e)}),s)},x.reject=function(e,t,i){return x.filter(e,function(e,s,n){return!t.call(i,e,s,n)},i)},x.every=x.all=function(e,t,s){t||(t=x.identity);var n=!0;return null==e?n:m&&e.every===m?e.every(t,s):(S(e,function(e,a,o){return(n=n&&t.call(s,e,a,o))?void 0:i}),!!n)};var T=x.some=x.any=function(e,t,s){t||(t=x.identity);var n=!1;return null==e?n:v&&e.some===v?e.some(t,s):(S(e,function(e,a,o){return n||(n=t.call(s,e,a,o))?i:void 0}),!!n)};x.contains=x.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):T(e,function(e){return e===t})},x.invoke=function(e,t){var i=r.call(arguments,2),s=x.isFunction(t);return x.map(e,function(e){return(s?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,i){return x.isEmpty(t)?i?null:[]:x[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var s={computed:-1/0,value:-1/0};return S(e,function(e,n,a){var o=t?t.call(i,e,n,a):e;o>=s.computed&&(s={value:e,computed:o})}),s.value},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var s={computed:1/0,value:1/0};return S(e,function(e,n,a){var o=t?t.call(i,e,n,a):e;o<s.computed&&(s={value:e,computed:o})}),s.value},x.shuffle=function(e){var t,i=0,s=[];return S(e,function(e){t=x.random(i++),s[i-1]=s[t],s[t]=e}),s};var $=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var s=$(t);return x.pluck(x.map(e,function(e,t,n){return{value:e,index:t,criteria:s.call(i,e,t,n)}}).sort(function(e,t){var i=e.criteria,s=t.criteria;if(i!==s){if(i>s||void 0===i)return 1;if(s>i||void 0===s)return-1}return e.index<t.index?-1:1}),"value")};var A=function(e,t,i,s){var n={},a=$(t||x.identity);return S(e,function(t,o){var r=a.call(i,t,o,e);s(n,r,t)}),n};x.groupBy=function(e,t,i){return A(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})},x.countBy=function(e,t,i){return A(e,t,i,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,i,s){i=null==i?x.identity:$(i);for(var n=i.call(s,t),a=0,o=e.length;o>a;){var r=a+o>>>1;i.call(s,e[r])<n?a=r+1:o=r}return a},x.toArray=function(e){return e?x.isArray(e)?r.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:r.call(e,0,t)},x.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,i){return r.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var D=function(e,t,i){return S(e,function(e){x.isArray(e)?t?o.apply(i,e):D(e,t,i):i.push(e)}),i};x.flatten=function(e,t){return D(e,t,[])},x.without=function(e){return x.difference(e,r.call(arguments,1))},x.uniq=x.unique=function(e,t,i,s){x.isFunction(t)&&(s=i,i=t,t=!1);var n=i?x.map(e,i,s):e,a=[],o=[];return S(n,function(i,s){(t?s&&o[o.length-1]===i:x.contains(o,i))||(o.push(i),a.push(e[s]))}),a},x.union=function(){return x.uniq(l.apply(s,arguments))},x.intersection=function(e){var t=r.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=l.apply(s,r.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=r.call(arguments),t=x.max(x.pluck(e,"length")),i=new Array(t),s=0;t>s;s++)i[s]=x.pluck(e,""+s);return i},x.object=function(e,t){if(null==e)return{};for(var i={},s=0,n=e.length;n>s;s++)t?i[e[s]]=t[s]:i[e[s][0]]=e[s][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var s=0,n=e.length;if(i){if("number"!=typeof i)return s=x.sortedIndex(e,t),e[s]===t?s:-1;s=0>i?Math.max(0,n+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;n>s;s++)if(e[s]===t)return s;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var s=null!=i;if(y&&e.lastIndexOf===y)return s?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var n=s?i:e.length;n--;)if(e[n]===t)return n;return-1},x.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var s=Math.max(Math.ceil((t-e)/i),0),n=0,a=new Array(s);s>n;)a[n++]=e,e+=i;return a},x.bind=function(e,t){if(e.bind===C&&C)return C.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}},x.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}},x.bindAll=function(e){var t=r.call(arguments,1);return 0===t.length&&(t=x.functions(e)),S(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var s=t.apply(this,arguments);return x.has(i,s)?i[s]:i[s]=e.apply(this,arguments)}},x.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(r.call(arguments,1)))},x.throttle=function(e,t){var i,s,n,a,o=0,r=function(){o=new Date,n=null,a=e.apply(i,s)};return function(){var l=new Date,h=t-(l-o);return i=this,s=arguments,0>=h?(clearTimeout(n),n=null,o=l,a=e.apply(i,s)):n||(n=setTimeout(r,h)),a}},x.debounce=function(e,t,i){var s,n;return function(){var a=this,o=arguments,r=function(){s=null,i||(n=e.apply(a,o))},l=i&&!s;return clearTimeout(s),s=setTimeout(r,t),l&&(n=e.apply(a,o)),n}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)x.has(e,i)&&(t[t.length]=i);return t},x.values=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push(e[i]);return t},x.pairs=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push([i,e[i]]);return t},x.invert=function(e){var t={};for(var i in e)x.has(e,i)&&(t[e[i]]=i);return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return S(r.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(s,r.call(arguments,1));return S(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(s,r.call(arguments,1));for(var n in e)x.contains(i,n)||(t[n]=e[n]);return t},x.defaults=function(e){return S(r.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var P=function(e,t,i,s){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var n=h.call(e);if(n!=h.call(t))return!1;switch(n){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var a=i.length;a--;)if(i[a]==e)return s[a]==t;i.push(e),s.push(t);var o=0,r=!0;if("[object Array]"==n){if(o=e.length,r=o==t.length)for(;o--&&(r=P(e[o],t[o],i,s)););}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(d)&&d instanceof d))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(r=x.has(t,c)&&P(e[c],t[c],i,s))))break;if(r){for(c in t)if(x.has(t,c)&&!o--)break;r=!o}}return i.pop(),s.pop(),r};x.isEqual=function(e,t){return P(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=w||function(e){return"[object Array]"==h.call(e)},x.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return h.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==h.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return d.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,i){for(var s=Array(e),n=0;e>n;n++)s[n]=t.call(i,n);return s},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=x.invert(I.escape);var M={escape:new RegExp("["+x.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(I.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(M[e],function(t){return I[e][t]})}}),x.result=function(e,t){if(null==e)return null;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){S(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),R.call(this,i.apply(x,e))}})};var L=0;x.uniqueId=function(e){var t=++L+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var s;i=x.defaults({},i,x.templateSettings);var n=new RegExp([(i.escape||E).source,(i.interpolate||E).source,(i.evaluate||E).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(n,function(t,i,s,n,r){return o+=e.slice(a,r).replace(N,function(e){return"\\"+F[e]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),s&&(o+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),n&&(o+="';\n"+n+"\n__p+='"),a=r+t.length,t}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{s=new Function(i.variable||"obj","_",o)}catch(r){throw r.source=o,r}if(t)return s(t,x);var l=function(e){return s.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},x.chain=function(e){return x(e).chain()};var R=function(e){return this._chain?x(e).chain():e};x.mixin(x),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],R.call(this,i)}}),S(["concat","join","slice"],function(e){var t=s[e];x.prototype[e]=function(){return R.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(i,s,n){e.Backbone=t(e,n,i,s)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender)}(this,function(e,t,i,s){var n=e.Backbone,a=[],o=a.push,r=a.slice,l=a.splice;t.VERSION="1.0.0",t.$=s,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var h=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var s=this._events[e]||(this._events[e]=[]);return s.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,s){if(!c(this,"once",e,[t,s])||!t)return this;var n=this,a=i.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,s)},off:function(e,t,s){var n,a,o,r,l,h,d,u;if(!this._events||!c(this,"off",e,[t,s]))return this;if(!e&&!t&&!s)return this._events={},this;for(r=e?[e]:i.keys(this._events),l=0,h=r.length;h>l;l++)if(e=r[l],o=this._events[e]){if(this._events[e]=n=[],t||s)for(d=0,u=o.length;u>d;d++)a=o[d],(t&&t!==a.callback&&t!==a.callback._callback||s&&s!==a.context)&&n.push(a);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],s=this._events.all;return i&&u(i,t),s&&u(s,arguments),this},stopListening:function(e,t,i){var s=this._listeners;if(!s)return this;var n=!t&&!i;"object"==typeof t&&(i=this),e&&((s={})[e._listenerId]=e);for(var a in s)s[a].off(t,i,this),n&&delete this._listeners[a];return this}},d=/\s+/,c=function(e,t,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)e[t].apply(e,[n,i[n]].concat(s));return!1}if(d.test(i)){for(var a=i.split(d),o=0,r=a.length;r>o;o++)e[t].apply(e,[a[o]].concat(s));return!1}return!0},u=function(e,t){var i,s=-1,n=e.length,a=t[0],o=t[1],r=t[2];switch(t.length){case 0:for(;++s<n;)(i=e[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=e[s]).callback.call(i.ctx,a);return;case 2:for(;++s<n;)(i=e[s]).callback.call(i.ctx,a,o);return;case 3:for(;++s<n;)(i=e[s]).callback.call(i.ctx,a,o,r);return;default:for(;++s<n;)(i=e[s]).callback.apply(i.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};i.each(p,function(e,t){h[t]=function(t,s,n){var a=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=i.uniqueId("l"));return a[o]=t,"object"==typeof s&&(n=this),t[e](s,n,this),this}}),h.bind=h.on,h.unbind=h.off,i.extend(t,h);var f=t.Model=function(e,t){var s,n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),(s=i.result(this,"defaults"))&&(n=i.defaults({},n,s)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,s){var n,a,o,r,l,h,d,c;if(null==e)return this;if("object"==typeof e?(a=e,s=t):(a={})[e]=t,s||(s={}),!this._validate(a,s))return!1;o=s.unset,l=s.silent,r=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={}),c=this.attributes,d=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],i.isEqual(c[n],t)||r.push(n),i.isEqual(d[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete c[n]:c[n]=t;if(!l){r.length&&(this._pending=!0);for(var u=0,p=r.length;p>u;u++)this.trigger("change:"+r[u],this,c[r[u]],s)}if(h)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var s in this.attributes)t[s]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,s=!1,n=this._changing?this._previousAttributes:this.attributes;for(var a in e)i.isEqual(n[a],t=e[a])||((s||(s={}))[a]=t);return s},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,s=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(s&&s(t,i,e),void t.trigger("sync",t,i,e)):!1},$(this,e),this.sync("read",this,e)},save:function(e,t,s){var n,a,o,r=this.attributes;if(null==e||"object"==typeof e?(n=e,s=t):(n={})[e]=t,s=i.extend({validate:!0},s),n&&!s.wait){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;n&&s.wait&&(this.attributes=i.extend({},r,n)),void 0===s.parse&&(s.parse=!0);var l=this,h=s.success;return s.success=function(e){l.attributes=r;var t=l.parse(e,s);return s.wait&&(t=i.extend(n||{},t)),i.isObject(t)&&!l.set(t,s)?!1:(h&&h(l,e,s),void l.trigger("sync",l,e,s))},$(this,s),a=this.isNew()?"create":s.patch?"patch":"update","patch"===a&&(s.attrs=n),o=this.sync(a,this,s),n&&s.wait&&(this.attributes=r),o},destroy:function(e){e=e?i.clone(e):{};var t=this,s=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&n(),s&&s(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;$(this,e);var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||T();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var s=this.validationError=this.validate(e,t)||null;return s?(this.trigger("invalid",this,s,i.extend(t||{},{validationError:s})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];i.each(g,function(e){f.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};i.extend(m.prototype,h,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.defaults(t||{},b))},remove:function(e,t){e=i.isArray(e)?e.slice():[e],t||(t={});var s,n,a,o;for(s=0,n=e.length;n>s;s++)o=this.get(e[s]),o&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,t.silent||(t.index=a,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=i.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),i.isArray(e)||(e=e?[e]:[]);var s,n,a,r,h,d=t.at,c=this.comparator&&null==d&&t.sort!==!1,u=i.isString(this.comparator)?this.comparator:null,p=[],f=[],g={};for(s=0,n=e.length;n>s;s++)(a=this._prepareModel(e[s],t))&&((r=this.get(a))?(t.remove&&(g[r.cid]=!0),t.merge&&(r.set(a.attributes,t),c&&!h&&r.hasChanged(u)&&(h=!0))):t.add&&(p.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)));if(t.remove){for(s=0,n=this.length;n>s;++s)g[(a=this.models[s]).cid]||f.push(a);f.length&&this.remove(f,t)}if(p.length&&(c&&(h=!0),this.length+=p.length,null!=d?l.apply(this.models,[d,0].concat(p)):o.apply(this.models,p)),h&&this.sort({silent:!0}),t.silent)return this;for(s=0,n=p.length;n>s;s++)(a=p[s]).trigger("add",a,this,t);return h&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var s=0,n=this.models.length;n>s;s++)this._removeReference(this.models[s]);return t.previousModels=this.models,this._reset(),this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,s){t||(t=this.comparator);var n=i.isFunction(t)?t:function(e){return e.get(t)};return i.sortedIndex(this.models,e,n,s)},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,s=this;return e.success=function(i){var n=e.reset?"reset":"set";s[n](i,e),t&&t(s,i,e),s.trigger("sync",s,i,e)},$(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var s=this,n=t.success;return t.success=function(i){t.wait&&s.add(e,t),n&&n(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,s){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,s),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(y,function(e){m.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var w=["groupBy","countBy","sortBy"];i.each(w,function(e){m.prototype[e]=function(t,s){var n=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,n,s)}});var _=t.View=function(e){this.cid=i.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,h,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var s=e[t];if(i.isFunction(s)||(s=this[e[t]]),s){var n=t.match(C),a=n[1],o=n[2];s=i.bind(s,this),a+=".delegateEvents"+this.cid,""===o?this.$el.on(a,s):this.$el.on(a,o,s)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=i.extend({},i.result(this,"options"),e)),i.extend(this,i.pick(e,x)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var s=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(s,!1)}}}),t.sync=function(e,s,n){var a=S[e];i.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:a,dataType:"json"};if(n.url||(o.url=i.result(s,"url")||T()),null!=n.data||!s||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||s.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",n.emulateJSON&&(o.data._method=a);
var r=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),r?r.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(i.extend(o,n));return s.trigger("request",s,l,n),l};var S={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=function(e,t){var s,n=this;s=e&&i.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},i.extend(s,n,t);var a=function(){this.constructor=s};return a.prototype=n.prototype,s.prototype=new a,e&&i.extend(s.prototype,e),s.__super__=n.prototype,s};f.extend=m.extend=_.extend=k;var T=function(){throw new Error('A "url" property or function must be specified')},$=function(e,t){var i=t.error;t.error=function(s){i&&i(e,s,t),e.trigger("error",e,s,t)}};return t}),define("pubsub",["underscore","backbone"],function(e,t){"use strict";var i=e.extend({},t.Events);i.attach=function(t,i){e.each(t,e.bind(function(e,t){this.on(t,e,i)},this))},i.unattach=function(t,i){e.each(t,e.bind(function(e,t){this.off(t,e,i)},this))};var s=i.trigger;return i.trigger=function(e){try{s.apply(i,arguments)}catch(t){console.error('PubSub trigger "'+e+'" threw exception: ',t.stack||t.stacktrace||t.message)}return i},i}),define("managers/trafficcop",["jquery","underscore"],function(e,t){var i=function(){this.DEBUG=!0,this.defaultTimeout=2e3,this.minTimeout=500,this.activeRequests=[],this.activeAnimations=[],this.animationCompletion=null};return i.prototype={addRequest:function(i){var s={ajaxPromise:i,gate:e.Deferred(),result:null};this.activeRequests.push(s),i.always(t.bind(function(e){this.activeAnimations.length?s.result=e:("resolved"===i.state()?s.gate.resolve(e):s.gate.reject(e),this._cleanup())},this));var n=s.gate.promise();return n.original=i,n.abort=i.abort,n},addAnimation:function(i,s,n,a,o){if(!i||"pending"!==i.state())return i;this.animationCompletion||(this.animationCompletion=e.Deferred());var r=Math.max(2*o,this.minTimeout)||this.defaultTimeout,l=setTimeout(t.bind(function(){console.warn("ANIMATION did NOT resolve within "+r+" ms, releasing barrier "+this._getAnimationPropertyDescription(n,a),s),this._resolveAnimation(i)},this),r);return this.activeAnimations.push(i),i.always(t.bind(function(){clearTimeout(l),this._resolveAnimation(i)||console.warn("animation finished after being released "+this._getAnimationPropertyDescription(n,a),s)},this)),this.animationCompletion.promise()},getAnimationCompletion:function(){return this.animationCompletion?this.animationCompletion.promise():e.Deferred().resolve()},_getAnimationPropertyDescription:function(e,t){return e?"on property "+e+":"+t:"on unregistered element"},_resolveAnimation:function(t){var i=e.inArray(t,this.activeAnimations);return-1!==i?(this.activeAnimations.splice(i,1),0===this.activeAnimations.length&&this._openGate(),!0):!1},_openGate:function(){var e=this.animationCompletion;this.animationCompletion=null,t.each(this.activeRequests,function(e){var t=e.ajaxPromise.state();"resolved"===t?e.gate.resolve(e.result):"rejected"===t&&e.gate.reject(e.result)}),this._cleanup(),e.resolve()},_cleanup:function(){this.activeRequests=t.reject(this.activeRequests,function(e){return"pending"!==e.gate.state()})}},new i}),function(e){"use strict";"function"==typeof define&&define.amd?define("libs/css-transition-lib/css-transition-lib",["jquery"],function(t){return window.CSSAnimate=e(t),window.CSSAnimate}):window.CSSAnimate=e(window.jQuery||window.Zepto||window.$)}(function(e){"use strict";function t(e){var t,i=document.createElement("p").style,s=["ms","O","Moz","Webkit"];if(""===i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),t=s.length;t--;)if(""===i[s[t]+e])return s[t]+e}function i(e){var t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return t[e]}var s=function(e){this.transitionCssName=e,this.transitionEndName=i(e)};return s.prototype={animate:function(t,i,s,n,a,o){var r=this;return t=e(t),0===t.length?(console.error("tried animating null or empty jquery object"),e.Deferred().reject()):e.when.apply(e,e.map(t,function(t){return r.transitionCssName?r.cssTransition(e(t),i,s,n,a,o):r.jQuery(e(t),i,s,n,a,o)}))},cssTransition:function(t,i,s,n,a,o){var r;return"opacity"===i&&"none"===t.css("display")&&(n=0),this._isDocumentHidden()?(t.css(i,s),e.Deferred().resolve()):(0!==n&&40>n&&(n=40),a=this._normalizeEasing(a,this._easingMap),r=e.camelCase(i),s=this._getCssNumber(r,s),o=o?" "+o+"ms":"",this._transition(t,i,r,s,n,a,o))},jQuery:function(t,i,s,n,a,o){if(this._isDocumentHidden())return t.css(i,s),e.Deferred().resolve();var r={};return a=this._normalizeEasing(a,this._invert(this._easingMap)),r[i]=s,e.Deferred(function(e){var l="proganimate"+i;t.stop(l,!0),0===n?(t.css(i,s),setTimeout(function(){e.resolve()},1)):t.delay(o||0,l).animate(r,{duration:n,easing:a,queue:l,done:function(){t.css(i,s),e.resolve()},fail:function(){e.reject()}}).dequeue(l)}).promise()},stop:function(t,i){var s=e.camelCase(i),n=window.getComputedStyle(t[0]).getPropertyValue(i);return t.stop("proganimate"+i,!0),this._failPreviousTransition(t,s)&&(t[0].style[s]=n),n},_easingMap:{easeInQuad:"ease-in",easeInSine:"ease-in",easeInCubic:"ease-in",easeInQuart:"ease-in",easeInQuint:"ease-in",easeInExpo:"ease-in",easeInCirc:"ease-in",easeInBack:"ease-in",easeInElastic:"ease-in",easeInBounce:"ease-in",easeOutQuad:"ease-out",easeOutSine:"ease-out",easeOutCubic:"ease-out",easeOutQuart:"ease-out",easeOutQuint:"ease-out",easeOutExpo:"ease-out",easeOutCirc:"ease-out",easeOutBack:"ease-out",easeOutElastic:"ease-out",easeOutBounce:"ease-out",easeInOutQuad:"ease-in-out",easeInOutSine:"ease-in-out",easeInOutCubic:"ease-in-out",easeInOutQuart:"ease-in-out",easeInOutQuint:"ease-in-out",easeInOutExpo:"ease-in-out",easeInOutCirc:"ease-in-out",easeInOutBack:"ease-in-out",easeInOutElastic:"ease-in-out",easeInOutBounce:"ease-in-out",swing:"ease-in-out"},_normalizeEasing:function(e,t){var i;return e=e||"linear",i=t[e],i?e=i:-1===e.indexOf("cubic-bezier")||t.swing?this._invert(t)[e]||(e="linear"):e="swing",e},_transition:function(t,i,s,n,a,o,r){var l,h=e.Deferred(),d=this._getCurrentValue(t,s,i);return this._shouldDoTransition(t,s,i,d,n,a)?(l=i+" "+a+"ms "+o+" "+r,h=this._doTransition(t,s,i,n,l)):setTimeout(function(){h.resolve()},1),h.promise()},_doTransition:function(t,i,s,n,a){var o=t[0].style,r=this;return this._getAnimationDeferred(t,i,s,"2d",function(e){r._triggerTransition(e,t,i,s,n,a)}).then(function(){return n.replace(/[ ]+/g,"")===o[i].replace(/[ ]+/g,"")?e.Deferred().resolve():e.Deferred().reject()})},_getAnimationDeferred:function(t,i,s,n,a){var o=this;return e.Deferred(function(e){var r=o._failPreviousTransition(t,i,!0);setTimeout(function(){r&&r.cleanup(),"pending"===e.state()&&a(e)},20),t.data("transition-animate-"+i+"-defer",{promise:e,animationType:n,cleanup:function(){o._removeTransition(t[0].style,s)}})}).always(function(e){t.removeData("transition-animate-"+i+"-defer"),e||o._removeTransition(t[0].style,s)})},_removeTransition:function(t,i){var s=t[this.transitionCssName];s=s||"",s=s.replace(new RegExp(i+" \\w+ [\\w-]+(\\s*\\([^\\)]*\\))?"),""),t[this.transitionCssName]=e.trim(s.replace(/^[ ,]+/,"").replace(/[ ,]+$/,"").replace(/,[ ]+,/,""))},_triggerTransition:function(e,t,i,s,n,a){var o=t[0].style;this._registerTransitionEndListener(t,e,s),this._setupTransition(o,s,a),o[i]=n},_failPreviousTransition:function(e,t,i){var s=e.data("transition-animate-"+t+"-defer");return s?(s.promise.reject(i),s):void 0},_setupTransition:function(e,t,i){var s=e[this.transitionCssName];s?s+=","+i:s=i,e[this.transitionCssName]=s},_getCurrentValue:function(e,t,i){var s=e[0].style,n=s[t]||e.css(i);return"auto"!==n&&n||(s[t]=this._getCssNumber(t,0),n="0"),n},_shouldDoTransition:function(e,t,i,s,n,a){var o=e[0].style;return 0===a?(this._failPreviousTransition(e,t),o[t]=n,!1):this._canAnimate(s,n)?s:(this._failPreviousTransition(e,t),!1)},_canAnimate:function(e,t){return"0"===e.replace(/[ a-z%]+/g,"")&&"0"===t.replace(/[ a-z%]+/g,"")?!1:e.replace(/[ ]/g,"")!==t.replace(/[ ]/g,"")},_getCssNumber:function(t,i){return e.cssNumber[t]||!this._isNumber(i)&&i.match(/[a-z%]/)?i+"":i+"px"},_registerTransitionEndListener:function(t,i,s){if(this.transitionEndName){var n=t[0],a=this.transitionEndName,o=function(e){e.target!==n||s&&e.propertyName!==s||(this.removeEventListener(a,o),i.resolve(),o=null)};return n.addEventListener(a,o),i.promise()}return e.Deferred.reject()},_invert:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t},_isNumber:function(e){return"[object Number]"===Object.prototype.toString.call(e)},_isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden}},new s(t("transition"))}),define("easing",["jquery"],function(e){e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,i,s,n,a){return e.easing[e.easing.def](t,i,s,n,a)},easeInQuad:function(e,t,i,s,n){return s*(t/=n)*t+i},easeOutQuad:function(e,t,i,s,n){return-s*(t/=n)*(t-2)+i},easeInOutQuad:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t+i:-s/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,s,n){return s*(t/=n)*t*t+i},easeOutCubic:function(e,t,i,s,n){return s*((t=t/n-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t+i:s/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,s,n){return s*(t/=n)*t*t*t+i},easeOutQuart:function(e,t,i,s,n){return-s*((t=t/n-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t*t+i:-s/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,s,n){return s*(t/=n)*t*t*t*t+i},easeOutQuint:function(e,t,i,s,n){return s*((t=t/n-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t*t*t+i:s/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,s,n){return-s*Math.cos(t/n*(Math.PI/2))+s+i},easeOutSine:function(e,t,i,s,n){return s*Math.sin(t/n*(Math.PI/2))+i},easeInOutSine:function(e,t,i,s,n){return-s/2*(Math.cos(Math.PI*t/n)-1)+i},easeInExpo:function(e,t,i,s,n){return 0==t?i:s*Math.pow(2,10*(t/n-1))+i},easeOutExpo:function(e,t,i,s,n){return t==n?i+s:s*(-Math.pow(2,-10*t/n)+1)+i},easeInOutExpo:function(e,t,i,s,n){return 0==t?i:t==n?i+s:(t/=n/2)<1?s/2*Math.pow(2,10*(t-1))+i:s/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,s,n){return-s*(Math.sqrt(1-(t/=n)*t)-1)+i},easeOutCirc:function(e,t,i,s,n){return s*Math.sqrt(1-(t=t/n-1)*t)+i},easeInOutCirc:function(e,t,i,s,n){return(t/=n/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+i:s/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,s,n){var a=1.70158,o=0,r=s;if(0==t)return i;if(1==(t/=n))return i+s;if(o||(o=.3*n),r<Math.abs(s)){r=s;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(s/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/o))+i},easeOutElastic:function(e,t,i,s,n){var a=1.70158,o=0,r=s;if(0==t)return i;if(1==(t/=n))return i+s;if(o||(o=.3*n),r<Math.abs(s)){r=s;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(s/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*n-a)*Math.PI/o)+s+i},easeInOutElastic:function(e,t,i,s,n){var a=1.70158,o=0,r=s;if(0==t)return i;if(2==(t/=n/2))return i+s;if(o||(o=.3*n*1.5),r<Math.abs(s)){r=s;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(s/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/o)+i:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/o)*.5+s+i},easeInBack:function(e,t,i,s,n,a){return void 0==a&&(a=1.70158),s*(t/=n)*t*((a+1)*t-a)+i},easeOutBack:function(e,t,i,s,n,a){return void 0==a&&(a=1.70158),s*((t=t/n-1)*t*((a+1)*t+a)+1)+i},easeInOutBack:function(e,t,i,s,n,a){return void 0==a&&(a=1.70158),(t/=n/2)<1?s/2*t*t*(((a*=1.525)+1)*t-a)+i:s/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+i},easeInBounce:function(t,i,s,n,a){return n-e.easing.easeOutBounce(t,a-i,0,n,a)+s},easeOutBounce:function(e,t,i,s,n){return(t/=n)<1/2.75?7.5625*s*t*t+i:2/2.75>t?s*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?s*(7.5625*(t-=2.25/2.75)*t+.9375)+i:s*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(t,i,s,n,a){return a/2>i?.5*e.easing.easeInBounce(t,2*i,0,n,a)+s:.5*e.easing.easeOutBounce(t,2*i-a,0,n,a)+.5*n+s}})}),define("transformSupport",["jquery"],function(e){e.support.css=e.support.css||{},Modernizr.csstransitions&&(e.support.css.transition={cssName:Modernizr.prefixed("transition"),endEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}},e.support.css.transition.endName=e.support.css.transition.endEventNames[e.support.css.transition.cssName],e.support.css.transition.registerTransitionEndListener=function(t,i,s){i||(i=e.Deferred());var n=e.support.css.transition.endName,a=function(e){e.target!=t||s&&e.propertyName!==s||(this.removeEventListener(n,a),i.resolve(),a=null)};return t.addEventListener(n,a),i.promise()}),!Modernizr.csstransforms3d||navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/5")||(e.support.css.transform={cssName:Modernizr.prefixed("transform"),originCssName:Modernizr.prefixed("transformOrigin"),styleCssName:Modernizr.prefixed("transformStyle"),backfaceVisibilityCssName:Modernizr.prefixed("backfaceVisibility"),perspectiveCssName:Modernizr.prefixed("perspective"),perspectiveOriginCssName:Modernizr.prefixed("perspectiveOrigin")},e.support.css.transform.cssHyphenName=e.support.css.transform.cssName.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"))}),define("baseview",["jquery","underscore","backbone","pubsub","managers/trafficcop","libs/css-transition-lib/css-transition-lib","easing","transformSupport"],function(e,t,i,s,n,a){"use strict";var o=i.View.extend({useCSSTransitions:!!e.support.css.transition,transitionCssName:e.support.css.transition&&e.support.css.transition.cssName,isSafari6:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/6"),isApple:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1,pubSub:null,options:{animations:{fadeIn:{duration:200,easing:"easeInQuad"},fadeOut:{duration:200,easing:"easeOutSine"},useCSSTransitions:!0}},initialize:function(t){this.options=e.extend(!0,{},o.prototype.options,t),this.useCSSTransitions=this.options.animations.useCSSTransitions&&this.useCSSTransitions,this.seenModules={},this.subviews=this.subviews||{},this.clear$$(),this.pubSub&&s.attach(this.pubSub,this)},$$:function(e){var t=this.cachedSelectors[e];return t||(t=this.$(e),this.cachedSelectors[e]=t),t},clear$$:function(e){e?delete this.cachedSelectors[e]:this.cachedSelectors={}},setElement:function(){this.clear$$(),i.View.prototype.setElement.apply(this,arguments)},destroy:function(e,t){this.destroyed=!0,this.destroyModules(e,t),this.clear$$(),this.pubSub&&s.unattach(this.pubSub,this),e&&this.$el.remove()},destroyModules:function(e,t){this._callCollection(this.subviews,"destroy",[e,t]),this.undelegateEvents(),this.subviews={}},triggerEvent:function(e,t){t=Array.prototype.slice.call(arguments,1),this._callCollection(this.subviews,e,t)},_callCollection:function(i,s,n){t.each(i,function(i){try{e.isArray(i)?t.each(i,function(t){e.isFunction(t[s])&&t[s].apply(t,n)}):i&&e.isFunction(i[s])&&i[s].apply(i,n)}catch(a){console.error("subview threw exception on destruction: ",a.stack||a.stacktrace||a.message)}})},registerAnimation:function(e,t,i,s,a){return n.addAnimation(e,t,i,s,a)},animate:function(i,s,o,r,l,h){return i&&0!==i.length?(this.isSafari6&&"opacity"===s&&(r=0),e.when.apply(e,t.map(i,t.bind(function(t){var i;return i=this.useCSSTransitions?a.cssTransition(e(t),s,o,r,l,h):a.jQuery(e(t),s,o,r,l,h),n.addAnimation(i,t,o,r),i},this)))):(console.error("tried animating null or empty jquery object"),e.Deferred().reject())},stopAnimate:function(i,s){t.each(i,function(t){a.stop(e(t),s)})},show:function(i,s){var n,a=this.options.animations.fadeIn;return i&&!this.isSafari6?(n=this.$el.fadeTo(a.duration,1,a.easing).promise(),this.registerAnimation(n,this.$el,"opacity",1)):(n=e.Deferred(),t.defer(function(){n.resolve()}),this.$el.css({display:"block",opacity:1})),n.done(function(){s&&s()}),n},hide:function(i,s){var n,a=this.options.animations.fadeOut;return i&&!this.isSafari6?(n=this.$el.fadeTo(a.duration,0,a.easing).promise(),n.done(t.bind(function(){this.$el.css({display:"none"})},this)),this.registerAnimation(n,this.$el,"opacity",0,a.duration)):(n=e.Deferred().resolve(),this.$el.css({display:"none",opacity:0})),n.done(function(){s&&s()}),n},setupSub:function(e,t,i,s){s=s||{};var n=this.subviews[e];n||(this.subviews[e]=n=[]),this.$(t).each(function(e,t){s.el=t,n.push(new i(s))})}});return o}),define("utils",["jquery","underscore"],function(e,t){"use strict";var i=function(){this.storage={},this.set("DEBUG",!0),this.set("document",e(document)),this.set("win",e(window)),this.set("body",e("body")),this.set("scrollEl",e("html,body")),this.set("doc",e(document))};return i.prototype={set:function(e,t){this.storage[e]=t},get:function(e){return this.storage[e]},getPageUrl:function(){return this.getOrigin()+window.location.pathname},getOrigin:function(){return window.location.protocol+"//"+window.location.host},getScrollPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},_loadedScripts:{},loadScript:function(e,t,i){return this._loadedScripts[t]=this._loadedScripts[t]||this._requireScript(e,t),this._loadedScripts[t].done(i)},_requireScript:function(t,i){return e.Deferred(function(e){require([t],function(){var s=window[i];s?e.resolve(s):e.reject("Missing symbol: "+i+" from script: "+t)},e.reject)}).fail(function(e){console.error(e)})},openPopup:function(e,t,i){t=t||600,i=i||400;var s=this.popupCoords(t,i);window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+i+",width="+t+",top="+s.top+",left="+s.left)},isValidUrl:function(e){if(!e)return!1;if(-1!==e.indexOf("mailto:"))return!0;if(-1!==e.indexOf("javascript:"))return!1;if("#"===e[0]){if(1===e.length)return!1}else if(-1!==e.indexOf("../")||"/"!==e[0]&&-1===e.indexOf("://"))return console.error("Attempting to load a relative url, bad code monkey! ("+e+")"),!1;return!0},getNested:function(e,i){return e?(i=Array.prototype.slice.call(arguments,1),t.reduce(i,function(e,t){return e&&e[t]},e)):void 0},getSiteSections:function(){var e=this.getNested(window.site_vars,"sections")||"";return e?e.split("|"):[]},popupCoords:function(e,t){var i=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,n=window.outerWidth?window.outerWidth:document.documentElement.clientWidth,a=window.outerHeight?window.outerHeight:document.documentElement.clientHeight;return{left:i+n/2-e/2,top:s+a/2-t/2-25}},addCommas:function(e){e+="";for(var t=e.split("."),i=t[0],s=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i+s},lazyLoadImage:function(i,s,n,a,o){var r=!1;return s=s||"data-src",i.each(t.bind(function(t,i){var l=e(i),h=l.attr(s),d=l.attr("src");h&&d!==h&&(this._attachHandler("error",l,a),o&&this._attachHandler("load",l,o),l.attr("src",h),n||l.removeAttr(s),r=!0)},this)),r},_attachHandler:function(e,t,i){var s=function(){t.off(e,s),"error"===e&&t.hide(),i&&i(t)};t.on(e,s)},getSectionPath:function(e){if(e&&(e=this._stripQueryParams(e)),e&&"/"!==e){"/"===e[0]&&(e=e.substring(1));var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return"home"},getSubSection:function(e){if(e){e=this._stripQueryParams(e),"/"!==e[e.length-1]&&(e+="/");var t=e.indexOf("/",1),i=e.indexOf("/",t+1);if(-1!==t&&-1!==i)return e.substring(t+1,i)}return""},_stripQueryParams:function(e){var t=e.indexOf("?");return-1!==t&&(e=e.substring(0,t)),e},lazyLoadError:function(t){e(this).hide(),t&&t(e(this))},requireSingleUseScript:function(i){return e.Deferred(function(e){require([i],function(t){e.resolveWith(this,[t])},function(t){console.error("failed loading scripts",t),e.reject(t)})}).always(t.bind(function(){this.removeRequireModule(i)},this)).promise()},removeRequireModule:function(t){require.undef(t),e('script[data-requiremodule="'+t+'"]').remove()},getUrlParam:function(e){var t=decodeURI((new RegExp(e+"=(.+?)(&|$)").exec(window.location.search)||[0,!1])[1]);return"false"===t?!1:"true"===t?!0:t},getSessionData:function(e,t){var i=sessionStorage[e];return i&&JSON.parse(i)||t},setSessionData:function(e,i){t.isString(i)||(i=JSON.stringify(i)),sessionStorage.setItem(e,i)},clearSessionData:function(e){sessionStorage.removeItem(e)},isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden},smartTruncate:function(e,t,i){if(e&&t){if(e.length<=t)return e;i=i||"&hellip;";var s=e.lastIndexOf(" ",t-1),n=s>0?s:t;return e.substr(0,n)+i}}},new i}),define("modules/global/alert",["jquery","underscore","pubsub"],function(e,t,i){var s=function(){};return s.prototype={render:function(){this.$alert||(this.$alert=e('<div class="ui-alert"><span class="text"></span><span class="close-btn">Close</span></div>').appendTo(e("body")),this.$alertText=this.$alert.find(".text"),this.$alert.on("click",".close-btn",t.bind(function(){this.hide()},this)))},show:function(e){this.render(),i.trigger("show:alert"),this.$alertText.html(e),this.$alert.addClass("active").removeClass("error")},hide:function(){i.trigger("hide:alert"),this.$alert.removeClass("active error")},showError:function(e){this.render(),i.trigger("show:error:alert"),this.$alertText.html(e),this.$alert.addClass("active error")}},new s}),define("managers/requestmanager",["jquery","underscore","managers/trafficcop","utils"],function(e,t,i,s){var n=function(){this.DEBUG=!0,this.xhrList=[],this.intervalList=[]};return e(document).ajaxSend(function(t,i,s){"post"===s.method&&i.setRequestHeader("X-CSRFToken",e.cookie("csrftoken"))}),n.prototype={timeout:3e4,fetchHtml:function(e,t,i,s){return this.fetchData(e,t,i,s,!0)},recurringFetchHtml:function(e,t,i,s,n){return this.recurringFetchData(e,t,i,s,n,!0)},recurringFetchData:function(e,i,s,n,a,o){var r=t.bind(function(){this.fetchData(e,i,!1,a,o).done(function(e){n(e)})},this);r();var l=setInterval(r,s);return this.intervalList.push(l),l},fetchData:function(i,s,n,a,o){s=this._setupRequest(i,s,a);var r=e.Deferred();this._startRequest(r,s,n,o);var l=r.promise();return l.abort=t.bind(function(){r.reject()},this),l},_setupRequest:function(t,i,s){var n={};return s&&(n["X-PJAX"]="true",n["X-PJAX-Container"]="#overlay"),t?0!==t.indexOf("/")&&0!==t.indexOf("http")&&(t="/"+t):t="/",i=e.extend({url:t,data:{ajax:!0},beforeSend:function(t){e.each(n,function(e,i){t.setRequestHeader(e,i)})},timeout:this.timeout},i)},_startRequest:function(t,s,n,a,o){var r=this._initializeFetchData(s.url,n);if(!r)return void t.reject();var l=e.ajax(s);this.DEBUG&&l.fail(function(e){e.statusText&&"abort"!==e.statusText&&console.log("fetchData Error: ",e.statusText,s)}),t.fail(function(){"pending"===l.state()&&l.abort()}),l=i.addRequest(l),this._registerNavRequests(l,t,s.url,n),n?this._resolveNavAjax(l,t,s,n,a,o):this._resolveAjax(l,t,a)},_refreshPage:function(){window.location=window.location},_resolveNavAjax:function(e,i,s,a,o,r){e.done(t.bind(function(){var t=e.original.getResponseHeader("X-Firefly-Session-Needed"),n=e.original.getResponseHeader("X-Gannett-Site-Version");t?this._handleFireflyAuth(t,i,s,a,o,r):n&&window.site_static_version!==n?this._refreshPage():this._resolveAjax(e,i,o)},this)).fail(function(){n.prototype._resolveAjax(e,i,o)})},_handleFireflyAuth:function(e,i,s,n,a,o){if(o)console.error("Auth failed, X-Firefly-Session-Needed appeared on refetch"),i.reject("NOT AUTHORIZED");else{console.log("Requesting FIREFLY Auth");var r=this._getFireflyAuth(e).done(t.bind(function(){console.log("FIREFLY Auth Successful, requesting original asset"),this._startRequest(i,s,n,a,!0)},this)).fail(function(e,t){i.reject(e,t)});i.fail(function(){r.reject()})}},_resolveAjax:function(e,t,i){e.done(function(s){i&&(s=n.prototype._toHtml(s)),t.resolveWith(e,[s])}).fail(function(i){t.rejectWith(e,[i])})},_toHtml:function(t){var i=document.createDocumentFragment(),s=document.createElement("div");return s.innerHTML=t,i.appendChild(s),e(i).children().children()},_getFireflyAuth:function(i){var n,a=Math.floor(1e3*Math.random()),o=this._createFireflyiFrame(i);return e.Deferred(t.bind(function(t){n=setTimeout(function(){console.error("Auth timeout occurred"),t.reject("NOT AUTHORIZED","Request Timed Out")},this.timeout),e(window).on("message.rqman"+a,function(e){if(e=e.originalEvent,e.origin===s.getOrigin())try{var i=JSON.parse(e.data);if("firefly-auth"!==i.type)return;if("success"===i.auth)return void t.resolve(i);t.reject("NOT AUTHORIZED",i)}catch(n){}})},this)).always(function(){clearTimeout(n),e(window).off(".rqman"+a),document.body.removeChild(o)})},_createFireflyiFrame:function(e){var i=document.createElement("iframe");return i.id=i.name=t.uniqueId("firefly_auth_"),i.className="hidden",i.src=e,document.body.appendChild(i),i},_registerNavRequests:function(e,i,s,n){var a={ajaxPromise:e,resultDeferred:i,url:s,isNav:n};this.xhrList.push(a),e.always(t.bind(function(){this.xhrList=t.without(this.xhrList,a)},this))},_initializeFetchData:function(e,t){var i=1==this.xhrList.length&&this.xhrList[0],s=i&&i.isNav;if(t){if(s&&i.url===e)return!1;this.abortAllRequests()}else if(s)return!1;return!0},abortAllRequests:function(){t.each(this.xhrList,function(e){e.ajaxPromise.abort(),e.resultDeferred.reject()}),t.each(this.intervalList,function(e){clearInterval(e)}),this.xhrList=[],this.intervalList=[]},done:function(){return e.when(this.xhrList)}},new n}),define("mergedSiteConfig",[],function(){return{require:{paths:{chosen:"libs/jquery/plugins/chosen.jquery.min",bxslider:"libs/jquery/plugins/jquery.bxslider.min",touchswipe:"libs/jquery/plugins/jquery.touchSwipe"},shim:{"libs/flot/jquery.flot.usat.pie":["libs/flot/jquery.flot"],"libs/flot/jquery.flot.multibars":["libs/flot/jquery.flot"],touchswipe:["jquery"],chosen:["jquery"],"libs/flot/jquery.flot.orderBars":["libs/flot/jquery.flot"],bxslider:["jquery"],"libs/flot/jquery.flot.usat.style":["libs/flot/jquery.flot"],"libs/flot/jquery.flot":["jquery","libs/flot/excanvas"]}},global:{modules:["modules/global/header","analytics/settealium","user-accounts/facebook-user-account","user-accounts/googleplus-user-account"],pubSub:{openFullScreenCarousel:["modules/carousel/carousel-fullscreen"]}},apps:{"contact-us-staff":{path:"apps/contact-us-staff",css:"apps/contact-us-staff"},Interactives:{path:"apps/interactives",selector:"#interactive"},Overlay:{path:"apps/simple-overlay",css:["story-article","story-grid","story-navbar","stories/sponsored-series","stories/story-right-rail"],overlay:!0},"Overlay-with-footer":{path:"apps/simple-overlay",init_modules:[{name:"footer"}],overlay:!0},Blog:{path:"blog/blog-front",init_modules:[{name:"footer"}],css:["blog","blog/blog-default"]},ballot:{path:"apps/ballot-app",selector:".ballot-app"},"member-guide-apps":{path:"apps/member-guide-apps",css:"apps/member-guide"},Users:{path:"base-app",selector:".something"},UGC:{path:"apps/ugc-app",css:["ugc/ugc"],selector:".ugc-app"},LiveApp:{path:"apps/live_app/live-app-app",selector:".live-app-view-content-wrapper"},MediaView:{path:"apps/media",css:"media-view",header:{fixed:!0,open:!1}},Search:{path:"apps/search",css:"modules/search",header:{fixed:!0,open:!0}},StaffCMS:{path:"base-app",init_modules:[{name:"staff-listing"}],css:["pages/staff-listing"]},BigPage:{path:"apps/bigpage",css:"bigpage",header:{fixed:!0,open:!1}},BaseApp:{path:"base-app"},Error:{path:"apps/404",css:"404",overlay:!0},Cards:{path:"apps/cards/cards",init_modules:[{name:"footer"},{name:"sidebar"}],css:["cards","sidebar"]},"Overlay-with-arrows":{path:"apps/overlay/overlay",init_modules:[{name:"utility-bar"},{name:"recommended-flyout"}],overlay:!0},StaffBio:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"headline-grid"}],css:["pages/staff"]},"Interactive-Overlay":{path:"apps/overlay/overlay",selector:"#interactive",overlay:!0},Topics:{path:"apps/topics",init_modules:[{name:"footer"}],css:["stag","apps/topics/topics-page-automated"]},longform:{path:"base-app",css:"longform/longform-article",header:{fixed:!0,open:!1}},Topics1:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"election-2012"}],name:"Topics1",pages:null},"member-guide":{path:"apps/member-guide",css:"apps/member-guide"},"Overlay-with-utility-bar":{path:"apps/simple-overlay",init_modules:[{name:"utility-bar"}],css:["utility-bar"],overlay:!0}},version:2,pages:[{path:"apps/overlay/pages/contact-us-overlay",init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"ContactUs",urls:["^(contactus.*)$"],appName:"Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Web to Watch",urls:["^(tv/web-to-watch.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"StaticContent",urls:["^(social-player.*|shop.*|about.*|rss.*|mobile-apps.*|mediakit.*|press-bios.*|reporters.*|legal.*|editorial-policy.*|conversation-guidelines.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{urls:["^(life/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Life",css:["life"],appName:"Cards"},{hosturls:{"puzzles.usatoday.com":["^(|crossword|dont-quote-me|minisudoku|quickcross|sudoku|upanddown|wordroundup)/*$"]},name:"Puzzles Flash legacy",appName:"Overlay",urls:["^((puzzles/legacy)(|/.*))$"],path:"apps/overlay/pages/puzzles-overlay",preloadedUrl:"http://www.usatoday.com/life/",css:["puzzles"]},{init_modules:[{name:"snapshots"}],name:"Home",urls:["^()$","^(index.html)$","^(home/flex.*)$"],appName:"Cards"},{init_modules:[{name:"taboola-recommendations"}],name:"Photo Asset",urls:["^((photos|picture-gallery)/.*/)$"],appName:"Overlay-with-arrows"},{init_modules:[{name:"taboola-recommendations"}],name:"Video Asset",urls:["^videos/.*/$"],appName:"Overlay-with-arrows"},{name:"Sports Player",appName:"Overlay-with-utility-bar",urls:["^(sports/[a-zA-Z]+/player/.*)$"],path:"apps/overlay/pages/player-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-datatables"},{name:"sports-more-teams-college"}],css:["sports","sports-logos"]},{name:"Sports Olympics Widgets",appName:"Cards",urls:["^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/)$","^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/[0-9\\-]+/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$","^(sports/services/rightrail/olympics/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"sports-olympics-schedule-results"},{name:"sports-filters"},{name:"sports-nav"},{name:"sports-jumptotop"}],css:["sports","sports-logos"]},{name:"Sports Olympics Profile Overlay",appName:"Overlay-with-utility-bar",urls:["^(sports/olympics/[a-zA-Z0-9]+/(athletes|countries)/[a-zA-Z0-9-]+/.*)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-olympics-profile-overlay"}],css:["sports","sports-logos"]},{name:"Sports BoxScores",appName:"Overlay",buildfile:{path:"buildfiles/sports-boxscore"},urls:["^(sports/[a-zA-Z]+/game/.*)$","^(sports/[a-zA-Z]+/event/.*)$","^(sports/soccer/[a-zA-Z]+/event/.*)$"],path:"apps/overlay/pages/boxscore-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"}],css:["sports","sports-logos"]},{name:"Sports Story Overlay",appName:"Overlay-with-arrows",urls:["^(story/sports/.*)"],path:"apps/overlay/pages/sports-story-overlay",preloadedUrl:"/sports/",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"nfl-unitedway"}],css:["sports","sports-logos"]},{name:"Sports",appName:"Cards",buildfile:{path:"buildfiles/sports",modules:["sports-scores-suspender"]},urls:["^(sports/[a-zA-Z0-9%\\-/\\.#]*)$"],path:"apps/cards/pages/sports-card",init_modules:[{name:"sports-filters"},{name:"scores-page"},{name:"sports-leagues"},{name:"sports-nav"},{name:"sports-player-news"},{name:"sports-popup"},{name:"sports-jumptotop"},{name:"sports-datatables"},{name:"sports-leader-rotate"},{name:"gallery"},{name:"utility-bar"},{name:"sports-event-tool"},{name:"sports-ballots"},{name:"sports-brackets"},{name:"sports-data-video"}],css:["sports","sports-logos"]},{urls:["^(topic/.*/video-big-board/)$"],init_modules:[{name:"sports-video"},{name:"sports-featured-content"},{name:"utility-bar"}],name:"Video Big Board",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-week-in-america/)$"],init_modules:[{name:"sports-video"}],name:"Fantasy Football Week In America",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-draft-kit/)$","^(topic/.*/spanning-the-sec/)$"],name:"Sports Topic Pages Without Init Modules",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/2014-olympic-(.+)s/)$"],init_modules:[{name:"sports-popup-media-view"}],name:"Sports Topic Pages With Popup Media View",css:["sports","sports-logos"],appName:"Topics"},{name:"Default",urls:["^(media/.*)$"],appName:"MediaView"},{name:"Default",urls:["^(topic/.*)$"],appName:"Topics"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(blogs/)$"],name:"BlogsIndex",css:["blogs-index"],appName:"Cards"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(life/books/best-selling/.*)$"],name:"Best Selling Book List",css:["book-reviews"],appName:"Cards"},{name:"Book Review Detail Page",appName:"Overlay-with-arrows",urls:["^(story/life/books/.*)$"],path:"apps/overlay/pages/story-overlay",preloadedUrl:"/life/books/",init_modules:[{name:"booksAssetView"},{name:"taboola-recommendations"},{name:"form-dropdown"}],css:["book-reviews"]},{path:"apps/overlay/pages/story-overlay",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"myCapture"}],name:"Story",urls:["^((story|article)/.*/)$"],appName:"Overlay-with-arrows"},{path:"modules/longform/longform",init_modules:[{name:"longform-navigation"},{name:"longform-share"},{name:"longform-nav-rail-bucket"},{name:"longform-arrow"},{name:"longform-poster-ad-bottom"}],name:"Longform",urls:["^(wide-story/.*)$","^(longform/.*)$"],appName:"longform"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive Overlay",urls:["^interactive/.+/\\d{4}/\\d{2}/\\d{2}/([^/]*/)?(\\d{1,32})/$"],appName:"Interactive-Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive",urls:["^interactive/\\d{1,32}/(embed/)?$"],appName:"Interactives"},{name:"Flight Tracker",appName:"Overlay-with-utility-bar",urls:["^(travel/flight-tracker/.*)$"],path:"apps/overlay/pages/flight-tracker-overlay",preloadedUrl:"travel/",css:["map"]},{init_modules:[{name:"footer"}],name:"Travel",urls:["^(travel/[a-zA-Z0-9%\\-/\\.#]*)$"],appName:"Cards"},{path:"modules/polldaddy-poll",urls:["^(polls/.*)$"],name:"Poll",css:["polldaddy"],appName:"Overlay-with-utility-bar"},{name:"Default",urls:["^(search/.*)$"],appName:"Search"},{urls:["^(lottery/.*/)$"],init_modules:[{name:"form-dropdown"},{name:"poster-ad-asset"}],name:"Lottery Overlay",css:["life"],appName:"Overlay-with-arrows"},{name:"Default",urls:["^(election-2012/.*)$"],appName:"Topics1"},{name:"Horoscope",appName:"Overlay-with-utility-bar",urls:["^horoscope/(?:(aries|taurus|gemini|cancer|leo|virgo|libra|scorpio|sagittarius|capricorn|aquarius|pisces).*)?$"],path:"apps/overlay/pages/horoscope-overlay",init_modules:[{name:"inline-share-tools"},{name:"taboola-recommendations"}],css:["horoscope"]},{name:"Default",urls:["^(big-page/.*)$"],appName:"BigPage"},{name:"Money Overlay",appName:"Overlay",urls:["^(money/(economic-calendar|etfs|funds|markets|stocks|lookup|watchlist)/.*/)$","^(money/watchlist/)$"],preloadedUrl:"/money/",init_modules:[{name:"form-dropdown"}],css:["money"]},{urls:["^(money/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Money",css:["money"],appName:"Cards"},{name:"Sports Employee Directory",urls:["^(staff/listing/.*)$","^(staff/record/.*)$"],appName:"StaffCMS"},{name:"Default",urls:["^(staff/.*)$"],appName:"StaffBio"},{path:"apps/live_app/live-app",urls:["^(rightnow/.*)$"],name:"Right Now",css:["live-app"],appName:"LiveApp"},{header:{fixed:!0,open:!1},urls:["^(memberguide/apps/?)$"],name:"Member Guide Apps",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide-apps"},{header:{fixed:!0,open:!1},urls:["^(memberguide/.*)$"],name:"Member Guide",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide"},{urls:["^(contact/staff/?)$"],name:"Contact Us Staff",viewport:"width=device-width, initial-scale=1.0",appName:"contact-us-staff"},{name:"CatchAll",urls:["^(errors/.*)$","^(404.html)$"],appName:"Error"},{name:"Puzzles Html5 Legacy Overlay",appName:"Overlay",urls:["^(puzzles/(crossword|sudoku|roundup|upanddown).*)$"],path:"apps/overlay/pages/puzzles-oldhtml5-overlay",preloadedUrl:"/life/",css:["life","puzzles"]},{path:"apps/cards/pages/weather-card",urls:["^(weather/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Weather",css:["weather"],appName:"Cards"},{css:["users"],name:"Profile Page",urls:["^(profile/[0-9]+/)$"],appName:"Users"},{css:["firefly"],name:"Not Authorized",urls:["^get-access/","^restricted/"],appName:"Overlay"},{name:"Generic Section",urls:["^({{sections}})$","^({{sections}})/.*$","^$","^index.html$","^section/[a-zA-Z0-9%_\\-/\\.]*$"],appName:"Cards"},{name:"Ballot",appName:"Overlay-with-utility-bar",urls:["^(take-your-pick/[a-zA-Z0-9%\\-/\\.]*)$"],preloadedUrl:"life/",init_modules:[{name:"ballot"},{name:"poster-ad-asset"},{name:"poster-ad-asset2"}],css:["ballot-page"]},{name:"Static Page",appName:"Overlay-with-utility-bar",header:{fixed:!0,open:!1},ajax:!1,urls:["^pages/.*$"],path:"pages/static_page"},{name:"UGC Home Page",appName:"UGC",urls:["^(yourtake/)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-hero",options:{thumbsSelector:".ugc-hero-multi-up-thumbs",fullScreen:"false",rotate:"true",ads:"false",track:"false",autostart:"true"}},{name:"ugc-my-contributions-links"}],css:["ugc-home-page"]},{name:"UGC Topics Home Page",appName:"UGC",urls:["^(yourtake/topics/)$","^(yourtake/topics/?.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-topics-sortby-dropdown"},{name:"ugc-my-contributions-links"}],css:["ugc-topics-page"]},{name:"UGC Topics Page",appName:"UGC",urls:["^(yourtake/topics/.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"},{name:"ugc-my-contributions-links"}],css:["ugc-topics-page"]},{name:"UGC Posts",appName:"Overlay-with-utility-bar",urls:["^(yourtake/asset/posts/[a-zA-Z0-9%\\-/\\.]*)$"],preloadedUrl:"/yourtake/",init_modules:[{name:"ugc-report-abuse",options:{tooltipOptions:{position:"left",customTextClass:"ugc-asset-page-media-item-report-abuse-tooltip-text",customPanelClass:"ugc-asset-page-media-item-report-abuse-tooltip-panel"}}},{name:"ugc-asset-gallery",options:{track:"false",fullScreen:"false",ads:"false"}},{name:"ugc-asset-video",options:{autostart:"true"}}],css:["ugc-asset-page"]},{name:"UGC Profile",appName:"Users",urls:["^yourtake/profile/[a-zA-Z0-9%\\-/\\.]*$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"}],css:["ugc-user-profile-page"]},{preloadedUrl:"/yourtake/",name:"UGC FAQ",urls:["^(yourtake/faq/)$"],appName:"Overlay-with-footer"},{name:"UGC Phase II Posts",appName:"Overlay-with-utility-bar",urls:["^(yourtake/posts/[a-zA-Z0-9%\\-/\\.]*)$"],preloadedUrl:"/yourtake/",init_modules:[{name:"ugc-report-abuse",options:{tooltipOptions:{position:"left",customTextClass:"ugc-asset-page-media-item-report-abuse-tooltip-text",customPanelClass:"ugc-asset-page-media-item-report-abuse-tooltip-panel"}}},{name:"ugc-asset-gallery",options:{track:"false",fullScreen:"false",ads:"false"}},{name:"ugc-asset-video",options:{autostart:"true"}}],css:["ugc-asset-page"]},{name:"UGC Collections Home Page",appName:"UGC",urls:["^(yourtake/collections/)$","^(yourtake/collections/?.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"}],css:["ugc-topics-page"]},{name:"UGC Tag  Page",appName:"UGC",urls:["^(yourtake/tags/?.*)$"],path:"apps/ugc/pages/ugc-front",init_modules:[{name:"ugc-featured-content"}],css:["ugc-topics-page"]}],siteModules:{"scores-page":{path:"modules/sports/scorespage",selector:"#scorespage"},"sports-more-teams":{path:"modules/sports/sports-more-teams"},"sponsor-story-topbar":{},"sponsor-story-more-stories":{},"interactive-poll":{path:"modules/interactive-poll",selector:".interactive-poll"},sigfig:{},"site-nav-firefly-module":{path:"modules/users/site-nav-firefly-module",selector:".site-nav-firefly-module"},"ugc-featured-content":{path:"modules/fronts/featured-content",selector:".ugc-featured-content-module"},"travel-featured-content":{path:"modules/travel/travel-featured-content"},"sports-data-video":{path:"modules/sports/sports-data-video",selector:".sp-data-video"},tripology:{path:"modules/travel/tripology"},"utility-bar-module-firefly":{path:"modules/stories/utility-bar-module-firefly",selector:".util-bar-module-firefly"},"sports-popup":{path:"modules/sports/popup-details",selector:"#section_sports"},quicklinks:{},"shermans-deals":{path:"modules/travel/shermans"},"rentals-listing-row":{path:"modules/rentals-listing-row"},"topics-videos":{path:"modules/topics/topics-videos"},"popular-on-social":{},sidebar:{path:"modules/sidebar",selector:"#card_full_width_main"},"sidebar-poster-ad":{path:"modules/fronts/sidebar-poster-ad",selector:".partner-sidebar-ad"},"travel-guides":{path:"modules/travel/travel-guides"},"blog-promo":{path:"modules/fronts/blog-promo"},"cxense-recommends":{path:"modules/cxense-recommends/cxense-recommends"},"rentals-apartments-ad":{path:"modules/rentals-apartments-ad"},"sports-olympics-countdown":{path:"modules/sports/sports-countdown"},"expandable-photo":{path:"modules/stories/expandable-photo"},"top-stories":{},"sports-pulse":{path:"modules/partner/sponsor-logo-ad",selector:".sponsor-logo"},"travel-dest-nav":{path:"modules/travel/travel-dest-nav"},"home-finder-featured":{path:"modules/home-finder/home-carousel"},"dynamic-video-playlist":{path:"modules/videos/video-gallery",selector:".video-gallery"},"headline-list":{},"longform-inline-share":{path:"modules/longform/longform-inline-share"},usanow:{},"more-blogs":{},interactive_beforeandafter:{path:"modules/interactives/before-after",selector:".interactive.before-after"},"share-facebook":{path:"modules/stories/share-facebook",selector:".util-bar-flyout-share"},"sports-more-teams-college":{path:"modules/sports/sports-more-teams-college",selector:"#sp-more-teams-slider"},"longform-sponsor-attribution":{},"home-finder-ads":{path:"modules/home-finder/home-ads"},"sports-tickets":{path:"modules/sports/sports-tickets"},puzzles:{},"sports-filters":{path:"modules/sports/sports-filters",selector:".sp-filter-bar-wrap"},"featured-content-with-advertising":{path:"modules/fronts/sidebar-poster-ad",selector:".poster-ad-primary"},"sports-datatables":{path:"modules/sports/sports-datatables",selector:"#section_sports"},"blogs-index-latest-hero":{},"leaderboard-ad":{path:"modules/partner/leaderboard-ad",selector:".leaderboard-ad"},"travel-trends":{},livevideo:{path:"modules/videos/brightcove-video",selector:".ui-video"},"assigned-content":{path:"modules/stories/assigned-content"},"sports-leader-rotate":{path:"modules/sports/sports-leader-rotate",selector:".sp-leader-rotate"},"featured-events":{},"ggm-jobs-search":{path:"modules/ggm-jobs-search/ggm-jobs-search"},"static-story-expand-faq":{path:"modules/stories/expand-faq",selector:".static-page-faq"},"ggm-earlybird-signup":{},"sports-olympics-medals":{path:"apps/overlay/pages/olympics-widgets"},"flight-tracker":{path:"modules/travel/flight-search"},"sports-front-video":{path:"modules/sports/sports-front-video"},"sponsored-series-topbar":{path:"modules/stories/sponsored-series-topbar",selector:".sponsored-series-bar"},"topics-related-tags":{},booksthreeup:{path:"modules/book-reviews/books-three-up",selector:".module-books-three-up"},twitter:{path:"modules/twitter"},"car-search":{path:"modules/car-search",selector:".car-search-module-wrap"},"market-symbol-search":{path:"modules/money/market-symbol-search"},elections:{path:"modules/fronts/elections-module"},interactive_piechart:{path:"modules/interactives/pie-chart",selector:".interactive.pie-chart"},"sports-nav":{path:"modules/sports/sports-nav",selector:".sp-nav-wrap"},video:{path:"modules/videos/brightcove-video",selector:".ui-video"},"sports-news":{path:"modules/sports/sports-news"},"featured-content":{path:"modules/fronts/featured-content"},ballot:{path:"modules/ballot/ballot",selector:".ballot-module"},"sports-video":{path:"modules/sports/sports-video",selector:".hero-3up"},"rentals-local-rentals":{path:"modules/rentals-local-rentals"},"related-topics-embed-stories":{},"longform-byline":{},"election-2012":{path:"apps/election-2012",selector:"#elections-2012"},"sports-olympics-schedule-results":{path:"apps/overlay/pages/olympics-schedule-results",selector:".olympics-schedule"},"longform-series-bottom":{path:"modules/longform/longform-series-bottom",selector:".series-bucket-wrapper"},"video-playlist-rightrail":{},"market-tool-links":{},"utility-bar-module-share":{path:"modules/stories/utility-bar-module-share",selector:".util-bar-module-share"},"front-galleries":{path:"modules/fronts/front-galleries"},hotelme:{path:"modules/travel/hotelme",selector:".hotelme-wrapper"},"site-nav-social-module":{path:"modules/header/site-nav-social-module",selector:".site-nav-social-module"},"headline-text-grid":{},"longform-headline":{},"recommended-flyout":{path:"modules/stories/recommended-flyout",selector:".recommended-flyout-container"},"iframe-auto-height":{path:"modules/global/iframe-auto-height",selector:".iframe-auto"},"sports-team-leaders":{path:"modules/sports/sports-team-leaders"},hero:{path:"modules/fronts/hero",selector:".hero"},"sports-brackets":{path:"modules/sports/sports-brackets",selector:".card-full-width.brackets"},"sports-twitter":{path:"modules/sports/sports-twitter"},"poster-ad-asset2":{path:"modules/partner/poster-ad-asset2",selector:".partner-asset-right-ad-2"},"web-twitter":{},"sports-front-galleries":{path:"modules/sports/sports-front-galleries"},"about-this-blog":{},"blog-list":{path:"blog/blog-list"},"sports-olympics-widgets":{path:"apps/overlay/pages/olympics-widgets",selector:".sports-olympics-widgets"},"longform-series-top":{path:"modules/longform/longform-featured-series",selector:".longform-top-series-bucket"},"headline-grid":{path:"modules/fronts/headline-grid"},"section-header-nation-now":{},"longform-nav-rail-bucket":{path:"modules/longform/longform-nav-rail-bucket",selector:".longform-series-flyout-bucket-wrapper"},"countdown-clock":{path:"modules/fronts/countdown-clock"},"sports-follow-usat-overlay":{path:"modules/sports/sports-follow-usat"},"topics-interactives":{},"topics-share-tools":{path:"modules/topics/topics-share-tools"},"site-nav-weather-module":{path:"modules/weather/site-nav-weather-module",selector:".site-nav-weather-module"},"national-news-desk":{},"section-header":{},"sports-video-ooyala":{path:"modules/sports/sports-video-ooyala",selector:".sports-ooyala"},"holiday-puzzles":{},"live-newscasts":{path:"modules/live-newscasts/live-newscasts"},interactive_overview:{path:"modules/interactives/overview",selector:".interactive.overview"},"gravy-events":{},"sports-olympics-results":{path:"apps/overlay/pages/olympics-widgets"},"trending-map":{path:"modules/trending-map/trending-map"},"topics-overview":{},"ugc-hero":{path:"modules/carousel/carousel",selector:".ugc-hero"},"travel-poll":{path:"modules/travel/travel-poll"},livefeed:{path:"modules/fronts/live-feed",selector:".livefeed-news-list"},"poster-ad-asset":{path:"modules/partner/poster-ad-asset",selector:".partner-asset-right-ad"},"sub-section-navigation":{},"sports-team-statistics":{path:"modules/sports/sports-team-leaders"},"rentals-header":{},"travel-your-take":{},"brightcove-video":{path:"modules/videos/brightcove-video",selector:".ui-video:not('.gallery-video')"},interactive_barchart:{path:"modules/interactives/bar-chart",selector:".interactive.bar-chart"},"google-survey":{path:"modules/stories/google-survey"},header:{path:"modules/global/header",selector:".site-header"},"video-carousel":{path:"modules/global/video-carousel"},"ggm-classifieds-search":{},"suspender-ad":{path:"modules/fronts/suspender-ad",selector:".suspender-ad"},lottery:{path:"modules/fronts/lottery",selector:".lottery-module-content"},myCapture:{path:"modules/myCapture/myCapture",selector:".mycapture-btn-wrap"},"longform-share":{path:"modules/longform/longform-share",selector:".longform-share-wrapper"},"sports-scores-suspender":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},"ggm-va-loan":{path:"modules/ggm-va-loan/ggm-va-loan"},"longform-navigation":{path:"modules/longform/longform-navigation",selector:".longform-navigation-wrapper"},"ugc-my-contributions-links":{path:"modules/ugc/my-contributions-links",selector:".ugc-page-container"},"generic-iframe":{},"travel-tools":{path:"modules/travel/travel-tools"},"sports-syndication-headline-grid":{path:"modules/sports/sports-headline-grid"},"polldaddy-poll":{path:"modules/polldaddy-poll"},"utility-bar-module-comments":{path:"modules/stories/utility-bar-module-comments",selector:".util-bar-module-comments"},"hero-4-up":{path:"modules/fronts/hero",selector:".hero"},"election-results":{path:"modules/fronts/election-results-module"},"longform-footer-logo":{},"sports-stn-promo":{path:"modules/sports/sports-stn-promo"},"ugc-report-abuse":{path:"modules/ugc/report-abuse",selector:".ugc-asset-page"},"sports-ballots":{path:"modules/sports/sports-ballots",selector:"#section_sports"},"travel-email":{path:"modules/travel/travel-email"},"story-byline":{},booksAssetView:{path:"apps/overlay/pages/book-reviews-overlay",selector:".books-meta-comp"},"site-nav-user-module":{path:"modules/users/site-nav-user-module",selector:".site-nav-user-module"},snapshots:{path:"modules/fronts/snapshots",selector:".front-galleries-module"},"story-headline":{},"job-search":{path:"modules/money/job-search",selector:".job-search-module-wrap"},"sports-story-video":{path:"modules/sports/sports-story-video"},"sports-multipurpose-promo":{path:"modules/sports/sports-multipurpose-promo"},"sports-scores-suspender-des":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},"kayak-widget":{path:"modules/travel/kayak-module"},"ggm-mil-mall-promo":{},"hero-4-up-flex":{path:"modules/fronts/hero",selector:".hp4fm-primary-wrap"},"travel-experience":{path:"modules/travel/travel-experience"},"longform-poster-ad-bottom":{path:"modules/longform/longform-poster-ad-bottom",selector:".longform-poster-ad-bottom"},footer:{path:"modules/global/footer",selector:".footer"},"inline-share-tools":{path:"modules/stories/inline-share-tools",selector:".inline-share-tools"},"most-popular":{path:"modules/fronts/most-popular"},"sports-countdown":{path:"modules/sports/sports-countdown"},"ugc-asset-gallery":{path:"modules/carousel/carousel",selector:".ugc-asset-page-gallery"},"sports-event-tool":{path:"modules/sports/sports-event-tool",selector:"#section_sports"},"home-finder-search":{path:"modules/home-finder/home-search"},"sports-popup-media-view":{path:"modules/sports/sports-popup-media-view",selector:".content-wrap"},blogs:{path:"modules/fronts/blogs"},"story-transition-ad":{path:"modules/partner/story-transition-ad",selector:".partner-overlay"},"form-dropdown":{path:"ui/dropdown",selector:".ui-dropdown"},"social-media":{},"gannett-properties":{selector:".gannett-properties-wrapper"},"sports-latest-player-news":{path:"modules/sports/sports-latest-player-news"},"sports-jumptotop":{path:"modules/sports/sports-jumptotop",selector:"#section_sports"},"blogs-index-grid":{},"taboola-recommendations":{path:"modules/stories/taboola-recommendations",selector:".transition-wrap:first"},"topics-timeline":{path:"modules/topics/topics-timeline"},"newsletter-signup":{path:"modules/newsletter-signup/newsletter-signup"},"sports-featured-content":{path:"modules/fronts/featured-content"},"assigned-content-nav":{path:"modules/fronts/assigned-content-nav"},"longform-arrow":{path:"modules/longform/cover-photo-arrow",selector:".longform-arrow-container"},"social-share-modal":{path:"modules/ugc/social-share-modal",selector:"social-share-modal"},"market-summary-search":{path:"modules/money/market-summary-search"},"slider-ad":{path:"modules/partner/slider-ad",selector:".slider-ad"},"big-headline":{},"sports-player-news":{path:"modules/sports/sports-player-news",selector:"#player-news-page"},"site-nav-more-module":{path:"modules/header/site-nav-more-module",selector:".site-nav-more-module"},"share-email":{path:"modules/stories/share-email",selector:".util-bar-flyout-share"},interactive_sequencer:{path:"modules/interactives/sequencer",selector:".interactive.sequencer"},"staff-listing":{path:"modules/tools/staff-listing",selector:"#section_staff"},"live-video-sidebar":{path:"modules/live-video-sidebar/live-video-sidebar"},"topics-photo-gallery":{path:"modules/topics/topics-photo-gallery"},"sports-team-matchup":{path:"modules/sports/sports-team-matchup"},"more-section-stories":{},"ugc-topics-sortby-dropdown":{path:"ui/dropdown",selector:".ugc-topics-filter-sortby-dropdown"},"ggm-jobs-latest":{},"overlay-ad":{},"hero-5-up":{path:"modules/fronts/hero",selector:".hero"},map:{path:"modules/map/map",selector:".mapboxWrap"},"sports-syndication-hero":{},"travel-experience-promo":{path:"modules/travel/travel-experience-promo"},"ugc-asset-video":{path:"modules/global/brightcove-video",selector:".video"},"related-topics-photo-gallery-embed-stories":{},horoscope:{path:"modules/horoscope"},interactive_timeline:{path:"modules/interactives/timeline",selector:".interactive.timeline"},oembed:{path:"modules/stories/oembed",selector:".js-oembed"},"utility-bar-module-print":{path:"modules/stories/utility-bar-module-print",selector:".util-bar-module-print"},"sports-olympics-profile-overlay":{path:"apps/overlay/pages/olympics-profile-overlay",selector:".olympics-profile"},"sports-follow-usat":{},gallery:{path:"modules/carousel/carousel",selector:".galleries"},"video-playlist":{path:"modules/videos/video-gallery",selector:".video-gallery"},"utility-bar":{path:"modules/stories/utility-bar",selector:".utility-bar-wrap"},"hero-6-pack":{path:"modules/fronts/hero",selector:".hero"},"section-highlights":{},"longform-subheadline":{},"longform-footer-copyright":{},dealchicken:{},"super-hero":{path:"modules/fronts/super-hero"},"travel-experience-featured":{path:"modules/travel/travel-experience-featured"},"vegas-experience":{},"sports-olympics-schedule":{path:"apps/overlay/pages/olympics-widgets"},"topics-scroller-ad":{},"sports-leagues":{path:"modules/sports/leagues",selector:"#section_sports"},"generic-front-header":{},booklist:{path:"modules/book-reviews/booklist",selector:".front-booklist-page-container"},"sports-galleries":{path:"modules/fronts/front-galleries"},interactive_linechart:{path:"modules/interactives/line-chart",selector:".interactive.line-chart"},"nfl-unitedway":{path:"modules/sports/nfl-unitedway",selector:"#nfl-unitedway-subscribe"}}}
}),define("managers/siteconfig",["jquery","underscore","mergedSiteConfig"],function(e,t,i){"use strict";var s={getSiteConfig:function(){return this.inited||(this.inited=!0,this.setupSiteConfig(i)),i},setupSiteConfig:function(e){!e.require||t.isEmpty(e.require.paths)&&t.isEmpty(e.require.shim)||require.config(e.require),s._replaceEnvVariables(e)},loadRoutes:function(){return e.Deferred(t.bind(function(e){var i=this.getSiteConfig(),s=t.pluck(i.apps,"path");require(s,t.bind(function(){var s=arguments,n=0;t.each(i.apps,function(e){e.AppClass=s[n++]}),this.urls=this._buildRoutes(i.pages,i.apps),e.resolve(this.urls)},this))},this))},_buildRoutes:function(e,i){return t.reduce(e,function(e,s){var n=i[s.appName],a=s.hosturls&&s.hosturls[location.hostname]||s.urls;return n||(s.appName&&(console.error("Invalid appName "+s.appName+" for Page "+s.name),s.appName="BaseApp"),n=i.BaseApp),s.modules=(s.init_modules||[]).concat(n.init_modules||[]),e.concat(t.map(a,function(e){var t=void 0===s.ajax&&void 0===n.ajax||void 0===s.ajax&&n.ajax===!0||s.ajax===!0;return{url:new RegExp(e),app:n,page:s,ajax:t}},this))},[])},getRouteInfo:function(i){return i&&(i=i.split("?")[0].split("#")[0],"/"===i[0]&&(i=i.substring(1)),i=e.trim(i)),null!==i&&t.find(this.urls,function(e){return e.url.test(i)})},_replaceEnvVariables:function(e){var i=t.templateSettings.interpolate;t.templateSettings.interpolate=/{{(.+?)}}/g,t.each(e.pages,function(e){if(e.urls){var i=[];t.each(e.urls,function(e){if(-1!=e.indexOf("{{")&&-1!=e.indexOf("}}"))try{e=t.template(e,window.site_vars||{})}catch(s){console.error("invalid url template: "+e),e=void 0}void 0!==e&&i.push(e)}),e.urls=i}}),t.templateSettings.interpolate=i}};return s}),define("managers/resourcemanager",["jquery","underscore","managers/siteconfig"],function(e,t,i){"use strict";var s=function(){this.initialize()};return s.prototype={initialize:function(s){s=e.extend({siteModules:i.getSiteConfig().siteModules},s),this.siteModules=s.siteModules||{},this.$stylesheets=e([]),this.stylesheets=[],this.staticUrl=window.site_static_url||"/static/",this.staticVersion=window.site_static_version||"off",e("link[data-identifier]").each(t.bind(function(t,i){var s=e(i).data("identifier");"main"!=s&&(this.stylesheets.push(e(i).data("identifier")),this.$stylesheets.push(i))},this))},fetchStyles:function(i,s,n){var a=t.difference(i,this.stylesheets),o=t.difference(this.stylesheets,i);n&&o.length&&console.log("removing styles from dom: ",o),n&&a.length&&console.log("adding styles to dom: ",a);var r=this._findStyleTags(o);this.stylesheets=i,this.$stylesheets=e(t.filter(this.$stylesheets,function(e){return!t.include(r,e)})),this._addStylesToHead(a),r.length&&s.done(function(){r.remove()})},fetchJavascript:function(i,s,n){return e.Deferred(t.bind(function(e){i&&s?require([i],t.bind(function(){require([s],t.bind(function(t){this._resolveFetchJavascript(e,t,n)},this))},this)):s?require([s],t.bind(function(t){this._resolveFetchJavascript(e,t,n)},this)):this._resolveFetchJavascript(e,null,n)},this)).promise()},_resolveFetchJavascript:function(e,t,i){this.fetchPageModules(i).done(function(i){e.resolve(t,i)})},fetchPageModules:function(i){return i=i||[],e.Deferred(t.bind(function(e){var s=i.length,n=[];return s?void t.each(i,function(i){n.push(i),this.getSiteModuleByName(i.name).done(function(e){i.selector=e.selector||"."+e.name+"-module",i.ModuleClass=e.ModuleClass}).fail(function(){n=t.reject(n,function(e){return e.name===i.name})}).always(function(){s--,0===s&&e.resolve(n)})},this):void e.resolve(n)},this)).promise()},getSiteModuleByName:function(i){return e.Deferred(t.bind(function(e){var t=this.siteModules[i];t?t.ModuleClass?e.resolve(t):t.path?require([t.path],function(s){t.ModuleClass=s,t.name=i,e.resolve(t)},function(i){console.error("Failed loading "+t.path+": "+i.message,i),e.reject(i)}):e.reject():e.reject("No Such Module Found")},this)).promise()},_findStyleTags:function(i){return e(t.filter(this.$stylesheets,function(s){var n=e(s).data("identifier");return t.find(i,function(e){return n===e})}))},_addStylesToHead:function(i){if(i&&i.length>0){var s=e([]);t.each(i,function(t){var i=e('<link rel="stylesheet" data-identifier="'+t+'" href="'+this.staticUrl+"css/bundles/"+t+(window.use_minified_css?".min":"")+".css?v="+this.staticVersion+'">')[0];s.push(i),this.$stylesheets.push(i)},this),e("head").append(s)}}},new s}),define("state",["jquery","underscore","pubsub","utils","modules/global/alert","managers/trafficcop","managers/requestmanager","managers/resourcemanager","managers/siteconfig"],function(e,t,i,s,n,a,o,r,l){"use strict";Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.constructor.prototype});var h=function(){this.scrollEl=s.get("scrollEl"),this.body=s.get("body"),this.initialize()};return h.prototype={DEBUG:!0,LAYER_OVERLAY:"overlay",LAYER_PRELOAD:"preload",LAYER_BASE:"base",REFRESH_FREQUENCY:60*(s.getNested(window.site_vars,"REFRESH_RATE")||0)*1e3,start:function(e){var t=l.getSiteConfig();this.started=!0,this.header=e,this.pubSub={"page:unload":this.updateActivityTimestamp,"page:load":this.updateActivityTimestamp,"video:load":this.updateActivityTimestamp,"slide:change":this.updateActivityTimestamp,heattrack:this.updateActivityTimestamp,vitrack:this.updateActivityTimestamp,uotrack:this.updateActivityTimestamp},i.attach(this.pubSub,this),this._setupGlobalPubSub(s.getNested(t,"global","pubSub")),this.startRefreshTimer()},stop:function(){this.started=!1,this._currentViewport="width=1070",i.unattach(this.pubSub,this),t.each(s.getNested(this.siteConfig,"global","pubSub"),function(e,t){i.off(t)})},_setupGlobalPubSub:function(e){t.each(e,function(e,s){e instanceof Array||(e=[e]),require(e,t.bind(function(){var e=arguments;this.started&&i.on(s,function(i){t.each(e,function(e){new e(i)})})},this))},this)},initialize:function(){this.$overlayFilm=e("#overlay-film"),this.activeAppInfo={url:null,css:[],layer:null,scrollTop:0,appConfig:null,pageConfig:null,app:null},this.lastUrl=null,this._clearPreloadedAppInfo(),this.fullscreenView=null},_clearPreloadedAppInfo:function(){this.preloadedAppInfo={url:null,css:[],scrollTop:0,appConfig:null,pageConfig:null,layer:this.LAYER_PRELOAD,app:null}},onRouteChange:function(e,t){return console.log("App: "+e.page.appName+"/"+e.page.name),this.activeAppInfo.app&&i.trigger("page:unload"),this._loadRoute(e,t)},_loadRoute:function(e,t,i){var s={preloadedUrl:e.page.preloadedUrl||e.app.preloadedUrl};return this._loadApp(e.app.AppClass,s,t,e.app,e.page,i)},_preloadRoute:function(e,t,i){return this._preloadApp(e.app.AppClass,{},t,e.app,e.page,i)},preloadPath:function(t){this.DEBUG&&console.log("Router: Preloading: ",t);var i=l.getRouteInfo(t);return!i||window.chromeless||this.activeAppInfo.layer&&this.activeAppInfo.layer!==this.LAYER_OVERLAY?e.Deferred().reject():this._preloadRoute(i,t)},_loadPath:function(t){var i=l.getRouteInfo(t);return i?this.onRouteChange(i,t):(console.error("StateManager: tried navigating to path, but no match found: "+t),e.Deferred().reject())},refreshActiveApp:function(){var e=this.activeAppInfo.url,t=l.getRouteInfo(e).page,s=r.fetchJavascript(t.buildfile&&t.buildfile.path,t.path,t.modules),n=this._fetchPathHtml(e);return i.trigger("page:unload"),this._changePage(this.activeAppInfo,e,e,n,s)},setIntentUrl:function(e){this.activeAppInfo.intentUrl=e,this.activeAppInfo.app&&this.activeAppInfo.app.destroyModules()},getIntentUrl:function(){return this.activeAppInfo.intentUrl},getPreloadedUrl:function(){return this.preloadedAppInfo.url},registerFullScreenView:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView=e,this.activeAppInfo.app.pause()},setActiveAppFixed:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},clearFullScreenView:function(){return this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView?(this.fullscreenView=null,this._loadPath(this.activeAppInfo.url)):void 0},clearActiveAppFixed:function(e){this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},_loadApp:function(e,i,s,n,a,o){var l,h=n.overlay?this.LAYER_OVERLAY:this.LAYER_BASE,d=r.fetchJavascript(a.buildfile&&a.buildfile.path,a.path,a.modules);return this._closeFullscreenView(),this.lastUrl=this.activeAppInfo.url,this.activeAppInfo.app&&(this.activeAppInfo.intentUrl&&this.activeAppInfo.intentUrl!==s&&(this.activeAppInfo.url=this.activeAppInfo.intentUrl),this.activeAppInfo.intentUrl=null),l=this._handleTransition(s,this.activeAppInfo,e,i,h,o,d),this.activeAppInfo.css=a.css||[],this.activeAppInfo.url=s,this.activeAppInfo.layer=h,this.activeAppInfo.pageConfig=a,this.activeAppInfo.appConfig=n,r.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),l),l},_preloadApp:function(e,i,s,n,a,o){var l=this._handleTransition(s,this.preloadedAppInfo,e,i,this.LAYER_PRELOAD,o);return this.preloadedAppInfo.css=a.css||[],this.preloadedAppInfo.url=s,this.preloadedAppInfo.pageConfig=a,this.preloadedAppInfo.appConfig=n,r.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),l),l},_closeFullscreenView:function(){if(this.fullscreenView){var e=this.fullscreenView;this.fullscreenView=null,e.close()}},_handleTransition:function(e,t,i,s,n,a,o){var r,l=t.url;return this._needsNewApp(i,t)?(r=new i(s),a=a||this._requestPageHtml(l,e,t===this.preloadedAppInfo),t.app?this._changeApps(t,n,r,l,e,a,o):this._revealApp(t,r,l,e,a,o)):t.layer===n?(a=this._requestPageHtml(l,e,t===this.preloadedAppInfo),this._changePage(t,l,e,a,o)):this._transitionFromOverlayToPreloadedApp(l,e,o)},_changeApps:function(i,s,n,a,o,r,l){return i.layer===s?i.app.removeApp(a,o).then(t.bind(function(){return this._revealApp(i,n,a,o,r,l)},this)):s===this.LAYER_OVERLAY?this._revealOverlay(n,a,o,r,l):e.when(this._removePreloadedApp(a,o),this._removeOverlay(i.app,a,o)).then(t.bind(function(){return this._revealApp(i,n,a,o,r,l)},this))},updateState:function(){var t=this.activeAppInfo;if(t.appConfig&&t.pageConfig){this.header&&this._setHeader(this.header,e.extend({},t.appConfig.header,t.pageConfig.header));var i=t.appConfig.viewport||t.pageConfig.viewport||"width=1070";this._currentViewport!==i&&(this._currentViewport=i,e("meta[name=viewport]").attr("content",i))}},_setHeader:function(e,i){t.isEmpty(i)?e.restoreDefaultState():i.fixed?i.open?e.setOpenFixed():e.setClosedFixed():e.setFixingScroller(!0)},_changePage:function(e,i,s,n,a){return e.app.changePage(i,s,n,a,e===this.preloadedAppInfo).then(null,t.bind(function(t,a){return"InvalidApp"===t&&a?this._invalidateApp(e,a,i,s,n):void 0},this))},_rerouteInitialPageLoad:function(i,s,n){return e.Deferred(function(e){t.defer(function(){i.app=null,i.url=null,e.resolve()})}).then(t.bind(function(){return this._loadRoute(n,s)},this))},_removePreloadedApp:function(e,t){var i=this.preloadedAppInfo.app;return i?(this._clearPreloadedAppInfo(),i.beforeOverlayRemove(t),i.removeApp(e,t)):void 0},_revealApp:function(e,i,s,n,a,o){return e.app=i,i.revealApp(s,n,a,o,e===this.preloadedAppInfo).then(null,t.bind(function(t,i){return"InvalidApp"===t&&i?this._invalidateApp(e,i,s,n,a):void 0},this))},_invalidateApp:function(e,t,i,s,n){try{e.app.destroy()}catch(a){console.error("View threw an exception on destroy: ",a.stack||a.stacktrace||a.message)}return console.log("Rerouting: "+t.page.appName+"/"+t.page.name),n?(e.url=i,e===this.activeAppInfo?this._loadRoute(t,s,n):this._preloadRoute(t,s,n)):this._rerouteInitialPageLoad(e,s,t)},_needsNewApp:function(e,t){return!(t.app&&t.app.isRevealed()&&(Object.getPrototypeOf(t.app)===e.prototype||this.preloadedAppInfo.app&&Object.getPrototypeOf(this.preloadedAppInfo.app)===e.prototype&&this.preloadedAppInfo.app.isRevealed()))},_requestPageHtml:function(e,t,i){if(null!==e||i){if(e!==t)return this._fetchPathHtml(t,i);i||o.abortAllRequests()}return null},_transitionFromOverlayToPreloadedApp:function(e,i,s){var n=this.preloadedAppInfo,a=this._requestPageHtml(n.url,i,!1),o=this.activeAppInfo.app;return this._movePreloadAppToActiveApp(this.LAYER_BASE),n.app.beforeOverlayRemove(i),this._removeOverlay(o,e,i).then(t.bind(function(){return this.updateState(),this._transitionFromOverlayScroll(n),this._changePage(n,e,i,a,s)},this))},_removeOverlay:function(t,i,s){return e.when(t.removeApp(i,s),this._fadeOutOverlayFilm(t))},_movePreloadAppToActiveApp:function(t){e.extend(this.activeAppInfo,this.preloadedAppInfo),this.activeAppInfo.layer=t,this._clearPreloadedAppInfo()},_deactivateActiveApp:function(){this.activeAppInfo.app.pause(),e.extend(this.preloadedAppInfo,this.activeAppInfo)},_revealOverlay:function(s,n,a,o,r){var l=this.activeAppInfo.app;l.isRevealed()?this._deactivateActiveApp():(l.removeApp(n,a),l=null),this.body.css("overflow-y","scroll"),this._transitionToOverlayScroll(this.preloadedAppInfo);var h=e.when(this._fadeInOverlayFilm(s),this._revealApp(this.activeAppInfo,s,n,a,o,r));return i.trigger("scrollTop",0),h.done(t.bind(function(){this.body.css("overflow-y",""),l&&!l.destroyed&&l.afterOverlayReveal(this.preloadedAppInfo.scrollTop)},this)),h},_fadeInOverlayFilm:function(t){var i=t.options.animations.fadeIn;return this.$overlayFilm.length||(this.$overlayFilm=e('<div class="ui-film"></div>'),this.body.append(this.$overlayFilm)),t.animate(this.$overlayFilm,"opacity",.7,i.duration,"ease-in")},_fadeOutOverlayFilm:function(t){var i=this.$overlayFilm,s=t.options.animations.fadeOut;return this.$overlayFilm=e([]),t.animate(i,"opacity",0,s.duration,"ease-out").done(function(){i.remove()})},_fetchPathHtml:function(e,i){var a=this.fetchHtml(e,null,!i);return i||a.fail(t.bind(function(e){if(e)if("NOT AUTHORIZED"===e)window.location.assign(s.getNested(window,"firefly_urls","samSubscribeURL")||"");else{var t=this.generateRequestError(e);t&&n.showError(t),(200!==e.status&&e.status||"timeout"===e.statusText)&&window.history.back()}},this)),a},generateRequestError:function(e){if(e){if(500===e.status)return"Connection Error... (INTERNAL SERVER ERROR)";if(404===e.status)return"Connection Error... (FILE NOT FOUND)";if(200!==e.status&&e.status)return"Connection Error... ("+(e.statusText||"Unknown Error")+")"}return null},_transitionFromOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.show():this._clearFixedPosition(e,t),t.$el.css("z-index",""))},_transitionToOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.hide():this._setFixedPosition(e,t),t.$el.css("z-index","0"))},_clearFixedPosition:function(e,t,s){t.clearFixedPosition(s),i.trigger("scrollTop",e.scrollTop||0)},_setFixedPosition:function(e,t,n){var a=t.getWindowOffset().top;e.scrollTop=s.getScrollPosition(),i.trigger("scrollTop",0),t.setFixedPosition(a,n)},updateActivityTimestamp:function(){this.lastActivityTimestamp=(new Date).getTime()},getActivePageInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.pageInfo||{}},getActiveAppClientInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.getClientInfo()||{}},getPreloadedPageInfo:function(){return this.preloadedAppInfo.app&&this.preloadedAppInfo.app.pageInfo||{}},getActiveApp:function(){return this.activeAppInfo.app},getPreloadedApp:function(){return this.preloadedAppInfo.app},getReferrer:function(){return null===this.lastUrl?document.referrer:s.getOrigin()+this.lastUrl},getCurrentUrl:function(){return s.getOrigin()+this.activeAppInfo.url},startRefreshTimer:function(){!this.refreshTimer&&this.REFRESH_FREQUENCY&&(this.lastActivityTimestamp=0,this.refreshTimer=setInterval(t.bind(function(){if(!this.fullscreenView&&this.activeAppInfo.layer!==this.LAYER_OVERLAY){var e=(new Date).getTime(),t=e-this.lastActivityTimestamp;t>this.REFRESH_FREQUENCY&&(i.trigger("site:refresh","refresh:"+(this.getActivePageInfo().ssts||"").replace(/[\/:].*/,"")),window.location=window.location)}},this),6e4))},stopRefreshTimer:function(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null)},registerAnimation:function(e,t,i,s,n){return a.addAnimation(e,t,i,s,n)},fetchHtml:function(e,t,i,s){return o.fetchHtml(e,t,i,s,!0)},fetchData:function(e,t,i,s,n){return o.fetchData(e,t,i,s,n)},recurringFetchHtml:function(e,t,i,s,n){return o.recurringFetchHtml(e,t,i,s,n,!0)},recurringFetchData:function(e,t,i,s,n,a){return o.recurringFetchData(e,t,i,s,n,a)}},window.stateManager=new h,window.stateManager}),define("managers/routemanager",["jquery","underscore","state","managers/siteconfig","pubsub","utils"],function(e,t,i,s,n,a){"use strict";var o=function(){};return o.prototype={baseUrl:window.location.protocol+"//"+window.location.host,usatBetaDomain:"http://beta.usatoday.com",start:function(e){this.started=!0,s.loadRoutes().done(t.bind(function(){this.started&&(e&&a.get("win").on("popstate",t.bind(this._onStateChange,this)),this._onStateChange(),console.log("Site Loaded"))},this))},getLocalPath:function(e){if(!e||"#"===e)return null;if(e.indexOf(this.baseUrl))if(e.indexOf(this.usatBetaDomain)){if(-1!==e.indexOf("://"))return null}else e=e.substring(this.usatBetaDomain.length);else e=e.substring(this.baseUrl.length);return e},stop:function(){this.started=!1,a.get("win").off("popstate")},getInfo:function(t){var i=this.getLocalPath(t);return null!==i?s.getRouteInfo(e.trim(i)):null},isAjax:function(e){var t=this.getInfo(e);return t&&t.ajax},goTo:function(e,t,s){if(!a.isValidUrl(e)||!this._canNavigate())return!1;if(!i.getIntentUrl()&&this.isCurrentUrl(e))return console.warn("Tried navigating to the current url, skipping"),!1;n.trigger("track",{label:t,url:e,event:s});var o=this._goHashTag(e)||this._goInternal(e);return o||this._setLocation(this.attachChromeless(e)),!0},goToInterstitual:function(e){return e=this.getLocalPath(e),Modernizr.history&&a.isValidUrl(e)&&this._canNavigate()&&this.getInfo(e)?(i.setIntentUrl(e),this._pushState(this.attachChromeless(e)),!0):!1},isCurrentUrl:function(e){var t=this.getLocalPath(e);return t&&(t=t.split("#")[0]),t===this._getCurrentPath()},_getCurrentPath:function(){return window.location.pathname+location.search},_setLocation:function(e){window.location.assign(e)},_canNavigate:function(){var e=i.getActivePageInfo().navigationWarning;return e&&!window.confirm(e)?!1:!0},_goHashTag:function(t){if("#"===t[0]){t=t.substring(1);var i=e("a[name="+t+"]").offset();return i&&i.top&&n.trigger("scrollTop",i.top-40),window.location.hash=t,!0}},attachChromeless:function(e){return window.chromeless?e+(-1===e.indexOf("?")?"?":"&")+"chromeless=true":e},_goInternal:function(e){return Modernizr.history&&this.isAjax(e)&&this.isAjax(a.getPageUrl())?(this._pushState(this.attachChromeless(this.getLocalPath(e))),this._onStateChange(),!0):!1},_pushState:function(e){window.history.pushState({},document.title,e)},_onStateChange:function(){var e,t=window.location;t.pathname!==this._currentPathName&&(this._currentPathName=t.pathname+t.search,e=this.getInfo(t.pathname),e?i.onRouteChange(e,t.pathname+t.search+t.hash):console.error("Could not find any site-config matching "+t.pathname))}},new o}),define("managers/cachemanager",["jquery","underscore"],function(e,t){"use strict";var i=function(){t.bindAll(this,"_updateCache"),window.addEventListener?window.addEventListener("storage",this._updateCache,!1):window.attachEvent("onstorage",this._updateCache),this.reset(),this.getValue("cmgc",this.gc,10080)};return i.prototype={keyPrefix:"wf_",reset:function(){this._cache={}},gc:function(){var e=i.prototype;t.each(t.keys(window.localStorage),function(t){0===t.indexOf(e.keyPrefix)&&(e._getBrowserCache(window.localStorage,t)||window.localStorage.removeItem(t))})},_updateCache:function(t){var i;t||(t=window.event),t.key&&0===t.key.indexOf(this.keyPrefix)&&(t.newValue?(i=JSON.parse(t.newValue),"raw"!==i.type&&(i.data=e.Deferred().resolve(i.data)),this._setMemoryCache(t.key,i)):delete this._cache[t.key])},getValue:function(e,i,s){var n,a,o,r=this._getStorage(s);return e=this.keyPrefix+e,n=this._getMemoryCache(e),n||(n=this._getBrowserCache(r,e),n||(a=this._getValue(i),o=this._isPromise(a),n=this._buildCacheEntry(a,o,s),o?a.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,s);this._setBrowserCache(e,i,r)},this)):this._setBrowserCache(e,n,r)),this._setMemoryCache(e,n)),n.data},setValue:function(e,i,s){var n=this._isPromise(i),a=this._buildCacheEntry(i,n,s);e=this.keyPrefix+e,n?i.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,s);this._setBrowserCache(e,i,this._getStorage(s))},this)):this._setBrowserCache(e,a,this._getStorage(s)),this._setMemoryCache(e,a)},_isPromise:function(t){return e.isPlainObject(t)&&e.isFunction(t.promise)},_getStorage:function(e){var t=e?"localStorage":"sessionStorage";return window[t]},_setMemoryCache:function(e,t){this._cache[e]=t},_setBrowserCache:function(e,t,i){try{i.setItem(e,JSON.stringify(t))}catch(s){console.log("Storage Set Failed for key: "+e)}},_buildCacheEntry:function(e,t,i){var s,n={data:e,type:t?0:"raw"};return i&&(s=new Date,n.expires=s.setTime(s.getTime()+1e3*i*60)),n},clearValue:function(e){e=this.keyPrefix+e,sessionStorage.removeItem(e),localStorage.removeItem(e),delete this._cache[e]},_getMemoryCache:function(e){var t=this._cache[e];if(t){if("raw"!==t.type){if("pending"===t.data.state())return t;if("rejected"===t.data.state())return null}if(!t.expires)return t;if(new Date<new Date(t.expires))return t}},_getBrowserCache:function(t,i){var s=t.getItem(i);return s&&(s=JSON.parse(s),!s.expires||new Date<new Date(s.expires))?("raw"!==s.type&&(s.data=e.Deferred().resolve(s.data)),s):void 0},_getValue:function(t){return e.isFunction(t)?t():t}},new i}),define("user-manager",["jquery","underscore","pubsub","managers/cachemanager"],function(e,t,i,s){"use strict";var n=function(){this.initialize()};return n.prototype={PREFERRED_ACCOUNT_KEY:"userPreferredAccount",PREFERRED_ACCOUNT_TIMEOUT:525600,initialize:function(){this.resetManager(),this.preferredAccount&&(this.state="loggingIn",i.on("page:load",this.autoLogin,this)),i.on("user:statuschange",this._userStatusChange,this)},destroy:function(){this.resetManager(),i.off("user:statuschange",this._userStatusChange,this),i.off("page:load",this.autoLogin,this)},autoLogin:function(){this.state=null,this.loginUser(this.preferredAccount,!0).fail(t.bind(function(){this.logoutUser()},this)),i.off("page:load",this.autoLogin,this)},registerAccount:function(e){var t=e.getName();return this.accounts[t]?void console.error("duplicate account name given to registerAccount"):void(this.accounts[t]=e)},unRegisterAccount:function(e){var t=e.getName();this.accounts[t]?this.accounts[t]=null:console.error("unRegisterAccount called on name that isn't registered!"),e.logout(),this.preferredAccount===t&&this.setPreferredAccount(null)},loginUser:function(e,t){return this._askAccount("login",e,t)},_userStatusChange:function(e,t,i){"loggedIn"===t?this._onLoginSuccess(e,i):"loggedOut"===t&&this._onLogoutSuccess(e)},_onLoginSuccess:function(e,t){this.setPreferredAccount(e),i.trigger("user:login",t,e)},setPreferredAccount:function(e){var t=this.getPreferredAccountLookupKey();e?s.setValue(t,e,this.PREFERRED_ACCOUNT_TIMEOUT):s.clearValue(t),this.preferredAccount=e},getPreferredAccountLookupKey:function(){return this.PREFERRED_ACCOUNT_KEY},getPreferredAccount:function(){return this.preferredAccount||s.getValue(this.getPreferredAccountLookupKey(),null,this.PREFERRED_ACCOUNT_TIMEOUT)},getLoginStatus:function(e){var t,i=this.getAccount(e);return t=i?i.getLoginStatus():"loggedOut",this.state||t},logoutUser:function(e){return this._askAccount("logout",e)},logoutAll:function(){return e.when.apply(e,t.map(this.accounts,function(e){return e.logout()}))},_onLogoutSuccess:function(e){i.trigger("user:logout",e),e===this.getPreferredAccount()&&this.setPreferredAccount(null)},getAccount:function(e){return this.accounts[e||this.preferredAccount]},getUserInfo:function(e){return this._askAccount("getUserInfo",e)},getCoreUserInfo:function(e){return this._askAccount("getCoreUserInfo",e)},resetManager:function(){this.accounts={},this.preferredAccount=this.getPreferredAccount()},_askAccount:function(t,i){var s=this.getAccount(i);return s?s[t]?s[t].apply(s,Array.prototype.slice.call(arguments,2)):e.Deferred().reject("Account "+(i||this.preferredAccount)+" does not support method "+t):e.Deferred().reject("Invalid Account")}},new n}),define("adLogger",["underscore"],function(e){"use strict";var t=function(){this.initialize()};return t.prototype={initialize:function(){this.debug=window.isAdDebug,Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&e.each(["log","info","warn","error"],function(e){window.console[e]=Function.prototype.call.bind(window.console[e],window.console)})},logGroup:function(e){this.debug&&window.console.groupCollapsed(e)},logGroupEnd:function(){this.debug&&window.console.groupEnd()},_log:function(e,t,i){var s="Ad "+t+": "+e;if(window.console&&window.console[t])if(i.length){window.console.groupCollapsed(s);for(var n=0,a=i.length;a>n;n++)window.console[t](i[n]);window.console.groupEnd()}else window.console[t](s)},logDebug:function(e){this.debug&&this._log(e,"log",Array.prototype.slice.call(arguments,1))},logError:function(e){this._log(e,"error",Array.prototype.slice.call(arguments,1))},logInfo:function(e){this.debug&&this._log(e,"info",Array.prototype.slice.call(arguments,1))},logWarn:function(e){this._log(e,"warn",Array.prototype.slice.call(arguments,1))}},new t}),define("partner/ad-slot",["jquery","underscore","baseview","state","utils","user-manager","pubsub","adLogger"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({className:"ad-slot",id:function(){return t.uniqueId("ad-slot-"+this.options.adUnit.replace(/\//g,"-")+"-")},events:{partnersetup:"onHighImpactAdLoad",partnerloading:"onPartnerLoading"},pageLoaded:!1,initialized:!1,queue:[],pageUnLoad:function(){l.prototype.pageLoaded=!1},pageLoad:function(){l.prototype.queue.length&&l.prototype._requestSlots(l.prototype.queue),l.prototype.queue=[],l.prototype.pageLoaded=!0},initialize:function(t){return t=e.extend({adUnit:null,targeting:{},sizes:[],type:"in",onSlotRequest:null,onSlotRender:null,onSlotEmpty:null,position:null},t),!l.prototype.initialized&&window.googletag&&(l.prototype.initialized=!0,googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",l.prototype._renderEnded)})),this.$el.length&&t.position&&t.position.length&&t.position.parents("body").length?(t.position.append(this.$el),this.gptSlot=null,this.slotId=this.$el.prop("id"),this.adDeliveryData=null,i.prototype.initialize.call(this,t),void this._buildGptSlot()):void r.logError("AdSlot("+this.options.adUnit+"): Unable to request ad because no valid dom element provided")},_buildGptSlot:function(){return s.getActivePageInfo().noadvertising?void r.logInfo("AdSlot("+this.options.adUnit+"): blocked because of noadvertising flag in pageinfo"):void("in"===this.options.type?this._registerSlotWithGoogle(this.options.adUnit,this.options.sizes,this.slotId):this._registerOutOfPageSlotWithGoogle(this.options.adUnit,this.slotId))},destroy:function(){this.gptSlot&&(this.gptSlot.__gannettSlot=null),this.destroyed=!0,this.gptSlot=null,i.prototype.destroy.call(this,!0)},refresh:function(){this.destroyed||(this.adLoading=!1,this.adData=null,this.$el.closest("body").length||this.options.position.append(this.$el),this.delegateEvents(),this.gptSlot?window.googletag&&!s.getActivePageInfo().noadvertising&&(this._refreshSlot(this.gptSlot),r.logInfo("AdSlot("+this.options.adUnit+"): Ad refreshed for slot",this.gptSlot)):this._buildGptSlot())},onPartnerLoading:function(){this.adLoading=!0},onHighImpactAdLoad:function(e,t){var i=null;if(t&&t.data)i=t.data;else{if(!e.originalEvent||!e.originalEvent.data)return void r.logError("AdSlot("+this.options.adUnit+"): Found a high impact ad, can't find the data object from the iFrame",arguments);i=e.originalEvent.data}if(!i||!i.adType)return void r.logError("AdSlot("+this.options.adUnit+"): high impact event received, but invalid data object was given",i);this.adData=i;var s=this._normalizeAdType(i.adType);this.options.onSlotRender(i,s)},_normalizeAdType:function(e){return e?e.toLowerCase().replace(/[^a-z]/,""):null},_registerOutOfPageSlotWithGoogle:function(e,i){window.googletag&&googletag.cmd.push(t.bind(function(){r.logInfo("AdSlot("+this.options.adUnit+"): registering out of page slot with google "+e),this.gptSlot=googletag.defineOutOfPageSlot(e,i).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(i),this._refreshSlot(this.gptSlot)},this))},_refreshSlot:function(e){this.setTargeting(this.options.targeting),this.pageLoaded?this._requestSlots([e]):this.queue.push(e)},_requestSlots:function(e){googletag.pubads().refresh(e),t.each(e,function(e){e.__gannettSlot.options.onSlotRequest()})},_registerSlotWithGoogle:function(e,i,s){window.googletag&&googletag.cmd.push(t.bind(function(){r.logGroup("AdSlot "+this.options.adUnit),r.logInfo("registering slot with google "+e+" sizes",i),this.gptSlot=googletag.defineSlot(e,i,s).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(s),this._refreshSlot(this.gptSlot),r.logGroupEnd()},this))},_renderEnded:function(e){e.slot.__gannettSlot&&t.defer(t.bind(function(){!this.gptSlot||this.adData||this.adLoading||(e.isEmpty||e.size[0]<10||e.size[1]<10?(r.logInfo("AdSlot("+this.options.adUnit+"): No Ad Delivered"),this.options.onSlotEmpty&&this.options.onSlotEmpty()):this.options.onSlotRender())},e.slot.__gannettSlot))},setTargeting:function(e){this.gptSlot&&(this.options.targeting=e,this._setTargeting(this.gptSlot,e))},_setTargeting:function(e,i){e.clearTargeting(),t.each(i,function(t,i){(t||0===t||t===!1)&&(e.setTargeting(i,t),r.logInfo("set targetting - key:"+i+" value:"+t))},this)}});return l}),define("modules/global/barrier",["jquery"],function(e){var t=function(t,i,s){e.extend(this,e.Deferred()),s&&(this.reject=this.resolve);var n=setTimeout(e.proxy(function(){this.reject()},this),i);t.then(e.proxy(function(){this.resolve.apply(this,arguments)},this),e.proxy(function(){this.reject.apply(this,arguments)},this)).always(function(){clearTimeout(n)})},i=function(){this.init()};return i.prototype={init:function(){this._processes=[],this._waiting=[]},add:function(e,i,s){return i?void this._addToQueue(this._processes,new t(e,i,s)):void console.error("Invalid Barrier, timeoutMS required")},cancel:function(t){e.each(this._waiting,function(e,t){t.reject()}),this._waiting=[],t&&(e.each(this._processes.slice(0),function(e,t){t.reject()}),this._processes=[])},wait:function(){var t=this._processes;return t.length?this._addToQueue(this._waiting,e.Deferred(function(i){e.when.apply(e,t).then(function(){i.resolve.apply(i,arguments)},function(){i.reject.apply(i,arguments)})})):e.Deferred().resolve()},_addToQueue:function(t,i){return t.push(i),i.always(e.proxy(function(){return this._removeFromQueue(t,i)},this))},_removeFromQueue:function(t,i){var s=e.inArray(i,t);return-1!==s?(t.splice(s,1),!0):!1}},i}),define("modules/global/memobarrier",["jquery","modules/global/barrier"],function(e,t){var i=function(){this.init()};return i.prototype=new t,i.prototype.constructor=i,i.prototype._addToQueue=function(e,t){return e.push(t),t},i}),function(e){"function"==typeof define&&define.amd?define("cookie",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return r.raw?e:encodeURIComponent(e)}function i(e){return r.raw?e:decodeURIComponent(e)}function s(e){return t(r.json?JSON.stringify(e):String(e))}function n(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(o," ")),r.json?JSON.parse(e):e}catch(t){}}function a(t,i){var s=r.raw?t:n(t);return e.isFunction(i)?i(s):s}var o=/\+/g,r=e.cookie=function(n,o,l){if(arguments.length>1&&!e.isFunction(o)){if(l=e.extend({},r.defaults,l),"number"==typeof l.expires){var h=l.expires,d=l.expires=new Date;d.setTime(+d+864e5*h)}return document.cookie=[t(n),"=",s(o),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")
}for(var c=n?void 0:{},u=document.cookie?document.cookie.split("; "):[],p=0,f=u.length;f>p;p++){var g=u[p].split("="),m=i(g.shift()),v=g.join("=");if(n&&n===m){c=a(v,o);break}n||void 0===(v=a(v))||(c[m]=v)}return c};r.defaults={},e.removeCookie=function(t,i){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),define("admanager",["jquery","underscore","pubsub","state","utils","user-manager","partner/ad-slot","modules/global/memobarrier","adLogger","cookie"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=function(){this.initialize()};return h.prototype={adSizes:{pushdown:[1200,615],gravity:[2560,1440],dual_pushdown:[1200,1230],skyline:[1080,450],elastic:[1080,810],outofpage:[1080,810],cinematicvideoskin:[2600,1400],heroflip:[720,524],coverviewfullpage:[1,1],bigpageflex:[1,1],mediumrectangle:[300,250],halfpage:[300,600],sponsor_logo_medium:[100,50],leaderboard:[728,90],generic:[1,2],filmstrip:[300,600],iabpushdown:[970,90],iabpushdown2:[970,66],billboard:[970,250],portrait:[300,1050],sponsor_logo:[100,30]},flexibleAds:["pushdown","gravity","dual_pushdown","elastic","outofpage","cinematicvideoskin","heroflip","coverviewfullpage","generic"],activeAdPlacements:{},globalTargetingKeys:[],getSharedAdSlot:function(e,i,s,n){var a=this._buildAdSizesFromPlacements(i),o=this.buildAdUnit(e),r=s&&s.$el||this.globalStaging;return n=n||s&&s.getSlotType()||"in",this._createAdSlot(o,{},a,n,r,function(e,t){if(!t&&s)s.render();else{var n=i[t];if(!n)return void l.logError("AdSlot("+o+"): ad delivered to unknown ad position/type: "+t);n.render(e,t)}},function(){t.each(i,function(e){e.noAd()})})},getAdSlot:function(e,t,i,s,n){var a=this.buildAdUnit(e),o=this._mapAdSizeNamesToActualSizes(i);return this._createAdSlot(a,t,o,n,s.$el,function(e,t){s.render(e,t)},function(){s.noAd()})},buildAdUnit:function(e){var t=n.getNested(window.site_vars,"ADS")||{},i=n.getNested(t,"DFP","ACCOUNTID"),s=n.getNested(t,"DFP","ACCOUNTNAME");return this.override&&(i=this.override.usatai,s=this.override.usatan),i+"/"+s+"/"+e},getSize:function(t){var i=this.adSizes[e.trim(t)];return i?i:(l.logWarn("Size not found for "+t),null)},isFlexibleAdSize:function(e){return-1!==t.indexOf(this.flexibleAds,e)},getVCESize:function(e){var t=this.getSize(e);return t?t.join("x"):"1x1"},initialize:function(){if(this._resetSlots(),!window.googletag)return this.adLoadBarrier.resolve(),void(this.pageLoaded=!0);this.targetBarrier=new r,this._fetchTargeting(),l.logGroup("AdManager initialize"),this.pubSub={"page:load":this.onPageLoad,"page:unload":this.onPageUnload,"user:statuschange":this.onUserStatusChange},i.attach(this.pubSub,this);var t=n.getUrlParam("usatai"),s=n.getUrlParam("usatan"),a=n.getUrlParam("usatl");t&&s&&a&&(this.override={usatai:t,usatan:s,usatl:a}),this.globalStaging=e("#ad-staging"),this._initializeGoogletag(),window.adManager=this,this._initializeBaseTargeting(),l.logDebug("AdManager initialized"),l.logGroupEnd()},stop:function(){i.unattach(this.pubSub,this)},_beginA9:function(){var e=n.getNested(window.site_vars,"ADS","a9");e&&e.enabled&&this.targetBarrier.add(this._fetchA9(e),2e3,!0)},_fetchA9:function(t){return n.loadScript(t.url,"amznads").then(function(i){try{i.ads={},i.getAdsAsync(t.account)}catch(s){return console.error("failed amznads.getAdsAsync("+t.account+")",s),e.Deferred().reject()}return e.Deferred(function(e){i.tasks.push(function(){e.resolve({amznslots:i.getTokens()})})})})},_fetchTargeting:function(){this._beginA9(),this._beginCriteo(),this._beginPubMatic()},_beginCriteo:function(){var e=n.getNested(window.site_vars,"ADS","criteo");e&&e.enabled&&this.targetBarrier.add(this._fetchCriteo(e),2e3,!0)},_fetchCriteo:function(i){return window[i.varName]=e.cookie(i.cookie),e.ajax({url:i.url,data:{netId:i.account,cookieName:i.cookie,varName:i.varName},dataType:"script"}).then(t.bind(function(){var e=window[i.varName];return e?t.reduce(e.split(";"),function(e,t){if(t){var i=t.split("=");e[i[0]]=i[1]}return e},{}):{}},this))},_beginPubMatic:function(){var e=n.getNested(window.site_vars,"ADS","pubMatic");e&&e.enabled&&this.targetBarrier.add(this._fetchPubMatic(e),2e3,!0)},_fetchPubMatic:function(i){window.pm_pub_id=i.account,window.pm_optimize_adslots=i.slots;var s,n=i.site,a=i.group;switch(window.location.href.split("/")[3]){case"ros":s="10";break;case"life":s="20";break;case"money":s="30";break;case"news":s="40";break;case"sports":s="50";break;case"tech":s="60";break;case"travel":s="70";break;case"weather":s="80";break;case"entertainment":s="90";break;default:s="0"}return window.pmzoneid=t.compact([a,n,s]).join(","),l.logGroup("PubMatic Initialization Info"),l.logInfo("PubMatic pmzoneid: "+window.pmzoneid),l.logInfo("PubMatic slots: "+window.pm_optimize_adslots),l.logGroupEnd(),e.Deferred(function(s){window.pm_async_callback_fn="pm_async_callback",window.pm_async_callback=function(){var e,i,n=window.PubMaticGrouped;if(n){try{e=n.getCombinedKeyValueGPT()}catch(a){l.logError("PubMatic.getCombinedKeyValueGPT() failed",a)}e&&(e=e.replace(/ATF@728x90/gi,"pm1").replace(/BTF@728x90/gi,"pm2").replace(/ATF@300x250/gi,"pm3").replace(/BTF@300x250/gi,"pm4").replace(/ATF@300x600/gi,"pm5").replace(/ROS@970x250/gi,"pm6-bid").replace(/ROS@300x150/gi,"pm7-bid"),i=t.chain(e.split(";")).map(function(e){return e.split("=")}).filter(function(e){return e.length>1&&e[0].match("bid$")&&parseInt(e[1],10)>0}).object().value(),s.resolve(i))}else l.logError("PubMatic script failed to provide PubMaticGrouped");s.reject()},e.ajax({url:i.url,dataType:"script",cache:!0}).fail(function(){s.reject()})})},_createAdSlot:function(i,s,a,r,l,h,d){var c=e.Deferred();return c.done(t.bind(function(){this.activeSlotStatistics.unknown--},this)),this.activeSlotStatistics.unknown++,new o({adUnit:i,targeting:s,sizes:a,type:r||"out",position:l,onSlotRequest:t.bind(function(){this.slotsBarrier.add(c,2e3,!0)},this),onSlotEmpty:t.bind(function(){this.activeSlotStatistics.noad++,c.resolve(),d()},this),onSlotRender:t.bind(function(e,t){if(t){this.activeSlotStatistics.high_impact++;var i=n.getNested(e,"dfp","ecid");this.activeSlotStatistics.high_impact_info.push({adType:t,cap:e.maxDisplayed,capExp:parseInt(e.leaveBehindExp,10),ecid:i,state:"loading"})}else this.activeSlotStatistics.iab++;c.resolve(),h(e,t)},this)})},_resetSlots:function(){this.slotsBarrier?this.slotsBarrier.cancel(!0):this.slotsBarrier=new r,this.adLoadBarrier&&this.adLoadBarrier.reject(),this.adLoadBarrier=e.Deferred(),this.activeSlotStatistics={high_impact:0,high_impact_info:[],iab:0,noad:0,unknown:0}},getActiveSlotStatistics:function(){return this.adLoadBarrier.then(t.bind(function(){return this.slotsBarrier.wait()},this)).then(t.bind(function(){var i=this.activeSlotStatistics;return e.Deferred(function(e){t.defer(function(){e.resolve(i)})})},this))},updateActiveSlotStatistics:function(e,i){var s=t.findWhere(this.activeSlotStatistics.high_impact_info,{adType:e});s&&(s.state=i)},_initializeGoogletag:function(){googletag.cmd.push(function(){var e=googletag.pubads();l.logInfo("Collapses the empty divs. Used for the asset pages where the slot and placement are the same"),e.collapseEmptyDivs(),e.enableSingleRequest(),l.logInfo("Disabling initial load of slots"),e.disableInitialLoad(),l.logInfo("Enabled the ad calls"),googletag.enableServices()})},_initializeBaseTargeting:function(){var t=googletag.pubads(),i=this.override;googletag.cmd.push(function(){var s=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join();t.setTargeting("aam",s),t.setTargeting("u",e.cookie("aam_uuid")||""),i&&i.usatl&&t.setTargeting("adlabel",i.usatl);var a=n.getNested(window.site_vars,"ADS","DFP","ENV");l.logInfo("using env targeting: "+a),t.setTargeting("env",a)})},onPageLoad:function(i){this._buildSharedAdSlots(i.cst),this.pageLoaded=!0,this.targetBarrier?this.targetBarrier.wait().done(t.bind(function(){var t=[{},{ss:this.ssInfo}].concat([].slice.call(arguments)),s=e.extend.apply(e,t);l.logInfo("AdManager: requestAds()",i,s),this._setGlobalTargeting(i,s),o.prototype.pageLoad(),this.adLoadBarrier.resolve()},this)):this.adLoadBarrier.resolve()},_buildSharedAdSlots:function(e){t.each(this.activeAdPlacements,function(t){t&&(t.slotInfo=this.getSharedAdSlot(t.name+"/"+e,t.positionMap,t.defaultPosition))},this)},onPageUnload:function(){this.pageLoaded=!1,this._resetSlots(),o.prototype.pageUnLoad(),this._resetTargeting()},_resetTargeting:function(){this.targetBarrier.cancel(!0),this._clearGlobalTargeting(),this._fetchTargeting()},isPageLoaded:function(){return this.pageLoaded},_clearGlobalTargeting:function(){googletag.cmd.push(t.bind(function(){var e=googletag.pubads(),i=this.globalTargetingKeys;l.logInfo("clear pubads() targetting",i),t.each(i,function(t){e.clearTargeting(t)}),this.globalTargetingKeys=[]},this))},_setGlobalTargeting:function(i,n){var a=this,o=s.getActiveApp(),r=e.extend({},this.getPageAdTargeting(i),n,o&&o.getClientAdInfo());this.globalTargetingKeys=[],googletag.cmd.push(function(){var e=googletag.pubads();t.each(r,function(t,i){(t||0===t||t===!1)&&(a.globalTargetingKeys.push(i),e.setTargeting(i,String(t)),l.logInfo("set pubads() targetting - key:"+i+" value:"+t))})})},getPageAdTargeting:function(e){var t=n.getNested(window,"site_vars","aws_site_name")||"usat";return{pageType:e.basePageType,referrer:(s.getReferrer().match(/https?:\/\/[:\w\.-]+/)||[])[0],series:e.series,sitepage:t+"/"+e.ssts,contentid:e.assetid,topic:e.topic}},onUserStatusChange:function(e,i){if("firefly"===e)if("loggedIn"==i||"loggingIn"==i){var s=a.getCoreUserInfo();s=s.then(t.bind(function(e){this.ssInfo=e.UserLicenseType?t.map(e.UserLicenseType.split("_"),function(e){return e.substring(0,3)}).join("_"):null},this),t.bind(function(){this.ssInfo=null},this)),this.targetBarrier.add(s,2e3,!0)}else this.ssInfo=null},getAdActualSizes:function(e){return this._mapAdSizeNamesToActualSizes(e)},_mapAdSizeNamesToActualSizes:function(e){if(t.isString(e)){var i=e.split(",");return this._processAdSizeData(i.length>1?i:[e])}return t.isArray(e)?this._processAdSizeData(this._isAdSizeArray(e)?[e]:e):[]},_processAdSizeData:function(e){return t.reduce(e,function(e,i){var s;return t.isString(i)?s=this._getAdSizeFromString(i):t.isArray(i)&&this._isAdSizeArray(i)&&(s=i),s&&e.push(s),e},[],this)},_isAdSizeArray:function(t){return 2===t.length&&e.isNumeric(t[0])&&e.isNumeric(t[1])},_getAdSizeFromString:function(e){var t=this.getSize(e);if(!t){var i=e.toLowerCase().split("x");2===i.length&&(i=[parseInt(i[0],10),parseInt(i[1],10)],this._isAdSizeArray(i)&&(t=i))}return t},_buildAdSizesFromPlacements:function(i){var s=[];return t.each(i,function(t){var i=this._mapAdSizeNamesToActualSizes(t.getAdSizes());e.merge(s,i)},this),t.uniq(s)},refreshSharedAdPosition:function(e){var i=this.activeAdPlacements[e];return i?i.slotInfo?(t.each(i.positionMap,function(e){e.destroyAdPlacement()},this),void i.slotInfo.refresh()):void l.logError("AdManager: tried refreshing shared ad position that hasn't been requested yet"):void l.logError("AdManager: tried refreshing shared ad position that no longer exists")},registerSharedAdPosition:function(e){var i=e.getAdPlacement(),s=e.getAdType();if(this._checkPageChange(),s&&!t.isArray(s)&&(s=[s]),!i||!s||!s.length)return void l.logError("AdManager: invalid ad unit registered, adUnit and adType are required",e);var n=this._getAdPlacementInfo(i);this._addAdToPlacementInfo(n,e,s)},_getAdPlacementInfo:function(e){var t=this.activeAdPlacements[e];return t||(this.activeAdPlacements[e]=t={name:e,positionMap:{},defaultPosition:null,slotInfo:null,numPositions:0}),t},_addAdToPlacementInfo:function(e,i,s){t.each(s,function(t){return e.positionMap[t]?void l.logError("AdManager: invalid ad unit registered, duplicate adType registered",i):(l.logInfo("AdManager: registerSharedAdPosition for adPlacement: "+e.name+" and adType:"+t),void(e.positionMap[t]=i))}),e.numPositions++,i.isDefaultPosition()&&(e.defaultPosition?l.logWarn("AdManager: multiple ad placements declared themselves default for adUnit: "+e.name,i):e.defaultPosition=i)},_checkPageChange:function(){var e=window.location.pathname;e!==this.siteUrl&&(this.siteUrl=e,t.each(this.activeAdPlacements,function(e){e&&l.logError("Site Url changed, but ad placements were not released: ",e)}),this.activeAdPlacements={})},destroySharedAdPosition:function(e){var i=e.getAdPlacement(),s=e.getAdType(),n=this.activeAdPlacements[i];return n?(s&&!t.isArray(s)&&(s=[s]),t.each(s,function(t){var s=n.positionMap[t];return s?(l.logInfo("AdManager: destroySharedAdPosition for adPlacement: "+i+" and adType:"+t),void(n.positionMap[t]=null)):void l.logError("AdManager: destruction of unknown ad type",e)}),e.isDefaultPosition()&&(n.defaultPosition=null),n.numPositions--,void(n.numPositions||(n.slotInfo&&n.slotInfo.destroy(),this.activeAdPlacements[i]=null))):void l.logError("AdManager: destruction of unknown ad unit",e)},_createScript:function(e,t,i){l.logDebug("Creating script",e,t,i[0]);var s=document.createElement("script");s.id=e,s.src=t,s.type="text/javascript",s.defer=!1,i[0].appendChild(s)},logDebug:function(){l.logDebug.apply(l,arguments)},logError:function(){l.logError.apply(l,arguments)},logInfo:function(){l.logInfo.apply(l,arguments)},logWarn:function(){l.logWarn.apply(l,arguments)}},new h}),define("api/ads",["jquery","admanager"],function(e,t){return{registerAd:function(i,s,n,a){var o=e("string"==typeof i?"#"+i:i),r={$el:o,render:function(){},noAd:function(){}};t.getAdSlot(s,a,n,r,"in")}}}),define("managers/autoplay",["jquery","underscore","pubsub","admanager","utils"],function(e,t,i,s,n){"use strict";var a=function(){this.pubSub={"page:load":this._onPageLoad,"page:unload":this._onPageUnload}};return a.prototype={start:function(){this._pageIndex=0,this.reset(),this._autoPlayOrder=n.getNested(window.site_vars,"autoplay","default")||[],i.attach(this.pubSub,this)},reset:function(){this._currentModules={},this._playedModules=[]},stop:function(){i.unattach(this.pubSub,this)},register:function(e,i){t.isFunction(i)&&(this._currentModules[e]=i)},_onPageLoad:function(){s.getActiveSlotStatistics().done(t.bind(function(){this._go(0,this._pageIndex)},this))},_onPageUnload:function(){this._pageIndex++,this.reset()},_go:function(e,i){i===this._pageIndex&&this._triggerAutoPlay(e||0).then(t.bind(function(){this._go(e+1,i)},this))},_triggerAutoPlay:function(i){var s=this._getAutoPlayResult(i);return s&&t.isFunction(s.then)?s:e.Deferred(t.bind(function(e){s===!1?e.reject():s===!0?e.resolve():(console.error("AutoPlayManager: Invalid return value from "+this._autoPlayOrder[i]+".startAutoPlay()"),e.resolve())},this))},_getAutoPlayResult:function(e){var t=this._autoPlayOrder[e],i=this._playedModules,s=this._currentModules[t];return s?(this._playedModules=this._playedModules.concat(t),s(i)):e<this._autoPlayOrder.length}},new a}),define("managers/abtestmanager",["jquery","underscore","utils","state","pubsub","cookie"],function(e,t,i,s,n){"use strict";var a=function(){this.pubSub={"page:unload":this._onPageUnLoad,"page:load":this._onPageLoad}};return a.prototype={cid:t.uniqueId("c"),start:function(){n.attach(this.pubSub,this),this.abTestGroup=this._readAbTestGroup()||this._initialGroupSetup()},stop:function(){n.unattach(this.pubSub,this),this._onPageUnLoad(),this.reset()},getVariantData:function(){return t.chain(this._getActiveTests()).map(function(e){return new RegExp(e.urlRegex).test(window.location.pathname)?this._getVariant(this.abTestGroup,e.trafficVolume,e.variants,e.trafficStartingOffset):void 0},this).compact().value()},_onPageLoad:function(){this._setupTestBuckets(this.abTestGroup,this._getActiveTests())},_onPageUnLoad:function(){i.get("body").off("."+this.cid)},reset:function(){window.localStorage.removeItem("wfm_abtestgroup")},_readAbTestGroup:function(){return JSON.parse(window.localStorage.getItem("wfm_abtestgroup"))},_initialGroupSetup:function(){var e=Math.floor(100*Math.random())+1;try{window.localStorage.setItem("wfm_abtestgroup",JSON.stringify(e))}catch(t){console.error("Failed saving abTestGroup",t.stack||t.stacktrace||t.message)}return e},_setupTestBuckets:function(e,i){t.each(i,t.partial(this._setupTestBucket,e),this)},_setupTestBucket:function(e,t){var s=this._getVariant(e,t.trafficVolume,t.variants,t.trafficStartingOffset),n=i.getNested(s,"variant")||"control",a=this._generateTestIdentifier(t.urlRegex,t.id);this._registerCookie(e,t,a,n),new RegExp(t.urlRegex).test(window.location.pathname)&&this._registerEvents(t.eventTriggers,a,n)},_getActiveTests:function(){return t.filter(i.getNested(window.site_vars,"abtests"),this._isActive)},_registerCookie:function(t,i,s,n){t<=i.trafficVolume+i.trafficStartingOffset&&(i.trafficVolume%i.variants.length===0&&n?e.cookie(s,n,{expires:new Date(i.endTime)}):console.warn("The number of variants for A/B Test "+i.name+" are not divisible by the traffic_volue("+i.trafficVolume+"). No segmentation cookies are being set."))},_getVariant:function(e,t,i,s){for(var n=0,a=t/i.length,o=t+s,r=s+1;o>=r;r++){if(e==r)return i[n];r%a===0&&n++}},_isActive:function(e){if(e.trafficStartingOffset=e.trafficStartingOffset||0,e.trafficStartingOffset+e.trafficVolume>100)return console.warn("Traffic Offset + Traffic Volume exceeds the maximum of 100, please reduce the offset or traffic volume"),!1;var t=new Date;return e.endTime&&new Date(e.endTime)<t?!1:e.startTime&&new Date(e.startTime)>t?!1:!0},_generateTestIdentifier:function(e,t){return"wfm-ab-"+e.replace(/[^\w\/-]+/g,"").replace(/^\//,"").replace(/\/$/,"").replace(/[ \/]/g,"-")+"-"+t},_registerEvents:function(e,s,a){t.each(e,function(e){e.selector&&i.get("body").on("click."+this.cid,e.selector,function(){n.trigger("abtesttrack",s+"|"+a)})},this)}},new a}),define("site-manager",["jquery","underscore","backbone","utils","pubsub","state","managers/routemanager","managers/autoplay","managers/abtestmanager"],function(e,t,i,s,n,a,o,r,l){var h=i.View.extend({el:"body",initialize:function(){window.appViewEventProxy=n,window.Utils=s,window.siteManager=this,this.DEBUG=s.get("DEBUG"),this.$win=s.get("win"),this.$top=s.get("scrollEl"),this.pubSub={scrollTop:this.scrollTop},n.attach(this.pubSub,this)},start:function(e,i){this.$win.on("resize."+this.cid,t.throttle(function(){n.trigger("resize:app")},50)).trigger("resize"),this.$el.on("click."+this.cid,"a,area",t.bind(this.triggerRoute,this)),this.$el.on("submit."+this.cid,"form.ui-ajax-form",t.bind(this.triggerForm,this)),e&&(window.header=this.header=new e),o.start(i||void 0===i),a.start(this.header),r.start(),l.start()},getHeader:function(){return this.header},scrollTop:function(e,t){return this.header?this.header.scrollTop(e,t):0},stop:function(){this.$el.off("."+this.cid),this.$win.off("."+this.cid),r.stop(),a.stop(),o.stop(),l.stop()},destroy:function(){this.undelegateEvents(),window.header&&delete window.header,delete window.appViewEventProxy,delete window.Utils,n.unattach(this.pubSub,this)},triggerRoute:function(t){var i=e(t.currentTarget),s=e.trim(i.attr("href"));t.isDefaultPrevented()||this._isMetaKey(t)?n.trigger("track",{event:t,url:s}):i.attr("target")?(n.trigger("track",{event:t,url:s}),this._goPopup(i,s)&&t.preventDefault()):s?(t.preventDefault(),o.goTo(s,i.data("trackLabel")||i.data("uotrack")||i.data("ht"),t)):(n.trigger("track",{event:t}),t.preventDefault())},_isMetaKey:function(e){return e.metaKey||e.ctrlKey||e.altKey||2==e.which},_goPopup:function(e,t){var i=e.attr("target");return"_popup"===i||"_blank"===i&&void 0!==e.data("popup")?(s.openPopup(t,e.data("popup-width"),e.data("popup-height")),!0):void 0},triggerForm:function(i){var s=e(i.currentTarget),n=s.data("mapping"),a={},r=s.attr("action");i.isDefaultPrevented()||(n&&(e.each(s.serializeArray(),function(e,t){a[t.name]=t.value}),r+=t.template(n,a)),i.preventDefault(),o.goTo(r,s.data("trackLabel")||s.data("uotrack")||s.data("ht"),i))}});return new h}),define("base-app",["jquery","underscore","baseview","state","managers/trafficcop","site-manager","utils","pubsub","managers/resourcemanager","managers/routemanager"],function(e,t,i,s,n,a,o,r,l,h){"use strict";var d=i.extend({currentPath:"",initialize:function(t){this._animId=0,this._fixedOffset=null,this.$top=o.get("scrollEl"),this.appRevealed=!1,this.pubSub=e.extend({"header:fixed":this._onHeaderFixed,"header:unfixed":this._onHeaderUnfixed},this.pubSub),i.prototype.initialize.call(this,t)},isRevealed:function(){return this.appRevealed},revealApp:function(e,t,i,s,n){var a=this._buildRequestInfo(e,t,s,n);return i?"rejected"===i.state()?i:this._handleAsyncReveal(i,a):this._handleInitialReveal(a)},_buildRequestInfo:function(t,i,s,n){return{fromUrl:t,toUrl:i,animId:++this._animId,resourcePromise:s||e.Deferred().resolve(),modulePromise:e.Deferred(),paused:n}},_handleInitialReveal:function(i){var s=e(".site-header").next();s.length||(s=o.get("body")),this.setElement(s);var n=this._setPageInfo(s,i);return this._isCorrectApp(n.jsUrl).then(t.bind(function(){return this._triggerAfterPageReveal(i)},this))},_handleAsyncReveal:function(i,s){var n;return"resolved"===i.state()?i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,s).then(t.bind(function(){return this._updateState(s),this._revealAppMarkup(e,s).then(t.bind(function(){return this._finishReveal(e,s)},this))},this))},this)):(n=this.getRevealAppLoader(s.toUrl),n instanceof e||(n=e(n)),this._revealAppMarkup(n,s).then(t.bind(function(){return i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,s).then(t.bind(function(){return this._updateState(s),this._handleRevealLoaderContentSwap(e,s).then(t.bind(function(){return this.setElement(e,!1),this._finishReveal(e,s)},this))},this))},this))},this)))},_updateState:function(e){e.paused||s.updateState()},_revealAppMarkup:function(t,i){this._insertAppMarkup(t,i.paused);var s=this._safeCall("animateRevealApp",i.fromUrl,i.toUrl,i.paused);return s?n.addAnimation(s):e.Deferred().resolve()},_handleRevealLoaderContentSwap:function(t,i){return i.animId!==this._animId?e.Deferred().reject():this.swapContent(this.$el,t,i.paused,this.getHash(i.toUrl))},_finishReveal:function(t,i){return i.animId!==this._animId?e.Deferred().reject():(i.paused&&this.setFixedPosition(this.$el.offset().top),this._triggerAfterPageReveal(i))},_fetchPageModules:function(e,t){t.paused?t.modulePromise.resolve():t.resourcePromise.done(function(){l.fetchPageModules(e.js_modules).done(t.modulePromise.resolve)})},_insertAppMarkup:function(t,i){var s=e(".site-header");t.hide(),this.setElement(t,!1),this.$el.insertAfter(s),i&&this.setFixedPosition(s.outerHeight())},changePage:function(e,t,i,s,n){var a=this._buildRequestInfo(e,t,s,n);return this.destroyModules(),i?this._handleChangePageRequest(i,a):this._handleChangePageNoRequest(a)},_handleChangePageNoRequest:function(e){return this._fetchPageModules(this.pageInfo,e),this._triggerAfterPageReveal(e)},_handleChangePageRequest:function(i,n){var a=this.animateChangePagePreData(n.fromUrl,n.toUrl);return a||this._triggerGenericLoader(i),i=i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,n).then(function(){return e})},this)),e.when(i,a).then(t.bind(function(e){return n.paused||s.updateState(),this._finishChangePage(e,n)},this))},_triggerGenericLoader:function(e){"pending"===e.state()&&(this.activateLoader(),e.always(t.bind(function(){this.deactivateLoader()},this)))},_finishChangePage:function(i,s){if(s.animId!==this._animId)return e.Deferred().reject();var n=this.animateChangePagePostData(s.fromUrl,s.toUrl,i,s.paused)||e.Deferred().resolve();return s.paused&&this.setFixedPosition(this.$el.offset().top),n.then(t.bind(function(){return this._triggerAfterPageReveal(s)},this))},swapContent:function(t,i,s,n){return this.isSafari5||this.isApple||s?(i.insertAfter(t),t.remove(),e.Deferred().resolve()):this._crossFade(t,i,n)},_crossFade:function(e,t,i){var s=parseInt(e.css("top"),10)||0;return s-=o.getScrollPosition(),t.css({"z-index":100}),e.css({position:"absolute","z-index":101,opacity:1,top:s}),t.insertAfter(e),i&&this._scrollToHashTag(t,i)||a.scrollTop(0),this.animate(e,"opacity",0,this.options.animations.fadeIn.duration).always(function(){t.css({"z-index":""}),e.remove()})},_scrollToHashTag:function(e,t){var i=this._getOffset(e,t);return i.top?(this.$top.scrollTop(i.top-this.$el.offset().top),!0):void 0},_getOffset:function(e,t){try{return e.find("a[name="+t+"]").offset()||{}}catch(i){console.warn("Invalid hashtag",t)}return{}},pause:function(){this.destroyModules(!1,!0)},getHash:function(e){var t=e.indexOf("#");return-1!==t?e.substring(t+1):null},_triggerAfterPageReveal:function(i){return e.when(i.resourcePromise,i.modulePromise).done(t.bind(function(e,t){i.animId===this._animId&&(i.paused||this._initPage(null!==i.fromUrl,e,t),this._safeCall("afterPageReveal",i.fromUrl,i.toUrl,i.paused,e&&e[0]),this.appRevealed=!0,this.currentPath=i.toUrl,i.paused||this.trackPageLoad(this.pageInfo))},this))},_safeCall:function(e){try{return this[e].apply(this,Array.prototype.slice.call(arguments,1))}catch(t){console.error("View threw an exception on "+e,t.stack||t.stacktrace||t.message)}},_initPage:function(e,t,i){e&&(this.delegateEvents(),this._updatePageTitle()),this._initModules(t&&t.length>1?t[1].concat(i||[]):i)},_triggerBeforePageReveal:function(e,t){this._safeCall("beforePageReveal",t.fromUrl,t.toUrl,e,t.paused);var i=this._setPageInfo(e,t);return this._isCorrectApp(i.jsUrl)},_isCorrectApp:function(t){var i=this;return e.Deferred(function(e){if(t){var s=h.getInfo(t);if(s&&s.app.AppClass.prototype!==Object.getPrototypeOf(i))return void e.reject("InvalidApp",s)}e.resolve()})},_setPageInfo:function(e,t){var i=this.pageInfo=this._safeCall("parsePageInfo",e)||{};return this._verifyPageInfo(i),this._fetchPageModules(i,t),i},_verifyPageInfo:function(e){e.templatetype=e.templatetype||"",e.ssts=e.ssts||"bugpages",e.cst=e.aws||e.cst||"undefined"},_updatePageTitle:function(){if("None"===(this.pageInfo.seotitle||"None")){var e=o.getNested(window.site_vars,"display_name");e&&(document.title=e)}else document.title=this.pageInfo.seotitle},removeApp:function(e,i){return this._animId++,this._safeCall("beforeAppRemove",e,i),this.destroyModules(!1),this._triggerAnimateRemoveApp(e,i).always(t.bind(function(){this._safeCall("afterAppRemove",e,i),this._safeDestroy()},this))},_triggerAnimateRemoveApp:function(t,i){var s=this._safeCall("animateRemoveApp",t,i);return s?n.addAnimation(s):e.Deferred().resolve()},_safeDestroy:function(){try{this.destroy(!0)}catch(e){console.error("View threw an exception on destroy: ",e.stack||e.stacktrace||e.message),this.$el.remove()}},getWindowOffset:function(){return this.el?this.el.getBoundingClientRect():{top:0,left:0}},animateRevealApp:function(t,i,s){return this.isApple&&s?e.Deferred().resolve():this.show(!0)},animateRemoveApp:function(){return this.hide(!0)},animateChangePagePreData:function(){return null},animateChangePagePostData:function(e,t,i,s){var n=this.swapContent(this.$el,i,s,this.getHash(t));return this.setElement(i,!1),n},setFixedPosition:function(e,t){t||!this.isSafari5&&!this.isApple?(this._header=a.getHeader(),this._header?this._header.isFixed()?(this._fixedOffset=this._header.isOpen()?e-this._header.getFixedThreshold():e,this.$el.css({position:"fixed",top:e})):(this._fixedOffset=e=this.$el.offset().top,this.$el.css({position:"absolute",top:e})):this._fixedOffset=e):this.$el.hide()},clearFixedPosition:function(e){this._fixedOffset=null,e||!this.isSafari5&&!this.isApple?this.$el.css({position:"",top:""}):this.$el.show()},_onHeaderFixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset-=this._header.getFixedThreshold(),this.$el.css({position:"fixed",top:this._fixedOffset}))},_onHeaderUnfixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset+=this._header.getFixedThreshold(),this.$el.css({position:"absolute",top:this._fixedOffset}))},activateLoader:function(){},deactivateLoader:function(){},beforeAppRemove:function(){},afterAppRemove:function(){},beforePageReveal:function(){},afterPageReveal:function(e,t,i,s){s&&(this.subviews.page=new s({el:this.$el}))},getRevealAppLoader:function(){return'<section class="ui-loading dark-medium ui-app-loader"></section>'},beforeOverlayRemove:function(){},afterOverlayReveal:function(){},getClientAdInfo:function(){return{}},parsePageInfo:function(e){return JSON.parse(e.find(".pageinfo").eq(0).html())||{}},getClientInfo:function(){return{}},trackPageLoad:function(e){t.defer(function(){n.getAnimationCompletion().done(function(){r.trigger("page:load",e)})})},buildModules:function(e){return l.fetchPageModules(e).done(t.bind(this._initModules,this))},_initModules:function(e){this.destroyed||t.each(e,this._initModule,this)},_initModule:function(i){var s=i.selector,n=this.seenModules[i.name]||0;i.position&&(s="#module-position-"+i.position+s+",#module-position-"+i.position+" "+s),this.$(s).each(t.bind(function(t,s){var a=e.extend(!0,{},i.options);a.el=s,a.layoutType=i.layoutType;try{this.subviews[i.name+n]=new i.ModuleClass(a)}catch(o){console.error("failed loading module "+i.name,o.stack||o.stacktrace||o.message)}n+=1},this)),this.seenModules[i.name]=n}});return d}),define("apps/contact-us-staff",["jquery","underscore","base-app","utils"],function(e,t,i,s){var n=i.extend({events:{"click .js-cufwa-jumper":"jumpToGroup"},beforePageReveal:function(){var e=s.get("body");e.hasClass("cufwa-body")||e.addClass("cufwa-body")},beforeAppRemove:function(){e("body").removeClass("cufwa-body")},jumpToGroup:function(t){t.preventDefault();var i=e(t.currentTarget).data("anchor"),s=this.$(".js-cufwa-jump[data-anchor='"+i+"']");e("html, body").animate({scrollTop:s.offset().top-60},500)}});return n}),define("apps/interactives",["jquery","underscore","base-app"],function(e,t,i){var s=i.extend({trackPageLoad:function(e){window.top===window&&i.prototype.trackPageLoad(e)}});return s}),define("apps/simple-overlay",["jquery","underscore","backbone","base-app","state","utils","site-manager","managers/routemanager","pubsub","user-manager"],function(e,t,i,s,n,a,o,r,l,h){"use strict";var d=s.extend({el:"#overlay",events:{"click .transition-wrap":"close","click .close-overlay":"close"},initialize:function(i){i=e.extend(!0,{template:'<div id="overlay" class="no-transition"><div class="transition-wrap"><article class="asset clearfix story ui-loading light-medium"></article></div></div>'},i),t.bindAll(this,"resizeHandler"),this.win=a.get("win"),this.scrollEl=a.get("scrollEl"),this.header=o.getHeader(),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed};var n=t.throttle(this.resizeHandler,50);this.win.on("resize."+this.cid,n),this.resizeHandler(),s.prototype.initialize.call(this,i)},destroy:function(e){this.win.off("."+this.cid),s.prototype.destroy.call(this,e)},resizeHandler:function(){this.winSize={width:this.win.width(),height:this.win.height()},this.header&&(this.winSize.height-=this.header.getCollapsedHeight()),this.setArticleMinHeight(this.$(".transition-wrap:first .asset"))},setArticleMinHeight:function(e){e.length&&e.outerHeight()<this.winSize.height&&e.css("min-height",this.winSize.height)},onHeaderFixed:function(){this.positionCloseButton("fixed"),this._onHeaderFixed()},onHeaderUnfixed:function(){this.positionCloseButton("absolute"),this._onHeaderUnfixed()},beforeAppRemove:function(){this.win.off("."+this.cid),this.positionCloseButton("absolute",a.getScrollPosition())},animateRemoveApp:function(e,t){return this.isSafari5?this.hide():(this.header&&this.header.updateNavigation(t),this.$el.css({position:"relative",opacity:1}),this.animate(this.$el,"opacity",0,250))},beforePageReveal:function(e,t,i){i.find(".asset").css("min-height",this.winSize.height)},animateRevealApp:function(){var i=this.$(".transition-wrap"),s=this.winSize.height;if(this.isSafari5||!e.support.css.transform)return i.css("height",s),this.show();i.css({height:s,overflow:"hidden",opacity:0}),i[0].style[e.support.css.transform.cssName]="scale(0.4)",i[0].style[e.support.css.transform.originCssName]="50% "+.25*s+"px",i[0].style[this.transitionCssName]=e.support.css.transform.cssHyphenName+" 300ms linear, opacity 300ms linear",this.$el.show().css({opacity:1,display:"block"}),t.delay(t.bind(function(){i[0].style[e.support.css.transform.cssName]="scale(1.0)",i[0].style.opacity=1
},this));var n=e.support.css.transition.registerTransitionEndListener(i[0]);return n.done(t.bind(function(){i[0].style[e.support.css.transform.cssName]="",i[0].style[this.transitionCssName]="",i[0].style[e.support.css.transform.originCssName]=""},this)),n.promise()},getRevealAppLoader:function(){return this.options.template},animateChangePagePreData:function(){var t=this.winSize.height,i=a.getScrollPosition(),s=this.$(".transition-wrap:first");this.prepareContentForTransition(s,i,t);var n=e(this.options.template),r=n.find(".transition-wrap");return this.prepareContentForTransition(r,0,t),this.$el.prepend(r),o.scrollTop(0),this.positionCloseButton("absolute",i,s),this.swapContent(s,r)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},animateChangePagePostData:function(e,i,s){var n=s.find(".transition-wrap");return n.css("height",this.winSize.height),this.setArticleMinHeight(n.find(".asset")),this.swapContent(this.$(".transition-wrap:first"),n,this.getHash(i)).done(t.bind(function(){n.css("height","")},this))},afterPageReveal:function(e,t,i,s){var n=this.$(".transition-wrap:first");n.css({height:"",overflow:"visible"}),this.currentSection=this.getSectionName(),this.preloadedUrl=this.options.preloadedUrl||this.currentSection||"/",this.header&&this.header.updateNavigation((this.pageInfo||{}).ssts),null===e&&this.preloadPath(),s&&(this.subviews.view=new s({el:n,path:t})),this.header&&this.header.isFixed()&&this.positionCloseButton("fixed")},parsePageInfo:function(){var e=h.getAccount("firefly"),t=s.prototype.parsePageInfo.apply(this,arguments),i="nothitpaywall";if(e){var n=e.getViewsCookie().viewsRemaining;n>=0&&(i=0===n?"nofreearticlesremaining":n)}return t.numPageViewsLeft=i,t},preloadPath:function(){n.preloadPath(this.preloadedUrl)},positionCloseButton:function(e,t,i){var s=i?i.find(".close-wrap"):this.$(".close-wrap");s.css("absolute"===e?{position:e,"margin-top":"",top:t||0}:{position:e,"margin-top":-80,top:""})},getSectionName:function(){var e,i="",s=this.pageInfo||{};if(s&&(s.ss||s.ssts)){if(e=s.ss,!e){e=s.ssts;var n=e.indexOf("/");n>0&&(e=e.substring(0,n)),-1===t.indexOf(a.getSiteSections(),e)&&(e="")}i=e,e.indexOf("/")>0&&(i=e.substring(0,e.indexOf("/"))),i="home"===i?"/":"/"+i+"/"}return i},close:function(t){if(!t||t.target===t.currentTarget){var i=e(t.currentTarget).attr("data-ht")||"modalclose";return l.trigger("heattrack",i),r.goTo(n.getPreloadedUrl()||"/"),t?!1:void 0}}});return d}),define("modules/global/footer",["jquery","underscore","baseview","easing","pubsub","utils"],function(e,t,i,s,n,a){var o=i.extend({events:{"click .site-index":"toggle","click .footer-more-trigger":"showMore"},initialize:function(e){this.$scrollEl=a.get("scrollEl"),this.$nav=this.$("nav"),this.$toggle=this.$(".site-index"),i.prototype.initialize.call(this,e)},showMore:function(t){t.preventDefault();var i=e(t.currentTarget);i.hide().siblings(".footer-more-item").show()},toggle:function(e){e&&e.preventDefault();var t=this.$el.offset().top-(a.get("headerHeight")||0);this.$toggle.toggleClass("open"),this.$scrollEl.animate({scrollTop:t},500,"easeInOutCubic"),this.$nav.slideToggle(500,"easeInOutCubic")}});return o});var swfobject=function(){function e(){if(!U){try{var e=N.getElementsByTagName("body")[0].appendChild(m("span"));e.parentNode.removeChild(e)}catch(t){return}U=!0;for(var i=O.length,s=0;i>s;s++)O[s]()}}function t(e){U?e():O[O.length]=e}function i(e){if(typeof F.addEventListener!=A)F.addEventListener("load",e,!1);else if(typeof N.addEventListener!=A)N.addEventListener("load",e,!1);else if(typeof F.attachEvent!=A)v(F,"onload",e);else if("function"==typeof F.onload){var t=F.onload;F.onload=function(){t(),e()}}else F.onload=e}function s(){B?n():a()}function n(){var e=N.getElementsByTagName("body")[0],t=m(D);t.setAttribute("type",M);var i=e.appendChild(t);if(i){var s=0;!function(){if(typeof i.GetVariable!=A){var n=i.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),V.pv=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)])}else if(10>s)return s++,void setTimeout(arguments.callee,10);e.removeChild(t),i=null,a()}()}else a()}function a(){var e=z.length;if(e>0)for(var t=0;e>t;t++){var i=z[t].id,s=z[t].callbackFn,n={success:!1,id:i};if(V.pv[0]>0){var a=g(i);if(a)if(!b(z[t].swfVersion)||V.wk&&V.wk<312)if(z[t].expressInstall&&r()){var d={};d.data=z[t].expressInstall,d.width=a.getAttribute("width")||"0",d.height=a.getAttribute("height")||"0",a.getAttribute("class")&&(d.styleclass=a.getAttribute("class")),a.getAttribute("align")&&(d.align=a.getAttribute("align"));for(var c={},u=a.getElementsByTagName("param"),p=u.length,f=0;p>f;f++)"movie"!=u[f].getAttribute("name").toLowerCase()&&(c[u[f].getAttribute("name")]=u[f].getAttribute("value"));l(d,c,i,s)}else h(a),s&&s(n);else w(i,!0),s&&(n.success=!0,n.ref=o(i),s(n))}else if(w(i,!0),s){var m=o(i);m&&typeof m.SetVariable!=A&&(n.success=!0,n.ref=m),s(n)}}}function o(e){var t=null,i=g(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=A)t=i;else{var s=i.getElementsByTagName(D)[0];s&&(t=s)}return t}function r(){return!W&&b("6.0.65")&&(V.win||V.mac)&&!(V.wk&&V.wk<312)}function l(e,t,i,s){W=!0,S=s||null,k={success:!1,id:i};var n=g(i);if(n){"OBJECT"==n.nodeName?(C=d(n),x=null):(C=n,x=i),e.id=L,(typeof e.width==A||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==A||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),N.title=N.title.slice(0,47)+" - Flash Player Installation";var a=V.ie&&V.win?"ActiveX":"PlugIn",o="MMredirectURL="+F.location.toString().replace(/&/g,"%26")+"&MMplayerType="+a+"&MMdoctitle="+N.title;if(typeof t.flashvars!=A?t.flashvars+="&"+o:t.flashvars=o,V.ie&&V.win&&4!=n.readyState){var r=m("div");i+="SWFObjectNew",r.setAttribute("id",i),n.parentNode.insertBefore(r,n),n.style.display="none",function(){4==n.readyState?n.parentNode.removeChild(n):setTimeout(arguments.callee,10)}()}c(e,t,i)}}function h(e){if(V.ie&&V.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=m("div");if(V.win&&V.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(D)[0];if(i){var s=i.childNodes;if(s)for(var n=s.length,a=0;n>a;a++)1==s[a].nodeType&&"PARAM"==s[a].nodeName||8==s[a].nodeType||t.appendChild(s[a].cloneNode(!0))}}return t}function c(e,t,i){var s,n=g(i);if(V.wk&&V.wk<312)return s;if(n)if(typeof e.id==A&&(e.id=i),V.ie&&V.win){var a="";for(var o in e)e[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?t.movie=e[o]:"styleclass"==o.toLowerCase()?a+=' class="'+e[o]+'"':"classid"!=o.toLowerCase()&&(a+=" "+o+'="'+e[o]+'"'));var r="";for(var l in t)t[l]!=Object.prototype[l]&&(r+='<param name="'+l+'" value="'+t[l]+'" />');n.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+r+"</object>",j[j.length]=e.id,s=g(e.id)}else{var h=m(D);h.setAttribute("type",M);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?h.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&h.setAttribute(d,e[d]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&u(h,c,t[c]);n.parentNode.replaceChild(h,n),s=h}return s}function u(e,t,i){var s=m("param");s.setAttribute("name",t),s.setAttribute("value",i),e.appendChild(s)}function p(e){var t=g(e);t&&"OBJECT"==t.nodeName&&(V.ie&&V.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=g(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function g(e){var t=null;try{t=N.getElementById(e)}catch(i){}return t}function m(e){return N.createElement(e)}function v(e,t,i){e.attachEvent(t,i),H[H.length]=[e,t,i]}function b(e){var t=V.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]?!0:!1}function y(e,t,i,s){if(!V.ie||!V.mac){var n=N.getElementsByTagName("head")[0];if(n){var a=i&&"string"==typeof i?i:"screen";if(s&&(T=null,$=null),!T||$!=a){var o=m("style");o.setAttribute("type","text/css"),o.setAttribute("media",a),T=n.appendChild(o),V.ie&&V.win&&typeof N.styleSheets!=A&&N.styleSheets.length>0&&(T=N.styleSheets[N.styleSheets.length-1]),$=a}V.ie&&V.win?T&&typeof T.addRule==D&&T.addRule(e,t):T&&typeof N.createTextNode!=A&&T.appendChild(N.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(q){var i=t?"visible":"hidden";U&&g(e)?g(e).style.visibility=i:y("#"+e,"visibility:"+i)}}function _(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=A?encodeURIComponent(e):e}{var C,x,S,k,T,$,A="undefined",D="object",P="Shockwave Flash",I="ShockwaveFlash.ShockwaveFlash",M="application/x-shockwave-flash",L="SWFObjectExprInst",E="onreadystatechange",F=window,N=document,R=navigator,B=!1,O=[s],z=[],j=[],H=[],U=!1,W=!1,q=!0,V=function(){var e=typeof N.getElementById!=A&&typeof N.getElementsByTagName!=A&&typeof N.createElement!=A,t=R.userAgent.toLowerCase(),i=R.platform.toLowerCase(),s=/win/.test(i?i:t),n=/mac/.test(i?i:t),a=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,r=[0,0,0],l=null;if(typeof R.plugins!=A&&typeof R.plugins[P]==D)l=R.plugins[P].description,!l||typeof R.mimeTypes!=A&&R.mimeTypes[M]&&!R.mimeTypes[M].enabledPlugin||(B=!0,o=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),r[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),r[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),r[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof F.ActiveXObject!=A)try{var h=new ActiveXObject(I);h&&(l=h.GetVariable("$version"),l&&(o=!0,l=l.split(" ")[1].split(","),r=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(d){}return{w3:e,pv:r,wk:a,ie:o,win:s,mac:n}}();!function(){V.w3&&((typeof N.readyState!=A&&"complete"==N.readyState||typeof N.readyState==A&&(N.getElementsByTagName("body")[0]||N.body))&&e(),U||(typeof N.addEventListener!=A&&N.addEventListener("DOMContentLoaded",e,!1),V.ie&&V.win&&(N.attachEvent(E,function(){"complete"==N.readyState&&(N.detachEvent(E,arguments.callee),e())}),F==top&&!function(){if(!U){try{N.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),V.wk&&!function(){return U?void 0:/loaded|complete/.test(N.readyState)?void e():void setTimeout(arguments.callee,0)}(),i(e)))}(),function(){V.ie&&V.win&&window.attachEvent("onunload",function(){for(var e=H.length,t=0;e>t;t++)H[t][0].detachEvent(H[t][1],H[t][2]);for(var i=j.length,s=0;i>s;s++)p(j[s]);for(var n in V)V[n]=null;V=null;for(var a in swfobject)swfobject[a]=null;swfobject=null})}()}return{registerObject:function(e,t,i,s){if(V.w3&&e&&t){var n={};n.id=e,n.swfVersion=t,n.expressInstall=i,n.callbackFn=s,z[z.length]=n,w(e,!1)}else s&&s({success:!1,id:e})},getObjectById:function(e){return V.w3?o(e):void 0},embedSWF:function(e,i,s,n,a,o,h,d,u,p){var f={success:!1,id:i};V.w3&&!(V.wk&&V.wk<312)&&e&&i&&s&&n&&a?(w(i,!1),t(function(){s+="",n+="";var t={};if(u&&typeof u===D)for(var g in u)t[g]=u[g];t.data=e,t.width=s,t.height=n;var m={};if(d&&typeof d===D)for(var v in d)m[v]=d[v];if(h&&typeof h===D)for(var y in h)typeof m.flashvars!=A?m.flashvars+="&"+y+"="+h[y]:m.flashvars=y+"="+h[y];if(b(a)){var _=c(t,m,i);t.id==i&&w(i,!0),f.success=!0,f.ref=_}else{if(o&&r())return t.data=o,void l(t,m,i,p);w(i,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){q=!1},ua:V,getFlashPlayerVersion:function(){return{major:V.pv[0],minor:V.pv[1],release:V.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,i){return V.w3?c(e,t,i):void 0},showExpressInstall:function(e,t,i,s){V.w3&&r()&&l(e,t,i,s)},removeSWF:function(e){V.w3&&p(e)},createCSS:function(e,t,i,s){V.w3&&y(e,t,i,s)},addDomLoadEvent:t,addLoadEvent:i,getQueryParamValue:function(e){var t=N.location.search||N.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return _(t);for(var i=t.split("&"),s=0;s<i.length;s++)if(i[s].substring(0,i[s].indexOf("="))==e)return _(i[s].substring(i[s].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=g(L);e&&C&&(e.parentNode.replaceChild(C,e),x&&(w(x,!0),V.ie&&V.win&&(C.style.display="block")),S&&S(k)),W=!1}}}}();define("libs/swfobject/swfobject",function(){}),define("partner/iab",["jquery","underscore","baseview","adLogger","libs/swfobject/swfobject"],function(e,t,i,s){"use strict";var n=i.extend({destroy:function(t){this.$markup&&this.$markup.remove(),this.$iabThirdParty.remove(),this.adData.cleanUpSelectors&&e(this.adData.cleanUpSelectors).remove(),i.prototype.destroy.call(this,t)},render:function(t){if(this.adData=t,this.$el.addClass("iab-risingstar"),this.$(".ad-slot").hide(),"flash"===t.adCreativeType)this.setupFlash(t);else if("image"===t.adCreativeType)this.setupImage(t);else if("third"===t.adCreativeType)return this.setupThirdParty(t);return e.Deferred().resolve()},setupFlash:function(i){var s={clickTag:i.clickUrl+i.clickThruUrl},n={allowscriptaccess:"always",wmode:"transparent"},a=i.flashAttr||{},o=t.uniqueId("flashiab_");this.$markup=e('<div id="'+o+'"></div>'),this.$el.append(this.$markup),window.swfobject&&window.swfobject.embedSWF(i.flashUrl,o,i.width,i.height,"9.0.0",null,s,n,a)},setupImage:function(t){this.$markup=e('<a href="'+t.clickUrl+t.clickThruUrl+'" target="_blank"><img src="'+t.imageUrl+'"></a>'),this.$el.append(this.$markup)},setupThirdParty:function(i){var n=document.createElement("iframe");if(n.id=n.name="google_ads_"+i.dfp.ecid,n.src="about:blank",n.width=i.width||0,n.height=i.height||0,n.width&&n.height||(n.style.display="none"),n.scrolling="no",n.marginWidth=0,n.marginHeight=0,n.frameBorder=0,n.className="iab-iframe",this.$el.append('<div class="iab-third-party"></div>'),this.$iabThirdParty=this.$(".iab-third-party"),this.$iabThirdParty[0].appendChild(n),n.doc=null,n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),!n.doc)return s.logError("IAB iFrame failed creation, container must be inserted into DOM before creating the iFrame"),e.Deferred().reject();var a="<!doctype html><head><script>window.template = "+JSON.stringify(i)+"; var inDapIF = true; var gnEbMinZIndex = 1; "+i.extraVars+'</script></head><body><script src="'+i.thirdPartyScript+'"></script><script>'+i.scriptOverrides+"</script></body></html>";return i.fullDump&&(a="<!doctype html><head><script>var inDapIF = true; var gnEbMinZIndex = 1;</script></head><body>"+i.thirdPartyTag+"</body></html>"),n.doc.open(),n.doc.write(a),this.$markup=e(n),e.Deferred(function(e){t.defer(function(){e.resolve()})}).promise()},onResize:function(){},onStopToClose:function(){}});return n}),define("partner/ad-position",["jquery","underscore","baseview","utils","admanager","managers/cachemanager","pubsub","partner/iab","adLogger"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=i.extend({$head:e("head"),initialize:function(s){s=e.extend({adSizes:[],adPlacement:null,subSection:null,slotType:"in",adWidth:null,adHeight:null,onAdReady:null,onNoAd:null,beforeAdRender:null},s),this._debounceAdReady=t.debounce(this._adReady,30),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),i.prototype.initialize.call(this,s),this.tracked=!1,this.adState="pending",this.$el.css({width:"",height:"",display:""});var n=this.$el.closest(".partner-placement");n.attr("data-monetization-id",this.options.adPlacement.replace(/\/.*/,"")),n.attr("data-monetization-sizes",this.options.adSizes.join(","))},render:function(e,t){this.options.beforeAdRender&&this.options.beforeAdRender(e,t),t||e?this._renderHighImpact(e,t):this._adReady()},_renderHighImpact:function(e,t){this.adType=t,this.adData=e,l.logDebug("AdPosition HighImpact Ad recieved with type: "+t,e),"risingstar"===t||"generic"===t?this._renderHighImpactIAB(e):this._renderCustomAd(e)},_renderHighImpactIAB:function(e){var i=this.subviews.partnerView=new r({el:this.$el});i.render(e).done(t.bind(function(){this.destroyed||this._adReady()},this))},noAd:function(){this.adState="noad",this.options.onNoAd&&this.options.onNoAd()},getAdState:function(){return this.adState},_renderCustomAd:function(i){return i.dfp&&i.dfp.ecid?(i.html&&(this.$adEl=e(e.parseHTML(i.html,document,!0)),this.$el.append(this.$adEl)),i.stylesheet&&(this.$stylesheet=e('<link rel="stylesheet" data-ad-stylesheet="'+i.dfp.ecid+'" href="'+i.stylesheet+'">'),this.$head.append(this.$stylesheet)),void(i.script?(i.el=this.$el,s.requireSingleUseScript(i.script).done(t.bind(function(e){var t=this._getPubSubKey();if(!this.destroyed){i.initialWidth=this.options.adWidth,i.initialHeight=this.options.adHeight,o.on(t,this._debounceAdReady,this);try{this.subviews.partnerView=new e(i)}catch(s){l.logError("AdSlot("+this.options.adUnit+"): ad delivered threw exception on creation",s.stack||s.stacktrace||s.message)}}},this))):this._adReady())):void l.logError("invalid ad returned, no dfp/ecid found",i)},_getPubSubKey:function(){return"partner:"+this.adData.dfp.ecid+":ready"},destroy:function(e){"hasad"===this.adState&&this.$el.css({width:this.getWidth(),height:this.getHeight()}),this.destroyAdPlacement();var t=this.$el.closest(".partner-placement");t.removeAttr("data-monetization-id"),t.removeAttr("data-monetization-sizes"),this.destroyed=!0,i.prototype.destroy.call(this,e)},destroyAdPlacement:function(){if(this.tracked=!1,this.subviews.partnerView&&(this.stopAd(),this._dispatchToPartner("destroy",!1),this.subviews.partnerView=null),this.adData&&this.adData.script&&o.off(this._getPubSubKey(),this._debounceAdReady,this),this.adType=this.adData=null,this.$adEl)this.$adEl.remove(),this.$adEl=null;else if(this.$el.hasClass("partner-billboard-ad")){var t=s.getNested(window.site_vars,"ADS","cleanup_selectors");e(t).remove()}else this.$("iframe").remove(),this.$(".ad-slot > div").remove();this.$stylesheet&&(this.$stylesheet.remove(),this.$stylesheet=null)},getAdPlacement:function(){var e=this.options.adPlacement;return this.options.subSection&&(e+="/"+this.options.subSection),e},getAdSizes:function(){return this.options.adSizes},getSlotType:function(){return this.options.slotType},_adReady:function(){l.logDebug("AdPosition("+this.getAdPlacement()+") "+this.adType+" ready"),this.adData&&this.adData.script&&o.off(this._getPubSubKey(),this._debounceAdReady,this),this.adState="hasad",this.options.onAdReady?this.options.onAdReady(this.adData,this.adType):"in"===this.options.slotType&&(this.adType&&"risingstar"!==this.adType?this.playAd():(this.show(),this.$el&&this.$el.height()>1&&this.$el.addClass("partner-placement-visible")))},isAdReady:function(){var e="hasad"===this.adState;return e&&"blank"===s.getNested(this.adData,"adType")?(this.trackAd(),!1):e},getCreativeState:function(e,t){return this.adData&&this.adData.dfp&&this.adData.dfp.ecid?a.getValue("dfpc_"+this.adData.dfp.ecid,e,t):void l.logWarn("Attempted to get state on non high impact ad")},setCreativeState:function(e,t){this.adData&&this.adData.dfp&&this.adData.dfp.ecid?a.setValue("dfpc_"+this.adData.dfp.ecid,e,t):l.logWarn("Attempted to set state on non high impact ad")},getHeight:function(){return this.$el.outerHeight()},getWidth:function(){return this.$el.outerWidth()},showAd:function(e,t){this.$el.show(),this._dispatchToPartner("onShow",e,t),this.trackAd()},resizeAd:function(e,t){this.options.adWidth=e,this.options.adHeight=t,this._dispatchToPartner("onResize",e,t)},setInitialDimensions:function(e,t){this.options.adWidth=e,this.options.adHeight=t},_dispatchToPartner:function(e){var t,i=this.subviews.partnerView;if(i)if(i[e]){t=Array.prototype.slice.call(arguments,1),l.logDebug.apply(l,["AdPosition("+this.getAdPlacement()+") "+e].concat());try{i[e].apply(i,t)}catch(s){l.logError("Ad threw an exception in function "+e,s.stack||s.stacktrace||s.message)}}else l.logWarn("Ad does not implement "+e)},stopAd:function(){this._dispatchToPartner("onStopToClose"),n.updateActiveSlotStatistics(this.adType,"stopped")},pauseAd:function(){this._dispatchToPartner("onPause"),n.updateActiveSlotStatistics(this.adType,"paused")},resumeAd:function(){this._dispatchToPartner("onResume"),n.updateActiveSlotStatistics(this.adType,"playing")},trackAd:function(t){var i;if(!this.tracked&&this.adData){if(this.tracked=!0,this.adData.viewUrl){var s=e('<img src="'+this.adData.viewUrl+encodeURIComponent(window.site_static_url+"images/pixels/pixel-transparent.png")+'" style="display:none;">');this.$adEl?this.$adEl.append(s):(this.$adEl=s,this.$el.append(s)),l.logDebug("Fired Tracking Pixel",this.adData.viewUrl)}if("Yes"===this.adData.trackVCE&&this.adData.vCEUrl){t=t||this.$el,i=t.prop("id");var a=this.adData.vCEUrl.replace(/\[domid\]/g,i);n._createScript("vce_"+i,a,t),l.logDebug("Tracked vCE",a)}}},playAd:function(){this.trackAd(),this._dispatchToPartner("onPlay"),n.updateActiveSlotStatistics(this.adType,"playing")}});return h}),define("directAdPosition",["jquery","underscore","partner/ad-position","state","admanager"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(t){t=e.extend({targeting:{},subSection:s.getActivePageInfo().cst,slotType:"in"},t),i.prototype.initialize.call(this,t),"in"==t.slotType&&this.refreshPosition()},prefetchAd:function(){return this.subviews.adSlot?!1:(this.adSlotPlacement=this.getAdPlacement(),this.subviews.adSlot=n.getAdSlot(this.adSlotPlacement,this.options.targeting,this.options.adSizes,this,this.options.slotType),!0)},setTargeting:function(e){this.options.targeting=e,this.subviews.adSlot&&this.subviews.adSlot.setTargeting(this.options.targeting)},destroy:function(){this.destroyAdSlot(),i.prototype.destroy.apply(this,arguments)},destroyAdSlot:function(){this.subviews.adSlot&&(this.subviews.adSlot.destroy(),this.subviews.adSlot=null)},setPageInfo:function(t){t.cst&&this.setSubSection(t.cst),this.setTargeting(e.extend(n.getPageAdTargeting(t),this.options.targeting))},setSubSection:function(e){this.options.subSection=e},refreshPosition:function(){this.adState="pending",this.subviews.adSlot&&this.adSlotPlacement!==this.getAdPlacement()&&(this.destroyAdPlacement(),this.destroyAdSlot()),this.prefetchAd()||(this.destroyAdPlacement(),this.subviews.adSlot.refresh())}});return a}),define("modules/partner/poster-ad-asset2",["jquery","underscore","baseview","state","site-manager","utils","admanager","directAdPosition"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({initialize:function(o){t.bindAll(this,"_overlayScrollListener","_handleResizeWindow","onSecondAdReady","_isInViewport"),o=e.extend({minTimeForAd:5e3,topMargin:30,disableRefresh:a.getNested(window.site_vars,"ADS","poster_scroll_refresh_disabled"),articleSelector:"article > div[role=main]",rightRailSelector:".story-right-rail"},o);var r=s.getActiveApp();this.$win=a.get("win"),this.$body=a.get("body"),this.header=n.getHeader(),this.overlayScrollListenerThrottle=t.throttle(this._overlayScrollListener,16,{leading:!1,trailing:!0}),this.$win.on("scroll."+this.cid,this.overlayScrollListenerThrottle).on("resize."+this.cid,this._handleResizeWindow),this.partnerScrollHeight=0,this.belowModuleInView=!1,this.pubSub={"breakingbar:after:open":this._overlayScrollListener,"breakingbar:after:close":this._overlayScrollListener,"gravity:open":this._handleResizeWindow},this.$adEl=this.$(".poster-scroll-ad"),this.$adScroll=this.$(".poster-scroll"),this.$otherAds=r.$(".partner-asset-right-ad,.datasphere-community-module"),this.$rightRail=this.$el.closest(o.rightRailSelector),this.$body.on("bx_impression."+this.cid,this._setHeight()),i.prototype.initialize.call(this,o),this._handleResizeWindow()},_overlayScrollListener:function(){return this.moduleOffsetTop=this.$el.offset().top,this._getModuleHeight()<(this.partnerScrollHeight||250)?void this.hide():(this._checkIfBottomInView(),this._goToState(this._getCurrentState()),void this._handleRequestAds())},_getCurrentState:function(){return this._isOtherAdinViewPort()||!this._isInViewport(this.$adScroll,this._getModuleHeight)?"hidden":this._shouldDockBottom()?"dockBottom":this._shouldFixAd()?"fixed":"dockTop"},_goToState:function(e){e!==this.state&&("hidden"!==this.state&&this.state||this.$adScroll.css("opacity","1"),"hidden"===e?this.$adScroll.css("opacity","0"):"fixed"===e?this.$adScroll.css({position:"fixed",top:this._getHeaderHeight()+this.options.topMargin}):"dockTop"===e?this.$adScroll.css({position:"static",top:"auto"}):"dockBottom"===e&&this._dockBottom(),this.state=e)},_checkIfBottomInView:function(){var e=this.$body.scrollTop()+this.winHeight;e>=this._getModuleOffsetBottom()&&this.belowModuleInView===!1?(this._setHeight(),this._setArticleDimensions(),this.belowModuleInView=!0):e<this._getModuleOffsetBottom()&&this.belowModuleInView===!0&&(this.belowModuleInView=!1)},_shouldFixAd:function(){return this.moduleOffsetTop-this.options.topMargin<=this._getViewportOffset()},_getViewportOffset:function(){return a.getScrollPosition()+this._getHeaderHeight()},_shouldDockBottom:function(){var e=this._getModuleOffsetBottom()-this.partnerScrollHeight-this.options.topMargin;return e<this._getViewportOffset()},_getHeaderHeight:function(){return this.header?this.header.getFixedHeight():0},_isOtherAdinViewPort:function(){return void 0!==t.find(this.$otherAds,function(e){return this._isInViewport(e)},this)},_isInViewport:function(t,i){var s=e(t),n=s.offset().top,a=n+(i||s.outerHeight()),o=this._getViewportOffset(),r=o+this.winHeight-this._getHeaderHeight();return!(s.is(":hidden")||o>a||n>r)},_isTimeToRefresh:function(){if(this.lastAdRefreshedTime){var e=(new Date).getTime();return e-this.lastAdRefreshedTime>=this.options.minTimeForAd}return!0},_getModuleHeight:function(){return this.articleOffsetTop+this.articleHeight-this.moduleOffsetTop},_getModuleOffsetBottom:function(){return this.moduleOffsetTop+this._getModuleHeight()},_hasScrolledAViewportHeight:function(){var e=a.getScrollPosition(),t=Math.abs(e-this.scrollTopAdRequestedAt);return t>=this.winHeight},_handleResizeWindow:function(){this.winHeight=this.$win.height(),this._setArticleDimensions()},_handleRequestAds:function(){"dockTop"!==this.state||this.subviews.ad?("fixed"===this.state&&!this.subviews.ad||"fixed"===this.state&&!this.options.disableRefresh&&this._hasScrolledAViewportHeight()&&this._isTimeToRefresh())&&this._requestAd():this._requestAd()},_dockBottom:function(){this.$adScroll.css({position:"absolute",top:this.articleHeight-this.partnerScrollHeight+this.railPositionTop})},_setArticleDimensions:function(){var e=s.getActiveApp().$(this.options.articleSelector);e.length&&(this.articleHeight=e.height(),this.articleOffsetTop=e.offset().top,this.railPositionTop=this.$rightRail.position().top)},_requestAd:function(){o.getActiveSlotStatistics().done(t.bind(function(e){var i=this.subviews.ad;if(i){if(!i.isAdReady())return;i.refreshPosition()}else{var n=["mediumrectangle"],o=600+this.options.topMargin,l=t.findWhere(e.high_impact_info,{adType:"gravity"});this._getModuleHeight()>=o&&this.winHeight-this._getHeaderHeight()>=o&&(n=n.concat(["halfpage","portrait","filmstrip"])),this.subviews.ad=new r({el:this.$adEl,adSizes:n,adPlacement:"poster_scroll",adType:"poster",onAdReady:this.onSecondAdReady,pageInfo:s.getActivePageInfo(),targeting:l?{creativeid:l.ecid}:{}})}this.scrollTopAdRequestedAt=a.getScrollPosition()},this))},_setHeight:function(){this.partnerScrollHeight=this.$adScroll.outerHeight()},onSecondAdReady:function(){this.subviews.ad.show(),this._setHeight(),this.lastAdRefreshedTime=(new Date).getTime(),this._overlayScrollListener(),"dockBottom"===this.state&&this._dockBottom()},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),i.prototype.destroy.call(this,e)}});return l}),define("partner/overlay-ad-base",["jquery","underscore","pubsub","state","utils","baseview","site-manager"],function(e,t,i,s,n,a,o){"use strict";var r=a.extend({events:{"click .partner-close,.ui-film":"onClickCloseButton"},initialize:function(i){i=e.extend({getHeaderOffset:null},i),t.bindAll(this,"onResize"),this.header=o.getHeader(),this.listen(),this.$body=n.get("body"),a.prototype.initialize.call(this,i),this.$placement=this.$(".partner-placement")},showAd:function(){s.setActiveAppFixed(!0),this.header&&this.header.setClosedFixed(!0),this.showingAd=!0,this.show(!0).done(t.bind(function(){this.subviews.ad&&this.subviews.ad.playAd()},this)),this.$body.addClass("high-impact-ad-visible")},stopAd:function(){this.subviews.ad&&this.subviews.ad.stopAd()},onAdReady:function(e,t){var i=this.subviews.ad;i&&("blank"===t?i.trackAd():this.showAd())},destroy:function(e){this.close(),a.prototype.destroy.call(this,e)},findSizeForAd:function(){var e={adSizeClass:"size-s",adTop:"50%",adHeight:450,adWidth:600},t=0;this.options.getHeaderOffset&&(t=this.options.getHeaderOffset()||0);var i=document.documentElement.clientHeight-t-80,s=document.documentElement.clientWidth-160;return s>1080&&i>810?(e.adSizeClass="size-xl",e.adHeight=810,e.adWidth=1080):s>936&&i>700?(e.adSizeClass="size-l",e.adHeight=700,e.adWidth=936):s>768&&i>576&&(e.adSizeClass="size-m",e.adHeight=576,e.adWidth=768),e.adTop=(document.documentElement.clientHeight-t-e.adHeight)/2+t+"px",e},listen:function(){this.pubSub={},this.pubSub["resize:app"]=this.onResize,this.pubSub["breakingbar:after:open"]=this.onResize,this.pubSub["breakingbar:after:close"]=this.onResize},onClickCloseButton:function(e){e.preventDefault(),this.close(!0)},close:function(e){this.showingAd&&this.subviews.ad&&(this.showingAd=!1,s.clearActiveAppFixed(!0),this.header&&this.header.restoreLastState(),this.subviews.ad.stopAd(),this.hide(e)),this.$body.removeClass("high-impact-ad-visible")},onResize:function(){var e=this.findSizeForAd();this.$placement.removeClass("size-s size-m size-l size-xl").addClass(e.adSizeClass).css({top:e.adTop}),this.subviews.ad&&this.subviews.ad.resizeAd(e.adWidth,e.adHeight)}});return r}),define("sharedAdPosition",["jquery","underscore","partner/ad-position","utils","admanager"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(t){t=e.extend({adType:null,defaultPosition:!1},t),i.prototype.initialize.call(this,t),n.registerSharedAdPosition(this)},isDefaultPosition:function(){return this.options.defaultPosition},getAdType:function(){return this.options.adType},refreshPosition:function(){n.refreshSharedAdPosition(this.getAdPlacement())},destroy:function(e){i.prototype.destroy.call(this,e),n.destroySharedAdPosition(this)}});return a}),define("partner/ad-utils",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=function(){};return s.prototype={changeBg:function(e,s,n){if(!s||"transparent"===s)return!1;var a=e.css("background-color");return"transparent"!==a&&a?(e.addClass("partner-background"),i.prototype.animate(e,"background-color",s,200,"ease-in").done(t.bind(function(){n?this.changeBgImg(e,n):this.changeBgImg(e,window.site_static_url+"images/pixels/pixel-transparent.png")},this)),a):!1},changeBgImg:function(e,t){e.css({"background-image":"url('"+t+"')","background-repeat":"repeat"})},clearBg:function(e,s){e.css({"background-image":"","background-repeat":""}),i.prototype.animate(e,"background-color",s,200,"ease-in").done(t.bind(function(){e.removeClass("partner-background")},this))}},new s}),define("partner/leavebehind",["jquery","underscore","baseview","adLogger","utils","managers/cachemanager","partner/ad-utils","state"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({events:{"click .js-partner-lb-click":"onClick"},initialize:function(a){a=e.extend({onShowAd:null,isCompact:!0,isNative:!1,behavior:{}},a),i.prototype.initialize.call(this,a),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),this.$body=n.get("body"),this.$clickArea=this.$(".js-partner-lb-click"),s.logDebug("LeaveBehind initialized",this)},destroy:function(){this.hide(),this.startBgColor&&o.clearBg(this.$body,this.startBgColor),this.$("img").remove(),this.$frame&&this.$frame.remove(),this.$el.removeClass("partner-lb-frame"),this.$clickArea.find(".partner-lb-click-arrow").remove(),this.options.cards&&this.addedSpace&&this.options.cards.animate({paddingTop:"-=10px"},350,function(){e(this).css("padding-top","")
}),this.$body.removeClass("partner-background"),i.prototype.destroy.call(this,!1)},render:function(i,s){var n=new e.Deferred;return this.adData=s,s.frameSliver?this._setupFrame(s,n):this.options.isNative?n.resolve():this._setupLb(s,n),n.then(t.bind(function(){this._showAdOrLb(i,s)},this)),n},_setupLb:function(t,i){var s=this.$el;this.options.isCompact?s.addClass("compact"):s.removeClass("compact"),s.append(e("<img>").attr({"class":"leavebehind-image",src:t.leaveBehindImage,alt:t.leaveBehindText})),i.resolve()},_setupFrame:function(i,s){this.$branding=e("<img>").attr({src:i.frameSliver,alt:i.leaveBehindText,"class":"lb-brand"}),i.frameArrowColor&&"None"!==i.frameArrowColor&&this.$clickArea.prepend('<svg class="partner-lb-click-arrow" fill="'+i.frameArrowColor+'" x="0px" y="0px" viewBox="0 0 26 26" enable-background="new 0 0 26 26"><path fill-rule="evenodd" clip-rule="evenodd" d="M13,0.5C6.1,0.5,0.5,6.1,0.5,13c0,6.9,5.6,12.5,12.5,12.5S25.5,19.9,25.5,13C25.5,6.1,19.9,0.5,13,0.5z M19,12l-5.3,5.3c-0.2,0.2-0.4,0.3-0.6,0.3c-0.2,0-0.5-0.1-0.6-0.3L7.1,12c-0.2-0.2-0.3-0.4-0.3-0.6c0-0.2,0.1-0.5,0.3-0.6c0.2-0.2,0.4-0.3,0.6-0.3c0.2,0,0.5,0.1,0.6,0.3l4.7,4.7l4.7-4.7c0.4-0.4,0.9-0.4,1.3,0C19.3,11,19.3,11.6,19,12z" /></svg>'),i.frameBackground?e("<img>").load(t.bind(function(t){e(t.currentTarget).remove(),this.$frame=e("<div>").css("background-image",'url("'+i.frameBackground+'")').addClass("lb-frame"),r.getActiveApp().$el.prepend(this.$frame),this.$body.addClass("partner-background"),s.resolve()},this)).attr("src",i.frameBackground):(this.$frame=e([]),s.resolve()),this.$el.append(this.$branding).addClass("partner-lb-frame")},shouldShowAd:function(e){var t=this.options.maxDisplayed||1,i=this.getAdState(e);return i.displayed<t},getStateKey:function(e){return"dfpc_"+e.dfp.ecid},getAdState:function(e){return a.getValue(this.getStateKey(e),{displayed:0},this.getExpirationMinutes(e.leaveBehindExp))},getExpirationMinutes:function(e){var t=parseInt(e,10);return isNaN(t)?n.getNested(window.site_vars,"ADS","LEAVEBEHIND_EXPIRATION_MINUTES"):t},incrementAdViewCount:function(e){var t=this.getAdState(e);t.displayed+=1,a.setValue(this.getStateKey(e),t,this.getExpirationMinutes(e.leaveBehindExp))},_showAdOrLb:function(e,t){var i=this.options;this.shouldShowAd(t)?(this.incrementAdViewCount(t),i.onShowAd&&i.onShowAd(),n.getNested(i,"behavior","initShow")&&this.$frame&&(this.$frame.fadeIn(350),this.startBgColor=o.changeBg(this.$body,t.frameColor))):(this.show(),e.trackAd(this.$el),this.track(t.leaveBehindTracking))},show:function(){if(!this.options.isNative&&this.adData&&(i.prototype.show.call(this),this.adData.frameSliver)){var e=this.options.cards;e&&!this.addedSpace&&(e.animate({paddingTop:"+=10px"},350),this.addedSpace=!0),this.$el.show(),this.$branding.fadeIn(350),this.$frame.fadeIn(350),this.startBgColor=o.changeBg(this.$body,this.adData.frameColor)}},hide:function(e){var s=this.options.behavior,n=this.startBgColor,a=this.options.cards,r=this.adData;!this.options.isNative&&r&&(r.frameSliver||i.prototype.hide.call(this),s.hidebrand&&this.$branding&&(!a||"Pushdown"!==r.adType&&"Pushdown+"!==r.adType||(a.animate({paddingTop:"-=10px"},350),this.addedSpace=!1),this.$branding.fadeOut(350,t.bind(function(){this.$el.hide()},this))),s.hideframe&&this.$frame&&this.$frame.fadeOut(350),n&&s.clearBgColor&&o.clearBg(this.$body,n),e&&this.track(r.reexpandTracking))},onClick:function(){return this.hide(!0),this.options.onShowAd&&this.options.onShowAd(!0),!1},track:function(e){var t;if(e)for(t=0;t<e.length;++t)(new Image).src=e[t]}});return l}),define("partner/overlay-ad-fronts",["jquery","underscore","partner/overlay-ad-base","sharedAdPosition","partner/leavebehind","adLogger"],function(e,t,i,s,n,a){"use strict";var o=i.extend({initialize:function(s){s=e.extend({leaveBehindEl:e(".partner-leavebehind"),adSizes:["elastic"],adType:"elastic",adPlacement:"high_impact",isCardBumped:!0,isNative:!1},s),t.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,s),this.loadAdPlacement(),a.logDebug("Partner Shared Overlay initialized",this)},destroy:function(e){var t=this.options.slot;t&&t.removeClass("show-slot"),i.prototype.destroy.call(this,e)},loadAdPlacement:function(){this.subviews.ad=new s({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&this.options.leaveBehindEl?(this.subviews.adLeaveBehind=new n({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.options.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!1}}),this.subviews.adLeaveBehind.render(this.subviews.ad,e)):this.showAd()},close:function(){this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show(),i.prototype.close.apply(this,arguments)}});return o}),define("partner/slider",["jquery","underscore","baseview","sharedAdPosition","utils"],function(e,t,i,s,n){"use strict";var a=i.extend({el:".partner-slider-ad",events:{"click .partner-slider-close":"onClickCloseButton"},destroy:function(){this.stopCloseTimer(),this.hide(!0),i.prototype.destroy.call(this,!1)},initialize:function(n){t.bindAll(this,"onAdReady"),n=e.extend({adSizes:["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"high_impact"},n),i.prototype.initialize.call(this,n),this.subviews.ad=new s({el:this.$el,adSizes:n.adSizes,adPlacement:n.adPlacement,adType:"slider",defaultPosition:!0,onAdReady:this.onAdReady})},onAdReady:function(){this.subviews.ad.show(),this.show(!0).done(t.bind(function(){this.startCloseTimer()},this))},onClickCloseButton:function(e){e.preventDefault(),this.destroy(!1)},startCloseTimer:function(){var e=n.getNested(window.site_vars,"ADS","SLIDER","CLOSETIME");e&&(this.closeTimer=setTimeout(t.bind(function(){this.hide()},this),e))},stopCloseTimer:function(){clearTimeout(this.closeTimer)}});return a}),define("modules/global/brightcove-video",["jquery","underscore","baseview","pubsub","state","admanager","adLogger","utils","cookie"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({events:{"click .videoStillPlay":"swapImageForVideo","click .videoStill":"swapImageForVideo","click .videoCloseButton":"hidePlayer"},initialize:function(r){r=e.extend({live:!1,onVideoComplete:null,onVideoShow:null,onVideoHide:null,onVideoLoaded:null},r),this.$videoObj=this.$(".videoObject"),this.$brightcove=this.$(".BrightcoveExperience"),this.brightcoveId=this.$(".BrightcoveExperience").attr("id"),this.playerHTML=this.$videoObj.html();var l=this.$videoObj.data()||{},h=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),d=e.cookie("aam_uuid"),c="";this.pageinfo=n.getActivePageInfo(),this.pageinfo.series&&(c+="&series="+encodeURIComponent(this.pageinfo.series)),this.pageinfo.topic&&(c+="&topic="+encodeURIComponent(this.pageinfo.topic)),c+="&aam="+h+"&u="+d,o.logInfo("Built ad call for video, "+l.id+".",this.pageinfo,l);var u="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+a.buildAdUnit("preroll_video")+"/"+l.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+l.brightcovevideoid+encodeURIComponent(c)+'&cmsid=12768&url=""';o.logInfo("Video Ad call: "+u),e("<param>",{name:"adServerURL",value:u}).appendTo(this.$(".BrightcoveExperience")),this.$videoObj.length&&this.brightcoveId&&(t.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this.throttledDetermine=t.throttle(this.determineCompletion,1500),i.prototype.initialize.call(this,r),(this.options.autostart||this.$videoObj.attr("data-autoplay"))&&this.createPlayer(),this._buildBrightCoveLoadCallback(),this._buildBrightCoveReadyCallback(),this.pubSub={"pause:videos":this.pauseVideo},s.attach(this.pubSub,this))},_buildBrightCoveLoadCallback:function(){window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.BCLoad||(window.BCLoad=t.bind(function(e){this._triggerNeon("onTemplateLoad",e),window.BCCallbacks[e]?window.BCCallbacks[e](e):console.log("received brightcove callback for video that does not exist: "+e)},this))},_buildBrightCoveReadyCallback:function(){window.BCReady||(window.BCReady=t.bind(function(e){this._triggerNeon("onTemplateReady",e)},this))},_neonEnabled:function(){return r.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},onBrightCoveLoad:function(e){this.$(".temp-loader").fadeOut(),this.player=window.brightcove.api.getExperience(e),this.APIModules=window.brightcove.api.modules.APIModules,this.player?(console.log("brightcove loaded successfully",this.brightcoveId),this.options.onVideoLoaded&&this.options.onVideoLoaded(this.brightcoveId),this.modVP=this.player.getModule(this.APIModules.VIDEO_PLAYER),this.modCon=this.player.getModule(this.APIModules.CONTENT),this.modExp=this.player.getModule(this.APIModules.EXPERIENCE),this.modExp.addEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady)):console.warn("brightcove video loaded, but could not get experience: "+e)},onTemplateReady:function(){this.modVP&&(this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))},onVideoStart:function(e){var t=this.getVideoDetail();t.videoDuration=e.duration<0?"":e.duration<120?"less than 2 min":"greater than 2 min",t.completion="0%",t.videoName=t.liveVideoSubject?t.liveVideoSubject:e.media.displayName,t.eventtype="video:load",t.contentid=e.target.experience.id,t.videoFulllengthUrl=e.media.FLVFullLengthURL,"undefined"!=typeof t.assetid&&e.media.referenceId!==t.assetid.toString()&&(t.assetid=e.media.referenceId,t.ssts=e.media.customFields.gdp_ssts||t.ssts,t.cst=e.media.customFields.gdp_cst||t.cst,t.videocontentprovider=e.media.customFields.gannetttracking+"|"+e.media.displayName,t.keywords=e.media.customFields.gdp_tags||t.keywords,"undefined"!=typeof e.media.customFields.gdp_canonical_url&&(t.pathName=e.media.customFields.gdp_canonical_url.replace(/^.*\/\/[^\/]+/,"")),t=this.setVideoDetailMeta(t)),s.trigger("video:load",t)},onVideoComplete:function(){console.log("video playback finished: "+this.brightcoveId),e.isFunction(this.options.onVideoComplete)&&this.options.onVideoComplete()},onMediaEventFired:function(e){s.trigger("uotrack",e.type)},determineCompletion:function(e){var t=e.duration,i=e.position,n=Math.round(i/t*100),a=this.video.url||e.media.customFields.gdp_canonical_url;!this.fiftypercent&&n>=50&&95>n?(s.trigger("vitrack",{percentage:"50%",video_url:a}),this.fiftypercent=!0):!this.ninetyfivepercent&&n>=95&&99>n&&(s.trigger("vitrack",{percentage:"95%",video_url:a}),this.ninetyfivepercent=!0)},createPlayer:function(){if(window.brightcove){var e=this.$brightcove;e.params={forceHTML:!1},window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperiences(null,this.brightcoveId),n.stopRefreshTimer(),this.$videoObj.show()}else this.loadScripts(this.createPlayer)},destroy:function(){if(n.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),this.modVP&&this.resetVideoState()),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===t.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0,window.BCReady=void 0;try{delete window.BCCallbacks,delete window.BCLoad,delete window.BCReady}catch(e){}}}else console.warn("BCCallbacks no longer available on video destroy");i.prototype.destroy.apply(this,arguments)},resetVideoState:function(){this.player&&(this.modVP&&(this.pauseVideo(),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.modVP=!1,this.modCon=!1,this.modExp=!1),this.player=!1),this.$(".videoStill, .videoStillPlay").show(),this.$videoObj.html(this.playerHTML),this.hidePlayer()},hidePlayer:function(){this.$videoObj&&this.$videoObj.hide(),this.options.onVideoHide&&this.options.onVideoHide(),n.startRefreshTimer()},loadScripts:function(e){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),e()):console.log("Error loading Brightcove")})},swapImageForVideo:function(){this.createPlayer(),this.options.onVideoShow&&this.options.onVideoShow(),this.$(".videoStill, .videoStillPlay").hide(),this.$(".temp-loader").show(),s.trigger("video:playClick")},getVideoDetail:function(){var e=this.$videoObj.data()||{};return e.pathName="",e.liveVideoSubject?e.pathName=e.liveVideoSubject:e.videourl&&(e.pathName=e.videourl.replace(/^.*\/\/[^\/]+/,"")),this.setVideoDetailMeta(e)},setVideoDetailMeta:function(e){try{e.cst||(e.cstlist=e.cst.split("/"),e.category=e.cstlist[0],e.cst=e.cstlist.slice(0,3).join(":"),e.subcategory=e.cstlist.slice(0,2).join(":")),e.sstslist||(e.sstslist=e.ssts.split("/"),e.section=e.sstslist[0],e.ssts=e.sstslist.join(":"),e.subsection=e.sstslist.slice(0,2).join(":"),e.topic=e.sstslist.slice(0,3).join(":"))}catch(t){return void console.error("Invalid page",t.stack||t.stacktrace||t.message)}return e},pauseVideo:function(){void 0!==this.modVP&&this.modVP.pause(!0)},isPlayingHandler:function(e){this.options.live||e&&this.modVP.pause(!0)},loadVideoById:function(e){this.modVP.loadVideoByID(e)}});return l}),define("blog/blog-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","directAdPosition","modules/partner/poster-ad-asset2","partner/overlay-ad-fronts","sharedAdPosition","partner/slider","modules/global/brightcove-video"],function(e,t,i,s,n,a,o,r,l,h,d,c,u,p){"use strict";var f=r.extend({el:".blt-content-container",afterPageReveal:function(){this.$el.hasClass("blt-content-container")?this._initNewBlogPage():this._initializeLegacyBlogPage(),n.stopRefreshTimer()},setupAds:function(){this.subviews.sidebarAd=new l({el:this.$(".partner-sidebar-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"sidebar"}),this.subviews.posterAd=new h({el:this.$(".blog-poster-scroll-ad-wrapper"),rightRailSelector:".blt-sidebar",disableRefresh:!1,minTimeForAd:15e3})},_initNewBlogPage:function(){this.setupAds()},_initializeLegacyBlogPage:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new p({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-logo":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=a.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new c({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new u)}});return f}),define("apps/ballot-app",["jquery","underscore","base-app","site-manager","state"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),n.stopRefreshTimer()},animateChangePagePreData:function(){s.scrollTop(0)},destroy:function(e){i.prototype.destroy.call(this,e),n.startRefreshTimer()}});return a}),define("apps/member-guide-apps",["jquery","base-app","site-manager"],function(e,t){var i=t.extend({events:{"click .js-mga-apps-icon-link":"showApp"},showApp:function(t){t.preventDefault();var i=e(t.currentTarget),s=i.data("app-number");this.$(".js-mga-apps-icon-link").removeClass("mga-icon-active"),this.$(".js-mga-panel[data-app-number]").removeClass("mga-active-app"),this.$(".js-mga-apps-icon-link[data-app-number="+s+"]").addClass("mga-icon-active"),0===s?this.$(".js-mga-panel[data-app-number]").addClass("mga-active-app"):this.$(".js-mga-panel[data-app-number="+s+"]").addClass("mga-active-app");var n=e(window).width();670>n&&e("html, body").animate({scrollTop:this.$(".mga-page-content").offset().top-60},500)},afterPageReveal:function(){e("body").addClass("mga-body").addClass("mga-body-subpage"),e(".js-mga-container").addClass("mga-body-subpage").addClass("mga-section-inline")},beforeAppRemove:function(){e("body").removeClass("mga-body")}});return i}),define("apps/ugc-app",["jquery","underscore","base-app","site-manager"],function(e,t,i,s){"use strict";var n=i.extend({animateChangePagePreData:function(){s.scrollTop(0)}});return n}),define("apps/live_app/live-app-app",["jquery","underscore","base-app","site-manager"],function(e,t,i,s){var n=i.extend({activateLoader:function(){window.scrollTo(0,0),this.$el.addClass("has-live-app-global-loader")},deactivateLoader:function(){window.scrollTo(0,0),this.$el.removeClass("has-live-app-global-loader")},animateRevealApp:function(){return s.getHeader().setClosedFixed(),i.prototype.animateRevealApp.apply(this,arguments)},afterAppRemove:function(){s.getHeader().restoreDefaultState()}});return n}),define("modules/global/taboola",["jquery","underscore","utils","managers/cachemanager"],function(e,t,i,s){"use strict";var n=function(s){var n=i.getNested(window.site_vars,"THIRDPARTYAPI","Taboola")||{};this.options=e.extend({apiBase:n.apiBase+n.api_id,apiKey:n.apiKey,widgetUrl:"http://cdn.taboolasyndication.com/libtrc/"+n.publisher_id+"/loader.js",widget:n.widget,taboola_enabled:n.ENABLED},s),this.options.widget&&i.loadScript(this.options.widgetUrl,"_taboola",t.bind(this.getWidget,this))};return n.prototype={setUserTaboolaSession:function(e){s.setValue("taboola_user_session_id",e)},getUserTaboolaSession:function(){return s.getValue("taboola_user_session_id","init")},registerTaboolaClick:function(e,t,i,s){s||(s="below-photo");var n=this.options.apiBase+"/recommendations.notify-click?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+i+"&item.type="+t+"&item.id="+e+"&placement="+s+"&response.session="+this.getUserTaboolaSession();(new Image).src=n},registerTaboolaVisible:function(e){var t=this.options.apiBase+"/recommendations.notify-visible?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+e+"&response.session="+this.getUserTaboolaSession();(new Image).src=t},getRelated:function(e,s,n,a,o,r,l){if(this.options.taboola_enabled){if(!e)return;s=s||"video",n=n||"video",a=a||6,o=o||window.location.href,r=r||0,l=l===!1?l:!0;var h=this.options.apiBase+"/recommendations.get";h+="?output.callback=define&app.type=desktop&app.apikey="+this.options.apiKey,h+="&source.id="+r+"&source.url="+encodeURIComponent(o)+"&source.type="+s+"&rec.type="+n+"&rec.visible="+l+"&rec.count="+a+"&user.session="+this.getUserTaboolaSession(),i.requireSingleUseScript(h).done(t.bind(function(t){i.set("taboolaResponseID",t.id),t.list||(t.list={}),this.setUserTaboolaSession(t.session),l&&this.registerTaboolaVisible(t.id),e(t)},this))}},getWidget:function(e){this.options.taboola_enabled&&(this.options.widget.length>1&&console.log("TABOOLA more stories"),e.push({notify:"newPageLoad"}),e.push({article:"auto",target_type:"mix",url:window.location.href}),t.each(this.options.widget,function(t){e.push(-1!==i.getPageUrl().indexOf("/sports/")||-1!==i.getPageUrl().indexOf("/gameon/")?{category:"sports",mode:t.mode,container:t.container}:{mode:t.mode,container:t.container})}))}},n}),define("meteredAdPosition",["jquery","underscore","directAdPosition","utils","managers/cachemanager","admanager","adLogger"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({initialize:function(t){t=e.extend({slotType:"out",rateMeterId:null},t),i.prototype.initialize.call(this,t)},getDefaultThreshold:function(e){var t=e||this.options.meterThreshold||this.options.adPlacement,i=t.indexOf("/");-1!==i&&(t=t.substring(0,i));var n=s.getNested(window.site_vars,"ADS","THRESHOLDS",t.toUpperCase());return n||o.logError("Could not find default threshold for metered ad: "+t),n},tickMeter:function(e,t){var i=!1,s=this.getCurrentMeter(t);return s.length?(s[0]=Math.max(0,s[0]-1),s[0]<1&&(i=!0,e||(s[0]=s[1])),n.setValue(this.getRateMeterId(t),s),i):i},resetMeter:function(e){var t=this.getCurrentMeter(e);t[0]=t[1],n.setValue(this.getRateMeterId(e),t)},getRateMeterId:function(e){return"dfpc_"+(e||this.options.rateMeterId)},getCurrentMeterCount:function(e){return this.getCurrentMeter(e)[0]||0},getCurrentMeter:function(e){var t=this.getRateMeterId(e),i=this.getDefaultThreshold(e);return i?n.getValue(t,i):[]},shouldShowAd:function(){var e=this.tickMeter();return this.prefetchAd(),e&&!this.isAdReady()&&(o.logDebug("ad skipped due to no ad being delivered in time, refreshing slot"),this.refreshPosition(),e=!1),o.logDebug("shouldShowAd: "+e,this),e}});return r}),define("modules/carousel/gallery",["jquery","underscore","backbone","baseview","pubsub","utils","state","modules/global/taboola","meteredAdPosition","directAdPosition","adLogger","cookie"],function(e,t,i,s,n,a,o,r,l,h,d){var c=s.extend({events:{"click .gallery-actions-replay, .gallery-photo":"nextSlide","click .gallery-related-link":"taboolaClick"},selectors:{endSlate:".endslate",slides:".slide:not(.partner-placement)",hiddenWhileSurvey:".p402_hide"},endSlateTemplate:'<% _.each(data, function(item) { %><li class="gallery-related-item"><a class="gallery-related-link" data-taboola-type="<%= item.type %>" data-taboola-id="<%= item.id %>" data-taboola-response-id="<%=response_id%>"href="<%= item.url %>"><span class="taboola-image-crop"><img src="<%= item.thumbnail[0].url %>" class="taboola-related-img" alt="" /></span><%= item.name %></a><span class="gallery-related-date"><%= item.created %></span></li><% }); %>',initialize:function(i){t.bindAll(this,"_showEndslate","setAdSize","beforeAdRender"),i=e.extend({ads:!0,slideTransition:0,imageLazySrcAttr:"data-src",lookAheadAmount:2,transitionSlides:null},i),this.index=i.index,s.prototype.initialize.call(this,i),this.adCount=0,this.googleSurveyNeeded=!1,a.getNested(window.site_vars,"ADS","GALLERY","SURVEY")&&(this.googleSurveyNeeded=!0),this._initializeAds(),this.endSlateBuilt=!1,this.isRotating=!1,this.galleryThumbnails=this.$(".gallery-thumbs")},destroy:function(){e.cookie("GoogleSurveyDropped")&&(e.cookie("GoogleSurveyDropped",""),0!==this.$el.parent(".p402_premium").length&&this.$el.unwrap(),e("#contain-402").remove()),this._destroySurveyCallback(),s.prototype.destroy.call(this)},_initializeAds:function(){var e,t,i,s,n,a;this.options.ads&&(this.galleryData=this.$el.data()||{},this.setAdCount(),e=this.getAdTargeting(),this.$sponsorshipAd=this.$(".snapshot-sponsor"),this.$sponsorshipAd.length&&(a=this._getSlideIn(this.index).data("qqid"),e.snapshotid=a,this.subviews.sponsorshipAd=new h({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/snapshots",adSizes:["sponsor_logo"],targeting:e})),this.$viewport=this.$(".viewport"),i=this.$viewport.width(),t=this.$viewport.height(),n=o.getActivePageInfo().excludeTransitionAd,450>t||600>i?d.logWarn("Advertisement viewport is too small: "+i+"x"+t):n||(this.$adSlide=this.$(".partner-slide-ad"),this.$adContents=this.$(".partner-slide-ad .gallery-photo-border"),s=null,"snapshot"===this.galleryData.galleryId&&(s="transition_snapshot"),this.subviews.ad=new l({el:this.$adContents,adPlacement:"transition_gallery/"+this.galleryData.cst,adSizes:["elastic"],beforeAdRender:this.beforeAdRender,meterThreshold:s,rateMeterId:"gallery_"+this.galleryData.galleryId,targeting:e})))},setAdCount:function(){this.adCount++},getAdTargeting:function(){return{pageType:this.galleryData.basePageType,contentid:this.galleryData.galleryId,sitePage:"usat/"+(this.galleryData.ssts||"").replace(/\/\/*$/,""),series:this.galleryData.series,topic:this.galleryData.topic,count:this.adCount,surveyCookie:""+(e.cookie("GoogleSurveyTaken")||!1),surveyOn:this.googleSurveyNeeded.toString()}},completedSurvey:function(){if(e.cookie("GoogleSurveyTaken","true",{expires:1}),e.cookie("GoogleSurveyDropped",""),this.isRotating)this.options.carousel.autoplay();else{var t=this.options.carousel.subviews.controls.selectors,i=!!e(t.nextArrow).attr("data-lastClicked"),s="none"==e(t.prevArrow).css("display"),n=-1;(i||s)&&(n=1),this.options.carousel.switchSlide(null,n)}var a=this.options.carousel.subviews.controls.$el;a.find(this.selectors.hiddenWhileSurvey).css("display","block"),this._destroySurveyCallback()},_destroySurveyCallback:function(){if(window.USATGoogleSurvey){window.USATGoogleSurvey=void 0;try{delete window.USATGoogleSurvey}catch(e){}}},render:function(){this._loadImage(this.$$(this.selectors.slides).eq(this.index))},taboolaClick:function(t){if(!this.$overrideTaboola){var i=e(t.currentTarget);r.prototype.registerTaboolaClick(i.attr("data-taboola-id"),i.attr("data-taboola-type"),i.attr("data-taboola-response-id"),"end-slate")}},nextSlide:function(e){e.preventDefault(),this.options.carousel.switchSlide(null,1)},_buildEndslate:function(){var e=this.$(".gallery-endslate-related"),t=this.options.endslateOptions,i=[];if(this.endSlateBuilt=!0,t&&t.overrideTaboola){{t.currentGallery}i=t.endslateGalleries.join("-"),this.$(".override_taboola").hide(),o.fetchData("/picture-gallery/"+i+"/").done(function(t){e.html(t)},this)}else{var s=window.location.href;this.$el.hasClass("hasendslate")&&this.$el.data("gallery-id")&&(s=window.location.protocol+"//"+window.location.host+"/picture-gallery/"+this.$el.data("gallery-id")+"/");var n=new r;this.$$(this.selectors.endSlate).addClass("loading"),n.getRelated(this._showEndslate,"photo","photo",4,s,this.$el.data("gallery-id"))}},_showEndslate:function(e){{var i=this.$$(this.selectors.endSlate).removeClass("loading");i.find(".gallery-endslate-related").attr("data-media-url")||""}if(t.each(e.list,function(e){e.thumbnail[0].url.indexOf("images.taboola.com")>-1&&(e.thumbnail[0].url=decodeURIComponent((e.thumbnail[0].url+"").replace(/\+/g,"%20")),e.thumbnail[0].url=e.thumbnail[0].url.replace("http://images.taboola.com/taboola/image/fetch/f_jpg,q_80,c_fill,g_face,e_sharpen/",""))}),1===i.length){var s=t.template(this.endSlateTemplate,{data:e.list,response_id:e.id});i.find(".gallery-endslate-related").html(s)}},goToSlide:function(t){var i=this._getSlideOut(),s=this._getSlideIn(t);return s.length?(this.index=t,n.trigger("carousel:switchSlide"),this.options.triggerAdRefresh&&n.trigger("carousel:refreshAd"),this._switchSlides(s,i)):e.Deferred().reject()},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(){var i=this._getSlideOut();return this.showingAd=this.$adSlide,i[0]!==this.showingAd[0]?(this.$sponsorshipAd&&this.$sponsorshipAd.hide(),this._switchSlides(this.showingAd,i).done(t.bind(function(){if(e.cookie("GoogleSurveyDropped")+""=="true"){var t=this.options.carousel.subviews.controls.$el,i=this.selectors.hiddenWhileSurvey.substr(1);t.find(".media-playlist").wrap('<div class="'+i+'"></div>'),this.options.carousel.playTimer&&(this.isRotating=!0,this.options.carousel._stopCarouselRotate())}this.subviews.ad.playAd(),this.hideThumbnails()},this))):e.Deferred().reject()},hideThumbnails:function(){this.galleryThumbnails.hide()},showThumbnails:function(){this.galleryThumbnails.show()},_transitionSlides:function(e,i){var s=this.options.slideTransition;if(this.options.transitionSlides){var n=this.$$(this.selectors.slides);return this.options.transitionSlides(n.index(e),n.index(i))}return i.css({opacity:1}),this.animate(i,"opacity",0,s,"ease-in-out").then(t.bind(function(){return this._fadeInSlide(e,s).done(t.bind(function(){i.css({visibility:"hidden",opacity:0})},this))},this))},_switchSlides:function(e,i){return i===this.showingAd&&(this.subviews.ad.stopAd(),this.showThumbnails()),this._transitionSlides(e,i).then(t.bind(function(){if(i.removeClass("active"),i===this.showingAd){this.setAdCount();var t=this.getAdTargeting();this.subviews.ad.setTargeting(t),this.subviews.ad.refreshPosition(),this.showingAd=null}e!==this.showingAd&&this.$sponsorshipAd&&this.$sponsorshipAd.length&&this.refreshSponsorshipAd(e.data("qqid"))},this))},refreshSponsorshipAd:function(e){var t=this.getAdTargeting();t.snapshotid=e,this.subviews.sponsorshipAd.setTargeting(t),this.subviews.sponsorshipAd.refreshPosition()},_getSlideOut:function(){var e;return e=this.showingAd?this.showingAd:this.$$(this.selectors.slides).eq(this.index)},_getSlideIn:function(e){var t;return t=this.$$(this.selectors.slides).eq(e),this._loadImage(t,this.index>e),!this.endSlateBuilt&&t.hasClass("endslate")&&this._buildEndslate(),t},_loadImage:function(e,t){var i=this.options.lookAheadAmount;do this._fetchImage(e.find("img")),i--,e=t?e.prev():e.next();while(i>=0&&e.length>0)},_fetchImage:function(e){if(e.length>0&&a.lazyLoadImage(e,this.options.imageLazySrcAttr)){var i=e.parent();i.addClass("loading"),e.load(t.bind(function(){i.removeClass("loading"),this._resizeMeta(e)},this))}},_fadeInSlide:function(e,t){return e.css({visibility:"visible","z-index":1}),e.addClass("active"),this._resizeMeta(e.find(".gallery-photo")),this.animate(e,"opacity",1,t,"ease-in-out")},_resizeMeta:function(e){if(e.length){var t=this._getImageWidth(e);t&&e.parent().width(t)}},_getImageWidth:function(e){return e.width()},viewportResize:function(i,s){this.$(".active .gallery-photo").each(t.bind(function(t,i){this._resizeMeta(e(i))},this)),this.$adSlide&&this.subviews.ad&&(this.setAdSize(i,s),this.subviews.ad.resizeAd(i,s))},beforeAdRender:function(e){e.survey&&(window.USATGoogleSurvey={completedSurvey:t.bind(this.completedSurvey,this)}),this.setAdSize()},setAdSize:function(e,t){e=e||this.$viewport.outerWidth(),t=t||this.$viewport.outerHeight();var i=this.findSizeForAd(e,t);this.$adContents.removeClass("size-s size-m size-l size-xl").addClass(i.adSizeClass),this.subviews.ad.setInitialDimensions(e,t)},findSizeForAd:function(e,t){var i={adSizeClass:"size-s",marginTop:"5px"},s=450;return e>1080&&t>810?(i.adSizeClass="size-xl",s=810):e>936&&t>700?(i.adSizeClass="size-l",s=700):e>768&&t>576&&(i.adSizeClass="size-m",s=576),i.marginTop=(t-s)/2+"px",i}});return c}),define("modules/myCapture/myCapture",["jquery","underscore","baseview","pubsub"],function(e,t,i,s){"use strict";var n=i.extend({events:{"click .js-mycapture-btn":"mycaptureBtnClick"},initialize:function(e){i.prototype.initialize.call(this,e)},mycaptureBtnClick:function(t){t.preventDefault(),s.trigger("uotrack","mycapturepurchase");var i=e(t.currentTarget.parentElement).parent(),n=location.host.split(".").slice(-2)[0],a=".mycapture.com/mycapture/remoteimage.asp?",o=i.parent().find("img").attr("data-mycapture-src"),r={image:o,caption:e.trim(i.find(".js-caption").text()),credit:e.trim(i.find(".credit").text()),backtext:"Back to Site",backurl:location.href},l="http://"+n+a+e.param(r);
window.open(l,"mycapture")},switchMyCaptureBtn:function(e){var t=e.$(".single-photo"),i=t.find(".js-mycapture-btn-small"),s=t.find(".js-mycapture-btn"),n=e.$(".js-caption-wrapper");t.hasClass("expandable-collapsed")?(i.hide(),s.show(),n.addClass("expandable-photo-caption-with-mycapture")):(s.hide(),i.show(),n.removeClass("expandable-photo-caption-with-mycapture"))},toggleSmallTag:function(e){this.$(".mycapture-small-btn").toggle(e)}});return n}),define("modules/carousel/controls",["jquery","underscore","backbone","baseview","modules/myCapture/myCapture","pubsub","utils"],function(e,t,i,s,n,a,o){var r=s.extend({events:{"click .slide-nav":"switchSlide","click .autoplay":"autoplay","click .thumbnails":"thumbsToggle","click .captions":"captionsToggle",mouseenter:"mouseover",mouseleave:"mouseout","click .fullscreen":"launchFullscreen"},selectors:{allCaptions:".meta",captionBtnLabel:".captionLabel",nextArrow:".slide-nav.next",playBtn:".playbtn",prevArrow:".slide-nav.prev",thumbsBtnLabel:".thumbLabel",thumbsWrapper:".thumbs",ticker:".ticker",viewport:".viewport",activeSlide:".gallery-viewport-slide.active"},initialize:function(t){t=e.extend({index:0,hoverShowControls:!0,interactionDemo:!0,interactionShowDelay:600,interactionHideDelay:3600,totalImages:0,totalSlides:0},t),this.index=t.index,s.prototype.initialize.call(this,t),o.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&this.setupMyCapture()},render:function(){this.updateTicker(),this.updateNextPrevArrows(this.index),this.options.interactionDemo&&this.startInteractionDemo()},destroy:function(e){this.clearUserInteractionDemo(),s.prototype.destroy.call(this,e)},setupMyCapture:function(){this.subviews.mycapture=new n({el:this.$el})},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget),s=i.hasClass("prev");if(i.attr("data-lastClicked","true").siblings(".slide-nav").removeAttr("data-lastClicked"),s?this.options.carousel.switchSlide(null,-1,!1):this.options.carousel.switchSlide(null,1,!1),this.subviews.mycapture){var n=this.$(this.selectors.allCaptions).hasClass("on");this.subviews.mycapture.toggleSmallTag(!n)}},autoplay:function(e){e.preventDefault(),this.options.carousel.autoplay()},startInteractionDemo:function(){var e=this;this.uxTimeout1=setTimeout(function(){e.$el.addClass("hover")},this.options.interactionShowDelay),this.uxTimeout2=setTimeout(function(){e.$el.removeClass("hover")},this.options.interactionHideDelay)},clearUserInteractionDemo:function(){clearTimeout(this.uxTimeout1),clearTimeout(this.uxTimeout2)},mouseover:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).addClass("hover"),this.$el.addClass("hover"),this.clearUserInteractionDemo()},mouseout:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).removeClass("hover"),this.$el.removeClass("hover")},launchFullscreen:function(e){e.preventDefault(),a.trigger("openFullScreenCarousel",{carousel:this,fullScreen:!0,parent:this.$el})},captionsToggle:function(e){var t=this.$$(this.selectors.allCaptions),i=this.$$(this.selectors.captionBtnLabel);e.preventDefault(),t.hasClass("on")?(t.removeClass("on"),i.html("Show Captions")):(t.addClass("on"),i.html("Hide Captions")),this.subviews.mycapture&&this.subviews.mycapture.toggleSmallTag(!t.hasClass("on"))},thumbsToggle:function(e){var t=this.$$(this.selectors.thumbsBtnLabel),i=this.$$(this.selectors.thumbsWrapper);e.preventDefault(),i.hasClass("on")?(i.removeClass("on"),t.html("Show Thumbnails"),this.options.carousel.toggleThumbnail(!1)):(i.addClass("on"),t.html("Hide Thumbnails"),this.options.carousel.toggleThumbnail(!0))},updateNextPrevArrows:function(e){var t=this.$$(this.selectors.prevArrow),i=this.$$(this.selectors.nextArrow);0===e?t.hide():t.show(),e<this.options.totalSlides-1?i.show():i.hide()},updateTicker:function(){var e=this.$$(this.selectors.ticker);e.length&&(e.css(this.index<this.options.totalImages?{visibility:"visible"}:{visibility:"hidden"}),e.html("<b>"+(this.index+1)+"</b> of <b>"+this.options.totalImages+"</b>"))},goToSlide:function(e){this.index=e,this.updateNextPrevArrows(e),this.updateTicker()},onPlay:function(){this.$$(this.selectors.playBtn).addClass("pause").text("Pause")},onStop:function(){this.$$(this.selectors.playBtn).removeClass("pause").text("Autoplay")}});return r}),function(e){"function"==typeof define&&define.amd?define("mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var o=t||window.event,r=l.call(arguments,1),h=0,c=0,u=0,p=0,f=0,g=0;if(t=e.event.fix(o),t.type="mousewheel","detail"in o&&(u=-1*o.detail),"wheelDelta"in o&&(u=o.wheelDelta),"wheelDeltaY"in o&&(u=o.wheelDeltaY),"wheelDeltaX"in o&&(c=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(c=-1*u,u=0),h=0===u?c:u,"deltaY"in o&&(u=-1*o.deltaY,h=u),"deltaX"in o&&(c=o.deltaX,0===u&&(h=-1*c)),0!==u||0!==c){if(1===o.deltaMode){var m=e.data(this,"mousewheel-line-height");h*=m,u*=m,c*=m}else if(2===o.deltaMode){var v=e.data(this,"mousewheel-page-height");h*=v,u*=v,c*=v}if(p=Math.max(Math.abs(u),Math.abs(c)),(!a||a>p)&&(a=p,s(o,p)&&(a/=40)),s(o,p)&&(h/=40,c/=40,u/=40),h=Math[h>=1?"floor":"ceil"](h/a),c=Math[c>=1?"floor":"ceil"](c/a),u=Math[u>=1?"floor":"ceil"](u/a),d.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,g=t.clientY-b.top}return t.deltaX=c,t.deltaY=u,t.deltaFactor=a,t.offsetX=f,t.offsetY=g,t.deltaMode=0,r.unshift(t,h,c,u),n&&clearTimeout(n),n=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function i(){a=null}function s(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,a,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var h=o.length;h;)e.event.fixHooks[o[--h]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),s=i["offsetParent"in e.fn?"offsetParent":"parent"]();return s.length||(s=e("body")),parseInt(s.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("modules/scroller/base-scroll",["jquery","underscore","backbone","baseview","pubsub","utils","mousewheel"],function(e,t,i,s,n,a){var o=s.extend({events:{mousewheel:"handleMouseWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onTouchStart","mousedown .scrolldragger":"onDraggerMouseDown","mouseenter .scrolldragger":"onDraggerMouseOver","mouseleave .scrolldragger":"onDraggerMouseOut","mousedown .scrollbar":"onBarClick"},removeActiveDelay:300,initialize:function(i){i=e.extend({disabled:!1,contentClass:".scrollable-content",lockPageScroll:!0,delayScroll:!1,minDraggerSize:40,template:null},i),t.bindAll(this,"onDraggerMouseUp","onDraggerMouseMove","onTouchMove","onTouchStop","_setMouseInHouse","_clearMouseInHouse"),this.content=this.$(i.contentClass),this.bar=e(i.template).hide(),this.bar.addClass("scrollbar"),this.dragger=this.bar.find(".scrolldragger"),this.body=a.get("body"),this.$el.append(this.bar),this.isMouseDown=!1,this.isMouseOver=!1,this.draggerOffset=0,s.prototype.initialize.call(this,i),this.refresh()},bindEvents:function(){this.delegateEvents()},unbindEvents:function(e){e||this.undelegateEvents(),this.body.off("."+this.cid),clearInterval(this.accelerationTimer),clearTimeout(this.enterDelay),clearTimeout(this.leaveDelay)},refresh:function(){if(this.content=this.$(this.options.contentClass),!this.options.disabled&&0!==this.content.length)if(this.viewportSize=this.getViewportSize(),this.contentSize=this.getContentSize(),this.contentViewportRatio=this.viewportSize/this.contentSize,this.contentViewportRatio<1){var e=this._calculateDraggerSize(this.viewportSize,this.contentViewportRatio,this.contentSize);this.draggerSize=this._setDraggerSize(e),this.active||(this.bar.show(),this.bindEvents(),this.active=!0,this.origPosition&&this.moveContentToPosition(this.origPosition.left,this.origPosition.top)),this.shiftContent(0,0)}else this.active&&(this.origPosition=this.content.position(),this.moveContentToPosition(0,0),this.bar.hide(),this.unbindEvents(),this.active=!1)},_calculateDraggerSize:function(e,t,i){var s=Math.round(e*t);if(s<this.options.minDraggerSize){var n=i-e,a=e-this.options.minDraggerSize;this.contentViewportRatio=a/n,s=this.options.minDraggerSize}return s},onTouchStart:function(e){var t=e.originalEvent.touches;t.length>1||this.options.disabled||!this.active||(clearInterval(this.accelerationTimer),this.touchX=t[0].pageX,this.touchY=t[0].pageY,this.touchVectorX=0,this.touchVectorY=0,this.touchDragStarted=!1,this.touchLastMove=(new Date).getTime(),this.body.on("touchend."+this.cid,this.onTouchStop),this.body.on("touchcancel."+this.cid,this.onTouchStop),this.body.on("touchmove."+this.cid,this.onTouchMove))},onTouchStop:function(e){if(0===e.originalEvent.touches.length&&(this.body.off("."+this.cid),this.touchDragStarted)){var t=(new Date).getTime(),i=t-this.touchLastMove;return e.preventDefault(),100>i&&this._triggerScrollingDecelerate(this.touchVectorX,this.touchVectorY,1500),!1}},_triggerScrollingDecelerate:function(e,i,s){var n=(new Date).getTime(),a=n+s,o=n,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame,l=t.bind(function(){var t=(new Date).getTime(),h=t-o;o=t,a>t&&r(l),t-=n;var d=this._adjustVelocityVector(e,t,s),c=this._adjustVelocityVector(i,t,s);this.shiftContent(d*h,c*h)},this);this.accelerationTimer=r(l)},_adjustVelocityVector:function(e,t,i){return e*Math.pow(1-t/i,3)},onTouchMove:function(e){if(1===e.originalEvent.touches.length){var t=e.originalEvent.touches,i=t[0].pageX-this.touchX,s=t[0].pageY-this.touchY;if(this.touchDragStarted||Math.abs(i)>10||Math.abs(s)>10){var n=(new Date).getTime();this.touchDragStarted=!0,this.touchX=t[0].pageX,this.touchVectorX=i/(n-this.touchLastMove),this.touchY=t[0].pageY,this.touchVectorY=s/(n-this.touchLastMove),this.touchLastMove=(new Date).getTime(),this.shiftContent(i,s)===!1&&e.preventDefault()}}},onBarClick:function(e){if(1===e.which&&!e.isDefaultPrevented()){e.preventDefault();var t=this.bar.offset(),i=e.pageX-t.left-this.draggerSize/2,s=e.pageY-t.top-this.draggerSize/2;this.moveDraggerToPosition(i,s),this.onDraggerMouseOver(e),this.onDraggerMouseDown(e)}},onDraggerMouseDown:function(e){if(1===e.which){this.isMouseDown=!0,e.preventDefault(),this.body.on("mousemove."+this.cid,this.onDraggerMouseMove),this.body.on("mouseup."+this.cid,this.onDraggerMouseUp);var t=this.dragger.offset();this.draggerClickOffset={left:e.pageX-t.left,top:e.pageY-t.top}}},onDraggerMouseUp:function(e){1===e.which&&(e.preventDefault(),this.isMouseDown=!1,this.body.off("."+this.cid),this.isMouseOver||this.dragger.removeClass("hover"))},onDraggerMouseMove:function(e){if(this.isMouseDown){var t=this.bar.offset(),i=e.pageX-t.left-this.draggerClickOffset.left,s=e.pageY-t.top-this.draggerClickOffset.top;this.moveDraggerToPosition(i,s)}},onDraggerMouseOver:function(){this.isMouseOver=!0,this.dragger.addClass("hover")},onDraggerMouseOut:function(){this.isMouseOver=!1,this.isMouseDown||this.dragger.removeClass("hover")},onMouseEnter:function(){clearTimeout(this.leaveDelay),this.enterDelay=setTimeout(this._setMouseInHouse,300)},onMouseLeave:function(){clearTimeout(this.enterDelay),this.leaveDelay=setTimeout(this._clearMouseInHouse,300)},_setMouseInHouse:function(){this.isMouseInTheHouse=!0},_clearMouseInHouse:function(){this.isMouseInTheHouse=!1},handleMouseWheel:function(e){if(!this.isMouseDown&&this.active&&(!this.options.delayScroll||this.isMouseInTheHouse)){var t=e.deltaY*e.deltaFactor,i=-1*e.deltaX*e.deltaFactor||t;this.shiftContent(i,t)===!1&&e.preventDefault()}},shiftContent:function(e,t){var i=this.content.position(),s=this.content.parent(),n=i.left+e-(parseInt(s.css("padding-left"),10)||0)-(parseInt(s.css("margin-left"),10)||0),a=i.top+t-(parseInt(s.css("padding-top"),10)||0)-(parseInt(s.css("margin-top"),10)||0);return this.moveContentToPosition(n,a)?!1:this.options.lockPageScroll?!1:void 0},destroy:function(){this.unbindEvents(!0),this.bar.remove(),s.prototype.destroy.apply(this,arguments)},moveDraggerToPosition:function(){},moveContentToPosition:function(){},scrollToElement:function(){},animateContentToPosition:function(){},getViewportSize:function(){return 0},getContentSize:function(){return 0},_setDraggerSize:function(e){return e}});return o}),define("modules/scroller/horizontal-scroll",["jquery","underscore","modules/scroller/base-scroll"],function(e,t,i){var s=i.extend({initialize:function(s){s=e.extend({color:"light",draggerPaddingLeft:0,draggerPaddingRight:2,delayScroll:!0},s);var n=t.template('<div class="horizontal-scroll ui-<%= color %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');s.template=n({color:s.color}),this.$(".horizontal-scroll").remove(),i.prototype.initialize.call(this,s)},getViewportSize:function(){return this.$el.width()},getContentSize:function(){return this.content.width()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingLeft+this.options.draggerPaddingRight,this.dragger.css({width:e}),e},animateContentToPosition:function(i,s,n,a){var o=this.viewportSize-this.contentSize,r=Math.max(o,Math.min(i,0));return a=a||"ease-out",e.when(this.animate(this.dragger,"left",-1*r*this.contentViewportRatio+"px",n||0,a),this.animate(this.content,"left",r+"px",n,a)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/o])},this))},scrollToElement:function(e,t,i,s){var n,a=e.outerWidth(),o=e.position().left+e.parent().position().left,r=o+a;if(0>o){var l=this.getViewportSize();n=t?o+(a-l):o}else r>this.getViewportSize()&&(n=t?o:o+(a-this.getViewportSize()));if(n){var h=this.content.position().left-n;this.animateContentToPosition(h,0,i,s)}},moveContentToPosition:function(e){if(!this.active)return!1;var t=Math.min(this.viewportSize-this.contentSize,0),i=Math.max(t,Math.min(e,0));return this._positionDragger(-1*i*this.contentViewportRatio),this._positionContent(i),this.$el.trigger("scrollBarUpdate",[i/t]),i===e},moveDraggerToPosition:function(e){if(!this.active)return!1;var t=this.viewportSize-(this.draggerSize+this.options.draggerPaddingRight+this.options.draggerPaddingLeft),i=Math.max(0,Math.min(e,t));return this._positionDragger(i),this._positionContent(-1*i/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",i/t),i===e},_positionDragger:function(e){e+=this.options.draggerPaddingLeft,e=Math.round(e),this.dragger.css({left:e})},_positionContent:function(e){e=Math.round(e),this.content.css({left:e})}});return s}),define("modules/carousel/thumbs",["jquery","underscore","backbone","baseview","pubsub","utils","modules/scroller/horizontal-scroll"],function(e,t,i,s,n,a,o){var r=s.extend({events:{"mouseenter li":"thumbMouseover","mouseleave li":"thumbMouseout","click li":"switchSlide"},selectors:{thumbs:"li"},initialize:function(t){t=e.extend({hoverTransition:0},t),this.index=t.index,s.prototype.initialize.call(this,t),this.subviews.scrollbar=new o({el:this.$el,color:this.options.scrollerColor,padding:2})},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget).index();this.options.carousel.switchSlide(i)},showAd:function(){var e=this.$$(this.selectors.thumbs);e.eq(this.index).removeClass("active")},thumbMouseover:function(i){var s=i.currentTarget;this.options.hoverTransition&&(this.hoverTimeout=setTimeout(t.bind(function(){this.hoverTimeout=null,this.options.carousel.switchSlide(e(s).index(),null,!0)},this),this.options.hoverTransition))},thumbMouseout:function(){this.options.hoverTransition&&this.hoverTimeout&&clearTimeout(this.hoverTimeout)},goToSlide:function(e){var t=this.$$(this.selectors.thumbs),i=t.eq(e);t.eq(this.index).removeClass("active"),i.addClass("active"),this.index=e,i.length&&this.subviews.scrollbar.scrollToElement(i,!1,300)},viewportResize:function(){this.subviews.scrollbar&&this.subviews.scrollbar.refresh()}});return r}),define("modules/partner/simple-ad",["jquery","underscore","baseview","state","sharedAdPosition","directAdPosition"],function(e,t,i,s,n,a){"use strict";var o=i.extend({initialize:function(n){t.bindAll(this,"onAdReady"),n=e.extend({adPlacement:"poster_front",adSizes:"mediumrectangle",pageInfo:s.getActivePageInfo(),onAdReady:this.onAdReady,isShared:!1},n),i.prototype.initialize.call(this,n)},_initAds:function(){var e=this.options,t=e.adSizes;t&&"string"==typeof t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:e.pageInfo,adSizes:t,onAdReady:this.onAdReady,adType:e.adType};e.isShared?(i.defaultPosition=!0,this.subviews.simpleAd=new n(i)):this.subviews.simpleAd=new a(i)},onAdReady:function(){this.subviews.simpleAd.show()}});return o}),define("modules/partner/companion-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adPlacement:"poster_gallery_companion"},t),i.prototype.initialize.call(this,t),this._initAds()},refresh:function(){this.subviews.simpleAd.refreshPosition()}});return s}),define("modules/carousel/companion",["jquery","underscore","baseview","modules/partner/companion-ad","utils"],function(e,t,i,s,n){"use strict";var a=i.extend({PROGRESSIVE_GALLERY_REFRESH_RATE:n.getNested(window.site_vars,"ADS","progressive_gallery_refresh_rate"),refreshCount:0,initialize:function(e){i.prototype.initialize.call(this,e),this.slides=e.slides,this.currentInfo=this.$(".pag-current-info"),this.subviews.ad=new s({el:this.$(".pag-ad"),adPlacement:"poster_gallery_companion"})},goToSlide:function(e){++this.refreshCount%this.PROGRESSIVE_GALLERY_REFRESH_RATE===0&&this.subviews.ad.refresh();var t=this.slides.eq(e),i=t.find(".pag-photo-info").html();this.currentInfo.html(i)}});return a}),define("modules/carousel/carousel",["jquery","underscore","backbone","baseview","pubsub","state","utils","modules/carousel/gallery","modules/carousel/controls","modules/carousel/thumbs","modules/carousel/companion"],function(e,t,i,s,n,a,o,r,l,h,d){var c=s.extend({events:{mouseenter:"mouseEnter"},selectors:{slides:".slide:not(.partner-placement)",images:".slide:not(.partner-placement,.endslate)",companion:".pag-companion-wrapper"},initialize:function(i){i=e.extend({ads:!0,slideTransition:0,hoverShowControls:!0,hoverTransition:0,interactionDemo:!0,linkPath:null,rotate:!1,controlsSelector:null,gallerySelector:null,thumbsSelector:".thumbs",imageLazySrcAttr:"data-src",scrollerColor:"light",rotateInterval:3e3,autostart:!1},i),t.bindAll(this,"rotateCarousel"),this.index=this.$(".slide.active").index(),-1===this.index&&(this.index=0),this.linkPath=i.linkPath?i.linkPath:"",this.playTimer=null,this.subviews={},this.triggerAdRefresh=0===this.$$(this.selectors.companion).length,this._initializeGallery(i.imageLazySrcAttr,i.slideTransition,i.ads,i.gallerySelector,this.triggerAdRefresh,i.endslateOptions),this._initializeControls(i.hoverShowControls,i.interactionDemo,i.controlsSelector),this._initializeThumbs(i.hoverTransition,i.scrollerColor,i.thumbsSelector),this._initializeCompanion(this.selectors.slides),this.pubSub={"carousel:stoptimer":this.stoptimer,"carousel:starttimer":this.resumeAutoPlay},s.prototype.initialize.call(this,i),i.autostart&&this._startCarouselRotate()},_initializeCompanion:function(e){this.$$(this.selectors.companion).each(t.bind(function(t,i){this.subviews.companion=new d({el:i,slides:this.$$(e)})},this))},_initializeGallery:function(e,t,i,s,n,a){this.subviews.gallery=new r({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:e,slideTransition:t,carousel:this,triggerAdRefresh:n,endslateOptions:a})},_initializeControls:function(e,t,i){var s=this.$(this.selectors.images),n=this.$$(this.selectors.slides);this.subviews.controls=new l({el:i?this.$(i):this.$el,hoverShowControls:e,interactionDemo:t,index:this.index,totalSlides:n.length,totalImages:s.length,carousel:this}),this.subviews.controls.render()},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new h({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},mouseEnter:function(){this.options.autostart&&this._stopCarouselRotate()},rotateCarousel:function(){var e=this.$$(this.selectors.slides).length-1;this.switchSlide(null,1,!0),this.index!==e||this.options.rotate||this._stopCarouselRotate()},destroy:function(e){this.playTimer&&this._stopCarouselRotate(),s.prototype.destroy.call(this,e)},stoptimer:function(){clearInterval(this.playTimer),this.playTimer=null},switchSlide:function(e,t,i){var s=this.$$(this.selectors.slides).length;if(!this.showingAd&&this.subviews.gallery.shouldShowAd())return this.showingAd=!0,this.slideAdStep=t,void this.triggerEvent("showAd");if(t){this.slideAdStep&&this.slideAdStep!==t&&(t+=this.slideAdStep);var n=this.index+t;e=0>n?s-1:n>=s?0:n}else 0>e?e=0:e>=s&&(e=s-1);(this.index!==e||this.showingAd)&&(this.showingAd=!1,this.slideAdStep=0,this.index=e,this.triggerEvent("goToSlide",e),i||this._trackSlideChange())},_trackSlideChange:function(){var t;t=this.$el.hasClass("galleries")?this.$el:this.$(".galleries");var i=t.attr("data-gallery-id"),s=(t.attr("data-gal-pageurl")||"").replace(/^.*\/\/[^\/]+/,""),o=a.getActivePageInfo().contenttype;o?-1===o.indexOf("gallery")&&(o=e.trim(o)+" gallery"):o="galleries";var r={gallery_id:i,gallery_title:t.attr("data-title"),gallery_index:this.index+1,slide_id:t.find(".slide.active img").attr("data-id"),ssts:t.attr("data-ssts"),cst:(t.attr("data-cst")||"bugpages").replace(/\/+$/,""),contenttype:"snapshot"===i?"snapshot":o,pathName:""===s?this.linkPath:s};n.trigger("slide:change",r),e.ajax({url:window.site_static_path+"html/comscorepvcandidate.xml",cache:!1})},autoplay:function(){this.playTimer?this._stopCarouselRotate():this._startCarouselRotate(!0)},_startCarouselRotate:function(e){0===this.options.rotateInterval?this.stoptimer():this.playTimer=setInterval(this.rotateCarousel,this.options.rotateInterval),e&&this.rotateCarousel(),this.triggerEvent("onPlay")},_stopCarouselRotate:function(){this.stoptimer(),this.options.autostart=!1,this.triggerEvent("onStop")},resumeAutoPlay:function(){this.options.autostart&&!this.playTimer&&this._startCarouselRotate()},toggleThumbnail:function(){this.triggerEvent("viewportResize")},viewportResize:function(){this.triggerEvent("viewportResize")}});return c}),define("modules/carousel/carousel-autosize",["jquery","underscore","backbone","baseview","utils","modules/carousel/carousel"],function(e,t,i,s,n,a){var o=a.extend({initialize:function(i){t.bindAll(this,"handleResizeWindow"),this.options=e.extend({hoverShowControls:!1,verticalAdjust:80,interactionDemo:!1,horizontalAdjust:0,thumbSize:84,imageLazySrcAttr:"data-large-src"},i),this.$win=n.get("win"),this.$el.hasClass("galleries")?this.$el.addClass("autosize"):this.$(".galleries").addClass("autosize");var s=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,s),this.handleResizeWindow(),a.prototype.initialize.call(this,this.options),this.subviews.gallery.render()},destroy:function(e){this.$win.off("."+this.cid),a.prototype.destroy.call(this,e)},handleResizeWindow:function(){this.windowHeight=this.$win.height(),this.windowWidth=this.$win.width(),this.viewportResize()},viewportResize:function(){var e=this.windowHeight-this.options.verticalAdjust;this.showThumbs&&(e-=this.options.thumbSize),this.$$(".viewport").height(e),this.triggerEvent("viewportResize",this.windowWidth-this.options.horizontalAdjust,e)},toggleThumbnail:function(e){this.showThumbs=e,this.viewportResize()}});return o}),define("modules/videos/video-transcript",["jquery","underscore","baseview","state","pubsub"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"click .video-transcript-caption":"onClickVideoSeek","click .video-transcript-keywordresult":"onClickkeyword","keydown .video-search-input":"onKeyDown","click .ui-ramp-transcriptplus":"onClickTranscriptSlide","click .toggle-transcript":"onClickTranscriptSlide","click .video-search-btn":"onClickVideoSearch","click .video-search-close-btn":"onClickSearchCloseBtn","click .transcript-navigate-next-active":"nextslide","click .transcript-navigate-prev-active":"prevslide","mouseenter .video-full-transcript-text":"toggleautoscroll","mouseleave .video-full-transcript-text":"toggleautoscroll"},initialize:function(t){var s=e.extend(!0,{animations:{useCSSTransitions:!1}},t);i.prototype.initialize.call(this,s),this.currentplayer=this.options.player||{},this.$viewport=this.$(".keywords-viewport"),this.$searchViewport=this.$(".search-viewport"),this.$keywordWindow=this.$(".video-keywords-result"),this.$searchWindow=this.$(".video-search-result"),this.initializeTranscript(),this.$searchinput=this.$(".video-search-input"),this.$keywords=this.$(".video-transcript-keywords"),this.$search=this.$(".video-transcript-search"),this.$searchresults=this.$(".video-search-display"),this.$searchCancelBtn=this.$(".video-search-close-btn"),this.$search.hide(),this._currentSlideCount=1,this.autoscroll=!0},onClickVideoSearch:function(t){this.$currentcaption.blur();var i,s;this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows();var n=this.$searchinput.val().toLowerCase(),a=new RegExp("\\b"+n+"\\b"),o=n.split(" ");if(0!==n.length){var r=this.$videotranscriptmain.filter(function(){return e(this).text().toLowerCase().search(a)>-1});if(2==o.length){var l=this.$videotranscriptmain.filter(function(){var t=e(this),i=e.trim(t.text().toLowerCase()).split(" ");if(i[i.length-1]==o[0]){var s=e.trim(t.next().text().toLowerCase()).split(" ");return s[0]==o[1]}return!1});l.length>0&&(r=r.add(l))}if(0===r.length&&"undefined"!=typeof t&&t.currentTarget.getAttribute("data-startoffset")&&(r=r.add(e(t.currentTarget))),this.trackclicks(this.$searchinput.data().track),this.$keywords.hide(),this.$search.show(),this.$searchOpen=this.$(".transcript-search-input"),this.$searchOpen.removeClass("video-search-open-button"),this.$searchCancelBtn.addClass("video-search-close-btn-visible"),this.$searchresults.addClass("show-results"),0!==r.length){this.$searchresults.append("<span class='video-search-term'>"+n+"</span> found at");for(var h=0;h<r.length;h++)i=r[h].getAttribute("data-startoffset"),s=r[h].getAttribute("data-startoffset_display"),this.$searchWindow.append("<span class='video-transcript-caption transcript-search-result' data-track='searchclick' data-startoffset="+i+">"+s+"</span>")}else this.$searchresults.append("<span class='no-results'>No results found for <span class='video-search-term'>\""+n+'"</span></span>')}this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&(this.$searchresults.empty(),this.$searchWindow.empty(),this.onClickVideoSearch(e))},onClickSearchCloseBtn:function(){this.$searchCancelBtn.removeClass("video-search-close-btn-visible"),this.$searchOpen.addClass("video-search-open-button"),this.$searchresults.removeClass("show-results"),this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows(),this.$searchWindow.css("left","auto"),this.$keywordWindow.css("left","auto"),this.$searchinput.val(""),this.$search.hide(),this.$keywords.show(),this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},togglesearch:function(e){var t=this.$(".video-full-transcript-control");e&&t.hasClass("searchcontroloff")?(t.removeClass("searchcontroloff"),this.trackclicks("open-search"),this.updateSlideCount(),this.loadActiveArrows()):(t.addClass("searchcontroloff"),this.trackclicks("close-search"))},isTranscriptAvailable:function(){return this.$videotranscriptmain.length>0},initializeTranscript:function(){this.$videotranscriptmain=this.$(".video-transcript-caption"),this.$currentcaption=e(this.$videotranscriptmain[0]),this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption),!this.options.player.hidesearchcontrol&&this.options.player.flashsearchcontrolOn&&(this.updateSlideCount(),this.loadActiveArrows())},loadActiveArrows:function(){this.$(".video-transcript-keywords").is(":visible")?!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$keywordWindow.width()>this.$viewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"):this.$search.is(":visible")&&!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$searchWindow.width()>this.$searchViewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active")},clearActiveArrows:function(){this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active"),this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active")},onClickVideoSeek:function(t){var i=e(t.currentTarget),s=i.data();this.trackclicks(s.track),this.options.seek&&this.options.seek(s.startoffset)},onClickkeyword:function(t){var i=e(t.currentTarget).text();this.$searchinput.val(e.trim(i)),this.onClickVideoSearch(t)},progressHighlight:function(e){this.$currentcaption&&e.position>parseFloat(this.$currentcaption.attr("data-startoffset"))+parseFloat(this.$currentcaption.attr("data-duration"))&&(this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption.next()))},clearHighlight:function(e){e.hasClass("active-transcript")&&e.removeClass("active-transcript")},toggleautoscroll:function(e){this.autoscroll="mouseenter"==e.type?!1:!0},transcriptautoscroll:function(e){if(this.autoscroll){var t=e.offsetTop-e.parentElement.offsetTop;this.$(".video-full-transcript-text").animate({scrollTop:t},1e3)}},addHighlight:function(e){e.length>0&&(this.transcriptautoscroll(e[0]),this.$currentcaption=e,this.$currentcaption.addClass("active-transcript"))},onStatusChange:function(i){if("mediaSeekNotify"===i.type){this.clearHighlight(this.$currentcaption);{t.find(this.$videotranscriptmain,function(t){var s=e(t);return i.position<s.data().startoffset+s.data().duration?(this.$currentcaption=s,this.addHighlight(s),!0):void 0},this)}}else"mediaBegin"===i.type&&i.media.referenceId.toString()!=this.options.video.id&&this.$el.hide()},onClickTranscriptSlide:function(){this.trackclicks("transcript"),this.$(".video-full-transcript-text").toggle("slow")},keywordSlide:function(e,t){return this.animate(e,"left",t+"px",250,"easeInOutQuad")},nextslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&e!=this.totalSlides&&(this.targetWindow=1==e?-1*this.slideWidth:this.slideWidth*e*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount+=1,this.$(".video-transcript-navigate-prev").addClass("transcript-navigate-prev-active")),this._currentSlideCount==this.totalSlides&&this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active")},prevslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&1!=e&&(this.targetWindow=this.slideWidth*(e-2)*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount-=1,this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"),1==this._currentSlideCount&&this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active"))
},getCurrentSlide:function(){return this._currentSlideCount},updateSlideCount:function(){var e,t;this.$(".video-transcript-keywords").is(":visible")?(e=this.$keywordWindow,t=e.width(),this.viewportWidth=this.$viewport.width()):this.$search.is(":visible")&&(e=this.$searchWindow,t=e.width(),this.viewportWidth=this.$searchViewport.width()),this.slideWidth=Math.floor(this.viewportWidth/2),t>this.viewportWidth/2&&(this.totalSlides=2*Math.ceil(t/this.viewportWidth))},trackclicks:function(e){n.trigger("uotrack","ramp"+this.currentplayer.name+e)}});return a}),define("modules/stories/taboola-recommendations",["jquery","underscore","baseview","state","managers/routemanager","utils","modules/global/taboola","pubsub"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({initialize:function(n){n=e.extend({videoResponse:{}},n),this.texttype=s.getActivePageInfo().texttype||"story",t.bindAll(this,"showTaboola","showNextRecommendation"),i.prototype.initialize.call(this,n),this.$endslate=this.$("#endslate-taboola-template"),this.$endslate_template=this.$(".video-endslate"),this.options.dontRenderMoreStories||this.render()},render:function(){var t;if("galleries"===this.texttype||-1!==this.texttype.indexOf("video")){if(0===this.$(".gallery-more .headline").length)if(this.subviews.taboola||(this.subviews.taboola=new o),"galleries"===this.texttype)this.subviews.taboola.getRelated(this.showTaboola,"photo","photo",null,null,s.getActivePageInfo().assetid);else{this.$video=this.$(".ui-video-data").html();var i=JSON.parse(this.$video);this.subviews.taboola.getRelated(this.showTaboola,"video","video",null,null,i.brightcove_id)}}else{if("interactive"!==this.texttype){var n=this.$(".double-wide"),a=this.$(".story-right-rail");if(!n.length)return;var r=n.position().top,l=n.height(),h=a.position().top+a.height()-r;h-50>l&&(t=!0)}e(".iframe-auto").length>0&&(t=!0),this.createTaboola(t)}},createTaboola:function(e){var t;e?(t={widget:[{mode:"verticalx8",container:"taboola-div-verticalx8"}]},this.$(".more-stories-wrap").addClass("vertical")):t=-1!==a.getPageUrl().indexOf("/sports/")||-1!==a.getPageUrl().indexOf("/gameon/")?{widget:[{mode:"grid-sports",container:"taboola-div-grid-2x4"}]}:{widget:[{mode:"grid-2x4",container:"taboola-div-grid-2x4"}]},this.subviews.taboola=new o(t)},showTaboola:function(e){var i=this.$("#more-galleries-template");if(1===i.length){var s=t.template(i.html(),{data:e.list});this.$(".headlines.gallery-more").append(s)}},renderEndslate:function(e,t){this.subviews.taboola||(this.subviews.taboola=new o),this.subviews.taboola.getRelated(this.showNextRecommendation,"video","video",1,e,t,!1)},showNextRecommendation:function(e){var i=decodeURIComponent(e.list[0].url.match(/\&redir\=(.+)/)[1]),n=i.replace(/^.*\/\/[^\/]+/,""),a=n.replace(/^\D+/g,"");s.fetchData("/videos/services/"+a).done(t.bind(function(t){t?(this.videoResponse=t,this.videoResponse.taboolaResponseId=e.id,this.video_media_url=decodeURIComponent(e.list[0].url.match(/\&redir\=(.+)/)[1]),this.temp_media_url="/media/cinematic/video/"+a):r.trigger("uotrack","taboola-no-recommendations")},this))},populateEndslate:function(i,s){this.$endslate_markup=i;var a=s,r="",l=3;if(this.subviews.taboola||(this.subviews.taboola=new o),this.videoResponse||(this.videoResponse=this.options.videoResponse),!e.isEmptyObject(this.videoResponse)){r=this.videoResponse.url.replace(/^.*\/\/[^\/]+/,""),this.$endslate=this.$endslate_markup.find("#endslate-taboola-template"),a&&(r=this.video_media_url.replace(/^.*\/\/[^\/]+/,""));var h=t.template(this.$endslate.html(),{data:this.videoResponse});this.$endslate_markup.append(h),this.showendslate(),this.subviews.taboola.registerTaboolaVisible(this.videoResponse.taboolaResponseId),this.$endslate_div=e(".next-video-data"),this.timer=setInterval(t.bind(function(){this.$endslate_markup.find(".counter").text("0"+l--),-1==l&&(clearInterval(this.timer),"video"==this.texttype||a?(this.refreshEndslate(),this.options.endCountdown?this.options.endCountdown():(this.subviews.taboola.registerTaboolaClick(this.videoResponse.brightcove_id,"video",this.videoResponse.taboolaResponseId),n.goTo(r))):"story"==this.texttype&&(this.refreshEndslate(),this.subviews.taboola.registerTaboolaClick(this.videoResponse.brightcove_id,"video",this.videoResponse.taboolaResponseId),this.options.playRecommendedVideo(this.videoResponse)))},this),1e3)}},showendslate:function(){this.$endslate_markup.addClass("video-endslate-active")},refreshEndslate:function(){this.$endslate_markup.removeClass("video-endslate-active"),this.$endslate_div.find(".next-video-thumbnail").empty(),this.$endslate_div.find(".next-video-title").empty(),this.$endslate_div.remove()},destroy:function(){clearInterval(this.timer),i.prototype.destroy.apply(this,arguments)}});return l}),define("modules/videos/brightcove-video",["jquery","underscore","baseview","state","utils","admanager","managers/cachemanager","pubsub","modules/videos/video-transcript","adLogger","modules/stories/taboola-recommendations"],function(e,t,i,s,n,a,o,r,l,h,d){"use strict";var c=i.extend({events:{"click .ui-video-still-image-active, .ui-video-play-btn-active":"onClickVideoStill"},initialize:function(s){s=e.extend({video:this.$(".ui-video-data").eq(0).html(),player:this.$(".ui-video-player-data").eq(0).html(),brightcovePlayerParams:null,onStatusChange:null,onProgressChange:null,onClickPlay:null,customContainerClass:""},s),t.bindAll(this,"onVideoStatusChange","onVideoProgressChange","seekVideo","onVideoError","destroy","playRecommendedVideo"),this.pubSub={"pause:videos":this.onPauseVideo,"page:load":this.onPageLoad},i.prototype.initialize.call(this,s),this.$videoStill=this.$(".ui-video-still-image"),this.$playBtn=this.$(".ui-video-play-btn"),this.isVideoStillActiveClassPreExisting=this.$videoStill.hasClass("ui-video-still-image-active"),this.isPlayBtnActiveClassPreExisting=this.$playBtn.hasClass("ui-video-play-btn-active"),window.BCCallbacks||(window.BCCallbacks={}),this.video=this._buildVideoData(),this.player=this._buildPlayerData()},playerKey:1,_buildVideoData:function(){var e=this.options.video||{};return"string"==typeof e&&(e=JSON.parse(e)),e},playVideo:function(){var e=this.getVideoData()||{},t=e.id,i=e.brightcove_id;t||i?(this.hideStill(),this.loadPlayer().then(function(e){e.getIsPlaying(function(s){s?e.pause(!1):t?e.loadVideoByReferenceID(t):i&&e.loadVideoByID(i)})})):console.warn("cannot autoplay video: no video id was specified!")},_buildPlayerData:function(){var t=this.options.player||{};return"string"==typeof t&&(t=e.parseJSON(t)),e.extend({width:480,height:270},t)},getVideoData:function(){return this.video},getPlayerData:function(){return this.player},onPageLoad:function(){var e,i,s;a.getActiveSlotStatistics().done(t.bind(function(a){var r=t.findWhere(a.high_impact_info,{adType:"gravity"});return r&&r.ecid&&(i=r.cap||2,s=isNaN(r.capExp)?n.getNested(window.site_vars,"ADS","LEAVEBEHIND_EXPIRATION_MINUTES"):r.capExp,e=o.getValue("dfpc_"+r.ecid,{displayed:0},s),e.displayed<i)?!1:void(this.getPlayerData().autoplay&&!this.destroyed&&this.playVideo())},this))},_loadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=e.Deferred(function(e){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?e.resolve():(console.warn("Error loading Brightcove"),e.reject())})})),this._loadScriptPromise.promise()},loadPlayer:function(){return this._loadScript().then(t.bind(function(){if(!this._loadPlayerPromise){var e=this.getPlayerKey();this.video.transcript_available&&(this.subviews.videotranscript=new l({el:this.$el.siblings(".ui-video-controls"),seek:this.seekVideo,video:this.video,player:this.player})),this._loadPlayerPromise=this._createPlayer(e).then(t.bind(function(t){return this.setupPlayer(t,e),this.$el.addClass("video-player-loaded"),this._player=t,t},this))}return this._loadPlayerPromise},this))},setupPlayer:function(e,i){this.setupEventListeners(e),this.addPlayerCallback(i,"onClickShareButton",t.bind(function(){this.onClickShareButton()},this)),this.addPlayerCallback(i,"onClickSearchButton",t.bind(function(e){this.onClickSearchButton(e)},this))},_neonEnabled:function(){return n.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_createPlayer:function(i){return this._videoObjEl=this._buildVideoObjectHtml(i),e.Deferred(t.bind(function(e){this.getPlayerData().id?(this.addPlayerCallback(i,this.getPlayerReadyCallbackKey(),t.bind(function(t){var s=window.brightcove.api.getExperience(i),n=s.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER);this._triggerNeon("onTemplateReady",t),e.resolve(n)},this)),this.addPlayerCallback(i,this.getPlayerLoadCallbackKey(),t.bind(function(){var e=window.brightcove.api.getExperience(i);this._triggerNeon("onTemplateLoad",e.id)},this)),this.addPlayerCallback(i,this.getPlayerErrorCallbackKey(),function(t){var i=t.errorType;4===t.code?i="error creating video player because of "+t.errorType:(console.warn("video player error: "+i),e.reject(t))}),window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperience(this._videoObjEl,this.$el[0],!0)):(console.warn("error creating video player: no video player id was specified!"),e.reject())},this))},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},onClickShareButton:function(){s.getActiveApp().$(".util-bar-btn-email").click()},onClickSearchButton:function(e){this.subviews.videotranscript.togglesearch(e)},onPauseVideo:function(){this._player&&this._player.pause()},addPlayerCallback:function(e,t,i){window.BCCallbacks[e]||(window.BCCallbacks[e]={}),window.BCCallbacks[e][t]||(window.BCCallbacks[e][t]={}),window.BCCallbacks[e][t]=function(){i.apply(this,arguments)}},setupEventListeners:function(e){this.eventListeners={BEGIN:this.onVideoStatusChange,COMPLETE:this.onVideoStatusChange,PLAY:this.onVideoStatusChange,STOP:this.onVideoStatusChange,SEEK_NOTIFY:this.onVideoStatusChange,PROGRESS:this.onVideoProgressChange,ERROR:this.onVideoError,CHANGE:this.onVideoProgressChange},this.mediaEventApi=window.brightcove.api.events.MediaEvent,t.each(this.eventListeners,function(t,i){e.addEventListener(this.mediaEventApi[i],t)},this)},removeEventListeners:function(e){t.each(this.eventListeners,function(t,i){e.removeEventListener(this.mediaEventApi[i],t)},this)},onVideoStatusChange:function(e){if("mediaBegin"===e.type){var t="video:load";s.stopRefreshTimer(),r.trigger(t,this.getVideoEventAnalyticsData(e,t))}else"mediaComplete"===e.type?this.player.gannett_continuous_endslate&&this.shouldIncludeRecommendation()&&!this.options.overrideGetRecommendations&&(this.subviews.TaboolaOutbrain?(this.$endslate_template=this.$(".video-endslate"),this.subviews.TaboolaOutbrain.populateEndslate(this.$endslate_template,this.player.mediatemplate)):this.reset()):r.trigger("uotrack",e.type);this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.onStatusChange(e),this.options.onStatusChange&&this.options.onStatusChange(e)},onVideoProgressChange:function(e){this.trackVideoProgressEvent(e),this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.progressHighlight(e),this.options.onProgressChange&&this.options.onProgressChange(e)},onVideoError:function(e){r.trigger("uotrack","videoError:"+this.player.name+":"+(e.errorType||e.code))},trackVideoProgressEvent:function(e){var t=e.duration,i=e.position,s=Math.round(i/t*100),n=this.video.url||e.media.customFields.gdp_canonical_url;!this.fiftypercent&&s>=50&&95>s?(r.trigger("vitrack",{percentage:"50%",video_url:n}),this.fiftypercent=!0):!this.ninetyfivepercent&&s>=95&&99>s&&(r.trigger("vitrack",{percentage:"95%",video_url:n}),this.ninetyfivepercent=!0,this.options.overrideGetRecommendations?this.player.gannett_continuous_endslate&&this.options.overrideGetRecommendations(e):this.shouldIncludeRecommendation()&&!this.subviews.TaboolaOutbrain&&(this.subviews.TaboolaOutbrain=new d({playRecommendedVideo:this.playRecommendedVideo,dontRenderMoreStories:!0}),this.subviews.TaboolaOutbrain.renderEndslate(this.video.url,this.video.brightcove_id)))},playRecommendedVideo:function(e){this.destroy(),this.subviews.nextVideo=new c({video:e,el:this.$el}),this.subviews.nextVideo.playVideo(),this.$el.parent().find(".video-desc").html(e.description+"<span class=credit>"+e.credit+"</span>")},_buildVideoObjectHtml:function(t){var i=document.createElement("object"),s=this.getPlayerData(),n=this.getVideoData();i.setAttribute("id",t),i.className="brightcove-video-object "+this.options.customContainerClass,i.setAttribute("style","width: "+s.width+"px; height: "+s.height+"px;");var a=e.extend({},this.getDefaultParams(t),this.options.brightcovePlayerParams);for(var o in a)if(a.hasOwnProperty(o)){var r=document.createElement("param");r.name=o,r.value=a[o],i.appendChild(r)}if(n&&(n.id||n.brightcove_id)){var l=document.createElement("param");l.name="@videoPlayer",l.value=n.id?"ref:"+n.id:n.brightcove_id,i.appendChild(l)}return i},getDefaultParams:function(e){var t=this.getVideoData(),i=this.getPlayerData(),s={};return s={bgcolor:"#FFFFFF",playerID:i.id,width:i.width,height:i.height,autoStart:!1,isVid:!0,isUI:!0,wmode:"transparent",htmlFallback:!0,dynamicStreaming:!0,includeAPI:!0,usat_hasEmbed:!0,templateReadyHandler:"BCCallbacks."+e+"."+this.getPlayerReadyCallbackKey(),templateLoadHandler:"BCCallbacks."+e+"."+this.getPlayerLoadCallbackKey(),templateErrorHandler:"BCCallbacks."+e+"."+this.getPlayerErrorCallbackKey(),adServerURL:this._buildAdServerParam(),usat_linkurl:t.url||"",SSTSCode:(t.ssts_string||"")+"/"},!this.player.hidesearchcontrol&&this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&(s.usat_searchToggled=this.player.flashsearchcontrolOn?"true":"false",s.usat_searchFunction="function(e){setTimeout(BCCallbacks."+e+".onClickSearchButton(e), 1)}"),this.video.sharecontrol&&(this.player.overridesharecontrol=!1),this.player.overridesharecontrol&&(s.usat_shareFunction="function(){setTimeout(BCCallbacks."+e+".onClickShareButton(), 1)}"),s},_buildAdServerParam:function(){var t=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),i=e.cookie("aam_uuid"),n="",o=s.getActivePageInfo(),r=this.getVideoData();o.series&&(n+="&series="+encodeURIComponent(o.series)),o.topic&&(n+="&topic="+encodeURIComponent(o.topic)),o.basePageType&&(n+="&pagetype="+encodeURIComponent(o.basePageType)),n+="&aam="+t+"&u="+i;var l="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+a.buildAdUnit("preroll_video")+"/"+r.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+r.id+encodeURIComponent(n)+'&cmsid=12768&url=""';return h.logInfo("Built ad call for video, "+r.id+".",o,r),h.logInfo("Video Ad call: "+l),l},getVideoEventAnalyticsData:function(e,t){var i=e.duration,s=e.media,n=Math.round(e.position/i*100),a=this.getVideoData(),o=this.getPlayerData(),r={completion:n+"%",videoFulllengthUrl:s.FLVFullLengthURL,eventtype:t||e.type,videoName:s.customFields.liveVideoSubject||s.displayName,contentid:s.id,assetid:s.referenceId,ssts:a.ssts_string||s.customFields.gdp_ssts,cst:a.cst||s.customFields.gdp_cst,keywords:a.keywords||s.customFields.gdp_tags,videoplayername:o.name,videocontentprovider:a.videocontentprovider||s.customFields.gannetttracking+"|"+s.displayName,contenttype:a.type||"video",videotranscript:this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()?"yes":"no"};return r.videoDuration=0>i?"":120>i?"less than 2 min":"greater than 2 min",a.url&&(r.pathName=a.url.replace(/^.*\/\/[^\/]+/,"")),r},shouldIncludeRecommendation:function(){return"sponsor-story"!=s.getActivePageInfo().section_name&&"sponsor-story"!=n.getNested(this.video,"ssts","section")},getPlayerReadyCallbackKey:function(){return"onTemplateReady"},getPlayerLoadCallbackKey:function(){return"onTemplateLoad"},getPlayerErrorCallbackKey:function(){return"onTemplateError"},getPlayerKey:function(){return this._playerKey||c.prototype.playerKey++,this._playerKey="myExperience"+c.prototype.playerKey,this._playerKey},onClickVideoStill:function(e){this.options.onClickPlay?this.options.onClickPlay(e):this.playVideo()},hideStill:function(){this.$videoStill.removeClass("ui-video-still-image-active"),this.$playBtn.removeClass("ui-video-play-btn-active")},showStill:function(){this.$videoStill.addClass("ui-video-still-image-active"),this.$playBtn.addClass("ui-video-play-btn-active")},reset:function(){var e=this._player;this.fiftypercent=!1,this.ninetyfivepercent=!1,this.showStill(),e&&e.getIsPlaying(function(t){t&&e.getVideoPosition(!1,function(t){0!==t&&e.seek(0),e.pause(!0)})})},_destroyVideoObjectElement:function(){this._videoObjEl&&(e("#"+this.getPlayerKey()).remove(),this._videoObjEl=null)},seekVideo:function(e){this._player&&this._player.seek(e)},_resetPlayerModule:function(){this._player&&(this.removeEventListeners(this._player),this._player=null)},_getPreExistingActiveClass:function(e){var t=e+"-active";return this.isPlayBtnActiveClassPreExisting||this.isVideoStillActiveClassPreExisting?t:""},destroy:function(t,n){if(s.startRefreshTimer(),!n){var a=this.getPlayerKey();window.BCCallbacks&&window.BCCallbacks[a]&&delete window.BCCallbacks[a],window.BCCallbacks&&e.isEmptyObject(window.BCCallbacks)&&delete window.BCCallbacks,this._resetPlayerModule(),this.fiftypercent=!1,this.ninetyfivepercent=!1,this._destroyVideoObjectElement(),this.$el.removeClass("video-player-loaded"),this.$videoStill.addClass(this._getPreExistingActiveClass("ui-video-still-image")),this.$playBtn.addClass(this._getPreExistingActiveClass("ui-video-play-btn"))}i.prototype.destroy.apply(this,arguments)}});return c}),define("modules/scroller/vertical-scroll",["jquery","underscore","utils","modules/scroller/base-scroll"],function(e,t,i,s){var n=s.extend({initialize:function(i){i=e.extend({color:"light",fadeout:!1,draggerPaddingTop:3,draggerPaddingBottom:3},i);var n=this.options.fadeout?"fadeout":"",a=t.template('<div class="vertical-scroll ui-<%= color %> <%= fade %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');i.template=a({color:i.color,fade:n}),this.$(".vertical-scroll").remove(),s.prototype.initialize.call(this,i)},getViewportSize:function(){return this.$el.height()},getContentSize:function(){return this.content.height()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingTop+this.options.draggerPaddingBottom,this.dragger.css({height:e}),e},animateContentToPosition:function(i,s,n,a){var o=this.viewportSize-this.contentSize,r=Math.max(o,Math.min(s,0));return a=a||"ease-out",e.when(this.animate(this.dragger,"top",-1*r*this.contentViewportRatio+"px",n||0,a),this.animate(this.content,"top",r+"px",n,a)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/o])},this))},scrollToElement:function(e,t,i,s){var n,a=e.outerHeight(),o=e.position().top+e.parent().position().top,r=o+a;if(0>o){var l=this.getViewportSize();n=t?o+(a-l):o}else r>this.getViewportSize()&&(n=t?o:o+(a-this.getViewportSize()));if(n){var h=this.content.position().top-n;this.animateContentToPosition(0,h,i,s)}},moveContentToPosition:function(e,t){if(!this.active)return!1;var i=Math.min(this.viewportSize-this.contentSize,0),s=Math.max(i,Math.min(t,0));return this._positionDragger(-1*s*this.contentViewportRatio),this._positionContent(s),this.$el.trigger("scrollBarUpdate",[s/i]),s===t},moveDraggerToPosition:function(e,t){if(!this.active)return!1;var i=this.viewportSize-(this.draggerSize+this.options.draggerPaddingBottom+this.options.draggerPaddingTop),s=Math.max(0,Math.min(t,i));return this._positionDragger(s),this._positionContent(-1*s/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",s/i),s===t},_positionDragger:function(e){e+=this.options.draggerPaddingTop,e=Math.round(e),this.dragger.css({top:e})},_positionContent:function(e){e=Math.round(e),this.content.css({top:e}),"function"==typeof this.options.onScroll&&this.options.onScroll(e)}});return n}),define("ui/dropdown",["jquery","underscore","utils","managers/routemanager","baseview","state","modules/scroller/vertical-scroll"],function(e,t,i,s,n,a,o){"use strict";var r=n.extend({events:{"click .ui-dropdown-value":"onClick",keydown:"onKeyDown","click .ui-dropdown-item":"onItemClick","mouseenter .ui-dropdown-item":"onItemHover","click .ui-dropdown-item-link":"onItemLinkClick"},initialize:function(s){s=e.extend({onSelect:null},s),t.bindAll(this,"refresh"),n.prototype.initialize.call(this,s),this.body=i.get("body"),this.$el.attr("tabindex")||this.$el.attr("tabindex",0),this.dropdownItems=this._setupDropdownItems(this.$(".ui-dropdown-item")),this.dropdownValueDiv=this.$(".ui-dropdown-value"),this.defaultItem=this.dropdownItems.filter('[data-selected="selected"]'),this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},_setupDropdownItems:function(t){var i=t.filter('[data-selected="selected"]');if(1!==i.length){var s=t.eq(0);s.length&&s.attr("data-selected","selected")}return t.each(function(t,i){var s=e(i),n=s.find("a");s.addClass(n.length?"ui-dropdown-item-with-link":"ui-dropdown-item-without-link")}),t},open:function(){var i=this.getDataValue(),s=this.getDropdownItemByDataValue(i);s.eq(0).attr("data-selected","selected").addClass("ui-dropdown-item-highlight"),this.$el.addClass("expanded"),this.isDropdownOpen=!0,this.subviews.scrollbar?this.subviews.scrollbar.refresh():this.subviews.scrollbar=new o({el:this.$(".ui-dropdown-content"),contentClass:".ui-dropdown-items-container",padding:6}),s.length&&this.subviews.scrollbar.scrollToElement(s,!1,50),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&this.close()},this))},close:function(){this.$el.removeClass("expanded"),this.dropdownItems.removeClass("ui-dropdown-item-highlight"),this.isDropdownOpen=!1,this.body.off("click."+this.cid)},onClick:function(){this.isDropdownOpen?this.close():this.open()},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;38===t||40===t?(this.isDropdownOpen?this.onResultItemUpDownArrowKeyPress(t):this.open(),e.preventDefault()):27===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):9===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):(32===t||13===t)&&(this.onSpaceBarOrEnterKeyPress(),e.preventDefault())},onResultItemUpDownArrowKeyPress:function(e){var t=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0);this.dropdownItems.removeClass("ui-dropdown-item-highlight"),t.length?38===e?(t=t.prev(),t.length||(t=this.dropdownItems.last()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):40===e&&(t=t.next(),t.length||(t=this.dropdownItems.first()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):t=this.dropdownItems.eq(0),t.addClass("ui-dropdown-item-highlight")},onSpaceBarOrEnterKeyPress:function(){var e=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0),t=e.find("a").attr("href"),i=e.data("value"),n=e.text();e.length&&this.setValue(i,n),this.options.onSelect&&this.options.onSelect(i,n,e),t&&s.goTo(t)},onItemClick:function(t){var i=e(t.currentTarget),s=i.data("value"),n=i.text();this.setValue(s,n),this.options.onSelect&&this.options.onSelect(s,n,i)},onItemLinkClick:function(t){var i=e(t.currentTarget).closest(".ui-dropdown-item");this.setValue(i.data("value"),i.text())},onItemHover:function(t){this.dropdownItems.removeClass("ui-dropdown-item-highlight"),e(t.currentTarget).addClass("ui-dropdown-item-highlight")},setValue:function(e,t){var i;this.dropdownItems.removeAttr("data-selected"),void 0!==e?(this.dropdownValueDiv.data("value",e),i=this.getDropdownItemByDataValue(e)):i=this.getDropdownItemByDisplayValue(t),this.dropdownValueDiv.html(t),"selected"!==i.eq(0).data("selected")&&i.eq(0).attr("data-selected","selected"),this.isDropdownOpen&&this.close()},getDataValue:function(){return this.dropdownValueDiv.data("value")||""},getDisplayValue:function(){return this.dropdownValueDiv.text()||""},getDropdownItemByDataValue:function(e){return this.dropdownItems.filter('[data-value="'+e+'"]')},getDropdownItemByDisplayValue:function(e){return this.dropdownItems.filter(':contains("'+e+'")')},refresh:function(t){if(t){var i=this._setupDropdownItems(e(t));this.$(".ui-dropdown-items-container").html(i),this.dropdownItems=i}var s=this.dropdownItems.filter('[data-selected="selected"]');this.setValue(s.data("value"),s.text()),this.defaultItem=s},reset:function(){this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},destroy:function(e){this.body.off("."+this.cid),n.prototype.destroy.call(this,e)}});return r}),define("apps/media",["jquery","underscore","pubsub","utils","state","base-app","sharedAdPosition","modules/carousel/carousel-autosize","modules/videos/brightcove-video","modules/global/taboola","ui/dropdown"],function(e,t,i,s,n,a,o,r,l,h,d){"use strict";var c=a.extend({el:"#media-view",events:{"click .recommended, .more-from, .expando":"mediaTabClick","mouseout .media-playlist":"mediaPlaylistMouseOut","mouseover .media-playlist":"mediaPlaylistMouseIn","click .media-playlist a":"changeMediaClick","click .media-sidebar-list li.sub":"sectionHighlight",click:"userInteraction"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{slide:{duration:350,easing:"ease-in-out"},cinematic:{change:{fadeOut:{duration:300,easing:"ease-in-out"},fadeIn:{duration:300,easing:"ease-in-out"}}}}},i),t.bindAll(this,"switchToNextVideo","handleResizeWindow"),this.win=s.get("win"),this.scrollEl=s.get("scrollEl"),this.win.on("resize."+this.cid,t.throttle(this.handleResizeWindow,50)),this.playlistTimer=null,this.init=!1,this.subviews={},a.prototype.initialize.call(this,i);var n=e(".sidenav > li.sub-active");this.lastSectionName=n.attr("data-section")},getAd:function(){this.subviews.skinad=new o({el:this.$(".partner-media-ad"),adSizes:["cinematicvideoskin"],adPlacement:"skin_media",adType:"skinmedia",defaultPosition:!0})},handleResizeWindow:function(){this.browse&&this.columnize(this.$el)},beforePageReveal:function(e,t,i){this.isCinematicPath(t)||this.columnize(i)},afterPageReveal:function(e,t){this.isCinematicPath(t)?("galleries"==this.pageInfo.media_type?this._initializeGallery():"videopage"==this.pageInfo.media_type&&(this._initializeVideo(this.$(".ui-video")),this.getAd()),this.browse=!1,this.isCinematicPath(e)||(this.playlistStuckOpen=!1,this.delayClosePlaylist(),e&&this.$(".back-to-media").attr("href",e))):this._initializeBrowse(),this.handleResizeWindow(),this.subviews.filterDropdown||(this.subviews.filterDropdown=new d({el:this.$(".media-view-sort-by-dropdown")})),s.lazyLoadImage(this.$(".more-from").find("img"),"data-src",!0)},animateChangePagePostData:function(e,t,i){return this.isCinematicPath(t)?this.isCinematicPath(e)?this._fadeInNewCinematicContent(t,i):this.slide(i,"left",this.options.animations.slide.duration,this.options.animations.slide.easing):this.isCinematicPath(e)?this.slide(i,"right",this.options.animations.slide.duration,this.options.animations.slide.easing):a.prototype.animateChangePagePostData.apply(this,arguments)},animateChangePagePreData:function(e,t){return this.isCinematicPath(e)||this.isCinematicPath(t)?void 0:this.changeBrowseSection(e,t)},changeBrowseSection:function(t,i){var s=this.$(".media-sidebar-list"),a=this._getSubSectionPath(t),o=this._getSubSectionPath(i);if(a!==o){var r,l;return s.children().each(function(t,i){i=e(i);var s=i.attr("data-section")||"";s===a?(r=i.find(".media-sidenav-sublist").slideUp(250).promise(),r.done(function(){i.removeClass("active")})):s===o&&(l=i.find(".media-sidenav-sublist").slideDown(250).promise(),l.done(function(){i.addClass("active")}))}),r&&n.registerAnimation(r),l&&n.registerAnimation(l),e.when(r,l)}},_getSubSectionPath:function(e){if(e=e.replace(/^media\/((latest|popular)\/)?/,"")){var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return""},isCinematicPath:function(e){return e&&-1!==e.indexOf("/cinematic")},_fadeInNewCinematicContent:function(i,s){return e.Deferred(t.bind(function(e){this._swapRelatedMedia(s),this._swapNavBar(s),this._swapMainView(s,e)},this)).promise()},_swapNavBar:function(e){var i=this.animate(this.$(".cinematic-side-nav-ul"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".cinematic-side-nav-ul");t.css("opacity",0),this.$(".cinematic-side-nav-ul").replaceWith(t),this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_swapMainView:function(e,i){var s=this.animate(this.$(".media-main-view"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);s.done(t.bind(function(){var s=e.find(".media-main-view");if(s.css("opacity",0),this.$(".media-main-view").replaceWith(s),s.length){var n=this.animate(s,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing);n.done(t.bind(function(){i.resolve()},this))}else i.resolve()},this))},_swapRelatedMedia:function(e){var i=this.animate(this.$(".recommended"),"opacity",this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".media-tabs-ul .recommended"),i=e.find(".media-playlist > .recommended");t.css("opacity",0),this.$(".media-tabs-ul .recommended").replaceWith(t),this.$(".media-playlist > .recommended").replaceWith(i),t.length&&this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_initializeGallery:function(){var e=this.$(".galleries"),t=e.data().galleryId||0;this.subviews.carousel=new r({el:this.$el,gallerySelector:e,scrollerColor:"dark",horizontalAdjust:126,verticalAdjust:117}),this.subviews.taboola=new h,this.subviews.taboola.getRelated(this.showRecommended,"photo","photo",10,null,t)},_initializeVideo:function(e){this.subviews.video=new l({el:e,onVideoStatusChange:this.switchToNextVideo,autostart:!0});var t=this.subviews.video.getVideoData().brightcove_id;this.subviews.taboola=new h,this.subviews.taboola.getRelated(this.showRecommended,"video","video",10,null,t)},userInteraction:function(){this.switchVideoTimer&&clearTimeout(this.switchVideoTimer)},switchToNextVideo:function(){var e=this.$(".more-from .active").next();e.length&&(this.switchVideoTimer=setTimeout(function(){e.find("a").click()},5e3))},destroyModules:function(){clearTimeout(this.switchVideoTimer),a.prototype.destroyModules.apply(this,arguments)},destroy:function(e){this.win.off("."+this.cid),a.prototype.destroy.call(this,e)},changeMediaClick:function(t){var i=e(t.target);this.$(".playlist li.active").removeClass("active"),i.closest("li").addClass("active")},mediaTabClick:function(t){var i=this.$(".media-playlist"),s=e(t.target).closest("li");s.hasClass("expando")?i.hasClass("open")?(this.playlistStuckOpen=!1,i.removeClass("open")):(this.playlistStuckOpen=!0,i.addClass("open")):s.hasClass("tab")&&(i.addClass("open"),s.hasClass("active")||(i.find(".media-tabs .active").removeClass("active"),s.addClass("active"),i.find(".playlist").addClass("hidden"),i.find("."+s.attr("for")).removeClass("hidden")))},mediaPlaylistMouseOut:function(){this.playlistStuckOpen||this.delayClosePlaylist()},mediaPlaylistMouseIn:function(){clearTimeout(this.playlistTimer)},delayClosePlaylist:function(){this.$(".media-playlist").removeClass("initial")},_initializeBrowse:function(){this.gridWrapper=this.$(".grid-wrapper"),this.browse=!0},columnize:function(t){var i=360,n=t.find(".medialistitems"),a=e(window).width(),o=a-130-31,r=Math.floor(o/i);1>r&&(r=1),t.find(".media-content").width(r*i),n.removeClass("mediaview-featured"),n.slice(0,r).addClass("mediaview-featured"),s.lazyLoadImage(this.$(".mediaview-featured").find("img"),"data-large-src",!0)
},sectionHighlight:function(t){var i=e(t.currentTarget);if(i.hasClass("active")&&!e(t.target).attr("href")){var s=i.children("ul");i.hasClass("collapsed")?(n.registerAnimation(s.slideDown(250).promise()),i.removeClass("collapsed")):(n.registerAnimation(s.slideUp(250).promise()),i.addClass("collapsed"))}},slide:function(i,n,a,o){var r=null,l=null;"left"===n?(r="left",l=-100):"right"===n&&(r="left",l=100);var h=s.getScrollPosition(),d=this.$el.offset().top;h-=d,this.$el.css(r,"0%"),this.$el.css({position:"absolute",top:-1*h}),i=e(i),i.css(r,-1*l+"%"),i.css({position:"absolute",top:d}),i.insertAfter(this.$el);var c=e.Deferred();return t.defer(t.bind(function(){0!==this.$el.length&&this.animate(this.$el,r,l+"%",a,o);var e=this.animate(i,r,"0%",a,o);e.done(t.bind(function(){this.$el.remove(),i.css({position:"",top:""}),this.setElement(i),c.resolve()},this))},this)),c.promise()},showRecommended:function(i){var s=e("#mediaview-recommended-template");if(1===s.length){var n=t.template(s.html(),{data:i.list});e("#mediaview-cinematic-recommended").append(n)}}});return c}),function(){var e={},t={};document.writeln=(self.console||{}).log||function(){},document.write=function(){for(var i in e)if(e.hasOwnProperty(i))try{e[i].apply({},arguments)}catch(s){}for(var n=Array.prototype.join.call(arguments,""),a="<script[^<>]*src=['\"]?([^'\"<> :/]*:*//[a-z0-9.]*google.com/[^'\"<> ]*)['\"]?[^<>]*>[^<>]*</script>",o=new RegExp(a,"gi"),r=new RegExp(a,"i"),l=n.match(o)||[],h=0;h<l.length;h++)l[h].match(r),$.ajax({cache:!0,dataType:"script",success:function(){for(var e in t)if(t.hasOwnProperty(e))try{t[e].apply({},arguments)}catch(i){}},url:RegExp.$1}),n=n.replace(l[h],"");if(!n.match(/^\s*$/))try{console.log("document.write ignoring ",n)}catch(s){}},document.addOnWrite=function(t,i){"function"==typeof i&&(e[t]||(e[t]=i))},document.addOnScript=function(e,i){"function"==typeof i&&(t[e]||(t[e]=i))},document.delOnWrite=function(t){delete e[t]||(e[t]=void 0)},document.delOnScript=function(e){delete t[e]||(t[e]=void 0)}}(),define("global/document-write",function(){}),define("apps/search",["jquery","underscore","backbone","pubsub","utils","base-app","state","site-manager","global/document-write"],function(e,t,i,s,n,a,o,r){"use strict";var l=a.extend({el:".search-results",events:{"click .grid-btn":"gridView","click .list-btn":"listView"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{open:{duration:250,easing:"ease-in-out"},close:{duration:250,easing:"ease-in-out"}}},i),this.win=n.get("win"),this.body=n.get("body"),this.scrollEl=n.get("scrollEl"),this.header=r.getHeader(),t.bindAll(this,"lazyload"),this.currentView="view-grid",this.init=!1,this.requestInProgress=!1,this.win.on("scroll."+this.cid,t.throttle(this.lazyload,200)),e(".site-masthead-search-close-btn").addClass("site-masthead-search-close-btn-visible"),a.prototype.initialize.call(this,i)},getRevealAppLoader:function(){return'<article class="search-results ui-loading dark-medium"></article>'},isSearchPage:!0,animateRevealApp:function(i){if(null===i)return e.Deferred().resolve();this.$("#search-form").css("height",""),this.$el.css({opacity:1,position:"absolute",overflow:"hidden",display:"block",top:"-100%",height:"100%"});var s=this.animate(this.$el,"top","0%",this.options.animations.open.duration,this.options.animations.open.easing);return s.done(t.bind(function(){this.body.addClass("show-search"),this.$el.css({height:"",top:"",position:""})},this)),s},setFixedPosition:function(){this.$(".summary").css({top:this.header.getCurrentHeight()}),a.prototype.setFixedPosition.apply(this,arguments)},clearFixedPosition:function(){this.$(".summary").css({top:"",position:""}),a.prototype.clearFixedPosition.apply(this,arguments)},_onHeaderFixed:function(){a.prototype._onHeaderFixed.apply(this,arguments),this._fixedOffset&&this.$(".summary").css({top:this.header.getCollapsedHeight(),position:"fixed"})},_onHeaderUnfixed:function(){this._fixedOffset&&this.$(".summary").css({top:-1*this._fixedOffset+this.header.getCollapsedHeight(),position:"absolute"}),a.prototype._onHeaderUnfixed.apply(this,arguments)},animateRemoveApp:function(){var e=n.getScrollPosition();return this.$el.css({marginTop:-1*e,overflow:"hidden",height:this.win.height()+e}),this.$(".summary").css("position","absolute"),this.body.removeClass("show-search"),this.animate(this.$el,"top","-100%",this.options.animations.close.duration,this.options.animations.close.easing)},afterAppRemove:function(){e(".site-masthead-search-close-btn").removeClass("site-masthead-search-close-btn-visible"),s.trigger("uotrack","searchResultsclose")},afterPageReveal:function(e){this.init||(this.init=!0,this.originalPath=e),this.moreResultsPlacer=this.$(".more-results"),this.lazyload(),this.searchWrap=this.$("#search-form"),this.searchTextInput=this.searchWrap.find(".text-input"),this.setup(),this.setupTextAd()},getMoreResults:function(e){return this.requestInProgress=!0,this.moreResultsPlacer.show(),o.fetchHtml(e).done(t.bind(function(e){this.moreResultsPlacer.parent().append(e),this.moreResultsPlacer.remove(),this.moreResultsPlacer=this.$(".more-results")},this)).fail(t.bind(function(){this.moreResultsPlacer.remove(),this.moreResultsPlacer=null},this)).always(t.bind(function(){this.requestInProgress=!1},this)),!1},getTerm:function(){return e(".search-term .term",this.$el).attr("data-term")},setup:function(){this.results=this.$(".results"),this.summary=this.$(".summary"),this.sidebar=this.$(".sidebar"),this.viewGrid=this.$(".grid-btn"),this.viewList=this.$(".list-btn"),"view-list"===this.currentView&&this.listView()},setupTextAd:function(){var t=this.getTerm(),i="partner_search_text_ads"+(new Date).getTime();e(".tile.ad",this.$el).attr("id",i);var s={pubId:"partner-usatoday_js",query:t,hl:"en"},n={container:i,lines:"3",fontFamily:"arial",fontSizeTitle:"13px",fontSizeDescription:"12px",fontSizeDomainLink:"12px",colorTitleLink:"1EA3FF",colorText:"FFFFFF",colorDomainLink:"00C641",colorBackground:"2C2C2C"};this.loadGoogleSearchAds(s,n)},gridView:function(){return this.viewGrid.addClass("active"),this.viewList.removeClass("active"),this.summary.removeClass("list").addClass("grid"),this.results.removeClass("view-list").addClass("view-grid"),this.currentView="view-grid",e(".ad").appendTo(".sidebar"),!1},listView:function(){return this.viewList.addClass("active"),this.viewGrid.removeClass("active"),this.summary.removeClass("grid").addClass("list"),this.results.removeClass("view-grid").addClass("view-list"),this.currentView="view-list",e(".ad").prependTo(".list-content"),!1},lazyload:function(){if(this.init&&this.moreResultsPlacer&&this.moreResultsPlacer.length&&!this.requestInProgress){var e=n.getScrollPosition(),t=this.body.height();this.moreResultsPlacer.offset().top<=e+t&&this.getMoreResults(this.moreResultsPlacer.data("href"))}},loadGoogleSearchAds:function(e,t){var i=!1,s=function(){return i?(document.delOnWrite("searchads"),void document.delOnScript("searchads")):void(window.google&&window.google.ads&&window.google.ads.search&&window.google.ads.search.Ads&&(i=new window.google.ads.search.Ads(e,t),document.delOnWrite("searchads"),document.delOnScript("searchads")))};s()||(document.addOnWrite("searchads",s),document.addOnScript("searchads",s),o.fetchData("http://www.google.com/adsense/search/ads.js",{cache:!0,dataType:"script",success:s}))},destroy:function(){document.delOnWrite("searchads"),document.delOnScript("searchads"),this.win.off("."+this.cid),a.prototype.destroy.apply(this,arguments)}});return l}),function(window,document,undefined){!function(e){"use strict";"function"==typeof define&&define.amd?define("libs/jquery/plugins/jquery.dataTables",["jquery"],e):jQuery&&!jQuery.fn.dataTable&&e(jQuery)}(function($){"use strict";var DataTable=function(oInit){function _fnAddColumn(e,t){var i=DataTable.defaults.columns,s=e.aoColumns.length,n=$.extend({},DataTable.models.oColumn,i,{sSortingClass:e.oClasses.sSortable,sSortingClassJUI:e.oClasses.sSortJUI,nTh:t?t:document.createElement("th"),sTitle:i.sTitle?i.sTitle:t?t.innerHTML:"",aDataSort:i.aDataSort?i.aDataSort:[s],mData:i.mData?i.oDefaults:s});if(e.aoColumns.push(n),e.aoPreSearchCols[s]===undefined||null===e.aoPreSearchCols[s])e.aoPreSearchCols[s]=$.extend({},DataTable.models.oSearch);else{var a=e.aoPreSearchCols[s];a.bRegex===undefined&&(a.bRegex=!0),a.bSmart===undefined&&(a.bSmart=!0),a.bCaseInsensitive===undefined&&(a.bCaseInsensitive=!0)}_fnColumnOptions(e,s,null)}function _fnColumnOptions(e,t,i){var s=e.aoColumns[t];i!==undefined&&null!==i&&(i.mDataProp&&!i.mData&&(i.mData=i.mDataProp),i.sType!==undefined&&(s.sType=i.sType,s._bAutoType=!1),$.extend(s,i),_fnMap(s,i,"sWidth","sWidthOrig"),i.iDataSort!==undefined&&(s.aDataSort=[i.iDataSort]),_fnMap(s,i,"aDataSort"));var n=s.mRender?_fnGetObjectDataFn(s.mRender):null,a=_fnGetObjectDataFn(s.mData);s.fnGetData=function(e,t){var i=a(e,t);return s.mRender&&t&&""!==t?n(i,t,e):i},s.fnSetData=_fnSetObjectDataFn(s.mData),e.oFeatures.bSort||(s.bSortable=!1),!s.bSortable||-1==$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortableNone,s.sSortingClassJUI=""):-1==$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortable,s.sSortingClassJUI=e.oClasses.sSortJUI):-1!=$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortableAsc,s.sSortingClassJUI=e.oClasses.sSortJUIAscAllowed):-1==$.inArray("asc",s.asSorting)&&-1!=$.inArray("desc",s.asSorting)&&(s.sSortingClass=e.oClasses.sSortableDesc,s.sSortingClassJUI=e.oClasses.sSortJUIDescAllowed)}function _fnAdjustColumnSizing(e){if(e.oFeatures.bAutoWidth===!1)return!1;_fnCalculateColumnWidths(e);for(var t=0,i=e.aoColumns.length;i>t;t++)e.aoColumns[t].nTh.style.width=e.aoColumns[t].sWidth}function _fnVisibleToColumnIndex(e,t){var i=_fnGetColumns(e,"bVisible");return"number"==typeof i[t]?i[t]:null}function _fnColumnIndexToVisible(e,t){var i=_fnGetColumns(e,"bVisible"),s=$.inArray(t,i);return-1!==s?s:null}function _fnVisbleColumns(e){return _fnGetColumns(e,"bVisible").length}function _fnGetColumns(e,t){var i=[];return $.map(e.aoColumns,function(e,s){e[t]&&i.push(s)}),i}function _fnDetectType(e){for(var t=DataTable.ext.aTypes,i=t.length,s=0;i>s;s++){var n=t[s](e);if(null!==n)return n}return"string"}function _fnReOrderIndex(e,t){for(var i=t.split(","),s=[],n=0,a=e.aoColumns.length;a>n;n++)for(var o=0;a>o;o++)if(e.aoColumns[n].sName==i[o]){s.push(o);break}return s}function _fnColumnOrdering(e){for(var t="",i=0,s=e.aoColumns.length;s>i;i++)t+=e.aoColumns[i].sName+",";return t.length==s?"":t.slice(0,-1)}function _fnApplyColumnDefs(e,t,i,s){var n,a,o,r,l,h;if(t)for(n=t.length-1;n>=0;n--){var d=t[n].aTargets;for($.isArray(d)||_fnLog(e,1,"aTargets must be an array of targets, not a "+typeof d),o=0,r=d.length;r>o;o++)if("number"==typeof d[o]&&d[o]>=0){for(;e.aoColumns.length<=d[o];)_fnAddColumn(e);s(d[o],t[n])}else if("number"==typeof d[o]&&d[o]<0)s(e.aoColumns.length+d[o],t[n]);else if("string"==typeof d[o])for(l=0,h=e.aoColumns.length;h>l;l++)("_all"==d[o]||$(e.aoColumns[l].nTh).hasClass(d[o]))&&s(l,t[n])}if(i)for(n=0,a=i.length;a>n;n++)s(n,i[n])}function _fnAddData(e,t){var i,s=$.isArray(t)?t.slice():$.extend(!0,{},t),n=e.aoData.length,a=$.extend(!0,{},DataTable.models.oRow);a._aData=s,e.aoData.push(a);for(var o,r=0,l=e.aoColumns.length;l>r;r++)if(i=e.aoColumns[r],"function"==typeof i.fnRender&&i.bUseRendered&&null!==i.mData?_fnSetCellData(e,n,r,_fnRender(e,n,r)):_fnSetCellData(e,n,r,_fnGetCellData(e,n,r)),i._bAutoType&&"string"!=i.sType){var h=_fnGetCellData(e,n,r,"type");null!==h&&""!==h&&(o=_fnDetectType(h),null===i.sType?i.sType=o:i.sType!=o&&"html"!=i.sType&&(i.sType="string"))}return e.aiDisplayMaster.push(n),e.oFeatures.bDeferRender||_fnCreateTr(e,n),n}function _fnGatherData(e){var t,i,s,n,a,o,r,l,h,d,c,u,p,f,g;if(e.bDeferLoading||null===e.sAjaxSource)for(r=e.nTBody.firstChild;r;){if("TR"==r.nodeName.toUpperCase())for(l=e.aoData.length,r._DT_RowIndex=l,e.aoData.push($.extend(!0,{},DataTable.models.oRow,{nTr:r})),e.aiDisplayMaster.push(l),o=r.firstChild,s=0;o;)p=o.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&(_fnSetCellData(e,l,s,$.trim(o.innerHTML)),s++),o=o.nextSibling;r=r.nextSibling}for(a=_fnGetTrNodes(e),n=[],t=0,i=a.length;i>t;t++)for(o=a[t].firstChild;o;)p=o.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&n.push(o),o=o.nextSibling;for(c=0,u=e.aoColumns.length;u>c;c++){f=e.aoColumns[c],null===f.sTitle&&(f.sTitle=f.nTh.innerHTML);var m,v,b,y,w=f._bAutoType,_="function"==typeof f.fnRender,C=null!==f.sClass,x=f.bVisible;if(w||_||C||!x)for(h=0,d=e.aoData.length;d>h;h++)g=e.aoData[h],m=n[h*u+c],w&&"string"!=f.sType&&(y=_fnGetCellData(e,h,c,"type"),""!==y&&(v=_fnDetectType(y),null===f.sType?f.sType=v:f.sType!=v&&"html"!=f.sType&&(f.sType="string"))),f.mRender?m.innerHTML=_fnGetCellData(e,h,c,"display"):f.mData!==c&&(m.innerHTML=_fnGetCellData(e,h,c,"display")),_&&(b=_fnRender(e,h,c),m.innerHTML=b,f.bUseRendered&&_fnSetCellData(e,h,c,b)),C&&(m.className+=" "+f.sClass),x?g._anHidden[c]=null:(g._anHidden[c]=m,m.parentNode.removeChild(m)),f.fnCreatedCell&&f.fnCreatedCell.call(e.oInstance,m,_fnGetCellData(e,h,c,"display"),g._aData,h,c)}if(0!==e.aoRowCreatedCallback.length)for(t=0,i=e.aoData.length;i>t;t++)g=e.aoData[t],_fnCallbackFire(e,"aoRowCreatedCallback",null,[g.nTr,g._aData,t])}function _fnNodeToDataIndex(e,t){return t._DT_RowIndex!==undefined?t._DT_RowIndex:null}function _fnNodeToColumnIndex(e,t,i){for(var s=_fnGetTdNodes(e,t),n=0,a=e.aoColumns.length;a>n;n++)if(s[n]===i)return n;return-1}function _fnGetRowData(e,t,i,s){for(var n=[],a=0,o=s.length;o>a;a++)n.push(_fnGetCellData(e,t,s[a],i));return n}function _fnGetCellData(e,t,i,s){var n,a=e.aoColumns[i],o=e.aoData[t]._aData;if((n=a.fnGetData(o,s))===undefined)return e.iDrawError!=e.iDraw&&null===a.sDefaultContent&&(_fnLog(e,0,"Requested unknown parameter "+("function"==typeof a.mData?"{mData function}":"'"+a.mData+"'")+" from the data source for row "+t),e.iDrawError=e.iDraw),a.sDefaultContent;if(null===n&&null!==a.sDefaultContent)n=a.sDefaultContent;else if("function"==typeof n)return n();return"display"==s&&null===n?"":n}function _fnSetCellData(e,t,i,s){var n=e.aoColumns[i],a=e.aoData[t]._aData;n.fnSetData(a,s)}function _fnGetObjectDataFn(e){if(null===e)return function(){return null};if("function"==typeof e)return function(t,i,s){return e(t,i,s)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t){return t[e]};var t=function(e,i,s){var n,a,o,r=s.split(".");if(""!==s)for(var l=0,h=r.length;h>l;l++){if(n=r[l].match(__reArray)){r[l]=r[l].replace(__reArray,""),""!==r[l]&&(e=e[r[l]]),a=[],r.splice(0,l+1),o=r.join(".");for(var d=0,c=e.length;c>d;d++)a.push(t(e[d],i,o));var u=n[0].substring(1,n[0].length-1);e=""===u?a:a.join(u);break}if(null===e||e[r[l]]===undefined)return undefined;e=e[r[l]]}return e};return function(i,s){return t(i,s,e)}}function _fnSetObjectDataFn(e){if(null===e)return function(){};if("function"==typeof e)return function(t,i){e(t,"set",i)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t,i){t[e]=i};var t=function(e,i,s){for(var n,a,o,r,l=s.split("."),h=0,d=l.length-1;d>h;h++){if(a=l[h].match(__reArray)){l[h]=l[h].replace(__reArray,""),e[l[h]]=[],n=l.slice(),n.splice(0,h+1),r=n.join(".");for(var c=0,u=i.length;u>c;c++)o={},t(o,i[c],r),e[l[h]].push(o);return}(null===e[l[h]]||e[l[h]]===undefined)&&(e[l[h]]={}),e=e[l[h]]}e[l[l.length-1].replace(__reArray,"")]=i};return function(i,s){return t(i,s,e)}}function _fnGetDataMaster(e){for(var t=[],i=e.aoData.length,s=0;i>s;s++)t.push(e.aoData[s]._aData);return t}function _fnClearTable(e){e.aoData.splice(0,e.aoData.length),e.aiDisplayMaster.splice(0,e.aiDisplayMaster.length),e.aiDisplay.splice(0,e.aiDisplay.length),_fnCalculateEnd(e)}function _fnDeleteIndex(e,t){for(var i=-1,s=0,n=e.length;n>s;s++)e[s]==t?i=s:e[s]>t&&e[s]--;-1!=i&&e.splice(i,1)}function _fnRender(e,t,i){var s=e.aoColumns[i];return s.fnRender({iDataRow:t,iDataColumn:i,oSettings:e,aData:e.aoData[t]._aData,mDataProp:s.mData},_fnGetCellData(e,t,i,"display"))}function _fnCreateTr(e,t){var i,s=e.aoData[t];if(null===s.nTr){s.nTr=document.createElement("tr"),s.nTr._DT_RowIndex=t,s._aData.DT_RowId&&(s.nTr.id=s._aData.DT_RowId),s._aData.DT_RowClass&&(s.nTr.className=s._aData.DT_RowClass);for(var n=0,a=e.aoColumns.length;a>n;n++){var o=e.aoColumns[n];i=document.createElement(o.sCellType),i.innerHTML="function"!=typeof o.fnRender||o.bUseRendered&&null!==o.mData?_fnGetCellData(e,t,n,"display"):_fnRender(e,t,n),null!==o.sClass&&(i.className=o.sClass),o.bVisible?(s.nTr.appendChild(i),s._anHidden[n]=null):s._anHidden[n]=i,o.fnCreatedCell&&o.fnCreatedCell.call(e.oInstance,i,_fnGetCellData(e,t,n,"display"),s._aData,t,n)}_fnCallbackFire(e,"aoRowCreatedCallback",null,[s.nTr,s._aData,t])}}function _fnBuildHead(e){var t,i,s,n=$("th, td",e.nTHead).length;if(0!==n)for(t=0,s=e.aoColumns.length;s>t;t++)i=e.aoColumns[t].nTh,i.setAttribute("role","columnheader"),e.aoColumns[t].bSortable&&(i.setAttribute("tabindex",e.iTabIndex),i.setAttribute("aria-controls",e.sTableId)),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),e.aoColumns[t].sTitle!=i.innerHTML&&(i.innerHTML=e.aoColumns[t].sTitle);else{var a=document.createElement("tr");for(t=0,s=e.aoColumns.length;s>t;t++)i=e.aoColumns[t].nTh,i.innerHTML=e.aoColumns[t].sTitle,i.setAttribute("tabindex","0"),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),a.appendChild(i);$(e.nTHead).html("")[0].appendChild(a),_fnDetectHeader(e.aoHeader,e.nTHead)}if($(e.nTHead).children("tr").attr("role","row"),e.bJUI)for(t=0,s=e.aoColumns.length;s>t;t++){i=e.aoColumns[t].nTh;var o=document.createElement("div");o.className=e.oClasses.sSortJUIWrapper,$(i).contents().appendTo(o);var r=document.createElement("span");r.className=e.oClasses.sSortIcon,o.appendChild(r),i.appendChild(o)}if(e.oFeatures.bSort)for(t=0;t<e.aoColumns.length;t++)e.aoColumns[t].bSortable!==!1?_fnSortAttachListener(e,e.aoColumns[t].nTh,t):$(e.aoColumns[t].nTh).addClass(e.oClasses.sSortableNone);if(""!==e.oClasses.sFooterTH&&$(e.nTFoot).children("tr").children("th").addClass(e.oClasses.sFooterTH),null!==e.nTFoot){var l=_fnGetUniqueThs(e,null,e.aoFooter);for(t=0,s=e.aoColumns.length;s>t;t++)l[t]&&(e.aoColumns[t].nTf=l[t],e.aoColumns[t].sClass&&$(l[t]).addClass(e.aoColumns[t].sClass))}}function _fnDrawHead(e,t,i){var s,n,a,o,r,l,h,d,c,u=[],p=[],f=e.aoColumns.length;for(i===undefined&&(i=!1),s=0,n=t.length;n>s;s++){for(u[s]=t[s].slice(),u[s].nTr=t[s].nTr,a=f-1;a>=0;a--)e.aoColumns[a].bVisible||i||u[s].splice(a,1);p.push([])}for(s=0,n=u.length;n>s;s++){if(h=u[s].nTr)for(;l=h.firstChild;)h.removeChild(l);for(a=0,o=u[s].length;o>a;a++)if(d=1,c=1,p[s][a]===undefined){for(h.appendChild(u[s][a].cell),p[s][a]=1;u[s+d]!==undefined&&u[s][a].cell==u[s+d][a].cell;)p[s+d][a]=1,d++;for(;u[s][a+c]!==undefined&&u[s][a].cell==u[s][a+c].cell;){for(r=0;d>r;r++)p[s+r][a+c]=1;c++}u[s][a].cell.rowSpan=d,u[s][a].cell.colSpan=c}}}function _fnDraw(e){var t=_fnCallbackFire(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==$.inArray(!1,t))return void _fnProcessingDisplay(e,!1);var i,s,n,a=[],o=0,r=e.asStripeClasses.length,l=e.aoOpenRows.length;if(e.bDrawing=!0,e.iInitDisplayStart!==undefined&&-1!=e.iInitDisplayStart&&(e._iDisplayStart=e.oFeatures.bServerSide?e.iInitDisplayStart:e.iInitDisplayStart>=e.fnRecordsDisplay()?0:e.iInitDisplayStart,e.iInitDisplayStart=-1,_fnCalculateEnd(e)),e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++;else if(e.oFeatures.bServerSide){if(!e.bDestroying&&!_fnAjaxUpdate(e))return}else e.iDraw++;if(0!==e.aiDisplay.length){var h=e._iDisplayStart,d=e._iDisplayEnd;e.oFeatures.bServerSide&&(h=0,d=e.aoData.length);for(var c=h;d>c;c++){var u=e.aoData[e.aiDisplay[c]];null===u.nTr&&_fnCreateTr(e,e.aiDisplay[c]);var p=u.nTr;if(0!==r){var f=e.asStripeClasses[o%r];u._sRowStripe!=f&&($(p).removeClass(u._sRowStripe).addClass(f),u._sRowStripe=f)}if(_fnCallbackFire(e,"aoRowCallback",null,[p,e.aoData[e.aiDisplay[c]]._aData,o,c]),a.push(p),o++,0!==l)for(var g=0;l>g;g++)if(p==e.aoOpenRows[g].nParent){a.push(e.aoOpenRows[g].nTr);break}}}else{a[0]=document.createElement("tr"),e.asStripeClasses[0]&&(a[0].className=e.asStripeClasses[0]);var m=e.oLanguage,v=m.sZeroRecords;1!=e.iDraw||null===e.sAjaxSource||e.oFeatures.bServerSide?m.sEmptyTable&&0===e.fnRecordsTotal()&&(v=m.sEmptyTable):v=m.sLoadingRecords;var b=document.createElement("td");b.setAttribute("valign","top"),b.colSpan=_fnVisbleColumns(e),b.className=e.oClasses.sRowEmpty,b.innerHTML=_fnInfoMacros(e,v),a[o].appendChild(b)}_fnCallbackFire(e,"aoHeaderCallback","header",[$(e.nTHead).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]),_fnCallbackFire(e,"aoFooterCallback","footer",[$(e.nTFoot).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]);var y,w=document.createDocumentFragment(),_=document.createDocumentFragment();if(e.nTBody){if(y=e.nTBody.parentNode,_.appendChild(e.nTBody),!e.oScroll.bInfinite||!e._bInitComplete||e.bSorted||e.bFiltered)for(;n=e.nTBody.firstChild;)e.nTBody.removeChild(n);for(i=0,s=a.length;s>i;i++)w.appendChild(a[i]);e.nTBody.appendChild(w),null!==y&&y.appendChild(e.nTBody)}_fnCallbackFire(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1,e.oFeatures.bServerSide&&(_fnProcessingDisplay(e,!1),e._bInitComplete||_fnInitComplete(e))}function _fnReDraw(e){e.oFeatures.bSort?_fnSort(e,e.oPreviousSearch):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(_fnCalculateEnd(e),_fnDraw(e))}function _fnAddOptionsHtml(e){var t=$("<div></div>")[0];e.nTable.parentNode.insertBefore(t,e.nTable),e.nTableWrapper=$('<div id="'+e.sTableId+'_wrapper" class="'+e.oClasses.sWrapper+'" role="grid"></div>')[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var i,s,n,a,o,r,l,h=e.nTableWrapper,d=e.sDom.split(""),c=0;c<d.length;c++){if(s=0,n=d[c],"<"==n){if(a=$("<div></div>")[0],o=d[c+1],"'"==o||'"'==o){for(r="",l=2;d[c+l]!=o;)r+=d[c+l],l++;if("H"==r?r=e.oClasses.sJUIHeader:"F"==r&&(r=e.oClasses.sJUIFooter),-1!=r.indexOf(".")){var u=r.split(".");a.id=u[0].substr(1,u[0].length-1),a.className=u[1]}else"#"==r.charAt(0)?a.id=r.substr(1,r.length-1):a.className=r;c+=l}h.appendChild(a),h=a}else if(">"==n)h=h.parentNode;else if("l"==n&&e.oFeatures.bPaginate&&e.oFeatures.bLengthChange)i=_fnFeatureHtmlLength(e),s=1;else if("f"==n&&e.oFeatures.bFilter)i=_fnFeatureHtmlFilter(e),s=1;else if("r"==n&&e.oFeatures.bProcessing)i=_fnFeatureHtmlProcessing(e),s=1;else if("t"==n)i=_fnFeatureHtmlTable(e),s=1;else if("i"==n&&e.oFeatures.bInfo)i=_fnFeatureHtmlInfo(e),s=1;else if("p"==n&&e.oFeatures.bPaginate)i=_fnFeatureHtmlPaginate(e),s=1;else if(0!==DataTable.ext.aoFeatures.length)for(var p=DataTable.ext.aoFeatures,f=0,g=p.length;g>f;f++)if(n==p[f].cFeature){i=p[f].fnInit(e),i&&(s=1);break}1==s&&null!==i&&("object"!=typeof e.aanFeatures[n]&&(e.aanFeatures[n]=[]),e.aanFeatures[n].push(i),h.appendChild(i))}t.parentNode.replaceChild(e.nTableWrapper,t)}function _fnDetectHeader(e,t){var i,s,n,a,o,r,l,h,d,c,u,p=$(t).children("tr"),f=function(e,t,i){for(var s=e[t];s[i];)i++;return i};for(e.splice(0,e.length),n=0,r=p.length;r>n;n++)e.push([]);for(n=0,r=p.length;r>n;n++)for(i=p[n],h=0,s=i.firstChild;s;){if("TD"==s.nodeName.toUpperCase()||"TH"==s.nodeName.toUpperCase())for(d=1*s.getAttribute("colspan"),c=1*s.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,c=c&&0!==c&&1!==c?c:1,l=f(e,n,h),u=1===d?!0:!1,o=0;d>o;o++)for(a=0;c>a;a++)e[n+a][l+o]={cell:s,unique:u},e[n+a].nTr=i;s=s.nextSibling}}function _fnGetUniqueThs(e,t,i){var s=[];i||(i=e.aoHeader,t&&(i=[],_fnDetectHeader(i,t)));for(var n=0,a=i.length;a>n;n++)for(var o=0,r=i[n].length;r>o;o++)!i[n][o].unique||s[o]&&e.bSortCellsTop||(s[o]=i[n][o].cell);return s}function _fnAjaxUpdate(e){if(e.bAjaxDataGet){e.iDraw++,_fnProcessingDisplay(e,!0);var t=(e.aoColumns.length,_fnAjaxParameters(e));return _fnServerParams(e,t),e.fnServerData.call(e.oInstance,e.sAjaxSource,t,function(t){_fnAjaxUpdateDraw(e,t)},e),!1}return!0}function _fnAjaxParameters(e){var t,i,s,n,a,o=e.aoColumns.length,r=[];for(r.push({name:"sEcho",value:e.iDraw}),r.push({name:"iColumns",value:o}),r.push({name:"sColumns",value:_fnColumnOrdering(e)}),r.push({name:"iDisplayStart",value:e._iDisplayStart}),r.push({name:"iDisplayLength",value:e.oFeatures.bPaginate!==!1?e._iDisplayLength:-1}),n=0;o>n;n++)t=e.aoColumns[n].mData,r.push({name:"mDataProp_"+n,value:"function"==typeof t?"function":t});if(e.oFeatures.bFilter!==!1)for(r.push({name:"sSearch",value:e.oPreviousSearch.sSearch}),r.push({name:"bRegex",value:e.oPreviousSearch.bRegex}),n=0;o>n;n++)r.push({name:"sSearch_"+n,value:e.aoPreSearchCols[n].sSearch}),r.push({name:"bRegex_"+n,value:e.aoPreSearchCols[n].bRegex}),r.push({name:"bSearchable_"+n,value:e.aoColumns[n].bSearchable});if(e.oFeatures.bSort!==!1){var l=0;for(i=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),n=0;n<i.length;n++)for(s=e.aoColumns[i[n][0]].aDataSort,a=0;a<s.length;a++)r.push({name:"iSortCol_"+l,value:s[a]}),r.push({name:"sSortDir_"+l,value:i[n][1]}),l++;for(r.push({name:"iSortingCols",value:l}),n=0;o>n;n++)r.push({name:"bSortable_"+n,value:e.aoColumns[n].bSortable})}return r}function _fnServerParams(e,t){_fnCallbackFire(e,"aoServerParams","serverParams",[t])}function _fnAjaxUpdateDraw(e,t){if(t.sEcho!==undefined){if(1*t.sEcho<e.iDraw)return;e.iDraw=1*t.sEcho}(!e.oScroll.bInfinite||e.oScroll.bInfinite&&(e.bSorted||e.bFiltered))&&_fnClearTable(e),e._iRecordsTotal=parseInt(t.iTotalRecords,10),e._iRecordsDisplay=parseInt(t.iTotalDisplayRecords,10);var i,s=_fnColumnOrdering(e),n=t.sColumns!==undefined&&""!==s&&t.sColumns!=s;n&&(i=_fnReOrderIndex(e,t.sColumns));for(var a=_fnGetObjectDataFn(e.sAjaxDataProp)(t),o=0,r=a.length;r>o;o++)if(n){for(var l=[],h=0,d=e.aoColumns.length;d>h;h++)l.push(a[o][i[h]]);_fnAddData(e,l)}else _fnAddData(e,a[o]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,_fnDraw(e),e.bAjaxDataGet=!0,_fnProcessingDisplay(e,!1)}function _fnFeatureHtmlFilter(e){var t=e.oPreviousSearch,i=e.oLanguage.sSearch;i=-1!==i.indexOf("_INPUT_")?i.replace("_INPUT_",'<input type="text" />'):""===i?'<input type="text" />':i+' <input type="text" />';var s=document.createElement("div");s.className=e.oClasses.sFilter,s.innerHTML="<label>"+i+"</label>",e.aanFeatures.f||(s.id=e.sTableId+"_filter");var n=$('input[type="text"]',s);return s._DT_Input=n[0],n.val(t.sSearch.replace('"',"&quot;")),n.bind("keyup.DT",function(){for(var i=e.aanFeatures.f,s=""===this.value?"":this.value,n=0,a=i.length;a>n;n++)i[n]!=$(this).parents("div.dataTables_filter")[0]&&$(i[n]._DT_Input).val(s);s!=t.sSearch&&_fnFilterComplete(e,{sSearch:s,bRegex:t.bRegex,bSmart:t.bSmart,bCaseInsensitive:t.bCaseInsensitive})}),n.attr("aria-controls",e.sTableId).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}),s}function _fnFilterComplete(e,t,i){var s=e.oPreviousSearch,n=e.aoPreSearchCols,a=function(e){s.sSearch=e.sSearch,s.bRegex=e.bRegex,s.bSmart=e.bSmart,s.bCaseInsensitive=e.bCaseInsensitive};if(e.oFeatures.bServerSide)a(t);else{_fnFilter(e,t.sSearch,i,t.bRegex,t.bSmart,t.bCaseInsensitive),a(t);for(var o=0;o<e.aoPreSearchCols.length;o++)_fnFilterColumn(e,n[o].sSearch,o,n[o].bRegex,n[o].bSmart,n[o].bCaseInsensitive);_fnFilterCustom(e)}e.bFiltered=!0,$(e.oInstance).trigger("filter",e),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e),_fnBuildSearchArray(e,0)}function _fnFilterCustom(e){for(var t=DataTable.ext.afnFiltering,i=_fnGetColumns(e,"bSearchable"),s=0,n=t.length;n>s;s++)for(var a=0,o=0,r=e.aiDisplay.length;r>o;o++){var l=e.aiDisplay[o-a],h=t[s](e,_fnGetRowData(e,l,"filter",i),l);h||(e.aiDisplay.splice(o-a,1),a++)}}function _fnFilterColumn(e,t,i,s,n,a){if(""!==t)for(var o=0,r=_fnFilterCreateSearch(t,s,n,a),l=e.aiDisplay.length-1;l>=0;l--){var h=_fnDataToSearch(_fnGetCellData(e,e.aiDisplay[l],i,"filter"),e.aoColumns[i].sType);r.test(h)||(e.aiDisplay.splice(l,1),o++)}}function _fnFilter(e,t,i,s,n,a){var o,r=_fnFilterCreateSearch(t,s,n,a),l=e.oPreviousSearch;if(i||(i=0),0!==DataTable.ext.afnFiltering.length&&(i=1),t.length<=0)e.aiDisplay.splice(0,e.aiDisplay.length),e.aiDisplay=e.aiDisplayMaster.slice();else if(e.aiDisplay.length==e.aiDisplayMaster.length||l.sSearch.length>t.length||1==i||0!==t.indexOf(l.sSearch))for(e.aiDisplay.splice(0,e.aiDisplay.length),_fnBuildSearchArray(e,1),o=0;o<e.aiDisplayMaster.length;o++)r.test(e.asDataSearch[o])&&e.aiDisplay.push(e.aiDisplayMaster[o]);else{var h=0;for(o=0;o<e.asDataSearch.length;o++)r.test(e.asDataSearch[o])||(e.aiDisplay.splice(o-h,1),h++)}}function _fnBuildSearchArray(e,t){if(!e.oFeatures.bServerSide){e.asDataSearch=[];for(var i=_fnGetColumns(e,"bSearchable"),s=1===t?e.aiDisplayMaster:e.aiDisplay,n=0,a=s.length;a>n;n++)e.asDataSearch[n]=_fnBuildSearchRow(e,_fnGetRowData(e,s[n],"filter",i))}}function _fnBuildSearchRow(e,t){var i=t.join("  ");return-1!==i.indexOf("&")&&(i=$("<div>").html(i).text()),i.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(e,t,i,s){var n,a;return i?(n=t?e.split(" "):_fnEscapeRegex(e).split(" "),a="^(?=.*?"+n.join(")(?=.*?")+").*$",new RegExp(a,s?"i":"")):(e=t?e:_fnEscapeRegex(e),new RegExp(e,s?"i":""))}function _fnDataToSearch(e,t){return"function"==typeof DataTable.ext.ofnSearch[t]?DataTable.ext.ofnSearch[t](e):null===e?"":"html"==t?e.replace(/[\r\n]/g," ").replace(/<.*?>/g,""):"string"==typeof e?e.replace(/[\r\n]/g," "):e}function _fnEscapeRegex(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"],i=new RegExp("(\\"+t.join("|\\")+")","g");return e.replace(i,"\\$1")}function _fnFeatureHtmlInfo(e){var t=document.createElement("div");return t.className=e.oClasses.sInfo,e.aanFeatures.i||(e.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),t.id=e.sTableId+"_info"),e.nTable.setAttribute("aria-describedby",e.sTableId+"_info"),t}function _fnUpdateInfo(e){if(e.oFeatures.bInfo&&0!==e.aanFeatures.i.length){var t,i=e.oLanguage,s=e._iDisplayStart+1,n=e.fnDisplayEnd(),a=e.fnRecordsTotal(),o=e.fnRecordsDisplay();t=0===o?i.sInfoEmpty:i.sInfo,o!=a&&(t+=" "+i.sInfoFiltered),t+=i.sInfoPostFix,t=_fnInfoMacros(e,t),null!==i.fnInfoCallback&&(t=i.fnInfoCallback.call(e.oInstance,e,s,n,a,o,t));for(var r=e.aanFeatures.i,l=0,h=r.length;h>l;l++)$(r[l]).html(t)}}function _fnInfoMacros(e,t){var i=e._iDisplayStart+1,s=e.fnFormatNumber(i),n=e.fnDisplayEnd(),a=e.fnFormatNumber(n),o=e.fnRecordsDisplay(),r=e.fnFormatNumber(o),l=e.fnRecordsTotal(),h=e.fnFormatNumber(l);return e.oScroll.bInfinite&&(s=e.fnFormatNumber(1)),t.replace(/_START_/g,s).replace(/_END_/g,a).replace(/_TOTAL_/g,r).replace(/_MAX_/g,h)}function _fnInitialise(e){var t,i,s=e.iInitDisplayStart;if(e.bInitialised===!1)return void setTimeout(function(){_fnInitialise(e)},200);for(_fnAddOptionsHtml(e),_fnBuildHead(e),_fnDrawHead(e,e.aoHeader),e.nTFoot&&_fnDrawHead(e,e.aoFooter),_fnProcessingDisplay(e,!0),e.oFeatures.bAutoWidth&&_fnCalculateColumnWidths(e),t=0,i=e.aoColumns.length;i>t;t++)null!==e.aoColumns[t].sWidth&&(e.aoColumns[t].nTh.style.width=_fnStringToCss(e.aoColumns[t].sWidth));if(e.oFeatures.bSort?_fnSort(e):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),null!==e.sAjaxSource&&!e.oFeatures.bServerSide){var n=[];return _fnServerParams(e,n),void e.fnServerData.call(e.oInstance,e.sAjaxSource,n,function(i){var n=""!==e.sAjaxDataProp?_fnGetObjectDataFn(e.sAjaxDataProp)(i):i;for(t=0;t<n.length;t++)_fnAddData(e,n[t]);e.iInitDisplayStart=s,e.oFeatures.bSort?_fnSort(e):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),_fnProcessingDisplay(e,!1),_fnInitComplete(e,i)},e)}e.oFeatures.bServerSide||(_fnProcessingDisplay(e,!1),_fnInitComplete(e))}function _fnInitComplete(e,t){e._bInitComplete=!0,_fnCallbackFire(e,"aoInitComplete","init",[e,t])}function _fnLanguageCompat(e){var t=DataTable.defaults.oLanguage;!e.sEmptyTable&&e.sZeroRecords&&"No data available in table"===t.sEmptyTable&&_fnMap(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&e.sZeroRecords&&"Loading..."===t.sLoadingRecords&&_fnMap(e,e,"sZeroRecords","sLoadingRecords")
}function _fnFeatureHtmlLength(e){if(e.oScroll.bInfinite)return null;var t,i,s='name="'+e.sTableId+'_length"',n='<select size="1" '+s+">",a=e.aLengthMenu;if(2==a.length&&"object"==typeof a[0]&&"object"==typeof a[1])for(t=0,i=a[0].length;i>t;t++)n+='<option value="'+a[0][t]+'">'+a[1][t]+"</option>";else for(t=0,i=a.length;i>t;t++)n+='<option value="'+a[t]+'">'+a[t]+"</option>";n+="</select>";var o=document.createElement("div");return e.aanFeatures.l||(o.id=e.sTableId+"_length"),o.className=e.oClasses.sLength,o.innerHTML="<label>"+e.oLanguage.sLengthMenu.replace("_MENU_",n)+"</label>",$('select option[value="'+e._iDisplayLength+'"]',o).attr("selected",!0),$("select",o).bind("change.DT",function(){var s=$(this).val(),n=e.aanFeatures.l;for(t=0,i=n.length;i>t;t++)n[t]!=this.parentNode&&$("select",n[t]).val(s);e._iDisplayLength=parseInt(s,10),_fnCalculateEnd(e),e.fnDisplayEnd()==e.fnRecordsDisplay()&&(e._iDisplayStart=e.fnDisplayEnd()-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),-1==e._iDisplayLength&&(e._iDisplayStart=0),_fnDraw(e)}),$("select",o).attr("aria-controls",e.sTableId),o}function _fnCalculateEnd(e){e._iDisplayEnd=e.oFeatures.bPaginate===!1?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength>e.aiDisplay.length||-1==e._iDisplayLength?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength}function _fnFeatureHtmlPaginate(e){if(e.oScroll.bInfinite)return null;var t=document.createElement("div");return t.className=e.oClasses.sPaging+e.sPaginationType,DataTable.ext.oPagination[e.sPaginationType].fnInit(e,t,function(e){_fnCalculateEnd(e),_fnDraw(e)}),e.aanFeatures.p||e.aoDrawCallback.push({fn:function(e){DataTable.ext.oPagination[e.sPaginationType].fnUpdate(e,function(e){_fnCalculateEnd(e),_fnDraw(e)})},sName:"pagination"}),t}function _fnPageChange(e,t){var i=e._iDisplayStart;if("number"==typeof t)e._iDisplayStart=t*e._iDisplayLength,e._iDisplayStart>e.fnRecordsDisplay()&&(e._iDisplayStart=0);else if("first"==t)e._iDisplayStart=0;else if("previous"==t)e._iDisplayStart=e._iDisplayLength>=0?e._iDisplayStart-e._iDisplayLength:0,e._iDisplayStart<0&&(e._iDisplayStart=0);else if("next"==t)e._iDisplayLength>=0?e._iDisplayStart+e._iDisplayLength<e.fnRecordsDisplay()&&(e._iDisplayStart+=e._iDisplayLength):e._iDisplayStart=0;else if("last"==t)if(e._iDisplayLength>=0){var s=parseInt((e.fnRecordsDisplay()-1)/e._iDisplayLength,10)+1;e._iDisplayStart=(s-1)*e._iDisplayLength}else e._iDisplayStart=0;else _fnLog(e,0,"Unknown paging action: "+t);return $(e.oInstance).trigger("page",e),i!=e._iDisplayStart}function _fnFeatureHtmlProcessing(e){var t=document.createElement("div");return e.aanFeatures.r||(t.id=e.sTableId+"_processing"),t.innerHTML=e.oLanguage.sProcessing,t.className=e.oClasses.sProcessing,e.nTable.parentNode.insertBefore(t,e.nTable),t}function _fnProcessingDisplay(e,t){if(e.oFeatures.bProcessing)for(var i=e.aanFeatures.r,s=0,n=i.length;n>s;s++)i[s].style.visibility=t?"visible":"hidden";$(e.oInstance).trigger("processing",[e,t])}function _fnFeatureHtmlTable(e){if(""===e.oScroll.sX&&""===e.oScroll.sY)return e.nTable;var t=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),r=e.nTable.cloneNode(!1),l=e.nTable.cloneNode(!1),h=e.nTable.getElementsByTagName("thead")[0],d=0===e.nTable.getElementsByTagName("tfoot").length?null:e.nTable.getElementsByTagName("tfoot")[0],c=e.oClasses;i.appendChild(s),a.appendChild(o),n.appendChild(e.nTable),t.appendChild(i),t.appendChild(n),s.appendChild(r),r.appendChild(h),null!==d&&(t.appendChild(a),o.appendChild(l),l.appendChild(d)),t.className=c.sScrollWrapper,i.className=c.sScrollHead,s.className=c.sScrollHeadInner,n.className=c.sScrollBody,a.className=c.sScrollFoot,o.className=c.sScrollFootInner,e.oScroll.bAutoCss&&(i.style.overflow="hidden",i.style.position="relative",a.style.overflow="hidden",n.style.overflow="auto"),i.style.border="0",i.style.width="100%",a.style.border="0",s.style.width=""!==e.oScroll.sXInner?e.oScroll.sXInner:"100%",r.removeAttribute("id"),r.style.marginLeft="0",e.nTable.style.marginLeft="0",null!==d&&(l.removeAttribute("id"),l.style.marginLeft="0");var u=$(e.nTable).children("caption");return u.length>0&&(u=u[0],"top"===u._captionSide?r.appendChild(u):"bottom"===u._captionSide&&d&&l.appendChild(u)),""!==e.oScroll.sX&&(i.style.width=_fnStringToCss(e.oScroll.sX),n.style.width=_fnStringToCss(e.oScroll.sX),null!==d&&(a.style.width=_fnStringToCss(e.oScroll.sX)),$(n).scroll(function(){i.scrollLeft=this.scrollLeft,null!==d&&(a.scrollLeft=this.scrollLeft)})),""!==e.oScroll.sY&&(n.style.height=_fnStringToCss(e.oScroll.sY)),e.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),e.oScroll.bInfinite&&$(n).scroll(function(){e.bDrawing||0===$(this).scrollTop()||$(this).scrollTop()+$(this).height()>$(e.nTable).height()-e.oScroll.iLoadGap&&e.fnDisplayEnd()<e.fnRecordsDisplay()&&(_fnPageChange(e,"next"),_fnCalculateEnd(e),_fnDraw(e))}),e.nScrollHead=i,e.nScrollFoot=a,t}function _fnScrollDraw(e){var t,i,s,n,a,o,r,l,h,d,c,u=e.nScrollHead.getElementsByTagName("div")[0],p=u.getElementsByTagName("table")[0],f=e.nTable.parentNode,g=[],m=[],v=null!==e.nTFoot?e.nScrollFoot.getElementsByTagName("div")[0]:null,b=null!==e.nTFoot?v.getElementsByTagName("table")[0]:null,y=e.oBrowser.bScrollOversize,w=function(e){r=e.style,r.paddingTop="0",r.paddingBottom="0",r.borderTopWidth="0",r.borderBottomWidth="0",r.height=0};$(e.nTable).children("thead, tfoot").remove(),h=$(e.nTHead).clone()[0],e.nTable.insertBefore(h,e.nTable.childNodes[0]),s=e.nTHead.getElementsByTagName("tr"),n=h.getElementsByTagName("tr"),null!==e.nTFoot&&(d=$(e.nTFoot).clone()[0],e.nTable.insertBefore(d,e.nTable.childNodes[1]),o=e.nTFoot.getElementsByTagName("tr"),a=d.getElementsByTagName("tr")),""===e.oScroll.sX&&(f.style.width="100%",u.parentNode.style.width="100%");var _=_fnGetUniqueThs(e,h);for(t=0,i=_.length;i>t;t++)l=_fnVisibleToColumnIndex(e,t),_[t].style.width=e.aoColumns[l].sWidth;if(null!==e.nTFoot&&_fnApplyToChildren(function(e){e.style.width=""},a),e.oScroll.bCollapse&&""!==e.oScroll.sY&&(f.style.height=f.offsetHeight+e.nTHead.offsetHeight+"px"),c=$(e.nTable).outerWidth(),""===e.oScroll.sX?(e.nTable.style.width="100%",y&&($("tbody",f).height()>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss($(e.nTable).outerWidth()-e.oScroll.iBarWidth))):""!==e.oScroll.sXInner?e.nTable.style.width=_fnStringToCss(e.oScroll.sXInner):c==$(f).width()&&$(f).height()<$(e.nTable).height()?(e.nTable.style.width=_fnStringToCss(c-e.oScroll.iBarWidth),$(e.nTable).outerWidth()>c-e.oScroll.iBarWidth&&(e.nTable.style.width=_fnStringToCss(c))):e.nTable.style.width=_fnStringToCss(c),c=$(e.nTable).outerWidth(),_fnApplyToChildren(w,n),_fnApplyToChildren(function(e){g.push(_fnStringToCss($(e).width()))},n),_fnApplyToChildren(function(e,t){e.style.width=g[t]},s),$(n).height(0),null!==e.nTFoot&&(_fnApplyToChildren(w,a),_fnApplyToChildren(function(e){m.push(_fnStringToCss($(e).width()))},a),_fnApplyToChildren(function(e,t){e.style.width=m[t]},o),$(a).height(0)),_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=g[t]},n),null!==e.nTFoot&&_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=m[t]},a),$(e.nTable).outerWidth()<c){var C=f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y")?c+e.oScroll.iBarWidth:c;y&&(f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss(C-e.oScroll.iBarWidth)),f.style.width=_fnStringToCss(C),e.nScrollHead.style.width=_fnStringToCss(C),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss(C)),""===e.oScroll.sX?_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):""!==e.oScroll.sXInner&&_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}else f.style.width=_fnStringToCss("100%"),e.nScrollHead.style.width=_fnStringToCss("100%"),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss("100%"));if(""===e.oScroll.sY&&y&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+e.oScroll.iBarWidth)),""!==e.oScroll.sY&&e.oScroll.bCollapse){f.style.height=_fnStringToCss(e.oScroll.sY);var x=""!==e.oScroll.sX&&e.nTable.offsetWidth>f.offsetWidth?e.oScroll.iBarWidth:0;e.nTable.offsetHeight<f.offsetHeight&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+x))}var S=$(e.nTable).outerWidth();p.style.width=_fnStringToCss(S),u.style.width=_fnStringToCss(S);var k=$(e.nTable).height()>f.clientHeight||"scroll"==$(f).css("overflow-y");u.style.paddingRight=k?e.oScroll.iBarWidth+"px":"0px",null!==e.nTFoot&&(b.style.width=_fnStringToCss(S),v.style.width=_fnStringToCss(S),v.style.paddingRight=k?e.oScroll.iBarWidth+"px":"0px"),$(f).scroll(),(e.bSorted||e.bFiltered)&&(f.scrollTop=0)}function _fnApplyToChildren(e,t,i){for(var s,n,a=0,o=0,r=t.length;r>o;){for(s=t[o].firstChild,n=i?i[o].firstChild:null;s;)1===s.nodeType&&(i?e(s,n,a):e(s,a),a++),s=s.nextSibling,n=i?n.nextSibling:null;o++}}function _fnConvertToWidth(e,t){if(!e||null===e||""===e)return 0;t||(t=document.body);var i,s=document.createElement("div");return s.style.width=_fnStringToCss(e),t.appendChild(s),i=s.offsetWidth,t.removeChild(s),i}function _fnCalculateColumnWidths(e){var t,i,s,n,a=(e.nTable.offsetWidth,0),o=0,r=e.aoColumns.length,l=$("th",e.nTHead),h=e.nTable.getAttribute("width"),d=e.nTable.parentNode;for(i=0;r>i;i++)e.aoColumns[i].bVisible&&(o++,null!==e.aoColumns[i].sWidth&&(t=_fnConvertToWidth(e.aoColumns[i].sWidthOrig,d),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t)),a++));if(r==l.length&&0===a&&o==r&&""===e.oScroll.sX&&""===e.oScroll.sY)for(i=0;i<e.aoColumns.length;i++)t=$(l[i]).width(),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t));else{var c=e.nTable.cloneNode(!1),u=e.nTHead.cloneNode(!0),p=document.createElement("tbody"),f=document.createElement("tr");c.removeAttribute("id"),c.appendChild(u),null!==e.nTFoot&&(c.appendChild(e.nTFoot.cloneNode(!0)),_fnApplyToChildren(function(e){e.style.width=""},c.getElementsByTagName("tr"))),c.appendChild(p),p.appendChild(f);var g=$("thead th",c);0===g.length&&(g=$("tbody tr:eq(0)>td",c));var m=_fnGetUniqueThs(e,u);for(s=0,i=0;r>i;i++){var v=e.aoColumns[i];v.bVisible&&null!==v.sWidthOrig&&""!==v.sWidthOrig?m[i-s].style.width=_fnStringToCss(v.sWidthOrig):v.bVisible?m[i-s].style.width="":s++}for(i=0;r>i;i++)if(e.aoColumns[i].bVisible){var b=_fnGetWidestNode(e,i);null!==b&&(b=b.cloneNode(!0),""!==e.aoColumns[i].sContentPadding&&(b.innerHTML+=e.aoColumns[i].sContentPadding),f.appendChild(b))}d.appendChild(c),""!==e.oScroll.sX&&""!==e.oScroll.sXInner?c.style.width=_fnStringToCss(e.oScroll.sXInner):""!==e.oScroll.sX?(c.style.width="",$(c).width()<d.offsetWidth&&(c.style.width=_fnStringToCss(d.offsetWidth))):""!==e.oScroll.sY?c.style.width=_fnStringToCss(d.offsetWidth):h&&(c.style.width=_fnStringToCss(h)),c.style.visibility="hidden",_fnScrollingWidthAdjust(e,c);var y=$("tbody tr:eq(0)",c).children();if(0===y.length&&(y=_fnGetUniqueThs(e,$("thead",c)[0])),""!==e.oScroll.sX){var w=0;for(s=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(w+=null===e.aoColumns[i].sWidthOrig?$(y[s]).outerWidth():parseInt(e.aoColumns[i].sWidth.replace("px",""),10)+($(y[s]).outerWidth()-$(y[s]).width()),s++);c.style.width=_fnStringToCss(w),e.nTable.style.width=_fnStringToCss(w)}for(s=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(n=$(y[s]).width(),null!==n&&n>0&&(e.aoColumns[i].sWidth=_fnStringToCss(n)),s++);var _=$(c).css("width");e.nTable.style.width=-1!==_.indexOf("%")?_:_fnStringToCss($(c).outerWidth()),c.parentNode.removeChild(c)}h&&(e.nTable.style.width=_fnStringToCss(h))}function _fnScrollingWidthAdjust(e,t){if(""===e.oScroll.sX&&""!==e.oScroll.sY){{$(t).width()}t.style.width=_fnStringToCss($(t).outerWidth()-e.oScroll.iBarWidth)}else""!==e.oScroll.sX&&(t.style.width=_fnStringToCss($(t).outerWidth()))}function _fnGetWidestNode(e,t){var i=_fnGetMaxLenString(e,t);if(0>i)return null;if(null===e.aoData[i].nTr){var s=document.createElement("td");return s.innerHTML=_fnGetCellData(e,i,t,""),s}return _fnGetTdNodes(e,i)[t]}function _fnGetMaxLenString(e,t){for(var i=-1,s=-1,n=0;n<e.aoData.length;n++){var a=_fnGetCellData(e,n,t,"display")+"";a=a.replace(/<.*?>/g,""),a.length>i&&(i=a.length,s=n)}return s}function _fnStringToCss(e){if(null===e)return"0px";if("number"==typeof e)return 0>e?"0px":e+"px";var t=e.charCodeAt(e.length-1);return 48>t||t>57?e:e+"px"}function _fnScrollBarWidth(){var e=document.createElement("p"),t=e.style;t.width="100%",t.height="200px",t.padding="0px";var i=document.createElement("div");t=i.style,t.position="absolute",t.top="0px",t.left="0px",t.visibility="hidden",t.width="200px",t.height="150px",t.padding="0px",t.overflow="hidden",i.appendChild(e),document.body.appendChild(i);var s=e.offsetWidth;i.style.overflow="scroll";var n=e.offsetWidth;return s==n&&(n=i.clientWidth),document.body.removeChild(i),s-n}function _fnSort(e,t){var i,s,n,a,o,r,l,h,d=[],c=[],u=DataTable.ext.oSort,p=e.aoData,f=e.aoColumns,g=e.oLanguage.oAria;if(!e.oFeatures.bServerSide&&(0!==e.aaSorting.length||null!==e.aaSortingFixed)){for(d=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),i=0;i<d.length;i++){var m=d[i][0],v=_fnColumnIndexToVisible(e,m);if(l=e.aoColumns[m].sSortDataType,DataTable.ext.afnSortData[l]){var b=DataTable.ext.afnSortData[l].call(e.oInstance,e,m,v);if(b.length===p.length)for(n=0,a=p.length;a>n;n++)_fnSetCellData(e,n,m,b[n]);else _fnLog(e,0,"Returned data sort array (col "+m+") is the wrong length")}}for(i=0,s=e.aiDisplayMaster.length;s>i;i++)c[e.aiDisplayMaster[i]]=i;var y,w,_=d.length;for(i=0,s=p.length;s>i;i++)for(n=0;_>n;n++)for(w=f[d[n][0]].aDataSort,o=0,r=w.length;r>o;o++)l=f[w[o]].sType,y=u[(l?l:"string")+"-pre"],p[i]._aSortData[w[o]]=y?y(_fnGetCellData(e,i,w[o],"sort")):_fnGetCellData(e,i,w[o],"sort");e.aiDisplayMaster.sort(function(e,t){var i,s,n,a,o,r;for(i=0;_>i;i++)for(o=f[d[i][0]].aDataSort,s=0,n=o.length;n>s;s++)if(r=f[o[s]].sType,a=u[(r?r:"string")+"-"+d[i][1]](p[e]._aSortData[o[s]],p[t]._aSortData[o[s]]),0!==a)return a;return u["numeric-asc"](c[e],c[t])})}for(t!==undefined&&!t||e.oFeatures.bDeferRender||_fnSortingClasses(e),i=0,s=e.aoColumns.length;s>i;i++){var C=f[i].sTitle.replace(/<.*?>/g,"");if(h=f[i].nTh,h.removeAttribute("aria-sort"),h.removeAttribute("aria-label"),f[i].bSortable)if(d.length>0&&d[0][0]==i){h.setAttribute("aria-sort","asc"==d[0][1]?"ascending":"descending");var x=f[i].asSorting[d[0][2]+1]?f[i].asSorting[d[0][2]+1]:f[i].asSorting[0];h.setAttribute("aria-label",C+("asc"==x?g.sSortAscending:g.sSortDescending))}else h.setAttribute("aria-label",C+("asc"==f[i].asSorting[0]?g.sSortAscending:g.sSortDescending));else h.setAttribute("aria-label",C)}e.bSorted=!0,$(e.oInstance).trigger("sort",e),e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch,1):(e.aiDisplay=e.aiDisplayMaster.slice(),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e))}function _fnSortAttachListener(e,t,i,s){_fnBindAction(t,{},function(t){if(e.aoColumns[i].bSortable!==!1){var n=function(){var s,n;if(t.shiftKey){for(var a=!1,o=0;o<e.aaSorting.length;o++)if(e.aaSorting[o][0]==i){a=!0,s=e.aaSorting[o][0],n=e.aaSorting[o][2]+1,e.aoColumns[s].asSorting[n]?(e.aaSorting[o][1]=e.aoColumns[s].asSorting[n],e.aaSorting[o][2]=n):e.aaSorting.splice(o,1);break}a===!1&&e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0])}else 1==e.aaSorting.length&&e.aaSorting[0][0]==i?(s=e.aaSorting[0][0],n=e.aaSorting[0][2]+1,e.aoColumns[s].asSorting[n]||(n=0),e.aaSorting[0][1]=e.aoColumns[s].asSorting[n],e.aaSorting[0][2]=n):(e.aaSorting.splice(0,e.aaSorting.length),e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0]));_fnSort(e)};e.oFeatures.bProcessing?(_fnProcessingDisplay(e,!0),setTimeout(function(){n(),e.oFeatures.bServerSide||_fnProcessingDisplay(e,!1)},0)):n(),"function"==typeof s&&s(e)}})}function _fnSortingClasses(e){var t,i,s,n,a,o,r=e.aoColumns.length,l=e.oClasses;for(t=0;r>t;t++)e.aoColumns[t].bSortable&&$(e.aoColumns[t].nTh).removeClass(l.sSortAsc+" "+l.sSortDesc+" "+e.aoColumns[t].sSortingClass);for(a=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),t=0;t<e.aoColumns.length;t++)if(e.aoColumns[t].bSortable){for(o=e.aoColumns[t].sSortingClass,n=-1,s=0;s<a.length;s++)if(a[s][0]==t){o="asc"==a[s][1]?l.sSortAsc:l.sSortDesc,n=s;break}if($(e.aoColumns[t].nTh).addClass(o),e.bJUI){var h=$("span."+l.sSortIcon,e.aoColumns[t].nTh);h.removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed);var d;d=-1==n?e.aoColumns[t].sSortingClassJUI:"asc"==a[n][1]?l.sSortJUIAsc:l.sSortJUIDesc,h.addClass(d)}}else $(e.aoColumns[t].nTh).addClass(e.aoColumns[t].sSortingClass);if(o=l.sSortColumn,e.oFeatures.bSort&&e.oFeatures.bSortClasses){var c,u,p=_fnGetTdNodes(e),f=[];for(t=0;r>t;t++)f.push("");for(t=0,c=1;t<a.length;t++)u=parseInt(a[t][0],10),f[u]=o+c,3>c&&c++;var g,m,v,b=new RegExp(o+"[123]");for(t=0,i=p.length;i>t;t++)u=t%r,m=p[t].className,v=f[u],g=m.replace(b,v),g!=m?p[t].className=$.trim(g):v.length>0&&-1==m.indexOf(v)&&(p[t].className=m+" "+v)}}function _fnSaveState(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var t,i,s=e.oScroll.bInfinite,n={iCreate:(new Date).getTime(),iStart:s?0:e._iDisplayStart,iEnd:s?e._iDisplayLength:e._iDisplayEnd,iLength:e._iDisplayLength,aaSorting:$.extend(!0,[],e.aaSorting),oSearch:$.extend(!0,{},e.oPreviousSearch),aoSearchCols:$.extend(!0,[],e.aoPreSearchCols),abVisCols:[]};for(t=0,i=e.aoColumns.length;i>t;t++)n.abVisCols.push(e.aoColumns[t].bVisible);_fnCallbackFire(e,"aoStateSaveParams","stateSaveParams",[e,n]),e.fnStateSave.call(e.oInstance,e,n)}}function _fnLoadState(e,t){if(e.oFeatures.bStateSave){var i=e.fnStateLoad.call(e.oInstance,e);if(i){var s=_fnCallbackFire(e,"aoStateLoadParams","stateLoadParams",[e,i]);if(-1===$.inArray(!1,s)){e.oLoadedState=$.extend(!0,{},i),e._iDisplayStart=i.iStart,e.iInitDisplayStart=i.iStart,e._iDisplayEnd=i.iEnd,e._iDisplayLength=i.iLength,e.aaSorting=i.aaSorting.slice(),e.saved_aaSorting=i.aaSorting.slice(),$.extend(e.oPreviousSearch,i.oSearch),$.extend(!0,e.aoPreSearchCols,i.aoSearchCols),t.saved_aoColumns=[];for(var n=0;n<i.abVisCols.length;n++)t.saved_aoColumns[n]={},t.saved_aoColumns[n].bVisible=i.abVisCols[n];_fnCallbackFire(e,"aoStateLoaded","stateLoaded",[e,i])}}}}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date;date.setTime(date.getTime()+1e3*iSecs);var aParts=window.location.pathname.split("/"),sNameFile=sName+"_"+aParts.pop().replace(/[\/:]/g,"").toLowerCase(),sFullCookie,oData;null!==fnCallback?(oData="function"==typeof $.parseJSON?$.parseJSON(sValue):eval("("+sValue+")"),sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join("/")+"/")):sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join("/")+"/";var aCookies=document.cookie.split(";"),iNewCookieLen=sFullCookie.split(";")[0].length,aOldCookies=[];if(iNewCookieLen+document.cookie.length+10>4096){for(var i=0,iLen=aCookies.length;iLen>i;i++)if(-1!=aCookies[i].indexOf(sBaseName)){var aSplitCookie=aCookies[i].split("=");try{oData=eval("("+decodeURIComponent(aSplitCookie[1])+")"),oData&&oData.iCreate&&aOldCookies.push({name:aSplitCookie[0],time:oData.iCreate})}catch(e){}}for(aOldCookies.sort(function(e,t){return t.time-e.time});iNewCookieLen+document.cookie.length+10>4096;){if(0===aOldCookies.length)return;var old=aOldCookies.pop();document.cookie=old.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join("/")+"/"}}document.cookie=sFullCookie}function _fnReadCookie(e){for(var t=window.location.pathname.split("/"),i=e+"_"+t[t.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",s=document.cookie.split(";"),n=0;n<s.length;n++){for(var a=s[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(i))return decodeURIComponent(a.substring(i.length,a.length))}return null}function _fnSettingsFromNode(e){for(var t=0;t<DataTable.settings.length;t++)if(DataTable.settings[t].nTable===e)return DataTable.settings[t];return null}function _fnGetTrNodes(e){for(var t=[],i=e.aoData,s=0,n=i.length;n>s;s++)null!==i[s].nTr&&t.push(i[s].nTr);return t}function _fnGetTdNodes(e,t){var i,s,n,a,o,r,l,h,d=[],c=e.aoData.length,u=0,p=c;for(t!==undefined&&(u=t,p=t+1),a=u;p>a;a++)if(l=e.aoData[a],null!==l.nTr){for(s=[],n=l.nTr.firstChild;n;)h=n.nodeName.toLowerCase(),("td"==h||"th"==h)&&s.push(n),n=n.nextSibling;for(i=0,o=0,r=e.aoColumns.length;r>o;o++)e.aoColumns[o].bVisible?d.push(s[o-i]):(d.push(l._anHidden[o]),i++)}return d}function _fnLog(e,t,i){var s=null===e?"DataTables warning: "+i:"DataTables warning (table id = '"+e.sTableId+"'): "+i;if(0===t){if("alert"!=DataTable.ext.sErrMode)throw new Error(s);return void alert(s)}window.console&&console.log&&console.log(s)}function _fnMap(e,t,i,s){s===undefined&&(s=i),t[i]!==undefined&&(e[s]=t[i])}function _fnExtend(e,t){var i;for(var s in t)t.hasOwnProperty(s)&&(i=t[s],"object"==typeof oInit[s]&&null!==i&&$.isArray(i)===!1?$.extend(!0,e[s],i):e[s]=i);return e}function _fnBindAction(e,t,i){$(e).bind("click.DT",t,function(t){e.blur(),i(t)}).bind("keypress.DT",t,function(e){13===e.which&&i(e)}).bind("selectstart.DT",function(){return!1})}function _fnCallbackReg(e,t,i,s){i&&e[t].push({fn:i,sName:s})}function _fnCallbackFire(e,t,i,s){for(var n=e[t],a=[],o=n.length-1;o>=0;o--)a.push(n[o].fn.apply(e.oInstance,s));return null!==i&&$(e.oInstance).trigger(i,s),a}function _fnBrowserDetect(e){var t=$('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];document.body.appendChild(t),e.oBrowser.bScrollOversize=100===$("#DT_BrowserTest",t)[0].offsetWidth?!0:!1,document.body.removeChild(t)}function _fnExternApiFunc(e){return function(){var t=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.oApi[e].apply(this,t)}}var __reArray=/\[.*?\]$/,_fnJsonString=window.JSON?JSON.stringify:function(e){var t=typeof e;if("object"!==t||null===e)return"string"===t&&(e='"'+e+'"'),e+"";var i,s,n=[],a=$.isArray(e);for(i in e)s=e[i],t=typeof s,"string"===t?s='"'+s+'"':"object"===t&&null!==s&&(s=_fnJsonString(s)),n.push((a?"":'"'+i+'":')+s);return(a?"[":"{")+n+(a?"]":"}")};this.$=function(e,t){var i,s,n,a=[],o=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),r=o.aoData,l=o.aiDisplay,h=o.aiDisplayMaster;if(t||(t={}),t=$.extend({},{filter:"none",order:"current",page:"all"},t),"current"==t.page)for(i=o._iDisplayStart,s=o.fnDisplayEnd();s>i;i++)n=r[l[i]].nTr,n&&a.push(n);else if("current"==t.order&&"none"==t.filter)for(i=0,s=h.length;s>i;i++)n=r[h[i]].nTr,n&&a.push(n);else if("current"==t.order&&"applied"==t.filter)for(i=0,s=l.length;s>i;i++)n=r[l[i]].nTr,n&&a.push(n);else if("original"==t.order&&"none"==t.filter)for(i=0,s=r.length;s>i;i++)n=r[i].nTr,n&&a.push(n);else if("original"==t.order&&"applied"==t.filter)for(i=0,s=r.length;s>i;i++)n=r[i].nTr,-1!==$.inArray(i,l)&&n&&a.push(n);else _fnLog(o,1,"Unknown selection options");var d=$(a),c=d.filter(e),u=d.find(e);return $([].concat($.makeArray(c),$.makeArray(u)))},this._=function(e,t){var i,s,n=[],a=this.$(e,t);for(i=0,s=a.length;s>i;i++)n.push(this.fnGetData(a[i]));return n},this.fnAddData=function(e,t){if(0===e.length)return[];var i,s=[],n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if("object"==typeof e[0]&&null!==e[0])for(var a=0;a<e.length;a++){if(i=_fnAddData(n,e[a]),-1==i)return s;s.push(i)}else{if(i=_fnAddData(n,e),-1==i)return s;s.push(i)}return n.aiDisplay=n.aiDisplayMaster.slice(),(t===undefined||t)&&_fnReDraw(n),s},this.fnAdjustColumnSizing=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnAdjustColumnSizing(t),e===undefined||e?this.fnDraw(!1):(""!==t.oScroll.sX||""!==t.oScroll.sY)&&this.oApi._fnScrollDraw(t)},this.fnClearTable=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnClearTable(t),(e===undefined||e)&&_fnDraw(t)},this.fnClose=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=0;i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e){var s=t.aoOpenRows[i].nTr.parentNode;return s&&s.removeChild(t.aoOpenRows[i].nTr),t.aoOpenRows.splice(i,1),0}return 1},this.fnDeleteRow=function(e,t,i){var s,n,a,o=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);a="object"==typeof e?_fnNodeToDataIndex(o,e):e;var r=o.aoData.splice(a,1);for(s=0,n=o.aoData.length;n>s;s++)null!==o.aoData[s].nTr&&(o.aoData[s].nTr._DT_RowIndex=s);var l=$.inArray(a,o.aiDisplay);return o.asDataSearch.splice(l,1),_fnDeleteIndex(o.aiDisplayMaster,a),_fnDeleteIndex(o.aiDisplay,a),"function"==typeof t&&t.call(this,o,r),o._iDisplayStart>=o.fnRecordsDisplay()&&(o._iDisplayStart-=o._iDisplayLength,o._iDisplayStart<0&&(o._iDisplayStart=0)),(i===undefined||i)&&(_fnCalculateEnd(o),_fnDraw(o)),r},this.fnDestroy=function(e){var t,i,s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=s.nTableWrapper.parentNode,a=s.nTBody;if(e=e===undefined?!1:e,s.bDestroying=!0,_fnCallbackFire(s,"aoDestroyCallback","destroy",[s]),!e)for(t=0,i=s.aoColumns.length;i>t;t++)s.aoColumns[t].bVisible===!1&&this.fnSetColumnVis(t,!0);for($(s.nTableWrapper).find("*").andSelf().unbind(".DT"),$("tbody>tr>td."+s.oClasses.sRowEmpty,s.nTable).parent().remove(),s.nTable!=s.nTHead.parentNode&&($(s.nTable).children("thead").remove(),s.nTable.appendChild(s.nTHead)),s.nTFoot&&s.nTable!=s.nTFoot.parentNode&&($(s.nTable).children("tfoot").remove(),s.nTable.appendChild(s.nTFoot)),s.nTable.parentNode.removeChild(s.nTable),$(s.nTableWrapper).remove(),s.aaSorting=[],s.aaSortingFixed=[],_fnSortingClasses(s),$(_fnGetTrNodes(s)).removeClass(s.asStripeClasses.join(" ")),$("th, td",s.nTHead).removeClass([s.oClasses.sSortable,s.oClasses.sSortableAsc,s.oClasses.sSortableDesc,s.oClasses.sSortableNone].join(" ")),s.bJUI&&($("th span."+s.oClasses.sSortIcon+", td span."+s.oClasses.sSortIcon,s.nTHead).remove(),$("th, td",s.nTHead).each(function(){var e=$("div."+s.oClasses.sSortJUIWrapper,this),t=e.contents();$(this).append(t),e.remove()})),!e&&s.nTableReinsertBefore?n.insertBefore(s.nTable,s.nTableReinsertBefore):e||n.appendChild(s.nTable),t=0,i=s.aoData.length;i>t;t++)null!==s.aoData[t].nTr&&a.appendChild(s.aoData[t].nTr);if(s.oFeatures.bAutoWidth===!0&&(s.nTable.style.width=_fnStringToCss(s.sDestroyWidth)),i=s.asDestroyStripes.length){var o=$(a).children("tr");for(t=0;i>t;t++)o.filter(":nth-child("+i+"n + "+t+")").addClass(s.asDestroyStripes[t])}for(t=0,i=DataTable.settings.length;i>t;t++)DataTable.settings[t]==s&&DataTable.settings.splice(t,1);s=null,oInit=null},this.fnDraw=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);e===!1?(_fnCalculateEnd(t),_fnDraw(t)):_fnReDraw(t)},this.fnFilter=function(e,t,i,s,n,a){var o=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(o.oFeatures.bFilter)if((i===undefined||null===i)&&(i=!1),(s===undefined||null===s)&&(s=!0),(n===undefined||null===n)&&(n=!0),(a===undefined||null===a)&&(a=!0),t===undefined||null===t){if(_fnFilterComplete(o,{sSearch:e+"",bRegex:i,bSmart:s,bCaseInsensitive:a},1),n&&o.aanFeatures.f)for(var r=o.aanFeatures.f,l=0,h=r.length;h>l;l++)try{r[l]._DT_Input!=document.activeElement&&$(r[l]._DT_Input).val(e)}catch(d){$(r[l]._DT_Input).val(e)}}else $.extend(o.aoPreSearchCols[t],{sSearch:e+"",bRegex:i,bSmart:s,bCaseInsensitive:a}),_fnFilterComplete(o,o.oPreviousSearch,1)},this.fnGetData=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(e!==undefined){var s=e;if("object"==typeof e){var n=e.nodeName.toLowerCase();"tr"===n?s=_fnNodeToDataIndex(i,e):"td"===n&&(s=_fnNodeToDataIndex(i,e.parentNode),t=_fnNodeToColumnIndex(i,s,e))}return t!==undefined?_fnGetCellData(i,s,t,""):i.aoData[s]!==undefined?i.aoData[s]._aData:null}return _fnGetDataMaster(i)},this.fnGetNodes=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);return e!==undefined?t.aoData[e]!==undefined?t.aoData[e].nTr:null:_fnGetTrNodes(t)},this.fnGetPosition=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=e.nodeName.toUpperCase();if("TR"==i)return _fnNodeToDataIndex(t,e);if("TD"==i||"TH"==i){var s=_fnNodeToDataIndex(t,e.parentNode),n=_fnNodeToColumnIndex(t,s,e);return[s,_fnColumnIndexToVisible(t,n),n]}return null},this.fnIsOpen=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=(t.aoOpenRows,0);i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e)return!0;return!1},this.fnOpen=function(e,t,i){var s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=_fnGetTrNodes(s);if(-1!==$.inArray(e,n)){this.fnClose(e);var a=document.createElement("tr"),o=document.createElement("td");a.appendChild(o),o.className=i,o.colSpan=_fnVisbleColumns(s),"string"==typeof t?o.innerHTML=t:$(o).html(t);var r=$("tr",s.nTBody);return-1!=$.inArray(e,r)&&$(a).insertAfter(e),s.aoOpenRows.push({nTr:a,nParent:e}),a}},this.fnPageChange=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnPageChange(i,e),_fnCalculateEnd(i),(t===undefined||t)&&_fnDraw(i)},this.fnSetColumnVis=function(e,t,i){var s,n,a,o,r,l=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),h=l.aoColumns,d=l.aoData;if(h[e].bVisible!=t){if(t){var c=0;for(s=0;e>s;s++)h[s].bVisible&&c++;if(o=c>=_fnVisbleColumns(l),!o)for(s=e;s<h.length;s++)if(h[s].bVisible){r=s;break}for(s=0,n=d.length;n>s;s++)null!==d[s].nTr&&(o?d[s].nTr.appendChild(d[s]._anHidden[e]):d[s].nTr.insertBefore(d[s]._anHidden[e],_fnGetTdNodes(l,s)[r]))}else for(s=0,n=d.length;n>s;s++)null!==d[s].nTr&&(a=_fnGetTdNodes(l,s)[e],d[s]._anHidden[e]=a,a.parentNode.removeChild(a));for(h[e].bVisible=t,_fnDrawHead(l,l.aoHeader),l.nTFoot&&_fnDrawHead(l,l.aoFooter),s=0,n=l.aoOpenRows.length;n>s;s++)l.aoOpenRows[s].nTr.colSpan=_fnVisbleColumns(l);(i===undefined||i)&&(_fnAdjustColumnSizing(l),_fnDraw(l)),_fnSaveState(l)}},this.fnSettings=function(){return _fnSettingsFromNode(this[DataTable.ext.iApiIndex])},this.fnSort=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);t.aaSorting=e,_fnSort(t)},this.fnSortListener=function(e,t,i){_fnSortAttachListener(_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),e,t,i)},this.fnUpdate=function(e,t,i,s,n){var a,o,r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),l="object"==typeof t?_fnNodeToDataIndex(r,t):t;if($.isArray(e)&&i===undefined)for(r.aoData[l]._aData=e.slice(),a=0;a<r.aoColumns.length;a++)this.fnUpdate(_fnGetCellData(r,l,a),l,a,!1,!1);else if($.isPlainObject(e)&&i===undefined)for(r.aoData[l]._aData=$.extend(!0,{},e),a=0;a<r.aoColumns.length;a++)this.fnUpdate(_fnGetCellData(r,l,a),l,a,!1,!1);else{_fnSetCellData(r,l,i,e),o=_fnGetCellData(r,l,i,"display");var h=r.aoColumns[i];null!==h.fnRender&&(o=_fnRender(r,l,i),h.bUseRendered&&_fnSetCellData(r,l,i,o)),null!==r.aoData[l].nTr&&(_fnGetTdNodes(r,l)[i].innerHTML=o)}var d=$.inArray(l,r.aiDisplay);return r.asDataSearch[d]=_fnBuildSearchRow(r,_fnGetRowData(r,l,"filter",_fnGetColumns(r,"bSearchable"))),(n===undefined||n)&&_fnAdjustColumnSizing(r),(s===undefined||s)&&_fnReDraw(r),0},this.fnVersionCheck=DataTable.ext.fnVersionCheck,this.oApi={_fnExternApiFunc:_fnExternApiFunc,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLanguageCompat:_fnLanguageCompat,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAddData:_fnAddData,_fnCreateTr:_fnCreateTr,_fnGatherData:_fnGatherData,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnServerParams:_fnServerParams,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnBuildSearchArray:_fnBuildSearchArray,_fnBuildSearchRow:_fnBuildSearchRow,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnDataToSearch:_fnDataToSearch,_fnSort:_fnSort,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnVisbleColumns:_fnVisbleColumns,_fnCalculateEnd:_fnCalculateEnd,_fnConvertToWidth:_fnConvertToWidth,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnDetectType:_fnDetectType,_fnSettingsFromNode:_fnSettingsFromNode,_fnGetDataMaster:_fnGetDataMaster,_fnGetTrNodes:_fnGetTrNodes,_fnGetTdNodes:_fnGetTdNodes,_fnEscapeRegex:_fnEscapeRegex,_fnDeleteIndex:_fnDeleteIndex,_fnReOrderIndex:_fnReOrderIndex,_fnColumnOrdering:_fnColumnOrdering,_fnLog:_fnLog,_fnClearTable:_fnClearTable,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnCreateCookie:_fnCreateCookie,_fnReadCookie:_fnReadCookie,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnScrollBarWidth:_fnScrollBarWidth,_fnApplyToChildren:_fnApplyToChildren,_fnMap:_fnMap,_fnGetRowData:_fnGetRowData,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnBindAction:_fnBindAction,_fnExtend:_fnExtend,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnJsonString:_fnJsonString,_fnRender:_fnRender,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnInfoMacros:_fnInfoMacros,_fnBrowserDetect:_fnBrowserDetect,_fnGetColumns:_fnGetColumns},$.extend(DataTable.ext.oApi,this.oApi);
for(var sFunc in DataTable.ext.oApi)sFunc&&(this[sFunc]=_fnExternApiFunc(sFunc));var _that=this;return this.each(function(){var e,t,i,s=0,n=this.getAttribute("id"),a=!1,o=!1;if("table"!=this.nodeName.toLowerCase())return void _fnLog(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);for(s=0,e=DataTable.settings.length;e>s;s++){if(DataTable.settings[s].nTable==this){if(oInit===undefined||oInit.bRetrieve)return DataTable.settings[s].oInstance;if(oInit.bDestroy){DataTable.settings[s].oInstance.fnDestroy();break}return void _fnLog(DataTable.settings[s],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy")}if(DataTable.settings[s].sTableId==this.id){DataTable.settings.splice(s,1);break}}(null===n||""===n)&&(n="DataTables_Table_"+DataTable.ext._oExternConfig.iNextUnique++,this.id=n);var r=$.extend(!0,{},DataTable.models.oSettings,{nTable:this,oApi:_that.oApi,oInit:oInit,sDestroyWidth:$(this).width(),sInstance:n,sTableId:n});if(DataTable.settings.push(r),r.oInstance=1===_that.length?_that:$(this).dataTable(),oInit||(oInit={}),oInit.oLanguage&&_fnLanguageCompat(oInit.oLanguage),oInit=_fnExtend($.extend(!0,{},DataTable.defaults),oInit),_fnMap(r.oFeatures,oInit,"bPaginate"),_fnMap(r.oFeatures,oInit,"bLengthChange"),_fnMap(r.oFeatures,oInit,"bFilter"),_fnMap(r.oFeatures,oInit,"bSort"),_fnMap(r.oFeatures,oInit,"bInfo"),_fnMap(r.oFeatures,oInit,"bProcessing"),_fnMap(r.oFeatures,oInit,"bAutoWidth"),_fnMap(r.oFeatures,oInit,"bSortClasses"),_fnMap(r.oFeatures,oInit,"bServerSide"),_fnMap(r.oFeatures,oInit,"bDeferRender"),_fnMap(r.oScroll,oInit,"sScrollX","sX"),_fnMap(r.oScroll,oInit,"sScrollXInner","sXInner"),_fnMap(r.oScroll,oInit,"sScrollY","sY"),_fnMap(r.oScroll,oInit,"bScrollCollapse","bCollapse"),_fnMap(r.oScroll,oInit,"bScrollInfinite","bInfinite"),_fnMap(r.oScroll,oInit,"iScrollLoadGap","iLoadGap"),_fnMap(r.oScroll,oInit,"bScrollAutoCss","bAutoCss"),_fnMap(r,oInit,"asStripeClasses"),_fnMap(r,oInit,"asStripClasses","asStripeClasses"),_fnMap(r,oInit,"fnServerData"),_fnMap(r,oInit,"fnFormatNumber"),_fnMap(r,oInit,"sServerMethod"),_fnMap(r,oInit,"aaSorting"),_fnMap(r,oInit,"aaSortingFixed"),_fnMap(r,oInit,"aLengthMenu"),_fnMap(r,oInit,"sPaginationType"),_fnMap(r,oInit,"sAjaxSource"),_fnMap(r,oInit,"sAjaxDataProp"),_fnMap(r,oInit,"iCookieDuration"),_fnMap(r,oInit,"sCookiePrefix"),_fnMap(r,oInit,"sDom"),_fnMap(r,oInit,"bSortCellsTop"),_fnMap(r,oInit,"iTabIndex"),_fnMap(r,oInit,"oSearch","oPreviousSearch"),_fnMap(r,oInit,"aoSearchCols","aoPreSearchCols"),_fnMap(r,oInit,"iDisplayLength","_iDisplayLength"),_fnMap(r,oInit,"bJQueryUI","bJUI"),_fnMap(r,oInit,"fnCookieCallback"),_fnMap(r,oInit,"fnStateLoad"),_fnMap(r,oInit,"fnStateSave"),_fnMap(r.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(r,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(r,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(r,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(r,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(r,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(r,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(r,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(r,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(r,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(r,"aoInitComplete",oInit.fnInitComplete,"user"),_fnCallbackReg(r,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user"),r.oFeatures.bServerSide&&r.oFeatures.bSort&&r.oFeatures.bSortClasses?_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"server_side_sort_classes"):r.oFeatures.bDeferRender&&_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"defer_sort_classes"),oInit.bJQueryUI?($.extend(r.oClasses,DataTable.ext.oJUIClasses),oInit.sDom===DataTable.defaults.sDom&&"lfrtip"===DataTable.defaults.sDom&&(r.sDom='<"H"lfr>t<"F"ip>')):$.extend(r.oClasses,DataTable.ext.oStdClasses),$(this).addClass(r.oClasses.sTable),(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(r.oScroll.iBarWidth=_fnScrollBarWidth()),r.iInitDisplayStart===undefined&&(r.iInitDisplayStart=oInit.iDisplayStart,r._iDisplayStart=oInit.iDisplayStart),oInit.bStateSave&&(r.oFeatures.bStateSave=!0,_fnLoadState(r,oInit),_fnCallbackReg(r,"aoDrawCallback",_fnSaveState,"state_save")),null!==oInit.iDeferLoading){r.bDeferLoading=!0;var l=$.isArray(oInit.iDeferLoading);r._iRecordsDisplay=l?oInit.iDeferLoading[0]:oInit.iDeferLoading,r._iRecordsTotal=l?oInit.iDeferLoading[1]:oInit.iDeferLoading}if(null!==oInit.aaData&&(o=!0),""!==oInit.oLanguage.sUrl?(r.oLanguage.sUrl=oInit.oLanguage.sUrl,$.getJSON(r.oLanguage.sUrl,null,function(e){_fnLanguageCompat(e),$.extend(!0,r.oLanguage,oInit.oLanguage,e),_fnInitialise(r)}),a=!0):$.extend(!0,r.oLanguage,oInit.oLanguage),null===oInit.asStripeClasses&&(r.asStripeClasses=[r.oClasses.sStripeOdd,r.oClasses.sStripeEven]),e=r.asStripeClasses.length,r.asDestroyStripes=[],e){var h=!1,d=$(this).children("tbody").children("tr:lt("+e+")");for(s=0;e>s;s++)d.hasClass(r.asStripeClasses[s])&&(h=!0,r.asDestroyStripes.push(r.asStripeClasses[s]));h&&d.removeClass(r.asStripeClasses.join(" "))}var c,u=[],p=this.getElementsByTagName("thead");if(0!==p.length&&(_fnDetectHeader(r.aoHeader,p[0]),u=_fnGetUniqueThs(r)),null===oInit.aoColumns)for(c=[],s=0,e=u.length;e>s;s++)c.push(null);else c=oInit.aoColumns;for(s=0,e=c.length;e>s;s++)oInit.saved_aoColumns!==undefined&&oInit.saved_aoColumns.length==e&&(null===c[s]&&(c[s]={}),c[s].bVisible=oInit.saved_aoColumns[s].bVisible),_fnAddColumn(r,u?u[s]:null);for(_fnApplyColumnDefs(r,oInit.aoColumnDefs,c,function(e,t){_fnColumnOptions(r,e,t)}),s=0,e=r.aaSorting.length;e>s;s++){r.aaSorting[s][0]>=r.aoColumns.length&&(r.aaSorting[s][0]=0);var f=r.aoColumns[r.aaSorting[s][0]];for(r.aaSorting[s][2]===undefined&&(r.aaSorting[s][2]=0),oInit.aaSorting===undefined&&r.saved_aaSorting===undefined&&(r.aaSorting[s][1]=f.asSorting[0]),t=0,i=f.asSorting.length;i>t;t++)if(r.aaSorting[s][1]==f.asSorting[t]){r.aaSorting[s][2]=t;break}}_fnSortingClasses(r),_fnBrowserDetect(r);var g=$(this).children("caption").each(function(){this._captionSide=$(this).css("caption-side")}),m=$(this).children("thead");0===m.length&&(m=[document.createElement("thead")],this.appendChild(m[0])),r.nTHead=m[0];var v=$(this).children("tbody");0===v.length&&(v=[document.createElement("tbody")],this.appendChild(v[0])),r.nTBody=v[0],r.nTBody.setAttribute("role","alert"),r.nTBody.setAttribute("aria-live","polite"),r.nTBody.setAttribute("aria-relevant","all");var b=$(this).children("tfoot");if(0===b.length&&g.length>0&&(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(b=[document.createElement("tfoot")],this.appendChild(b[0])),b.length>0&&(r.nTFoot=b[0],_fnDetectHeader(r.aoFooter,r.nTFoot)),o)for(s=0;s<oInit.aaData.length;s++)_fnAddData(r,oInit.aaData[s]);else _fnGatherData(r);r.aiDisplay=r.aiDisplayMaster.slice(),r.bInitialised=!0,a===!1&&_fnInitialise(r)}),_that=null,this};DataTable.fnVersionCheck=function(e){for(var t=function(e,t){for(;e.length<t;)e+="0";return e},i=DataTable.ext.sVersion.split("."),s=e.split("."),n="",a="",o=0,r=s.length;r>o;o++)n+=t(i[o],3),a+=t(s[o],3);return parseInt(n,10)>=parseInt(a,10)},DataTable.fnIsDataTable=function(e){for(var t=DataTable.settings,i=0;i<t.length;i++)if(t[i].nTable===e||t[i].nScrollHead===e||t[i].nScrollFoot===e)return!0;return!1},DataTable.fnTables=function(e){var t=[];return jQuery.each(DataTable.settings,function(i,s){(!e||e===!0&&$(s.nTable).is(":visible"))&&t.push(s.nTable)}),t},DataTable.version="1.9.4",DataTable.settings=[],DataTable.models={},DataTable.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:DataTable.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""},DataTable.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){if(1e3>e)return e;for(var t=e+"",i=t.split(""),s="",n=t.length,a=0;n>a;a++)a%3===0&&0!==a&&(s=this.oLanguage.sInfoThousands+s),s=i[n-a-1]+s;return s},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(e,t,i,s){s.jqXHR=$.ajax({url:e,data:t,success:function(e){e.sError&&s.oApi._fnLog(s,0,e.sError),$(s.oInstance).trigger("xhr",[s,e]),i(e)},dataType:"json",cache:!1,type:s.sServerMethod,error:function(e,t){"parsererror"==t&&s.oApi._fnLog(s,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},fnServerParams:null,fnStateLoad:function(oSettings){var sData=this.oApi._fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance),oData;try{oData="function"==typeof $.parseJSON?$.parseJSON(sData):eval("("+sData+")")}catch(e){oData=null}return oData},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(e,t){this.oApi._fnCreateCookie(e.sCookiePrefix+e.sInstance,this.oApi._fnJsonString(t),e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"},DataTable.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},fnDisplayEnd:function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null},DataTable.ext=$.extend(!0,{},DataTable.models.ext),$.extend(DataTable.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""}),$.extend(DataTable.ext.oJUIClasses,DataTable.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"}),$.extend(DataTable.ext.oPagination,{two_button:{fnInit:function(e,t,i){var s=e.oLanguage.oPaginate,n=(e.oClasses,function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)}),a=e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>':'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+s.sPrevious+'</a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+s.sNext+"</a>";$(t).append(a);var o=$("a",t),r=o[0],l=o[1];e.oApi._fnBindAction(r,{action:"previous"},n),e.oApi._fnBindAction(l,{action:"next"},n),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_previous",l.id=e.sTableId+"_next",r.setAttribute("aria-controls",e.sTableId),l.setAttribute("aria-controls",e.sTableId))},fnUpdate:function(e){if(e.aanFeatures.p)for(var t,i=e.oClasses,s=e.aanFeatures.p,n=0,a=s.length;a>n;n++)t=s[n].firstChild,t&&(t.className=0===e._iDisplayStart?i.sPagePrevDisabled:i.sPagePrevEnabled,t=t.nextSibling,t.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?i.sPageNextDisabled:i.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,t,i){var s=e.oLanguage.oPaginate,n=e.oClasses,a=function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)};$(t).append('<a  tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageFirst+'">'+s.sFirst+'</a><a  tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPagePrevious+'">'+s.sPrevious+'</a><span></span><a tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageNext+'">'+s.sNext+'</a><a tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageLast+'">'+s.sLast+"</a>");var o=$("a",t),r=o[0],l=o[1],h=o[2],d=o[3];e.oApi._fnBindAction(r,{action:"first"},a),e.oApi._fnBindAction(l,{action:"previous"},a),e.oApi._fnBindAction(h,{action:"next"},a),e.oApi._fnBindAction(d,{action:"last"},a),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_first",l.id=e.sTableId+"_previous",h.id=e.sTableId+"_next",d.id=e.sTableId+"_last")},fnUpdate:function(e,t){if(e.aanFeatures.p){var i,s,n,a,o,r,l,h=DataTable.ext.oPagination.iFullNumbersShowPages,d=Math.floor(h/2),c=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),u=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,p="",f=e.oClasses,g=e.aanFeatures.p,m=function(s){e.oApi._fnBindAction(this,{page:s+i-1},function(i){e.oApi._fnPageChange(e,i.data.page),t(e),i.preventDefault()})};for(-1===e._iDisplayLength?(i=1,s=1,u=1):h>c?(i=1,s=c):d>=u?(i=1,s=h):u>=c-d?(i=c-h+1,s=c):(i=u-Math.ceil(h/2)+1,s=i+h-1),n=i;s>=n;n++)p+=u!==n?'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButton+'">'+e.fnFormatNumber(n)+"</a>":'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButtonActive+'">'+e.fnFormatNumber(n)+"</a>";for(n=0,a=g.length;a>n;n++)l=g[n],l.hasChildNodes()&&($("span:eq(0)",l).html(p).children("a").each(m),o=l.getElementsByTagName("a"),r=[o[0],o[1],o[o.length-2],o[o.length-1]],$(r).removeClass(f.sPageButton+" "+f.sPageButtonActive+" "+f.sPageButtonStaticDisabled),$([r[0],r[1]]).addClass(1==u?f.sPageButtonStaticDisabled:f.sPageButton),$([r[2],r[3]]).addClass(0===c||u===c||-1===e._iDisplayLength?f.sPageButtonStaticDisabled:f.sPageButton))}}}}),$.extend(DataTable.ext.oSort,{"string-pre":function(e){return"string"!=typeof e&&(e=null!==e&&e.toString?e.toString():""),e.toLowerCase()},"string-asc":function(e,t){return t>e?-1:e>t?1:0},"string-desc":function(e,t){return t>e?1:e>t?-1:0},"html-pre":function(e){return e.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(e,t){return t>e?-1:e>t?1:0},"html-desc":function(e,t){return t>e?1:e>t?-1:0},"date-pre":function(e){var t=Date.parse(e);return(isNaN(t)||""===t)&&(t=Date.parse("01/01/1970 00:00:00")),t},"date-asc":function(e,t){return e-t},"date-desc":function(e,t){return t-e},"numeric-pre":function(e){return"-"==e||""===e?0:1*e},"numeric-asc":function(e,t){return e-t},"numeric-desc":function(e,t){return t-e}}),$.extend(DataTable.ext.aTypes,[function(e){if("number"==typeof e)return"numeric";if("string"!=typeof e)return null;var t,i="0123456789-",s="0123456789.",n=!1;if(t=e.charAt(0),-1==i.indexOf(t))return null;for(var a=1;a<e.length;a++){if(t=e.charAt(a),-1==s.indexOf(t))return null;if("."==t){if(n)return null;n=!0}}return"numeric"},function(e){var t=Date.parse(e);return null!==t&&!isNaN(t)||"string"==typeof e&&0===e.length?"date":null},function(e){return"string"==typeof e&&-1!=e.indexOf("<")&&-1!=e.indexOf(">")?"html":null}]),$.fn.DataTable=DataTable,$.fn.dataTable=DataTable,$.fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext})}(window,document),define("modules/tools/staff-listing",["jquery","underscore","baseview","state","utils","modules/scroller/vertical-scroll","libs/jquery/plugins/jquery.dataTables"],function(e,t,i,s,n,a){var o=i.extend({events:{"mouseenter .staff-filter-dropdown":"onHoverFilterDropdown","mouseleave .staff-filter-dropdown":"onHoverFilterDropdown","click .staff-details-open":"onDetailsOpen","click .staff-details-close":"onDetailsClose"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.$popupBox=this.$(".staff-details-box"),this.$popupFilm=this.$(".staff-details-film"),this.$popupTop=parseInt(this.$popupBox.css("top"),10);var t=e.extend({},e.fn.dataTable.defaults,{bAutoWidth:!1,bFilter:!1,bDestroy:!0,bPaginate:!1,bInfo:!1});this.$staffList=this.$(".staff-listing-table").dataTable(t)},onDetailsOpen:function(t){t.preventDefault(),this.openedOnce=!0,this.$popupLink=e(t.currentTarget);var i=this.$popupLink.data("class"),s=n.getScrollPosition();this.$popupBox.css("top",s),this.$popupBox.data("url")!=this.$popupLink.data("url")&&this.loadDetails(),this.$popupBox.addClass(i),this.$popupFilm.show(),this.$popupBox.show(),e(".site-footer").css({visibility:"hidden"})},onDetailsClose:function(t){if(this.openedOnce){t&&t.preventDefault();var i=this.$popupLink.data("class");this.$popupBox.removeClass(i),this.$popupBox.hide(),this.$popupFilm.hide(),this.$(".staff-details-data").addClass("staff-loading-details"),e(".site-footer").css({visibility:"visible"})}},loadDetails:function(){this.$(".staff-details-loaded").remove();var e=this.$popupLink.data("url");this.$popupBox.data("url",e),s.fetchHtml(e).done(t.bind(function(t){t.find(".staff-details-loaded").length?(this.$(".staff-details-data").removeClass("staff-details-loading"),this.$(".staff-details-data").html(t)):console.log("Unable to load details for: "+e)},this))},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),s=i.find(".staff-filter-scroll-wrap");this.subviews.vscroll=new a({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return o}),define("uiPageTurn",["jquery","transformSupport"],function(e){"use strict";var t="uiPageTurn",i={useTransforms:!!e.support.css.transform,fallback:"crossfade",pageSelector:".ui-page-turn",placerSelector:".ui-placer",transitionTiming:"linear",turnDuration:300,perspective:"2200px",slideDuration:200,fadeDuration:200,shadow:!0,shadowOpacity:.7,onPageTurn:function(){}},s={init:function(s){return this.each(function(){var n=e(this),a=e.extend({},i,s),o=n.find(a.pageSelector+".active");0===o.length&&(o=n.children(":first")),o.next(a.pageSelector).addClass("preload"),n.data(t,{currentPage:o,busy:!1,settings:a})})},option:function(e,i){var s=this.data(t);if(s&&e){if(!i)return s[e];("function"==typeof i||"onPageTurn"!==e)&&(s[e]=i)}},nextPage:function(e,i){var s=this.data(t),a=s.settings,o=s.currentPage,r=o.next(a.pageSelector);return n.transition(this,o,r,!1,a,s,e,i)},prevPage:function(e,i){var s=this.data(t),a=s.settings,o=s.currentPage,r=o.prev(a.pageSelector);return n.transition(this,o,r,!0,a,s,e,i)},goToPage:function(i,s,a){var o=this.data(t),r=o.settings,l=o.currentPage,h=this.children(r.pageSelector),d=h.eq(i),c=h.index(l);return c===i?e.Deferred().reject():n.transition(this,l,d,c>i,r,o,s,a)},getCurrentPage:function(){var e=this.data(t);return e.currentPage}},n={transition:function(t,i,s,a,o,r,l,h){var d;return!s.length||r.busy?e.Deferred().reject():l?(n.finishTransition(i,s,a,o,r),e.Deferred().resolve()):(r.busy=!0,s.removeClass("preload"),d=!h&&o.useTransforms?n.flipTransform(t,i,s,a,o):"slide"===o.fallback?n.slideTransition(i,s,a,o):n.fadeTransition(i,s,o),d.done(function(){n.finishTransition(i,s,a,o,r)}),d)},finishTransition:function(e,t,i,s,n){s.onPageTurn(t),n.busy=!1,e.removeClass("active"),t.addClass("active"),i?t.prev(s.pageSelector).addClass("preload"):t.next(s.pageSelector).addClass("preload"),n.currentPage=t},flipTransform:function(t,i,s,a,o){i.removeClass("active");var r=i.clone(),l=s.clone(),h=e('<div class="ui-shadow"></div>'),d=e('<div class="ui-shadow"></div>'),c=e('<div class="ui-page-turn-animator"></div>');o.shadow&&(s.append(h),i.append(d),h.css({opacity:o.shadowOpacity}),d.css({opacity:0})),c.append(r),c.append(l),t.append(c),a?(i.addClass("right"),s.addClass("left"),l.addClass("right"),r.addClass("left")):(i.addClass("left"),s.addClass("right"),l.addClass("left"),r.addClass("right")),n.setupTransition(t[0],c[0],r[0],l[0],a,o);var u=e.Deferred();return e.support.css.transition.registerTransitionEndListener(c[0],u).done(function(){d.remove(),h.remove(),c.remove(),s.removeClass("left right"),i.removeClass("left right"),t[0].style[e.support.css.transform.perspectiveCssName]="",t[0].style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t=a?"rotateY(180deg)":"rotateY(-180deg)";c[0].style[e.support.css.transform.cssName]=t,o.shadow&&(h[0].style[e.support.css.transition.cssName]=n.getTransitionStyle("opacity",o.turnDuration/2,o.transitionTiming),d[0].style[e.support.css.transition.cssName]=n.getTransitionStyle("opacity",o.turnDuration/2,o.transitionTiming,o.turnDuration/2),h.css({opacity:0}),d.css({opacity:o.shadowOpacity}))},20),u.promise()},slideTransition:function(t,i,s,a){if(i.addClass("active"),t.css({left:"0%"}),i.css(s?{left:"-100%"}:{left:"100%"}),e.support.css.transition){var o=n.getTransitionStyle("left",a.slideDuration,a.transitionTiming);return i[0].style[e.support.css.transition.cssName]=o,t[0].style[e.support.css.transition.cssName]=o,setTimeout(function(){i.css({left:"0%"}),t.css({left:s?"100%":"-100%"})},20),e.support.css.transition.registerTransitionEndListener(i[0])}return t.animate({left:s?"100%":"-100%"},a.slideDuration,a.transitionTiming),i.animate({left:"0%"},a.slideDuration,a.transitionTiming).promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var s=e.fadeOut(i.fadeDuration).promise();return s.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),s},getTransitionStyle:function(e,t,i,s){var n=e+" "+t+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(t,i,s,a,o,r){t.style[e.support.css.transform.perspectiveCssName]=r.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.perspectiveCssName]=r.perspective,i.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,r.turnDuration,r.transitionTiming),s.style[e.support.css.transform.styleCssName]="preserve-3d",s.style[e.support.css.transform.cssName]="rotateY(0deg)",s.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",a.style[e.support.css.transform.styleCssName]="preserve-3d",o?(s.style[e.support.css.transform.originCssName]="right center",a.style[e.support.css.transform.originCssName]="left center",a.style[e.support.css.transform.cssName]="rotateY(-180deg) translateZ(1px)"):(s.style[e.support.css.transform.originCssName]="left center",a.style[e.support.css.transform.originCssName]="right center",a.style[e.support.css.transform.cssName]="rotateY(180deg) translateZ(1px)")}};e.fn.uiPageTurn=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("apps/bigpage",["jquery","underscore","backbone","pubsub","utils","state","admanager","base-app","directAdPosition","uiPageTurn"],function(e,t,i,s,n,a,o,r,l){var h=r.extend({el:"#cover-view",events:{"click .big-page-prev":"prevSlide","click .ui-page-turn":"palmSlide","click .big-page-next":"nextSlide"},initialize:function(i){i=e.extend(!0,{animation:{slideDuration:350}},i),t.bindAll(this,"keyboardShortcuts","onPageTurn","resizeHandler","moveSlide","playAd"),this.$body=n.get("body"),this.$doc=n.get("doc"),this.$win=n.get("win"),this.$adContents=this.$(".partner-coverview-contents");var s=t.throttle(this.resizeHandler,50);this.$win.on("resize."+this.cid,s),r.prototype.initialize.call(this,i)},resizeHandler:function(){if(this.$pages){var t=this.$win.width(),i=this.$win.height()-40;t%2?this.$pages.addClass("width-wiggler"):this.$pages.removeClass("width-wiggler"),this.$adContents.css({width:t+"px",top:40,height:i+"px"}),e.each(this.subviews,function(e,s){0===e.indexOf("ad_")&&s.resizeAd(t,i)})}},palmSlide:function(t){var i=e(t.target);if(!(i.hasClass("load-story")||i.hasClass("parent-label")||i.closest(".partner-placement").length)){var s=t.screenX,n=this.$win.width()>>1;s>n?this.nextSlide(t):this.prevSlide(t)}},prevSlide:function(e){e&&e.preventDefault(),this.moveSlide(-1),s.trigger("heattrack","thebigpageleft")},nextSlide:function(e){e&&e.preventDefault(),this.moveSlide(1),s.trigger("heattrack","thebigpageright")},moveSlide:function(e){var t=this.$pages.uiPageTurn("getCurrentPage").index(),i=t+e,s=!1,n=this.playAd;this.isIndexAd(i)?(s=this.isAdReady(i),s||(i+=e)):this.prepareNextAd(t),a.registerAnimation(this.$pages.uiPageTurn("goToPage",i)).done(function(){s&&n(i)})},playAd:function(e){var t=this.subviews["ad_"+e];t&&(t.playAd(),t.show())},fetchAd:function(e){var t,i,s=this.$pagesChildren.eq(e),a=n.getNested(window.site_vars,"aws_site_name")||"usat",o=s.find(".partner-coverview-contents");return t=this.getPageInfo(s.prev()),this.subviews["ad_"+e]=i=new l({el:o,adPlacement:"coverview/"+t.cst,adSizes:["coverviewfullpage"],targeting:{sitePage:a+"/"+(t.ssts||"").replace(/\/\/*$/,"")},slotType:"out"}),i.prefetchAd(),this.resizeHandler(),!0},getNextAdIndex:function(e){return this.$pagesChildren.eq(e).nextAll(".partner-placement").first().index()},checkIfAdHasBeenFetched:function(e){e>0&&!this.subviews["ad_"+e]&&this.fetchAd(e)},isIndexAd:function(e){return this.$pagesChildren.eq(e).hasClass("partner-placement")},prepareNextAd:function(e){var t=this.getNextAdIndex(e);this.checkIfAdHasBeenFetched(t)},isAdReady:function(e){var t=this.subviews["ad_"+e];return t?t.isAdReady():!1},slideTransition:function(e,i){e.addClass("active"),i?e.css("left","100%"):e.css("left","-100%"),this.animate(e,"left",0,this.options.animation.slideDuration,"linear").done(t.bind(function(){this.$activePage=e,this.busy=!1},this)),this.$activePage.css("left","0%"),this.animate(this.$activePage,"left",i?"-100%":"100%",this.options.animation.slideDuration,"linear")},keyboardShortcuts:function(e){e.target===this.$body[0]&&(37===e.which?this.prevSlide(e):39===e.which&&this.nextSlide())},afterPageReveal:function(){this.$prev=this.$(".big-page-prev"),this.$next=this.$(".big-page-next"),this.$pages=this.$("#cover-view-pages"),this.$pagesChildren=this.$pages.children(),this.$pages.uiPageTurn({onPageTurn:this.onPageTurn,turnDuration:600,fallback:"slide",shadow:!1}),this.resizeHandler(),this.$doc.on("keyup."+this.cid,this.keyboardShortcuts),this.trackPageChange(this.$(".ui-page-turn.active"))
},onPageTurn:function(e){e.prev(".ui-page-turn").length?this.$prev.show():this.$prev.hide(),e.next(".ui-page-turn").length?this.$next.show():this.$next.hide(),this.trackPageChange(e)},trackPageLoad:function(){},trackPageChange:function(e){this.pageInfo=this.getPageInfo(e),s.trigger("page:load",this.pageInfo)},getPageInfo:function(e){var t,i=e.find(".coverInfo").html()||"{}";try{t=JSON.parse(i)}catch(s){console.error("could not get current asset page info",s.stack||s.stacktrace||s.message)}return t||{}},pause:function(){this.$doc.off("."+this.cid),r.prototype.pause.apply(this,arguments)},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),r.prototype.destroy.apply(this,arguments)}});return h}),define("apps/404",["jquery","underscore","backbone","state","pubsub","apps/simple-overlay"],function(e,t,i,s,n,a){var o=a.extend({initialize:function(e){a.prototype.initialize.call(this,e),this.options.ajax&&(this.render(this.options.htmlFrag),s.registerFullScreenView(this),this.afterPageReveal())},close:function(e){return e&&e.target!==e.currentTarget?void 0:(this.options.ajax?(s.clearFullScreenView(this),this.destroy(!0)):s.navigateToPreloadedUrl(),!1)}});return o}),define("apps/cards/layouts",[],function(){return{"primary-suspender-sidebar-page":[{name:"large",adClass:"size-l",adTargeting:"large",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:340,belowHeroAd:!1,belowTheFoldAd:!0,cardWidth:1180,windowWidth:1250},{name:"medium",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:1080,windowWidth:1150},{name:"small",adClass:"size-s",adTargeting:"small",sidebarOpen:!1,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:840,windowWidth:980}],"primary-flex-sidebar-page":[{name:"1320w",adClass:"size-xl",adTargeting:"xlarge",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:960,cardWidth:1320,windowWidth:1320},{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:720,cardWidth:1080,windowWidth:1150,layout:"flexCard"}]}}),define("partner/high-impact-base",["jquery","underscore","baseview","sharedAdPosition","admanager","managers/autoplay","partner/leavebehind"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({initialize:function(s){t.bindAll(this,"onAdReady","showAd","beforeAdRender","startAutoPlay"),s=e.extend({leaveBehindEl:e(".partner-leavebehind"),frameBehavior:{clearBgColor:!0,hideframe:!0,hidebrand:!0}},s),i.prototype.initialize.call(this,s)},_createAd:function(e,t,i){var n=this._filterAdsByCardWidth(e,i);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:n,adType:t,onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender}),this.currentCardInfo=i},_filterAdsByCardWidth:function(e,i){var s,a;return t.filter(e,function(e){return s=n.isFlexibleAdSize(e),a=n.getSize(e),s||a&&a[0]<=i.cardWidth})},beforeAdRender:function(e){this.adData=e,a.register("high-impact-ad",this.startAutoPlay),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&(this.subviews.adLeaveBehind=new o({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10)||this.options.maxDisplayed,behavior:this.options.frameBehavior||{}}))},startAutoPlay:function(){return this.subviews.adLeaveBehind?!this.subviews.adLeaveBehind.shouldShowAd(this.adData):!1},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),this.subviews.adLeaveBehind?this.subviews.adLeaveBehind.render(this.subviews.adPosition,e):this.showAd()},showAd:function(){this.showingAd=!0,this.subviews.adPosition.show()}});return r}),define("partner/pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","partner/ad-utils","adLogger"],function(e,t,i,s,n,a){"use strict";var o=s.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(n){n=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{}},n),t.bindAll(this,"onAdReady","showAd","beforeAdRender"),s.prototype.initialize.call(this,n),this.$body=i.get("body"),this.$bigHeadline=this.$(".big-headline"),this.$aboveCardContent=this.options.cards.find(".card-above-content"),a.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["pushdown"],["pushdown"],e),this.isCardBumped=t},beforeAdRender:function(e){var t=this.currentCardInfo;this.adData=e,t&&this.onCardWidthChange(t),s.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.showingAd?this.closeAd(!0):this.startBgColor&&n.clearBg(this.$body,this.startBgColor),s.prototype.destroy.call(this,e)},getAdHeight:function(e){var t=this.adData.ratio;return t?t.height/t.width*e:615},onAdReady:function(e){"Pushdown+"===e.adType&&(this.persistBackground=!0,this.startBgColor=n.changeBg(this.$body,e.backgroundSolidColor,e.backgroundRepeatingImage),this.$el.css({display:"block",height:0})),s.prototype.onAdReady.call(this,e),this.subviews.adLeaveBehind&&(this.subviews.adLeaveBehind.options.behavior.clearBgColor=!1)},showAd:function(){var i,a=this.options.animations.vertical.duration,o=this.getOffsetHeight(),r=this.$el;s.prototype.showAd.call(this),this.$aboveCardContent.animate({opacity:0},150).slideUp(a-150),r.hasClass("iab-risingstar")?this.isCardBumped&&r.css("margin","-5px auto 10px"):(r.css({height:0}),i=this.getAdHeight(this.currentCardInfo.cardWidth)-o,this.$bigHeadline.css("visibility","hidden"),e.when(this.animate(r,"height",i,a),o?this.animate(r,"top",0,a):null).done(t.bind(function(){this.subviews.adPosition&&(r.addClass("partner-pushdown-ad-open"),this.subviews.adPosition.playAd())},this)),this.$body.addClass("high-impact-ad-visible")),this.startBgColor=n.changeBg(this.$body,this.adData.backgroundSolidColor,this.adData.backgroundRepeatingImage)},closeAdClick:function(e){e.preventDefault(),this.closeAd(),this.$aboveCardContent.slideDown(this.options.animations.vertical.duration-150).animate({opacity:1},150)},getOffsetHeight:function(){return this.$bigHeadline.height()||0},closeAd:function(i){var s=this.subviews.adLeaveBehind,a=s.startBgColor||this.startBgColor,o=this.$el,r=this.getOffsetHeight(),l=this.options.animations.vertical.duration;o.hasClass("iab-risingstar")?this.isCardBumped&&o.css("margin",""):(this.showingAd=!1,this.subviews.adPosition.stopAd(),e.when(this.animate(o,"height",0,l),r?this.animate(o,"top",r+"px",l):null).done(t.bind(function(){o.removeClass("partner-pushdown-ad-open"),this.$bigHeadline.css("visibility","visible"),s&&!i&&s.show()},this))),this.$body.removeClass("high-impact-ad-visible"),this.startBgColor&&(!this.persistBackground&&!s.startBgColor||i)&&n.clearBg(this.$body,a)},onCardWidthChange:function(e){if(this.subviews.adPosition&&this.adData){var t=this.adData.adType,i=this.$el,s=this.getOffsetHeight(),n=this.getAdHeight(e.cardWidth);this.currentCardInfo=e,"Pushdown+"!==t||this.showingAd||i.css("top",s),i.removeClass(this.options.adClasses).addClass(e.adClass),this.subviews.adPosition.resizeAd(e.cardWidth,n),!i.hasClass("iab-risingstar")&&this.adData.ratio&&this.showingAd&&(n-=s,i.css("height",n)),i.hasClass("iab-risingstar")&&"small"===e.name&&(i.remove(),this.destroy())}}});return o}),define("partner/gravity-ad",["jquery","underscore","utils","state","user-manager","pubsub","partner/high-impact-base","site-manager","adLogger"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=o.extend({haveBreakingNews:!1,pubSub:{},state:"stopped",events:{"click .partner-scroll":"scrollPage","click .partner-scroll-login":"showLogin","click .partner-login-modal-close":"closeLogin","click .ui-film":"closeLogin","click .partner-login-modal-btn":"onClickLogin"},initialize:function(s){s=e.extend({adClasses:"",maxDisplayed:2},s),this.pubSub={"user:statuschange":this.determineLoggedInStatus},t.bindAll(this,"onAdReady","onResizeWindow","onScrollWindow","scrollPage","countDown","shiftUnlockedContentDown"),o.prototype.initialize.call(this,s),this.header=r.getHeader(),this.header&&this.header.subviews&&(this.breakingbar=this.header.subviews.breakingbar),this.$body=i.get("body"),this.$loginOverlay=this.$(".partner-login-overlay"),this.$partnerScroll=this.$(".partner-scroll"),this.$leftCircleHalf=this.$(".left-half .scroll-circle"),this.$rightCircleHalf=this.$(".right-half .scroll-circle"),this.$partnerScrollMessage=this.$(".partner-scroll-message"),this.$window=i.get("win"),l.logDebug("Gravity Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["gravity"],"gravity",e),this.isCardBumped=t},beforeAdRender:function(){this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition.setInitialDimensions(this.windowWidth,this.windowHeight),o.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.closeAd(),this.header&&(this.header.destroyTransparency(),this.header.restoreLastState()),this.$leftCircleHalf.removeAttr("style"),this.$rightCircleHalf.removeAttr("style"),this.$partnerScroll.removeAttr("style").removeClass("done").off("."+this.cid),o.prototype.destroy.call(this,e)},showAd:function(e){this.showingAd=!0,this.$partnerScroll=this.$(".partner-scroll");var s=t.throttle(this.onResizeWindow,50),o=t.throttle(this.onScrollWindow,50);this.$window.on("resize."+this.cid,s).on("scroll."+this.cid,o),this.pubSub={"breakingbar:before:open":this.onResizeWindow,"breakingbar:before:close":this.onResizeWindow},a.attach(this.pubSub,this),this.onResizeWindow(),this.subviews.adPosition.show(),this.options.contentSection.css("margin-top",this.cardOffset),this.onScrollWindow(),this.$body.addClass("high-impact-ad-visible"),this.header.setClosedFixed(!0),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.hide(),this.setBreakingNewsBarrier();var r=n.getLoginStatus();this.paywall=i.getNested(window.site_vars,"ADS","gravity_paywall"),!this.paywall||"loggedOut"!==r&&"loggingOut"!==r&&"loginFailed"!==r||e?this.$partnerScroll.addClass("done"):(this.$partnerScrollMessage.text("Loading your news..."),this.lockContent()),a.trigger("gravity:open")},lockContent:function(){if(this.count=i.getNested(window.site_vars,"ADS","gravity_paywall_wait")||30,this.contentLocked=!0,this.$loadingNumber=this.$(".partner-scroll-number"),e.support.css.transform){var t=this.count/2,s=e.support.css.transform.cssName+" "+t+"s "+t+"s linear",n=e.support.css.transform.cssName+" "+t+"s linear";this.$leftCircleHalf[0].style[e.support.css.transition.cssName]=s,this.$rightCircleHalf[0].style[e.support.css.transition.cssName]=n,this.$leftCircleHalf[0].style[e.support.css.transform.cssName]="rotate(180deg)",this.$rightCircleHalf[0].style[e.support.css.transform.cssName]="rotate(180deg)"}this.options.contentSection.css("position","fixed"),this.countDown(),this.countdownInterval=setInterval(this.countDown,1e3)},countDown:function(){this.$loadingNumber.text(this.count),this.count||this.unlockContent(),this.count--},unlockContent:function(){this.contentLocked=!1,clearInterval(this.countdownInterval),this.$partnerScrollMessage.text("Your news is ready!"),this.$partnerScroll.on("click."+this.cid,this.scrollPage),this.$partnerScroll.addClass("done"),this.options.contentSection.css("position",""),this.shiftUnlockedContentUp(this.$partnerScroll)},shiftUnlockedContentUp:function(){var e=this.cardOffset-this.header.getCollapsedHeight()-30;this.options.contentSection.animate({"margin-top":e},350).addClass("gravity-bumped"),this.shiftDownTimeout=t.delay(t.bind(function(){this.shiftUnlockedContentDown()},this),5e3)},shiftUnlockedContentDown:function(){this.options.contentSection.hasClass("gravity-bumped")&&(this.options.contentSection.removeClass("gravity-bumped"),e.when(this.animate(this.options.contentSection,"margin-top",this.cardOffset,500),this.animate(this.$partnerScroll,"margin-top",-75,500)).done(t.bind(function(){this.$partnerScroll.css("margin-top","").addClass("shifted")},this)))},determineLoggedInStatus:function(e,t,i){"loggedIn"===t?this.welcomeUser(i):"loggedOut"===t&&this.unWelcomeUser()},welcomeUser:function(t){if(!this.showingAd)return!1;var i=t.first_name;this.$partnerScrollMessage.fadeOut(350,function(){e(this).text("Welcome back "+i+", get the news").fadeIn(350)}),this.$partnerScroll.hasClass("done")||this.contentLocked?this.contentLocked&&(this.closeLogin(),this.unlockContent()):this.shiftUnlockedContentUp(this.$partnerScroll)},unWelcomeUser:function(){this.$partnerScrollMessage.fadeOut(350,function(){e(this).text("Get the news").fadeIn(350)})},showLogin:function(){this.$loginOverlay.show()},closeLogin:function(){this.$loginOverlay.hide()},onClickLogin:function(t){var i=e(t.target).data("user-account");n.loginUser(i)},setBreakingNewsBarrier:function(){this.breakingNewsBarrier&&"resolved"!==this.breakingNewsBarrier.state()||(this.breakingNewsBarrier=new e.Deferred,this.breakingbar.addToBarrier(this.breakingNewsBarrier,999999,!1))},getHeaderOffset:function(){return this.header&&this.breakingbar?this.header.getCollapsedHeight()+this.breakingbar.getHeight():0},closeAd:function(){this.subviews.adPosition&&this.adData&&(this.showingAd=!1,this.subviews.adPosition.stopAd(),this.breakingNewsBarrier&&this.breakingNewsBarrier.resolve(),this.options.contentSection.css({"margin-top":"",position:""}),this.$body.removeClass("high-impact-ad-visible"),clearInterval(this.countdownInterval),clearTimeout(this.shiftDownTimeout),this.$window.off("."+this.cid))},onResizeWindow:function(){return this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition?(this.subviews.adPosition.resizeAd(this.windowWidth,this.windowHeight),this.cardOffset=this.windowHeight-this.getHeaderOffset(),this.options.contentSection.css("margin-top",this.cardOffset),void this.onScrollWindow()):!1},onScrollWindow:function(){var e=this.$window.scrollTop(),t=this.header.getCurrentHeight(),i=(this.windowHeight-e-t)/(this.windowHeight-t),s=i>0?i:0;this.$el.css("opacity",s),.1>s&&"playing"===this.state?(this.state="paused",this.subviews.adPosition&&(this.subviews.adPosition.pauseAd(),this.breakingNewsBarrier.resolve(),this.haveBreakingNews&&this.breakingbar.openBreakingBar()),this.header.toggleTransparency(!1)):s>.1&&"paused"===this.state?(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.resumeAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.header.toggleTransparency(!0)):s>.1&&"stopped"===this.state&&(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.playAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.header.toggleTransparency(!0)),0===s?this.$el.css("display","none"):this.$el.css("display","block"),this.onArticleScroll&&this.onArticleScroll(s,t)},scrollPage:function(t){t.preventDefault();var i=this.windowHeight-this.header.getCurrentHeight();e("body, html").animate({scrollTop:i},500),this.shiftDownTimeout&&(clearTimeout(this.shiftDownTimeout),this.shiftUnlockedContentDown())}});return h}),define("partner/dual-pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","site-manager","partner/ad-utils","adLogger"],function(e,t,i,s,n,a,o){"use strict";var r=s.extend({initialize:function(a){a=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}}},a),t.bindAll(this,"onAdReady","beforeAdRender","onResizeWindow","onScrollWindow"),s.prototype.initialize.call(this,a),this.header=n.getHeader(),this.headerHeight=this.header?this.header.getCurrentHeight():0,this.pubSub={"header:fixed":this.onHeaderHeightChange,"header:unfixed":this.onHeaderHeightChange},this.$body=i.get("body"),this.$bigHeadline=this.$(".big-headline"),this.$window=i.get("win"),o.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(e){this._createAd(["dual_pushdown"],"dualpushdown",e)},beforeAdRender:function(i){if(this.adType=i.adType,this.adData=e.extend({ratio:{height:9,width:16},fixed:!0},i),this.currentCardInfo&&this.onCardWidthChange(this.currentCardInfo,!0),(e("html").hasClass("lt-ie10")||Modernizr.touch)&&(this.adData.fixed=!0),!this.adData.fixed){var n=t.throttle(this.onResizeWindow,50),a=t.throttle(this.onScrollWindow,10);this.$window.on("resize."+this.cid,n).on("scroll."+this.cid,a),this.onResizeWindow()}this.$el.addClass("partner-dual-pushdown"),s.prototype.beforeAdRender.apply(this,arguments)},closeAd:function(){this.showingAd=!1,this.subviews.adPosition.stopAd(),e.when(this.animate(this.options.card,"margin-bottom",0,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",0,this.options.animations.vertical.duration)).done(t.bind(function(){this.$bigHeadline.css("visibility","visible")},this)),this.$body.removeClass("high-impact-ad-visible"),this.stgoundColor&&a.clearBg(this.$body,this.startingBackgroundColor),this.$window.off("."+this.cid)},destroy:function(e){this.closeAd(),clearTimeout(this.calcWait),s.prototype.destroy.call(this,e)},getAdHeight:function(e){return this.adData.ratio.height/this.adData.ratio.width*e},getBigHeadlineHeight:function(){return this.$bigHeadline.height()||0},onAdReady:function(e){this.backgroundSolidColor=e.backgroundSolidColor,this.backgroundRepeatingImage=e.backgroundRepeatingImage,this.showAd()},onCardWidthChange:function(e,i){if(this.subviews.adPosition&&this.adType){this.currentCardInfo=e;var s=this.getAdHeight(e.cardWidth)-this.getBigHeadlineHeight();this.$el.removeClass(this.options.adClasses).addClass(e.adClass),this.subviews.adPosition.resizeAd(e.cardWidth,s),clearTimeout(this.calcWait),this.calcWait=setTimeout(t.bind(function(){if(!i)if(this.calculateScrollSpecs(s),this.options.card.css({"margin-bottom":s+50,"margin-top":s}),this.adData.fixed){var e=this.cardHeight;this.$(".partner-pushdown-container").css("height",e)}else this.onScrollWindow()},this),100)}},onHeaderHeightChange:function(){this.headerHeight=this.header.getCurrentHeight()},onScrollWindow:function(){var e=this.$window.scrollTop()-this.headerHeight,t=this.cardHeight-this.windowHeight,i=1-(t-e)/t;i>1?i=1:0>i&&(i=0);var s=50+this.adDiffHeight*i;this.$el.css("top",s)},onResizeWindow:function(){this.windowHeight=this.$window.height()},showAd:function(){s.prototype.showAd.call(this),this.adHeight=this.$el.height();var i=this.getAdHeight(this.currentCardInfo.cardWidth)-this.getBigHeadlineHeight();this.calculateScrollSpecs(i),this.adData.fixed?this.$(".partner-pushdown-container").css("height",this.cardHeight):this.onScrollWindow(),e.when(this.animate(this.options.card,"margin-bottom",i+50,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",i,this.options.animations.vertical.duration)).done(t.bind(function(){this.subviews.adPosition&&this.subviews.adPosition.playAd()},this)),this.$bigHeadline.css("visibility","hidden"),this.$body.addClass("high-impact-ad-visible"),this.startBgColor=a.changeBackground(this.$body,this.adData.backgroundSolidColor,this.adData.backgroundRepeatingImage)},calculateScrollSpecs:function(e){this.cardHeight=this.options.card.height()+70+2*e,this.adDiffHeight=this.cardHeight-this.adHeight-this.headerHeight+100}});return r}),define("partner/skyline-ad",["jquery","underscore","sharedAdPosition","partner/high-impact-base","adLogger"],function(e,t,i,s,n){"use strict";var a=s.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(i){i=e.extend({adClasses:""},i),t.bindAll(this,"onAdReady","showAd"),s.prototype.initialize.call(this,i),n.logDebug("Skyline Advertisment initialized",this)},renderCardInfo:function(e){this._createAd(["skyline"],"skyline",e)},destroy:function(e){this.showingAd&&this.closeAd(),s.prototype.destroy.call(this,e)},closeAdClick:function(e){e.preventDefault(),this.closeAd()},closeAd:function(){this.showingAd=!1,this.subviews.adPosition.stopAd(),this.subviews.adPosition.hide(),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()}});return a}),define("apps/cards/cards",["jquery","underscore","pubsub","utils","site-manager","base-app","apps/cards/layouts","partner/pushdown-ad","partner/gravity-ad","partner/dual-pushdown-ad","partner/overlay-ad-fronts","partner/skyline-ad","sharedAdPosition"],function(e,t,i,s,n,a,o,r,l,h,d,c,u){"use strict";var p=a.extend({cards:(window.section_arrows||"home").split("|"),cardsDisplay:(window.section_arrows_display||"home").split("|"),initialize:function(i){i=e.extend(!0,{animations:{horizontal:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"},fadeIn:{duration:200}},UPDATE_FREQUENCY:9e5,keyboard:!1,peekWidth:-100,template:'<div class="card-wrap-<%= layoutType %> card-wrap"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-loading-border"></div></section></div>',overlayTemplate:'<div class="card-wrap-<%= layoutType %> card-wrap card-wrap-behind-overlay"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-suspender-color <%= section %>"></div><div class="card-loading-border"></div><div class="sidebar"></div></section></div>'},i),t.bindAll(this,"handleResizeWindow"),this.$top=s.get("scrollEl"),this.$doc=s.get("doc"),this.$body=s.get("body"),this.$win=s.get("win"),this.template=t.template(i.template),this.overlayTemplate=t.template(i.overlayTemplate),this.containerOffset=0,this.header=n.getHeader(),this.cardSizes=[];var o=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,o),this.options.keyboard&&this.$doc.on("keydown."+this.cid,this.keyNavigation),a.prototype.initialize.call(this,i)},destroy:function(e){this.$win.off("."+this.cid),this.$doc.off("."+this.cid),a.prototype.destroy.call(this,e)},animateChangePagePreData:function(e,t){var i=s.getSectionPath(t),a=this.goTo(i);if(this._updateNav(t,i),!a&&this.currentPath!==t){var o=this.createAndInitializeEmptyCard(i,this.$win.height()),r=s.getScrollPosition();r-=n.scrollTop(0),this.$currentCard.children(".card").css({top:-1*r}),o.css({position:"relative",margin:"",left:-1*this.containerOffset}),this.$currentCard.css({left:this.leftMargin+-1*this.containerOffset}),a=this.swapContent(this.$currentCard,o),this.$currentCard=o}return a},animateChangePagePostData:function(e,t,i){var s=this.$currentCard,n=i.find(".card-wrap");return n.css({left:-1*this.containerOffset}),s.css({height:"",overflow:"","padding-right":"",left:this.leftMargin+-1*this.containerOffset}),this.$currentCard=n,this.swapContent(s,n,!1,this.getHash(t))},animateRevealApp:function(t,i,s){return s?(this.afterOverlayReveal(0,i),e.Deferred().resolve()):a.prototype.animateRevealApp.apply(this,arguments)},beforePageReveal:function(e,t,i,s){s&&i.css("display","none")},afterPageReveal:function(e,n,a,r){var l=s.getSectionPath(n);this.domInitialized||this.initializeDom(),this.cardSizes=o[s.getNested(this.pageInfo,"layout_type")]||[],this.calculateCardDimensions(this.$win.width()),this._updateNav(n,l),this.$currentCard=this.$container.children(".card-wrap"),this.currentIndex=t.indexOf(this.cards,l),a||(r&&(this.subviews.view=new r({el:this.$currentCard})),this.setupAds(),this.triggerEvent("renderCardInfo",this.currentCardInfo,this.isCurrentCardBumped())),i.trigger("cards:loaded")},setupAds:function(){var e=this.$(".partner-billboard-ad"),i=this.$currentCard;this.subviews.billboardAd=new u({defaultPosition:!0,el:e,adPlacement:"high_impact",adSizes:s.getNested(window.site_vars,"ADS","front_billboard_ad_sizes")||["iabpushdown","iabpushdown2","billboard","risingstar"],adType:["billboard","risingstar"]}),this.subviews.pushdownAd=new r({el:this.$(".partner-pushdown-ad"),adClasses:t.pluck(this.cardSizes,"adClass").join(" "),cards:i,slot:e}),this.subviews.gravityAd=new l({el:this.$(".partner-gravity-ad"),contentSection:this.$el,cards:i,slot:e}),this.subviews.dualPushdownAd=new h({el:this.$(".partner-pushdown-ad"),card:i.children(".card"),cards:i,adClasses:t.pluck(this.cardSizes,"adClass").join(" "),slot:e}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),cards:i,isCardBumped:this.isCurrentCardBumped(),getHeaderOffset:t.bind(function(){return this.header.getExpandedHeight()},this),slot:e}),this.subviews.skylineAd=new c({el:this.$(".partner-skyline-ad"),slot:e}),this.subviews.genericad=new u({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"})},isCurrentCardBumped:function(){return this.$currentCard.children(".card-bumped").length},beforeAppRemove:function(){e(".site-nav span.site-nav-span").removeClass("site-nav-active-span")},getRevealAppLoader:function(t){var i=s.getSectionPath(t),n=this.createAndInitializeEmptyCard(i,this.$win.height());return n.css({position:"relative",margin:""}),n=e('<div class="card-container"></div>').append(n),n=e('<article id="cards" class="cards"></article>').append(n)},initializeDom:function(){this.$container=this.$(".card-container"),this.$prevBtn=this.$("#cards-prev-link"),this.$nextBtn=this.$("#cards-next-link"),this.buttonWidth=this.$prevBtn.width(),this.buttonsVisible=!1,this.domInitialized=!0},handleResizeWindow:function(){if(this.domInitialized){var e=this.$win.width();if(this.windowWidth===e)return!1;var t=this.currentCardInfo;this.calculateCardDimensions(e),this.currentCardInfo!==t&&this.triggerEvent("onCardWidthChange",this.currentCardInfo)}},calculateCardDimensions:function(e){var i=this.getMinCardInfo();e<i.windowWidth&&(e=i.windowWidth),this.windowWidth=e;var s=i,n=(window.matchMedia||Modernizr.mq("only all"))&&!this.$top.hasClass("lt-ie9");return t.find(this.cardSizes,function(t){if(n){if(Modernizr.mq("only screen and (min-width: "+t.windowWidth+"px)"))return s=t,!0}else if(e>=t.windowWidth)return s=t,!0}),this.cardWrapWidth=s.cardWidth+((e-2*this.options.peekWidth-s.cardWidth)/2+.5)>>0,this.cardWrapWidth<i.cardWidth&&(this.cardWrapWidth=i.cardWidth),this.leftMargin=(e-s.cardWidth-2*this.options.peekWidth)/2+this.options.peekWidth+.5>>0,this.currentCardInfo=s,this._shouldShowBtns(s.cardWidth,e),s},_shouldShowBtns:function(e,t){var i=2*this.buttonWidth+e<t;i!==this.buttonsVisible&&(i?(this.$nextBtn.css("visibility","visible"),this.$prevBtn.css("visibility","visible")):(this.$nextBtn.css("visibility","hidden"),this.$prevBtn.css("visibility","hidden")),this.buttonsVisible=i)},updateNavLinks:function(e,t){t="home"===t?"/":"/"+t+"/",e.attr("href",t)},keyNavigation:function(e){switch(e.keyCode){case 37:this.previous();break;case 39:this.next()}},inBounds:function(e,t){return!isNaN(parseFloat(e,10))&&isFinite(e)&&e>=0&&t-1>=e},goTo:function(i){var n=t.indexOf(this.cards,i);if(-1!==n&&-1!==this.currentIndex&&n!==this.currentIndex){var a=s.getScrollPosition();return this.isApple&&a>0?e.Deferred(t.bind(function(e){this.$top.animate({scrollTop:0},200).promise().done(t.bind(function(){this._animateCards(n,a).done(function(){e.resolve()})},this))},this)).promise():this._animateCards(n,a)}},_animateCards:function(t,i){var s,a=0,o=e([]),r=this.$win.height(),l=this.$currentCard,h=this.currentIndex,d=this.$currentCard.height(),c=l.offset().top,u=0;u=Math.abs(t-h)>this.cards.length/2?t>h?-1:1:t>h?1:-1;do h=this._incrementIndex(h,u),s=this.createAndInitializeEmptyCard(this.cards[h],r),h!==t&&o.push(s[0]),this._positionCard(s,++a*u),this.$container.append(s);while(h!==t);this.$currentCard=s,this.containerOffset-=a*u*this.cardWrapWidth,i>d+c-r&&l.css({height:r,overflow:"hidden"}),i-=n.scrollTop(0),this.isApple||l.children(".card").css({top:-1*i});var p=this.animate(this.$container,"left",this.containerOffset+"px",this.options.animations.horizontal.duration,this.options.animations.horizontal.easing);return p.done(function(){s.css("position","relative")}).always(function(){l.remove(),o.remove()}),p},_incrementIndex:function(e,t){return(this.cards.length+e+t)%this.cards.length},createAndInitializeEmptyCard:function(t,i){var n=e(this.template({section:t,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"}));return n.css({margin:0,position:"absolute",height:i,bottom:0}),n},_positionCard:function(e,t){e.css({left:this.leftMargin-this.containerOffset+t*this.cardWrapWidth})},getMinCardInfo:function(){return this.cardSizes[this.cardSizes.length-1]||{}},afterOverlayReveal:function(t,i){var n=s.getSectionPath(i||this.currentPath),a=this.$(".card-wrap > .card").position().top||50,o=this.header.getFixedThreshold(),r=a+this.header.getExpandedHeight();this.$el.hide(),r>t&&(t>o&&(r-=t-o),this.offsetPlaceholder=e('<div id="cards-offset-placeholder" style="height:'+r+'px"></div>'),this.$body.append(this.offsetPlaceholder)),this.header.isFixed()?this._fixPlaceholder():this._unfixPlaceholder(),this.fakeCardPlaceholder=e(this.overlayTemplate({section:n,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"})),this.$body.append(this.fakeCardPlaceholder)},_fixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"fixed",top:-1*this.header.getFixedThreshold()})},_unfixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"absolute",top:0})},_onHeaderFixed:function(){this._fixPlaceholder(),a.prototype._onHeaderFixed.apply(this,arguments)},_onHeaderUnfixed:function(){this._unfixPlaceholder(),a.prototype._onHeaderUnfixed.apply(this,arguments)},beforeOverlayRemove:function(){this.$el.show(),this.offsetPlaceholder&&(this.offsetPlaceholder.remove(),this.offsetPlaceholder=null),this.fakeCardPlaceholder&&(this.fakeCardPlaceholder.remove(),this.fakeCardPlaceholder=null)},getClientAdInfo:function(){return{cardsize:this.currentCardInfo.adTargeting}},_updateNav:function(e,i){var s,n,a=t.indexOf(this.cards,i),o=this._incrementIndex(a,1),r=this._incrementIndex(a,-1);this.header&&this.header.updateNavigation(e),this.domInitialized&&(-1===a&&(o=t.indexOf(this.cards,"home"),r=this._incrementIndex(o,-1)),s=this.cards[o],n=this.cards[r],this.updateNavLinks(this.$nextBtn,s),this.updateNavLinks(this.$prevBtn,n),this.$(".front-next-arrow-label").html(this.cardsDisplay[o]||s),this.$(".front-prev-arrow-label").html(this.cardsDisplay[r]||n),this.$nextBtn.removeClass().addClass("front-arrow-"+s),this.$prevBtn.removeClass().addClass("front-arrow-"+n),this.$(".front-overlay-next-arrows-anchor").removeClass().addClass("front-overlay-next-arrows-anchor "+s+"-theme-bg"),this.$(".front-overlay-prev-arrows-anchor").removeClass().addClass("front-overlay-prev-arrows-anchor "+n+"-theme-bg"))}});return p}),define("modules/scroller/sidebar-scroll",["jquery","underscore","modules/scroller/vertical-scroll"],function(e,t,i){var s=i.extend({initialize:function(s){t.bindAll(this,"onScrollUpdated","removeActiveClass"),s=e.extend({removeActiveDelay:700},s),Modernizr.touch&&(this.$el.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$el.css("-webkit-overflow-scrolling")&&(this.$el.css({overflow:"scroll"}),s.disabled=!0)),this._addBottomShadow(),this._addTopShadow(),i.prototype.initialize.call(this,s),this.bar.addClass("hide")},bindEvents:function(){this.options.disabled||(this.$el.on("scrollBarUpdate."+this.cid,this.onScrollUpdated),i.prototype.bindEvents.apply(this,arguments))},destroy:function(){this.$el.off("."+this.cid),this.topShadow.remove(),this.bottomShadow.remove(),clearTimeout(this.removeActiveClassDelay),clearTimeout(this.hideClassDelay),i.prototype.destroy.apply(this,arguments)},_addTopShadow:function(){this.topShadow=e('<div class="shadow top-shadow"></div>').hide(),this.$el.append(this.topShadow)},_addBottomShadow:function(){this.bottomShadow=e('<div class="shadow bottom-shadow"></div>').hide(),this.$el.append(this.bottomShadow)},removeActiveClass:function(){this.isMouseDown||this.isMouseOver||(this.bar.removeClass("active"),clearTimeout(this.removeActiveClassDelay),this.hideClassDelay=setTimeout(t.bind(function(){this.bar.addClass("hide")},this),1e3))},addActiveClass:function(e){this.bar.addClass("active"),this.bar.removeClass("hide"),this.startTimeout(e||this.options.removeActiveDelay)
},startTimeout:function(e){clearTimeout(this.removeActiveClassDelay),this.removeActiveClassDelay=setTimeout(this.removeActiveClass,e)},onMouseOut:function(){i.prototype.onMouseOut.apply(this,arguments),this.isMouseDown||this.startTimeout(this.options.removeActiveDelay)},onMouseEnter:function(){i.prototype.onMouseEnter.apply(this,arguments),this.addActiveClass(this.options.removeActiveDelay)},onScrollUpdated:function(e,t){0===t?this.topShadow.hide():this.topShadow.show(),1===t?this.bottomShadow.hide():this.bottomShadow.show(),this.addActiveClass()}});return s}),define("modules/sidebar",["jquery","underscore","baseview","pubsub","state","modules/scroller/sidebar-scroll"],function(e,t,i,s,n,a){"use strict";var o=i.extend({events:{"click .open-sidebar":"openSidebarClick","click .close-sidebar":"closeSidebarClick"},initialize:function(s){this.sidebar=this.$(".sidebar"),this.sidebar.length&&(t.bindAll(this,"showSidebarOpenButton","showSidebarCloseButton","onScroll","_recalculateScrollBar"),s=e.extend(!0,{animations:{sidebar:{button:{fadeIn:200,fadeOut:200},slide:250}}}),this.pubSub={"sidebar:hide":this.closeSidebarClick,"sidebar:show":this.openSidebarClick,"showmore:headlines":this.onHeadlinesUpdated},this.refreshSidebarScroll=t.debounce(this._recalculateScrollBar,1e3),i.prototype.initialize.call(this,s),this._addSidebar())},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&(this.isSidebarOpen=!0,this.refreshSidebarScroll())},onCardWidthChange:function(e){var t=e.sidebarOpen!==this.currentCardInfo.sidebarOpen||this.sidebarOpen!==e.sidebarOpen;this.currentCardInfo=e,this.resetSidebar(),t&&n.getActiveApp().triggerEvent(e.sidebarOpen?"openSideBar":"closeSideBar")},_recalculateScrollBar:function(){this._setSideBarTitles();var e=this.$(".sidebar-fixed-content"),t=e.height(),i=this.sidebar.height(),s=Math.max(0,i-t),a=this.$(".sidebar-scrollable-window");t>i&&(t=i,e.css("height",i)),s!==parseInt(a[0].style.height,10)&&(a.css("height",s),n.getActiveApp().triggerEvent("onSidebarScrollableHeightChange",t,s)),this.subviews.vscrollbar&&this.subviews.vscrollbar.refresh()},_addSidebar:function(){Modernizr.touch||this.initializeSidebarTitles(),this.openButton=this.$(".open-sidebar"),this.closeButton=this.$(".close-sidebar"),this.subviews.vscrollbar=new a({el:this.$(".sidebar-scrollable-window"),contentClass:this.$(".sidebar-scrollable-content"),padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0,onScroll:this.onScroll})},initializeSidebarTitles:function(){this.$sidebarScrollableTitles=this.$(".sidebar-scrollable-content .sidebar-title-wrapper"),this.$sidebarStaticTitle=this.$(".sidebar-static-title-wrapper");var e=this.$(".sidebar-scrollable-content .sidebar-title-wrapper:first");e.length&&(e.hide(),this.$sidebarStaticTitle.html(e.html()).show())},_setSideBarTitles:function(){var t=this;this.sideBarTitles=[],this.$sidebarScrollableTitles&&this.$sidebarScrollableTitles.each(function(i,s){var n=e(s),a=!1;n.is(":hidden")&&(n.show(),a=!0);var o=n.position().top+n.outerHeight();a&&n.hide(),o=-1*o,t.sideBarTitles.push({position:o,html:n.html()})})},onScroll:function(e){if(this.$sidebarScrollableTitles.length>1&&0!==e){var t=this.$sidebarStaticTitle;this.sideBarTitles||this._setSideBarTitles();var i,s=this.sideBarTitles.length-1,n=t.html();for(s;s>=0;s--)if(i=this.sideBarTitles[s],i.position>e){n=i.html;break}t.html()!==n&&t.html(n)}},openSidebarClick:function(e){e&&e.preventDefault(),n.getActiveApp().triggerEvent("openSideBar"),this._slideSidebar(this.openButton,!0)},openSidebar:function(){this.isSidebarOpen=!0},closeSidebarClick:function(e){e&&e.preventDefault(),this._slideSidebar(this.closeButton,!1),n.getActiveApp().triggerEvent("closeSideBar")},closeSidebar:function(){this.isSidebarOpen=!1},_slideSidebar:function(e,i){var s=this.options.animations.sidebar.slide,a=this.options.animations.sidebar.button.fadeOut;n.registerAnimation(e.fadeOut(a,"easeInOutCubic").promise());var o=parseInt(this.sidebar.css("width"),10),r=null;if(this.currentCardInfo.sidebarOpen){var l=i?this.currentCardInfo:n.getActiveApp().getMinCardInfo();this.sidebar.removeClass("top"),r=this.animate(this.$.closest(".card"),"width",l.cardWidth,s,"ease-in-out")}else r=this.animate(this.sidebar,"right",-1*o,s,"ease-in-out");return r.then(t.bind(function(){var e=this.animate(this.sidebar,"right",0,s,"ease-in-out");return i?this.currentCardInfo.sidebarOpen?(this.sidebar.removeClass("top"),this.$el.closest(".card").css("width","")):(this.sidebar.addClass("top"),e.done(this.showSidebarCloseButton)):(e.done(this.showSidebarOpenButton),this.sidebar.removeClass("top")),e},this))},resetSidebar:function(){this.$el.closest(".card").css("width",""),this.sidebar.removeClass("top"),this.currentCardInfo.sidebarOpen?(this.openButton.hide(),this.closeButton.hide()):(this.adVisible?this.openButton.hide():this.openButton.show(),this.closeButton.hide()),this._setSideBarTitles()},showSidebarOpenButton:function(){this.adVisible||(this.openButton.css({visibility:"visible",display:"none"}),this.openButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic"))},showSidebarCloseButton:function(){this.closeButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic")},onHeadlinesUpdated:function(){this.headlinesUpdate=setTimeout(this._recalculateScrollBar,1e3)},onHeroAdClose:function(){this.adVisible=!1,this.isSidebarOpen||this.showSidebarOpenButton()},onHeroAdOpen:function(){this.adVisible=!0,this.isSidebarOpen?this.currentCardInfo.sidebarOpen||this.closeSidebar():this.openButton.fadeOut(this.options.animations.sidebar.button.fadeOut,"easeInOutCubic")}});return o}),define("partner/overlay-ad-asset",["jquery","underscore","partner/overlay-ad-base","meteredAdPosition","adLogger"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(s){s=e.extend({adSizes:["elastic"],adPlacement:"transition",rateMeterId:"transition",pageInfo:null},s),t.bindAll(this,"onAdReady"),i.prototype.initialize.call(this,s),this.loadAdPlacement(this.options.pageInfo),n.logDebug("Partner Metered Overlay initialized",this)},loadAdPlacement:function(e){e=e||this.options.pageInfo,this.subviews.ad=new s({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,rateMeterId:this.options.rateMeterId,pageInfo:e,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},triggerAd:function(){var e="transition_referrer"===this.options.adPlacement,t=this.options.pageInfo.excludeTransitionAd;this._tickMeterFetchAd(t),e&&!t&&this.$placement.children(".partner-overlay-close").data("uotrack","referreradclosed")},getCurrentMeterCount:function(){return this._tellAd("getCurrentMeterCount")},_tickMeterFetchAd:function(e){this.tickMeter(e)&&!e&&this.subviews.ad.prefetchAd()},tickMeter:function(e,t){return this._tellAd("tickMeter",e,t)},_tellAd:function(e){var t=this.subviews.ad;return t&&t[e]?t[e].apply(t,Array.prototype.slice.call(arguments,1)):null},resetMeter:function(e){return this._tellAd("resetMeter",e)},refresh:function(e){this.destroyAdPosition(),this.loadAdPlacement(e)}});return a}),define("modules/partner/story-transition-ad",["jquery","underscore","baseview","state","site-manager","utils","admanager","partner/overlay-ad-asset"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.renderAd()},renderAd:function(){var e=s.getReferrer(),i={el:this.$el,pageInfo:s.getActivePageInfo(),getHeaderOffset:function(){var e=n.getHeader();return e?e.getExpandedHeight():0}},a=!1;e&&-1===e.indexOf(window.location.protocol+"//"+window.location.hostname)&&(i.adPlacement="transition_referrer",i.rateMeterId="transition_referrer",a=!0),this.subviews.transitionAd=new r(i),Modernizr.history||(a=!0),0===this.subviews.transitionAd.getCurrentMeterCount()&&(a=!0),o.getActiveSlotStatistics().done(t.bind(function(e){this.destroyed||(t.findWhere(e.high_impact_info,{adType:"gravity"})&&a&&(a=!1,this.subviews.transitionAd.resetMeter("transition")),a?this.subviews.transitionAd.triggerAd():this.subviews.transitionAd.tickMeter(!0,"transition"),"transition_referrer"===i.rateMeterId&&this.subviews.transitionAd.resetMeter("transition"))},this))},getTransitionMeterCount:function(){return this.subviews.transitionAd?this.subviews.transitionAd.getCurrentMeterCount("transition"):0}});return l}),define("partner/gravity-ad-article",["jquery","underscore","utils","sharedAdPosition","partner/gravity-ad"],function(e,t,i,s,n){"use strict";var a=n.extend({articleElsHidden:!1,initialize:function(e){n.prototype.initialize.call(this,e);var t=this.options.contentSection;this.$recommended=t.find(".recommended-flyout-container"),this.$utilityBarPrimaryModules=t.find(".util-bar-primary-modules"),this.$utilityBarSecondaryModules=t.find(".util-bar-secondary-modules"),this.$closeWrap=t.find(".close-wrap"),this._createAd(["gravity"],"gravity")},_createAd:function(){var e=this._filterAdsByCardWidth(["gravity"]);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:e,adType:"gravity",onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender})},onAdReady:function(e){var t=this.subviews.adLeaveBehind;t.shouldShowAd(e)&&(t.incrementAdViewCount(e),this.showAd(),i.get("scrollEl").animate({scrollTop:0},500))},onArticleScroll:function(e,t){var i=this.$utilityBarSecondaryModules.height();.1>e&&this.articleElsHidden?(this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:0},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$recommended.show(),this.$closeWrap.show(),this.$body.removeClass("high-impact-ad-visible"),this.articleElsHidden=!1):e>.1&&!this.articleElsHidden&&(this.$recommended.hide(),this.$closeWrap.hide(),this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:-1*i},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$body.addClass("high-impact-ad-visible"),this.articleElsHidden=!0),0>=e?(this.$utilityBarPrimaryModules.css({position:"fixed",top:80+t}),this.$closeWrap.css({position:"fixed",top:80+t})):e>0&&(this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$closeWrap.css({position:"absolute",top:80}))},shiftUnlockedContentUp:function(){n.prototype.shiftUnlockedContentUp.call(this),this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$partnerScroll.animate({"margin-top":-145},350)},showAd:function(){n.prototype.showAd.call(this),(!this.paywall||this.paywall&&("loggedIn"===status||"loggingIn"===status))&&this.shiftUnlockedContentUp()}});return a}),define("apps/overlay/overlay",["jquery","underscore","backbone","utils","site-manager","apps/simple-overlay","state","admanager","modules/partner/story-transition-ad","directAdPosition","meteredAdPosition","partner/gravity-ad-article","managers/routemanager"],function(e,t,i,s,n,a,o,r,l,h,d,c,u){"use strict";var p=a.extend({el:"#overlay",events:function(){return e.extend({},a.prototype.events,{"click .overlay-content-arrows":"nextArticleClick"})},initialize:function(i){i=e.extend({inbetweenAdTemplate:'<div class="partner-inbetween transition-wrap"><div class="partner-inbetween-content partner-placement"></div></div>'},i),this.init=!1,this.$doc=s.get("doc"),this.$body=s.get("body"),t.bindAll(this,"keyboardEvent","beforeInbetweenAdRender"),this.currentStoryIndex=-1,this.storyCollection=[],this.animationIndex=0,a.prototype.initialize.call(this,i)},resizeHandler:function(){a.prototype.resizeHandler.apply(this,arguments),this.inbetweenAd&&this.inbetweenAd.resizeAd(980,this.winSize.height),this.$inbetweenPartner&&this.$inbetweenPartner.css(this.winSize)},afterPageReveal:function(e){a.prototype.afterPageReveal.apply(this,arguments),this.$doc.on("keyup."+this.cid,this.keyboardEvent),this.init?(this.renderInbetweenAd(),this.updateArrowLinks()):(this.initializeDom(),this.init=!0,this.updateArrowLinks(!0),this.subviews.storyTransitionAd=new l({el:this.$(".partner-overlay")}),0===this.subviews.storyTransitionAd.getTransitionMeterCount()&&this.renderInbetweenAd()),null!==e&&this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex),this.loadAdPlacements()},loadAdPlacements:function(){var e=o.getActivePageInfo();e.sponsored_series||("video"!==e.priority_asset&&(this.subviews.gravityAd=new c({el:this.$(".partner-gravity-ad"),contentSection:this.$el})),!s.getNested(window.site_vars,"ADS","teads_enabled")||t.findWhere(e.js_modules,{oembedtype:"rich"})||t.findWhere(e.js_modules,{name:"gallery"})||"no"!==e.videoincluded||"Published"!==e.asset_status||(this.subviews.teadsAd=new h({el:this.$(".partner-teads"),adSizes:[1,1],adPlacement:"video_inread-partner_teads",adType:"teads",pageInfo:e})))},preloadPath:function(){o.preloadPath(this.preloadedUrl).done(t.bind(function(){this.updateArrowLinks(!0),this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex)},this))},beforeInbetweenAdRender:function(){this.inbetweenAd.setInitialDimensions(980,this.winSize.height)},renderInbetweenAd:function(){this.$inbetweenPartner?this.$inbetweenPartner.parent().length||this.$el.append(this.$inbetweenPartner.hide()):(this.$inbetweenPartner=e(this.options.inbetweenAdTemplate),this.$el.append(this.$inbetweenPartner)),this.inbetweenAd?this.isShowingAd&&(this.isShowingAd=!1):this.inbetweenAd=new d({el:this.$inbetweenPartner.find(".partner-inbetween-content"),adPlacement:"transition",adSizes:["bigpageflex"],beforeAdRender:this.beforeInbetweenAdRender,rateMeterId:"transition"}),this.inbetweenAd.setPageInfo(o.getActivePageInfo()),this.inbetweenAd.tickMeter(!0)&&r.getActiveSlotStatistics().done(t.bind(function(e){t.findWhere(e.high_impact_info,{adType:"gravity"})?this.inbetweenAd.resetMeter():(this.timeToShowAd=!0,this.inbetweenAd.refreshPosition())},this))},keyboardEvent:function(t){if(t.target===this.$body[0])switch(t.which){case 37:e(".overlay-content-arrows-previous-wrap").trigger("click");break;case 39:e(".overlay-content-arrows-next-wrap").trigger("click")}},nextArticleClick:function(i){var s=1,n=e(i.currentTarget),a=n.attr("href"),o=this.inbetweenAd;if(n.hasClass("overlay-content-arrows-previous-wrap")&&(s=-1),!this.isShowingAd&&this.timeToShowAd&&o.isAdReady()&&(o.tickMeter(),this.timeToShowAd=!1,i.preventDefault(),u.goToInterstitual(a))){var r=this.getStoryCollection();return n.siblings().remove(),this.arrowContainer.append(this.buildArrowDom(r[this.currentStoryIndex],0>s?"next":"previous")),this.currentStoryIndex+=s/2,o.showAd(980,this.winSize.height),this.animateToContent(this.$inbetweenPartner,s).done(t.bind(function(){this.inbetweenAd&&(this.isShowingAd=!0,o.playAd())},this))}},initializeDom:function(){this.arrowWrapTemplate=this.$("#overlay-arrow-wrap"),this.arrowContainer=this.$(".overlay-arrows")},destroyModules:function(){this.$doc.off("."+this.cid),a.prototype.destroyModules.apply(this,arguments)},beforeAppRemove:function(){this.inbetweenAd&&(this.inbetweenAd.destroy(),this.inbetweenAd=null),a.prototype.beforeAppRemove.apply(this,arguments)},updateArrowLinks:function(e){if(-1!==this.currentStoryIndex||(this.currentStoryIndex=this.getBestStoryIndex(window.location.pathname,e),-1!==this.currentStoryIndex)){var t=this.getStoryCollection(),i=this.buildArrowDom(t[this.currentStoryIndex-1],"previous"),s=this.buildArrowDom(t[this.currentStoryIndex+1],"next");this.arrowContainer.empty().append(i).append(s),this.animate(this.arrowContainer,"opacity",1,250)}},buildArrowDom:function(i,s){var n=!i;if(i?i.disabled="":i={disabled:"disabled"},i.dir=s,i.photo&&i.photo.crops&&i.photo.crops["1_1"]&&-1!==i.photo.crops["1_1"].indexOf(".jpg")&&(i.image=i.photo.crops["1_1"]),!this.arrowWrapTemplate.length)return e([]);var a=e(e.trim(t.template(this.arrowWrapTemplate.html(),i)));return n?a.css(this.isApple?{display:"none"}:{"z-index":1}):this.isApple&&a.find(".preview").remove(),a},getBestStoryIndex:function(e,t){e&&"/"!==e[0]&&(e="/"+e);var i=this.getStoryCollection();if(!i||0===i.length)return-1;var s=-1,n=-1,a=Math.round(this.currentStoryIndex);-1===a&&(a=0);var o;for(o=a;o>=0;o--)if(i[o].links===e){s=o;break}for(o=a;o<i.length;o++)if(i[o].links===e){n=o;break}if(-1===n&&-1===s&&t){var r={links:e};return this.storyCollection.unshift(r),0}return-1===n?s:-1===s?n:n-a>a-s?s:n},getStoryCollection:function(){if(0===this.storyCollection.length){var e=o.getPreloadedPageInfo(),i=e&&e.asset_collection;i&&(this.storyCollection=t.filter(i,this._filterStoryCollection))}return this.storyCollection},_filterStoryCollection:function(e){var t,i,s;return e.links&&(t=u.getInfo(e.links),i=t&&t.app&&t.app.AppClass),s=i===p,e.headline&&e.links&&!e.links.match("http")&&s},animateChangePagePreData:function(t,i){var s,n=this.getBestStoryIndex(i);return-1!==this.currentStoryIndex&&-1!==n&&(s=this.currentStoryIndex>n?"left":"right"),this.currentStoryIndex=n,this.animateToContent(e(this.options.template).find(".transition-wrap"),s)},animateToContent:function(i,a){var o=this.winSize.height,r=s.getScrollPosition(),l=this.$(".transition-wrap:first");if(r-=n.scrollTop(0),this.$el.css({position:"relative"}),this.prepareContentForTransition(l,r,o),i.css({position:"absolute",top:0,display:"block"}),i.attr("data-animation-index",++this.animationIndex),this.prepareContentForTransition(i,0,o),i.closest("body").length||this.$el.prepend(i),this.header.isFixed()&&this.positionCloseButton("absolute",r,l),a){l.css({left:"0%"});var h,d="0%";return"left"===a?(i.css("left","-100%"),h="100%"):(i.css("left","100%"),h="-100%"),e.Deferred(t.bind(function(s){var n=e.when(this.animate(l,"left",h,350,"ease-in-out"),this.animate(i,"left",d,350,"ease-in-out"));n.done(t.bind(function(){this.isShowingAd&&this.inbetweenAd&&this.inbetweenAd.destroyAdPlacement(),l.remove(),parseInt(i.attr("data-animation-index"),10)===this.animationIndex&&this.resetContentTransition(i),s.resolve()},this))},this)).promise()}return i.css({position:"relative"}),this.swapContent(l,i)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},resetContentTransition:function(e){e.css({position:"relative"}),this.$el.css({position:"",top:""})}});return p}),define("third-party-apis/base-third-party-api",["jquery","underscore","backbone","pubsub","utils"],function(e,t,i,s,n){"use strict";var a=i.View.extend({SITE_CONFIG:n.getNested(window.site_vars,"THIRDPARTYAPI"),initialize:function(){s.on("page:load",t.bind(this.loadScript,this))},loadScript:function(){return this.loadScriptPromise||(this.loadScriptPromise=this._handleLoadScript()),this.loadScriptPromise},_handleLoadScript:function(){return e.Deferred().resolve()},setupOnLoadCallbacks:function(e,i){window[e]||(window[e]=t.bind(function(){i()},this))},getApiSiteConfig:function(e){var t=this.SITE_CONFIG;return t?t[e]:(console.error("No siteconfig set up for "+e+" api!"),{})}});return a}),function(){var e="undefined"!=typeof exports?exports:window,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=function(){try{document.createElement("$")}catch(e){return e}}();e.btoa||(e.btoa=function(e){for(var s,n,a=0,o=t,r="";e.charAt(0|a)||(o="=",a%1);r+=o.charAt(63&s>>8-a%1*8)){if(n=e.charCodeAt(a+=.75),n>255)throw i;s=s<<8|n}return r}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw i;for(var s,n,a=0,o=0,r="";n=e.charAt(o++);~n&&(s=a%4?64*s+n:n,a++%4)?r+=String.fromCharCode(255&s>>(-2*a&6)):0)n=t.indexOf(n);return r})}(),define("base64",function(){}),define("third-party-apis/firefly/firefly",["jquery","underscore","third-party-apis/base-third-party-api","managers/requestmanager","utils","base64"],function(e,t,i,s,n){"use strict";var a=i.extend({getUserInfo:function(){return this.userInfo&&"rejected"!==this.userInfo.state()||(this.userInfo=s.fetchData(n.getNested(window,"firefly_urls","samServiceURL")+"gateway/getUser/?callback=?",{dataType:"jsonp",data:{}}).then(function(t){return 0===t.meta.status?t.response:e.Deferred().reject("Not logged in.")})),this.userInfo},getGupUserInfo:function(){return this.gupUserInfo&&"rejected"!==this.gupUserInfo.state()||(this.gupUserInfo=e.getJSON(n.getNested(window.site_vars,"ugc","gup_yourtake_user")+"?callback=?")),this.gupUserInfo},sanitizeFireflyViewsObject:function(e){return t.isObject(e)?e.viewCount&&e.viewThreshold&&e.viewedContent?t.isNumber(e.viewCount)&&t.isNumber(e.viewThreshold)&&t.isArray(e.viewedContent)?(e.viewCount<1&&(e.viewCount=1),e.viewThreshold<1&&(e.viewThreshold=1),e.viewCount>e.viewThreshold&&(e.viewThreshold=e.viewCount),e):(console.error("Wrong format in Firefly views object values"),!1):(console.error("Missing Firefly views object properties"),!1):(console.error("Firefly views cookie is not an object"),!1)},getFireflyViewsCookie:function(){var t=null,i=e.cookie("firefly_akamai_open");if(i&&(t=this._parseCookie(i))){t=this.sanitizeFireflyViewsObject(t);var s=t.viewThreshold-t.viewCount;t.viewsRemaining=s}return t},_parseCookie:function(e){try{return JSON.parse(atob(e))}catch(t){try{return JSON.parse(e)}catch(i){}}return null},getLoginStatus:function(){return this.getUserInfo()},loginUser:function(){return this.getLoginStatus()},logoutUser:function(){return this.userInfo=null,this.gupUserInfo=null,e.Deferred().resolve()}});return new a}),define("modules/stories/utility-bar-module-popups",["jquery","underscore","backbone"],function(e,t,i){var s=i.View.extend({});return new s}),define("modules/stories/utility-bar",["jquery","underscore","backbone","pubsub","utils","state","baseview","site-manager","managers/resourcemanager","third-party-apis/firefly/firefly","user-manager","modules/stories/utility-bar-module-popups"],function(e,t,i,s,n,a,o,r,l,h,d,c){var u=o.extend({el:".utility-bar-wrap",events:{"click .util-bar-btn":"onClickUtilityBtn"},initialize:function(e){t.bindAll(this,"onDestroySubview"),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed,"user:statuschange":this._loginStatus,"fireflyout:open":this.allowOpenFireflyout},this.$primaryModules=this.$(".util-bar-primary-modules"),this.$secondaryModules=this.$(".util-bar-secondary-modules"),this.canFireflyoutOpen=!n.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","ENABLED")||!1,this.isFireflyoutOpen=!1;var i=r.getHeader();i&&i.isFixed()&&this.onHeaderFixed(),o.prototype.initialize.call(this,e),this.autoPopoutComments(),this.setupFireflyout()},autoPopoutComments:function(){this.$commentsBtn=this.$(".util-bar-btn-comments"),window.location.search.search("[?&]fb_comment_id=.+")>-1&&t.defer(t.bind(function(){this.openComments()},this))},setupFireflyout:function(){this.$fireflyModule=this.$(".util-bar-module-firefly"),this.$fireflyBtn=this.$(".util-bar-btn-firefly"),this.$fireflyModule.length&&this._checkUserAccount()},_checkUserAccount:function(){var e=d.getAccount("firefly");e&&e.getUserInfo().always(t.bind(function(t){this._loginStatus("firefly",e.getLoginStatus(),t)},this))},_loginStatus:function(e,t,i){if("firefly"===e){"loggedIn"===t?this.$fireflyModule.addClass("util-bar-module-firefly-authenticated"):"loggingIn"!==t&&this.$fireflyModule.removeClass("util-bar-module-firefly-authenticated");var s=a.getActivePageInfo().content_protection_state,n=!s||"free"===s;"loggedIn"===t&&i&&i.hasMarketAccess||n?this.$fireflyModule.removeClass("util-bar-module-firefly-visible"):"loggingIn"!==t&&(this.$fireflyModule.addClass("util-bar-module-firefly-visible"),this.fireflyCookieCheck())}},fireflyCookieCheck:function(){var e=h.getFireflyViewsCookie();e&&this._canFireflyoutOpen()&&!this.isFireflyoutOpen&&(1===e.viewCount||e.viewsRemaining<2||this._overrideFlyoutOpen(e.viewsRemaining))&&t.delay(t.bind(function(){this.isFireflyoutOpen=!0,this.openFireflyout()},this),0)},_overrideFlyoutOpen:function(e){return t.indexOf(n.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutOverrideArticleViewsRemaining"),e)>-1},_canFireflyoutOpen:function(){return this.canFireflyoutOpen},allowOpenFireflyout:function(){this.canFireflyoutOpen=!0;var e=d.getAccount("firefly");if(e){var t=e.getLoginStatus();("loggedIn"!==t||"loggingIn"!==t)&&this.fireflyCookieCheck()}},openFireflyout:function(){this.$fireflyBtn.trigger("click")},openComments:function(){this.$commentsBtn.trigger("click")},onHeaderFixed:function(){this.$primaryModules.css({position:"fixed",top:"auto"})},onHeaderUnfixed:function(){this.$primaryModules.css({position:"absolute",top:""})},onClickUtilityBtn:function(i){var s=e(i.currentTarget);if(s.data("popup-callback")){var n=s.data("popup-callback");c[n]()}else if("A"!==s.prop("tagName")){i.preventDefault();var a=s.data("module-name"),o=s.data("module-section")||"";this.subviews[a]?o&&o!==this.subviews[a].activeSection?this.subviews[a].open(o):this.subviews[a].close&&this.subviews[a].close():(t.each(this.subviews,function(e){e&&e.close&&e.close()}),l.getSiteModuleByName(a).done(t.bind(function(e){this.destroyed||(this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector,onDestroy:this.onDestroySubview},e.options)),this.subviews[e.name].open&&this.subviews[e.name].open(o))},this)).fail(function(){console.error("Failed to load utility bar module: "+a+".js")}))}},onDestroySubview:function(e){t.each(this.subviews,function(t,i){t===e&&(this.subviews[i]=null)},this)},show:function(){this.$el.addClass("show")},hide:function(){this.$el.removeClass("show")},destroy:function(e){this.destroyed=!0,this.$el.css("padding-top",n.getScrollPosition()),this.$primaryModules.css("position","absolute"),this.$secondaryModules.css("position","absolute"),o.prototype.destroy.call(this,e)}});return u}),define("modules/stories/recommended-flyout",["jquery","underscore","baseview","utils","state","managers/cachemanager"],function(e,t,i,s,n,a){"use strict";var o=i.extend({events:{"click .closed":"toggle","click .recommended-flyout-close":"toggle"},initialize:function(){t.bindAll(this,"scrollListener","fetchTrendingStories"),this.isOpen=!1,this.forcedStatus=!1,this.hasOpened=!1,this.rendered=!1,this.$flyout=this.$(".recommended-flyout"),this.$flyoutWrap=this.$(".recommended-flyout-wrap"),this.$flyoutTemplate=this.$("#recommended-flyout-template"),this.$win=s.get("win"),this.winHeight=this.$win.height(),this.trackLimit=10,this.audienceSegments=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(),this.trendingUrl="/feeds/recommended-for-you/",this.trackAsset(),this.getRecommendation(),i.prototype.initialize.apply(this,arguments)},bind:function(){var e=t.throttle(this.scrollListener,100);this.$win.on("scroll."+this.cid,e)},unbind:function(){this.$win.off("."+this.cid)},getTracker:function(){return this.tracker?this.tracker:(this.tracker=localStorage.getItem("recommendation-history"),this.tracker=this.tracker?JSON.parse(this.tracker):{history:[]},this.tracker)},trackAsset:function(){var e=n.getActivePageInfo(),i=this.getTracker(),s=Number(e.assetid);s&&-1==t.indexOf(i.history,s)&&(i.history.length>=this.trackLimit&&i.history.pop(),i.history.unshift(s),localStorage.setItem("recommendation-history",JSON.stringify(i)))},getRecommendation:function(){this.$triggerDom=this.$el.next();var e=this.$triggerDom.offset();e&&(this.triggerDomOffset=e.top,this.bind(),a.getValue("recommendation-trendingStories",this.fetchTrendingStories,5).done(t.bind(function(e){var i=this.tracker.history;i.length&&(e=t.reject(e,function(e){return-1!==t.indexOf(i,e.asset_id)})),e&&e.length&&"object"==typeof e[0]&&this.renderRecommendation(e)},this)))},fetchTrendingStories:function(){var e=n.getActivePageInfo();return n.fetchData(this.trendingUrl,{data:{segments:this.audienceSegments,site:"1",front:e.section_name}})},renderRecommendation:function(e){var t=e[0];t&&this.render(t)},scrollListener:function(){var e=s.getScrollPosition(),t=e+this.winHeight;this.forcedStatus||(this.triggerDomOffset<=t?this.openFlyout():this.closeFlyout())},render:function(e){var i=this.$flyoutTemplate.html();if(i){var s=t.template(i,{data:e});this.$flyout.html(s),this.rendered=!0}},toggle:function(e){e.preventDefault(),this.forcedStatus=!0,this.isOpen?this.closeFlyout():this.openFlyout()},openFlyout:function(){!this.isOpen&&this.rendered&&(this.animate(this.$flyoutWrap,"width",360,350,"ease-out"),this.$flyout.removeClass("closed"),this.isOpen=!0,this.hasOpened=!0)},closeFlyout:function(){this.hasOpened&&this.isOpen&&(this.animate(this.$flyoutWrap,"width",24,250,"ease-out"),this.$flyout.addClass("closed"),this.isOpen=!1)},destroy:function(){this.unbind(),i.prototype.destroy.apply(this,arguments)}});return o}),define("apps/stag-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","sharedAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video"],function(e,t,i,s,n,a,o,r,l,h,d,c){"use strict";var u=r.extend({el:".cards.stag",afterPageReveal:function(e){this._initializeTopic(e,"stag")},_initializeTopic:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new c({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=a.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new l({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new h)}});return u}),define("ui/button-toggle",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({initialize:function(s){s=e.extend({onSelect:null},s),i.prototype.initialize.call(this,s),this.toggleItems=this.$(".ui-button-toggle-item"),this.toggleItems.on("click."+this.cid,t.bind(function(t){this.onClick(e(t.currentTarget))},this))},onClick:function(e){e.hasClass("active")||(this.toggleItems.removeClass("active"),e.addClass("active"),this.options.onSelect&&this.options.onSelect(e))},destroy:function(e){this.toggleItems.off("."+this.cid),i.prototype.destroy.call(this,e)}});return s}),define("modules/cxense-recommends/cxense-base",["jquery","underscore","baseview","state","utils","pubsub"],function(e,t,i,s,n,a){var o=i.extend({monthsAbbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],selectors:{itemsWrap:".cx-items-wrap",itemTemplate:".cx-item-template"},events:{"click .cx-item-link":"_onClickCxenseItem"},initialize:function(s){return t.bindAll(this,"processRecs"),s=e.extend({relativeLinks:!0,getRecsOnInit:!0,cxenseWidgetId:null,cxenseUserObj:null,cxenseContextObj:null,cxenseNumRecs:0,recsTimeout:5e3},s),i.prototype.initialize.call(this,s),s.cxenseWidgetId?(this.sectionNames=e.extend({tv:"TV",mmajunkie:"MMAjunkie",ftw:"FTW",entertainthis:"Entertain This!",usatodaycollege:"USA TODAY College",roadwarriorvoices:"Road Warrior Voices"},n.getNested(window,"section_display_names")),this.urlRegExp=new RegExp("http(s)?://(www\\.)?("+n.getNested(window.site_vars,"base_url")+")","gi"),this.itemTemplate=t.template(this.$(this.selectors.itemTemplate).html()||'<li class="cx-item"><%= headline %></li>'),this.pixelTemplate=t.template('<img src="<%= pixelUrl %>?t=<%= cacheBuster %>" width="1" height="1" style="display:none;" />'),void(s.getRecsOnInit&&this._getRecs())):this.destroy(!0)},_getRecs:function(){var t=n.getNested(window.site_vars,"THIRDPARTYAPI","CXENSE","API"),i=this.options.cxenseWidgetId.replace(/\s+/,"");return t&&i?this._fetchRecs(t,i).done(this.processRecs):e.Deferred().reject()},_fetchRecs:function(e,t){var i=Date.now(),o={widgetId:t};return this.options.cxenseUserObj&&(o.user=this.options.cxenseUserObj),this.options.cxenseContextObj&&(o.context=this.options.cxenseContextObj),s.fetchData(e+"public/widget/data",{data:{json:JSON.stringify(o)},dataType:"jsonp",timeout:this.options.recsTimeout}).then(function(e){return a.trigger("cxresptrack","success|"+t+"|"+(Date.now()-i)),n.getNested(e,"response","items")||[]},function(){a.trigger("cxresptrack","fail|"+t+"|"+(Date.now()-i))})},processRecs:function(e){var i="",s=[];return t.each(e,t.bind(function(e){e["recs-publishtime"]!==e.createtime&&(s.length<this.options.cxenseNumRecs||0===this.options.cxenseNumRecs)&&s.push(e)
},this)),t.each(s,t.bind(function(e,t){i+=this.itemTemplate(this._formatItemForTemplate(e,t+1))},this)),this.renderRecs(i,s.length)},renderRecs:function(e){this.$(this.selectors.itemsWrap).append(e)},_getDisplaySection:function(e){if(e){var t=e.split("/");return e=t.length>1?t[1]:t[0],e in this.sectionNames&&(e=this.sectionNames[e]),e.replace(/\-/g," ")}return""},_getPublishedTime:function(e){return e?this._formatTimestamp(new Date(e)):""},_formatItemForTemplate:function(t,i){var s=t["recs-contenttype"]||null,a=t.tag||"default",o=this.options.relativeLinks===!0?t.url.replace(this.urlRegExp,""):t.url;t.url.indexOf("/videos/")>-1&&(s="video");var r={headline:t.title,url:o,urlWithParams:this._formatUrlWithParams(o,a),clickPixelUrl:t.click_url.replace(/click/,"click/image"),imgSrc:n.getNested(t,"dominantthumbnail")||null,thumbSrc:n.getNested(t,"recs-image")||null,imgAlt:t.title,section:(t["recs-category"]?t["recs-category"].split("/")[0]:"home").toLowerCase(),sectionDisplay:t["recs-category"]?this._getDisplaySection(t["recs-category"]):"",time:t["recs-publishtime"]?this._formatTimestamp(t["recs-publishtime"]):"",timestamp:t["recs-publishtime"],type:"galleries"==s?"gallery":s,isMedia:"galleries"==s||"video"==s,tag:a,position:i};return e.extend(r,this.additionalFormatItemForTemplate(t,r))},additionalFormatItemForTemplate:function(){return{}},_formatUrlWithParams:function(e,t){return e+"#cx_tag="+t+"&cx_ab_test_id="+s.getActivePageInfo().ab_test_id+"&cx_ab_test_variant="+s.getActivePageInfo().ab_test_variant+"&cxrecs_s"},_formatTimestamp:function(e){var t=(new Date).getDate(),i=new Date(e),s=Math.floor((new Date-i)/1e3),n=Math.floor(s/60),a="";if(n>10){var o=i.getHours(),r=i.getMinutes(),l=o>=12?"p.m.":"a.m.",h=i.getDate(),d=i.getMonth();return o%=12,o=o?o:12,r=10>r?"0"+r:r,h!=t&&(a=this.monthsAbbreviated[d]+" "+h+", "),a+=o+":"+r+" "+l}return n>1&&10>=n?n+" min ago":Math.floor(s)+" sec ago"},_onClickCxenseItem:function(t){this.$el.append(this.pixelTemplate({pixelUrl:e(t.currentTarget).data("cx-pixel-url"),cacheBuster:Math.round((new Date).getTime()/1e3)}))}});return o}),define("modules/cxense-recommends/cxense-headline-grid",["jquery","underscore","state","utils","modules/cxense-recommends/cxense-base"],function(e,t,i,s,n){var a=n.extend({initialize:function(t){t=e.extend({recsTimeout:3e3,cxenseContextObj:{neighbors:this.getNeighbors()}},t),this.mmGridImgBase="http://www.gannett-cdn.com/-mm-/3082afecf818b4f454af81a4d259036225fa8c0c/c=864-0-4320-3456&r=x233&c=210x230/local/-/",this.mmListImgBase="http://www.gannett-cdn.com/-mm-/3fcdc686a1f05df1f66a590aff64da282580e7f1/c=0-432-4608-3024&r=x83&c=140x80/local/-/",this.mmRx=new RegExp(".*local\\/-\\/"),n.prototype.initialize.call(this,t)},renderRecs:function(e,t){var i=this.$(".headline-page.active");i.children("li").slice(0,t).remove(),i.prepend(e)},additionalFormatItemForTemplate:function(t,i){var n="first";return i.position%2===0&&(n="middle"),i.position%3===0&&(n="last"),e.extend({columnPos:n,description:s.smartTruncate(t.description,250)||null},this.getImages(t))},getImages:function(e){var t=null,i=!1,n=null,a=!1,o=s.getNested(e,"dominantimage")||"",r=s.getNested(e,"dominantthumbnail")||null;return-1!==o.indexOf("-mm-")?(o=o.replace(this.mmRx,""),t=this.mmGridImgBase+o,n=this.mmListImgBase+o,i=a=!0):r&&(t=n=r),{gridImgSrc:t,gridImgUsesMin:i,listImgSrc:n,listImgUsesMin:a}},getNeighbors:function(){var e=[],s=this.$(".headline-page.active").children("li");return t.each(i.getActivePageInfo().asset_collection,t.bind(function(t){("headline-grid"===t.module&&t.position>=this.options.cxenseNumRecs&&t.position<s.length||"hero"===t.module)&&e.push(t.assetId)},this)),e}});return a}),define("modules/fronts/headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle","modules/cxense-recommends/cxense-headline-grid"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=o.extend({events:{"click .button-add-content":"showMore"},initialize:function(e){this.$button=this.$(".button-add-content"),o.prototype.initialize.call(this,e),t.bindAll(this,"transitionMore","toggleGridListView");var i=this.$(".headline-toggler");i.length&&(this.subviews.gridListViewToggler=new r({el:i,onSelect:this.toggleGridListView})),e.cxenseWidgetId&&(this.subviews.cxense=new l({el:this.$el,cxenseNumRecs:e.cxenseNumRecs,cxenseWidgetId:e.cxenseWidgetId,getRecsOnInit:!1})),this.$(".headline-page.active").hasClass("placeholder")&&this.render()},render:function(){var i;i=this.subviews.cxense?this.subviews.cxense._getRecs():e.Deferred().resolve(),i.always(t.bind(function(){this.load()},this))},getMoreHeadlines:function(e,i){s.fetchHtml(window.location.pathname+e+"/").done(t.bind(function(e){var t=e.find(".headline-page").removeClass("active").addClass("inactive"),s=e.find(".button-add-content");this.$(".headline-collection").append(t),s.length>0?this.$(".headlines-show-more").empty().append(s):this.$button.addClass("inactive"),i(t)},this)).fail(t.bind(function(){var e=this.$button.attr("data-default");this.$button.removeClass("loading").addClass("inactive").text(e)},this))},showMore:function(t){if(e(t.target).hasClass("inactive"))return!1;if(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.$el.hasClass("stagfront-primary")&&!this.$(".front-headlines-header").hasClass("staff")){var i=parseInt(e(t.target).data("next"),10);this.getMoreHeadlines(i,this.transitionMore)}else{var s=this.$(".headline-page.active:last").next(),o=s.attr("data-itemnum"),r=s.attr("data-items-per-page"),l=Math.round(o/r);this.load(),n.trigger("uotrack",a.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(s)}t.preventDefault()},toggleGridListView:function(e){var t=e.hasClass("grid-big")?"grid-big":"list-big",i=this.$(".headline-collection");"list-big"===t?(i.addClass("listview"),n.trigger("uotrack","listview")):(i.removeClass("listview"),n.trigger("uotrack","gridview")),this.load()},load:function(){var e=this.$(".headline-page.active"),t=this.$(".headline-collection").hasClass("listview");a.lazyLoadImage(e.find("img"),"data-"+(t?"list":"grid")+"-src",!1),e.removeClass("placeholder")},transitionMore:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive"),this.load(),this.$button.removeClass("loading").text(this.$button.attr("data-default")),n.trigger("showmore:headlines")}});return h}),define("partner/pushdown-ad-article",["jquery","partner/pushdown-ad"],function(e,t){"use strict";var i=t.extend({initialize:function(i){i=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{},cardInfo:{}},i),t.prototype.initialize.call(this,i),this._createAd(["pushdown"],["pushdown"],i.cardInfo)}});return i}),define("apps/topics",["jquery","underscore","state","site-manager","base-app","sharedAdPosition","directAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video","partner/gravity-ad-article","partner/pushdown-ad-article","modules/partner/poster-ad-asset2"],function(e,t,i,s,n,a,o,r,l,h,d,c,u){"use strict";var p=n.extend({initialize:function(e){this.pubSub={"topicgallery:open":this.gravityPause,"topicgallery:close":this.gravityResume,"topicarticles:fetched":this._handleFetchedArticles},n.prototype.initialize.call(this,e)},afterPageReveal:function(){this.$el.hasClass("topics-page-automated")?this._initNewTopicPage():this._initLegacyTopicPage(),i.stopRefreshTimer()},_initNewTopicPage:function(){this.$pageWrap=this.$(".tpa-page-wrap"),this.setupAds()},_initLegacyTopicPage:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new h({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new l({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=s.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new a({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new r)},activateLoader:function(){window.scrollTo(0,0),this.$el.html('<section class="tpa-page-loader"></section>')},deactivateLoader:function(){window.scrollTo(0,0),this.$el.html("")},setupAds:function(){this.subviews.pushdownAd=new c({defaultPosition:!0,el:this.$(".partner-pushdown-ad"),cards:this.$pageWrap,cardInfo:{adClass:"size-m",adTargeting:"medium",cardWidth:1080}}),this.subviews.gravityAd=new d({el:this.$(".partner-gravity-ad"),contentSection:this.$pageWrap}),this.subviews.ad=new o({el:this.$(".tpa-ad-sidebar-wrapper"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"sidebar"}),this.subviews.posterAd=new u({el:this.$(".tpa-scroller-ad-sidebar-wrapper"),articleSelector:".tpa-content-wrap",rightRailSelector:".tpa-sidebar-wrap",disableRefresh:!1,minTimeForAd:15e3})},gravityPause:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.subviews.adPosition.pauseAd(),this.subviews.gravityAd.$el.css("display","none"))},gravityResume:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.$el.css("display","block"),this.subviews.gravityAd.subviews.adPosition.resumeAd())},_handleFetchedArticles:function(){this.subviews.posterAd&&this.subviews.posterAd._setArticleDimensions()}});return p}),define("form/base-form-element",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({getFormElement:function(){return this.$el},getUIElement:function(){return this.$el},getType:function(){return""},reset:function(){},isRequired:function(){var e=this.getFormElement().attr("required");return"required"===e||e}});return s}),define("form/input-field",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{focus:"onInputFocus",blur:"onInputBlur",keyup:"onKeyPress"},initialize:function(t){t=e.extend({onValueChange:null},t),i.prototype.initialize.call(this,t),this.isInputField="input"===(this.$el.prop("tagName")||"").toLowerCase()?!0:!1,this.hasPlaceHolderNativeSupport=Modernizr.input.placeholder?!0:!1,this.placeholder=this.$el.attr("placeholder"),this.setup()},setup:function(){this.placeholder&&this.showPlaceHolder(),this.$el.data("clearable")&&this.isInputField&&this._setupClearButton()},showPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.setInputValue(this.placeholder),this.$el.addClass("ui-text-input-placeholder"))},clearPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.clearInputValue(),this.$el.removeClass("ui-text-input-placeholder"))},getInputValue:function(){var e=this.$el.val();return e===this.placeholder&&(e=""),e},clearInputValue:function(){var e=this.getInputValue();this.$el.val(""),e&&this._triggerValueChange()},setInputValue:function(e){this.$el.val(e),this._triggerValueChange()},_setupClearButton:function(){this.clearButton=e('<div class="ui-text-input-clear-btn" style="display:none"></div>'),this.$el.parent().append(this.clearButton),this.clearButton.on("mousedown."+this.cid,t.bind(function(e){this.onClearButtonClick(e)},this))},onInputFocus:function(){var e=this.getInputValue();e?this.clearButton&&this.clearButton.show():this.clearPlaceHolder()},onInputBlur:function(){this.getInputValue()||this.reset(),this.clearButton&&this.clearButton.hide()},_triggerValueChange:function(){var e=this.getInputValue();this.clearButton&&(e?this.clearButton.show():this.clearButton.hide()),this.options.onValueChange&&this.options.onValueChange(e)},resetInput:function(){this.reset()},reset:function(){this.clearInputValue(),this.placeholder&&this.showPlaceHolder(),this.clearButton&&this.clearButton.hide()},onKeyPress:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){this._triggerValueChange()},this),1)},getType:function(){return"input"},onClearButtonClick:function(e){e.preventDefault(),this.clearInputValue(),this.clearButton.hide(),this.$el.focus()},destroy:function(e){this.clearButton&&(this.clearButton.off("."+this.cid),this.clearButton.remove()),i.prototype.destroy.call(this,e)}});return s}),define("form/autocomplete",["jquery","underscore","form/base-form-element","state","form/input-field"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"keydown .ui-text-input":"onKeyDown","paste .ui-text-input":"updateResults",focusout:"onInputBlur","mousedown .ui-autocomplete-result-item":"onMouseDownResultItem","mouseenter .ui-autocomplete-result-item":"onResultMouseEnterLeave","mousedown .ui-text-input-clear-btn":"onClearButtonClick"},initialize:function(s){s=e.extend({url:this.$el.data("autocomplete-url"),ajaxOptions:null,ajaxQueryKey:"query",resultDisplayTemplate:null,resultValueTemplate:null,onError:null,onSelect:null,maxResults:4,onShowResults:null,onParseResults:null,onValueChange:null},s),this.inputField=this.$el,this.setElement(this.$el.parent(),!1),this.autoCompleteResultsContainer=e('<ul class="ui-autocomplete-result-container"></ul>'),this.autoCompleteContent=e('<div class="ui-autocomplete-content"></div>'),this.autoCompleteContent.append(this.autoCompleteResultsContainer),this.$el.append(this.autoCompleteContent),t.bindAll(this,"updateResults","showResult","clearResults"),i.prototype.initialize.call(this,s),this.subviews.inputField=new n({el:this.inputField,onValueChange:this.options.onValueChange})},updateAjaxOptions:function(t){e.extend(!0,this.options.ajaxOptions,t)},updateResults:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){var e=this.inputField.val();this.fetcher&&this.fetcher.abort(),e.length?this.fetcher=this._fetchResults(e):this.clearResults()},this),1)},onResultMouseEnterLeave:function(t){var i=e(t.target);i.hasClass("hover")||(this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item").removeClass("hover"),i.addClass("hover"))},onInputBlur:function(){this.clearResults(),this.fetcher&&this.fetcher.abort()},onMouseDownResultItem:function(t){3!==t.which&&this._processSelectedItem(e(t.currentTarget))},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which,i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item"),s=i.filter(".ui-autocomplete-result-hover");9!==t&&(38===t||40===t?(e.preventDefault(),i.length&&this.onResultItemUpDownArrowKeyPress(t,s)):13===t?s.length?(e.preventDefault(),this._processSelectedItem(s)):this.clearResults():32===t&&s.length?this._processSelectedItem(s):this.updateResults())},onResultItemUpDownArrowKeyPress:function(e,t){var i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item");i.removeClass("ui-autocomplete-result-hover"),38===e?t.length&&this.inputField.val()!==this.currentInputFieldValue?t.prev().length?this.hoverResultItem(t.prev()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.last()):t.length?t&&t.next().length?this.hoverResultItem(t.next()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.first())},hoverResultItem:function(e){e.addClass("ui-autocomplete-result-hover"),this.inputField.val(e.text())},getUIElement:function(){return this.inputField},getFormElement:function(){return this.inputField},reset:function(){this.clearResults(),this.subviews.inputField.reset()},resetInput:function(){this.reset()},showResult:function(t,i,s){var n=e('<li class="ui-autocomplete-result-item"></li>');n.text(t),n.data("value",i),s&&n.data("result",s),this.autoCompleteResultsContainer.append(n)},clearResults:function(){this.autoCompleteResultsContainer.empty()},onClearButtonClick:function(){this.clearResults()},_processSelectedItem:function(e){var t=e.data("value")||e.text(),i=e.data("result");this.inputField.val(t),this.clearResults(),this.options.onSelect&&this.options.onSelect(t,i)},_getFetchAjaxOptions:function(i){var s=e.extend(!0,{},this.options.ajaxOptions),n={},a=s.url||this.options.url;return-1!==a.indexOf("<%=")?s.url=t.template(a,{query:i}):(n[this.options.ajaxQueryKey]=i,s=e.extend(!0,{url:a,data:n},s)),s},_fetchResults:function(i){var n=this._getFetchAjaxOptions(i);return s.fetchData(null,n).done(t.bind(function(t){var i=t;this.options.onParseResults&&(i=this.options.onParseResults(t)),this.autoCompleteResultsContainer.empty(),e.isArray(i)&&i.length>0&&(i=i.slice(0,this.options.maxResults),this._parseResults(i),this.options.onShowResults&&this.options.onShowResults(i),this.currentInputFieldValue=this.inputField.val())},this)).fail(t.bind(function(e){this.options.onError&&this.options.onError(e)},this))},_parseResults:function(i){e.map(i,t.bind(function(e){var i,s;this.options.resultDisplayTemplate&&(s=t.template(this.options.resultDisplayTemplate,e)),this.options.resultValueTemplate&&(i=t.template(this.options.resultValueTemplate,e)),this.showResult(s,i,e)},this))},getType:function(){return"autocomplete"},destroy:function(e){this.autoCompleteContent.remove(),i.prototype.destroy.call(this,e)}});return a}),define("apps/election-2012",["jquery","underscore","backbone","utils","pubsub","baseview","form/autocomplete"],function(e,t,i,s,n,a,o){var r=a.extend({el:"#elections-2012",initialize:function(i){this.$win=s.get("win"),e("#election-results-fullscreen").get(0)&&(this.onResize(),this.$win.on("resize."+this.cid,this.onResize)),t.bindAll(this,"onStateSelect"),a.prototype.initialize.call(this,i),this.$(".election-state-input").each(t.bind(function(e,t){this.subviews["stateAutocomplete"+e]=new o({el:t,resultDisplayTemplate:"<%= state %>",resultValueTemplate:"<%= state %>",onSelect:this.onStateSelect,selectedInputValue:"state"})},this))},onStateSelect:function(e,t){var i=this.$("#election-state-nav-form");i.attr("action",t.link),i.submit()},onResize:function(){var t=this.$win.height()>620?this.$win.height():620;e("#election-results-fullscreen").height(t)},destroy:function(e){this.$win.off("."+this.cid),a.prototype.destroy.call(this,e)}});return r}),define("apps/member-guide",["jquery","underscore","state","base-app","site-manager","pubsub"],function(e,t,i,s,n,a){var o=s.extend({afterPageReveal:function(){e("body").addClass("mga-body"),a.on("user:login",this.killLoginBanner,this)},killLoginBanner:function(){e(".mga-login-wrap").remove()},beforeAppRemove:function(){e("body").removeClass("mga-body"),a.off("user:login",this.killLoginBanner,this)}});return o}),define("modules/stories/expand-faq",["jquery","baseview"],function(e,t){var i=t.extend({events:{"click a":"expandFaq"},expandFaq:function(t){var i=e(t.target),s=i.next();s.is(":visible")?(i.parent().removeClass("active"),s.slideUp(200)):(i.parent().addClass("active"),s.slideDown(200))}});return i}),define("modules/fronts/snapshots",["jquery","underscore","baseview","state","cookie"],function(e,t,i,s){var n=i.extend({el:".front-galleries-module",events:{"click a.vote":"revealQuickQuestion","click .snap-vote a.cancel":"revealSnapshotTeaser","click a.snap-vote-btn":"registerVote"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.render()},render:function(){if(e("#snapshots").length<=0){var t=this.$(".js-fg-nav-list"),i=t.find("li:first-child"),s=t.data("item-class")||"",n=t.data("link-class")||"";i.after('<li data-id="gallery" id="snapshots" class="front-gallery-item news-theme-border-hover '+s+'" data-href="/services/snapshots/gallery/" data-theme="news-theme-border"><a class="front-gallery-link '+n+'" href="/services/snapshots/gallery/" data-href="/services/snapshots/gallery/">Snapshots</a></li>')}},revealQuickQuestion:function(t){var i=e(t.currentTarget).closest(".snapshot-card");e(".snapshot",i).hide(),e(".snap-vote",i).not(".results").fadeIn()},revealSnapshotTeaser:function(t){var i=e(t.currentTarget).closest(".snapshot-card");e(".snap-vote",i).hide(),e(".snapshot",i).fadeIn()},revealResults:function(t,i){var s=e(t.currentTarget).closest(".snapshot-card");s.find(".snap-vote.results").length?s.find(".snap-vote.results").replaceWith(i):s.append(i),e(".snap-vote",s).hide(),e(".snap-vote.results",s).fadeIn()},registerVote:function(i){var n,a=(e(i.currentTarget).closest(".snapshot-card"),e(i.currentTarget).attr("data-answer-id"));e(i.currentTarget).addClass("loading");var o=this.$(".slide.active[data-qqid]").attr("data-qqid");n=e.cookie(o)?"/services/snapshots/get/"+o+"/":"/services/snapshots/vote/"+a+"/"+o+"/",this.ajax=s.fetchData(n).done(t.bind(function(s){var n=t.pluck(s.quick_question.answers,"votes"),a=t.reduce(n,function(e,t){return e+parseFloat(t)},0),r=s.quick_question.answers.length-1,l=0;t.each(s.quick_question.answers,function(e,t){var i=Math.round(parseFloat(e.votes)/a*100);t===r?i=100-l:l+=i,e.answerPercent=i});var h=e("#snapshot-results"),d=t.template(h.html(),{data:s.quick_question});this.revealResults(i,d),e(i.currentTarget).removeClass("loading"),e.cookie(o,!0)},this))}});return n}),define("modules/sports/sports-video",["jquery","underscore","baseview","modules/global/brightcove-video"],function(e,t,i,s){"use strict";var n=s.extend({events:function(){var e=s.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .videoStillPlay":"swapImageForVideo","click .hero-3up-image-1":"swapImageForVideo","click .stagfront-hero-3up-text-1":"swapImageForVideo"})},initialize:function(e){this.$(".util-bar-primary-modules").addClass("util-bar-primary-modules-topic"),this.$(".util-bar-primary-modules-topic").removeClass("util-bar-primary-modules"),s.prototype.initialize.call(this,e)},swapImageForVideo:function(t){e(this.$(".parent-label.sports")[0]).css("display","none"),s.prototype.swapImageForVideo.call(this,t)},destroy:function(){s.prototype.destroy.call(this,!1)}});return n}),define("ui/generic-paginator",["jquery","underscore","backbone","baseview"],function(e,t,i,s){var n=s.extend({events:{"click .paginator-indicator-target":"onPaginatorClick"},initialize:function(t){this.$pageElements=this.$(".paginator-indicator-target"),t=e.extend({onBeforePaginator:null,onGoTo:null},t),s.prototype.initialize.call(this,t)},onPaginatorClick:function(t){t&&t.preventDefault();var i=e(t.currentTarget).index();if(this.options.onBeforePaginator){var s=this.options.onBeforePaginator(i,t);if(!s)return!1}this.goToPage(i)},goToPage:function(e){if(0!==this.$pageElements.length){0>e?e=0:e>=this.$pageElements.length&&(e=this.$pageElements.length-1);var t=this.$pageElements.eq(e);this.$(".paginator-indicator-bullet").removeClass("active"),t.find(".paginator-indicator-bullet").addClass("active"),this.options.onGoTo&&this.options.onGoTo(e)}},goToNextPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i<this.$pageElements.length-1?this.goToPage(i+1):e&&this.goToPage(0)},goToPrevPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i>0?this.goToPage(i-1):e&&this.goToPage(this.$pageElements.length-1)}});return n}),define("modules/fronts/featured-content",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".fcpm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return a}),define("third-party-apis/facebook/facebook",["jquery","underscore","third-party-apis/base-third-party-api"],function(e,t,i){"use strict";var s=i.extend({initialize:function(){this._config=this.getApiSiteConfig("FACEBOOK"),this._config&&(this._appid=this._config.APPID,this._channelUrl=window.location.protocol+"//"+window.location.host+window.site_static_url+"html/channel.html"),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._facebookPromise||(this._facebookPromise=e.Deferred(t.bind(function(i){return this._config.ENABLED?void e.ajax("//connect.facebook.net/en_US/sdk.js",{cache:!0,data:{},dataType:"script"}).done(t.bind(function(){FB?(this._initializeFacebook(),i.resolve(FB)):i.reject()},this)).fail(function(){i.reject()}):void i.reject()},this)).promise()),this._facebookPromise},_initializeFacebook:function(){FB.init({appId:this._appid,version:"v2.3",channelUrl:this._channelUrl,status:!0,cookie:!0,xfbml:!1})},getUserPermissions:function(){return this._config.PERMISSIONS}});return new s}),define("modules/stories/share-facebook",["jquery","underscore","backbone","baseview","pubsub","utils","third-party-apis/facebook/facebook"],function(e,t,i,s,n,a,o){var r=s.extend({events:{"click .util-bar-share-submit-btn-facebook":"onClickPostBtn","click .util-bar-success-link-facebook":"onClickPostLink"},initialize:function(e){t.bindAll(this,"fbShareCallback"),s.prototype.initialize.call(this,e)},onClickPostBtn:function(){this.$loading=this.$$(".util-bar-share-loading-facebook"),this.$status=this.$$(".util-bar-share-status-text-facebook"),this.$message=this.$$(".util-bar-share-message-facebook"),this.$successPane=this.$$(".util-bar-flyout-pane-success-facebook"),this.$successLink=this.$$(".util-bar-success-link-facebook"),this.$successDescription=this.$$(".util-bar-success-description-facebook"),this.$flyoutSection=this.$$(".util-bar-flyout-section-facebook"),this.fbShare()},fbShare:function(){this.$loading.show();var e={method:"feed",link:this.$message.data("link"),picture:this.$message.data("image"),name:this.$message.data("title")};o.loadScript().done(t.bind(function(){FB.ui(e,this.fbShareCallback)},this))},fbShareCallback:function(t){if(t)if(t.error)this.$loading.hide(),this.$status.text("An error occurred, try again.");else{if(this.$successLink.remove(),t.post_id){var i=t.post_id.split("_");if(i.length>=2){var s="https://www.facebook.com/"+i[0]+"/posts/"+i[1],a=e('<a class="util-bar-success-link-facebook" href="'+s+'">View the post.</a>');this.$successDescription.append(a)}}this.$loading.hide(),this.$flyoutSection.hide(),this.$successPane.show(),n.trigger("uotrack","UtilityBarShareFacebook")}else this.$loading.hide()},onClickPostLink:function(t){t.preventDefault();var i=e(t.target).attr("href");a.openPopup(i,1e3,600)}});return r}),define("ui/loader",["jquery","underscore","baseview","pubsub","utils"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(t){this.options=e.extend({msg:""},t),this.win=n.get("win"),this.body=n.get("body"),this.el=e(this.options.el),this.msg=this.options.msg,this.render()},render:function(){var t=e("<div>").addClass("loading-icon");this.$loader=e("<div>").addClass("ui-loader"),this.$target=this.$el,this.$target.append(this.$loader.append(t).append(e("<span>").html(this.msg))),this.$el=this.$loader},destroy:function(){this.hide(),i.prototype.destroy.apply(this,arguments)},show:function(){this.$loader.addClass("active")},hide:function(){this.$loader.removeClass("active")}});return a}),define("modules/fronts/front-galleries",["jquery","underscore","backbone","pubsub","baseview","utils","modules/carousel/carousel","ui/loader","state"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=n.extend({empty:!0,events:{"click .js-fg-link":"select"},initialize:function(){this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".js-fgs-item"),this.overrideTaboola=this.$(".js-fg-nav-list").data("taboolaOverride")?!0:!1,this.currentGallery=this.$(".fgpfm-gallery.front-gallery.selected").attr("id");var i=[],s=this.currentGallery;if(this.$(".fgpfm-nav-link").each(function(){var t=e(this).data("id");t&&s!=t&&i.push(t)}),this.endslateGalleries=i,t.bindAll(this,"switchGallery"),n.prototype.initialize.call(this,{}),this.subviews.loader=new r({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var a=this.$(".front-gallery.selected");this._initializeCarousel(a,a.index(),this.$navItems.filter(".selected").find("a").attr("href")),this.empty=!1}else{var o=this.$navItems.first().find("a").attr("href");"undefined"!=typeof o&&o.length>1&&this.fetchData(o,0,this.switchGallery)}},_initializeCarousel:function(e,t,i){var s=new o({ads:!0,linkPath:i,el:e.find(".galleries"),fullScreen:!0,endslateOptions:{overrideTaboola:this.overrideTaboola,endslateGalleries:this.endslateGalleries,currentGallery:this.currentGallery}});return this.subviews["gallery"+t]=s,s},onCardWidthChange:function(e){this.currentCardInfo&&this.currentCardInfo.primaryFlexWidth===e.primaryFlexWidth||this.triggerEvent("viewportResize"),this.currentCardInfo=e},fetchData:function(e,t,i){var s=this,n=!0,a=this.$el.data("layout-type"),o=this.$(".front-gallery.selected");o.length&&(o.css({opacity:1}),this.animate(o,"opacity",0,200).done(function(){n&&s.loading(!0)})),a&&(e="/"+a+e),l.fetchHtml("/front-gallery"+e).done(function(s){i(s,t,e)}).always(function(){n=!1,s.loading(!1)})},loading:function(e){e?this.subviews.loader.show():this.subviews.loader.hide()},select:function(t){var i=e(t.currentTarget),s=i.attr("href"),n=i.parent(),a=n.index(),o=this.$galleries.eq(a);-1===s.indexOf("://")&&(o.find(".galleries").length>0?this.switchGallery(null,a,s):this.fetchData(s,a,this.switchGallery),t&&t.preventDefault());var r=this.$navItems.filter(".selected"),l=r.attr("data-theme")||"",h=n.attr("data-theme")||"";r.removeClass(l+" selected"),n.addClass(h+" selected")},switchGallery:function(e,t,i){var s=this.$galleries.eq(t);if(this.$galleries.removeClass("selected"),s.addClass("selected"),e&&s.html(e),this.subviews["gallery"+t])this.trackGalleryChange(this.subviews["gallery"+t]);else{var n=this._initializeCarousel(s,t,i);this.empty||this.trackGalleryChange(n)}s.css({opacity:0}),this.animate(s,"opacity",1,200)},trackGalleryChange:function(e){e._trackSlideChange()}});return h}),define("modules/sports/sports-gallery-sponsorship-skin",["jquery","underscore","baseview","pubsub"],function(e,t,i,s){"use strict";var n=i.extend({initialize:function(n){n=e.extend({imageSkinTop:"",imageSkinRight:"",imageSkinRightHeight:0,imageSkinBottom:"",imageSkinLeft:"",imageSkinLeftHeight:0,htmlBackground:"",clickThru:""},n),this.$background=e(""),t.bindAll(this,"showSkin","hideSkin","setupBackground"),i.prototype.initialize.call(this,n),s.on("carousel:sidebarOpened",this.showSkin),s.on("carousel:sidebarClosed",this.hideSkin)},destroy:function(e){this.$background&&(this.$background.remove(),this.$background=null),s.off("carousel:sidebarOpened",this.showSkin),s.off("carousel:sidebarClosed",this.hideSkin),i.prototype.destroy.call(this,e)},hideSkin:function(){this.$background.hide()},render:function(){this.setupBackground(),this.options.startVisible()&&this.showSkin()},showSkin:function(){this.options.sidebarAds()&&this.$background.parent().hasClass("active")&&this.$background.show()},setupBackground:function(){if("Yes"===this.options.hasSkin||!this.options.sponsorshipHtml){this.$background=e(t.template(this.options.htmlBackground,this.options));var i=e(this.options.galleryClass).height();if(""===this.options.imageSkinTop&&this.$background.remove(".sp-galleries-skin-top"),""===this.options.imageSkinRight)this.$background.remove(".sp-galleries-skin-right");else{var s=(i-this.options.imageSkinRightHeight)/2;this.$background.children(".sp-galleries-skin-right").css("top",s)
}if(""===this.options.imageSkinBottom&&this.$background.remove(".sp-galleries-skin-bottom"),""===this.options.imageSkinLeft)this.$background.remove(".sp-galleries-skin-left");else{var n=(i-this.options.imageSkinLeftHeight)/2;this.$background.children(".sp-galleries-skin-left").css("top",n)}this.hideSkin(),this.$el.after(this.$background)}}});return n}),define("modules/sports/sports-carousel-gallery",["jquery","underscore","backbone","baseview","pubsub","utils","modules/global/taboola","modules/carousel/gallery","directAdPosition","modules/sports/sports-gallery-sponsorship-skin","adLogger"],function(e,t,i,s,n,a,o,r,l,h){var d=r.extend({initialize:function(i){t.bindAll(this,"onAdReady","_initializeAds","startVisible","teardownSponsorshipAd"),i=e.extend({galleryClass:".sports-front-galleries-primary"},i),r.prototype.initialize.call(this,i)},_initializeAds:function(){if(this.options.ads){this.galleryData=this.$el.data()||{};var e=this.getAdTargeting();if(this.teardownSponsorshipAd(),this.$sponsorshipAd.length){var t=this._getSlideIn(this.index).data("qqid");e.snapshotid=t,this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/"+this.$el.data("cst"),adSizes:["sponsor_logo"],targeting:e,onAdReady:this.onAdReady})}}},onAdReady:function(t,i){"sponsorshiplogo"===i&&"Yes"===t.hasSkin&&(this.subviews.sponsorshipSkin=new h(e.extend({el:this.$sponsorshipAd,startVisible:this.startVisible,sidebarAds:this.options.sidebarAds,galleryClass:this.options.galleryClass},t)),this.subviews.sponsorshipSkin.render())},startVisible:function(){return this.options.isSideBarOpen()&&this.options.sidebarAds()?!0:!1},teardownSponsorshipAd:function(){this.$sponsorshipAd=this.$el.closest(this.options.galleryClass).find(".sp-galleries-sponsored-by"),this.$sponsorshipSkin=this.$el.closest(this.options.galleryClass).find(".sp-galleries-skin"),this.$sponsorshipAd.children().empty(),this.$sponsorshipSkin.remove()},refreshSponsorshipAd:function(){},refreshSportsSponsorshipAd:function(){this.teardownSponsorshipAd();var e=this.getAdTargeting();this.subviews.sponsorshipAd.setTargeting(e),this.subviews.sponsorshipAd.refreshPosition()}});return d}),define("modules/sports/sports-front-carousel",["jquery","underscore","utils","pubsub","modules/carousel/carousel","modules/sports/sports-carousel-gallery"],function(e,t,i,s,n,a){"use strict";var o=n.extend({events:function(){var e=n.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{mouseenter:"mouseEnter",click:"mouseClick"})},initialize:function(a){this.$primary=e(".sports-front-galleries-primary"),this.$module=e(".sports-front-galleries-module"),this.$closer=e(".gallery-sidebar-close"),this.$sidebar=e(".gallery-sidebar-ad"),this.$counter=e(".gallery-count"),this.$cardfilm=e(".card-film"),this.$cardcolor=e(".card-suspender-color"),this.$suspender=e(".sports-front-galleries-suspender"),this.$caption=e(".gallery-sidebar-ad .caption").html(),t.bindAll(this,"mouseScroll","mouseClick","mouseEnter","isSideBarOpen","sidebarCaption"),n.prototype.initialize.call(this,a),this.sidebarCaption(),s.on("carousel:switchSlide",t.bind(function(){this.captionPoll=setInterval(this.sidebarCaption,200)},this)),s.on("gallery:clickSidebar",t.bind(function(){this.showSidebar()},this)),this.$win=i.get("win"),this.$win.on("scroll."+this.cid,this.mouseScroll),this.$win.on("click."+this.cid,this.mouseClick)},_initializeGallery:function(e,t,i,s){this.subviews.gallery=new a({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:e,slideTransition:t,carousel:this,isSideBarOpen:this.isSideBarOpen,sidebarAds:this.options.sidebarAds})},sidebarCaption:function(){var t=e(".gallery-sidebar-ad .caption"),i=e(".selected .active .gallery-viewport-caption").html();i!=this.$caption&&(this.$caption=i,clearInterval(this.captionPoll)),i?t.html(i):t.empty()},openSidebar:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=parseInt(this.$sidebar.outerWidth()+1,10),n=null;this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),n=this.animate(this.$sidebar,"right",-i+"px",250,"ease-in-out").promise().done(t.bind(function(){this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),s.trigger("carousel:sidebarOpened")},this)))},showSidebar:function(){var e=parseInt(this.$sidebar.outerWidth(),10);this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),this.$primary.addClass("active"),this.$sidebar.css({right:-e+"px",transition:""}),this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),this.$closer.addClass("active"))},isSideBarOpen:function(){return!this.$cardfilm.hasClass("inactive")},mouseEnter:function(){},mouseScroll:function(){if(this.$sidebar.hasClass("active")){var t=this.$sidebar.outerHeight(),i=this.$module.position().top,s=e(window).scrollTop(),n=e(window).outerHeight();(s>i+t+90||i>s+n-130)&&this.$closer.click()}},mouseClick:function(e){if(this.$sidebar.hasClass("active")){s.trigger("carousel:cardfilmActive");var t=this.$module.offset().top,i=this.$module.offset().left,n=this.$module.outerWidth()+this.$sidebar.outerWidth(),a=this.$sidebar.outerHeight();e.pageX<i||e.pageX>i+n||e.pageY<t||e.pageY>t+a?this.$closer.click():this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color")))}},destroy:function(e){clearInterval(this.captionPoll),this.$win.off("."+this.cid),e&&this.$el.parent().remove(),s.off("carousel:switchSlide"),s.off("gallery:clickSidebar"),n.prototype.destroy.call(this,!1)}});return o}),define("modules/sports/sports-front-galleries",["jquery","underscore","baseview","pubsub","modules/stories/share-facebook","modules/fronts/front-galleries","modules/sports/sports-front-carousel","ui/loader","directAdPosition"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=a.extend({events:function(){var e=a.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn","click .gallery-sidebar-close":"closeSidebar","click .fullscreen":"launchFullscreen","click .sidebar-gallery-btn, .thumb-link":"clickPhoto"})},initialize:function(){if(this.$primary=e(".sports-front-galleries-primary"),this.$module=e(".sports-front-galleries-module"),this.$closer=this.$(".gallery-sidebar-close"),this.$sidebar=this.$(".gallery-sidebar-ad"),this.$counter=e(".gallery-count"),this.$toolbox=this.$(".gallery-sidebar-toolbox"),this.$cardfilm=e(".card-film"),this.$cardcolor=e(".card-suspender-color"),this.$suspender=e(".sports-front-galleries-suspender"),this.$(".front-gallery.snapshot-placeholder").remove(),this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".js-fgs-item"),this.overrideTaboola=this.$(".js-fg-nav-list").data("taboolaOverride")?!0:!1,this.currentGallery=this.$(".fgpfm-gallery.front-gallery.selected").attr("id"),this.$titles=this.$(".gallery-sidebar-title"),this.$partnerSlot=e(".sp-galleries-partner-slot"),this.$sidebarBtn=this.$(".sidebar-gallery-btn"),t.bindAll(this,"switchGallery","setupAd","refreshAd","sidebarAds","resetGallery","clickPhoto"),i.prototype.initialize.call(this,{}),s.on("carousel:switchSlide",t.bind(function(){this.refreshAd()},this)),s.on("gallery:hideSidebar",t.bind(function(){this.hideSidebar()},this)),this.subviews.loader=new r({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var a=this.$(".front-gallery.selected"),l=this.$(".front-gallery");this.subviews["gallery"+l.index(a)]=new o({ads:!0,linkPath:this.$navItems.filter(".selected").find("a").attr("href"),el:a.find(".galleries"),fullScreen:!0,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds}),this.empty=!1}else{var h=this.$navItems.first().find("a").attr("href");"undefined"!=typeof h&&h.length>1&&this.fetchData(h,0,this.switchGallery)}this.$(".util-bar-flyout-section").hide(),this.subviews.facebook=new n({el:this.$(".util-bar-flyout-share")})},_initializeAds:function(){this.$sponsorshipAd||(this.$sponsorshipAd=e('<div class="partner-placement poster" data-monetization-id="sp-gallery" data-monetization-sizes="mediumrectangle"></div>'),this.$partnerSlot.append(this.$sponsorshipAd))},renderCardInfo:function(e){this.currentCardInfo=e},onCardWidthChange:function(e){this.currentCardInfo=e,this.sidebarAds()?(this.setupAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:cardfilmActive")):(this.teardownAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:sidebarClosed"))},sidebarAds:function(){return this.currentCardInfo?this.currentCardInfo.sidebarAds:!1},switchGallery:function(t,i,s){var n=this.$galleries.eq(i);this.$galleries.removeClass("selected"),n.addClass("selected");var a=this.$toolbox.eq(i);this.$toolbox.length>1&&this.$toolbox.removeClass("selected"),a.addClass("selected"),this.$(".util-bar-flyout-nav-btn").removeClass("active");var r=this.$titles.eq(i);this.$titles.length>1&&this.$titles.removeClass("selected"),r.addClass("selected");var l=this.$(".gallery-sidebar-ad .caption"),h=n.find(".active .gallery-viewport-caption").html();if(this.resetSections(),l.html(h),t){n.html(t);var d='<div class="gallery-count"><div>'+n.find(".thumb-item").length+'</div><div class="line">Photos</div></div>';n.append(d),this.$counter=e(".gallery-count")}if(this.subviews["gallery"+i])this.trackGalleryChange(this.subviews["gallery"+i]),this.subviews["gallery"+i].subviews.gallery&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd(),this.teardownAd(),this.setupAd();else{var c=this.subviews["gallery"+i]=new o({ads:!0,el:n.find(".galleries"),fullScreen:!0,linkPath:s,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds});this.empty||(this.trackGalleryChange(c),this.empty=!1)}n.css({opacity:0}),this.animate(n,"opacity",1,200)},launchFullscreen:function(){e(".front-gallery.selected .fullscreen").click()},setupAd:function(){var e=this.$(".front-gallery").index(this.$(".front-gallery.selected"));if(this.sidebarAds()){this.adSetup=!0,this._initializeAds();var t={};this.subviews["gallery"+e].subviews.gallery&&this.subviews["gallery"+e].subviews.gallery.getAdTargeting&&(t=this.subviews["gallery"+e].subviews.gallery.getAdTargeting());var i=this.$(".front-gallery.selected .galleries").data();this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"poster_gallery_companion/"+i.cst,adSizes:["mediumrectangle"],targeting:t})}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),n=e(t.currentTarget).data("share-method"),a=e(t.currentTarget).data("share-title"),o=e(t.currentTarget).data("share-link"),r="SportsGallery"+n;s.trigger("uotrack",r),n&&this.showSection(i.parent().parent(),n),this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color"))),"facebook"==n&&(this.$(".util-bar-share-message-facebook").data("link",o),this.$(".util-bar-share-message-facebook").data("title",a),this.resetSections(),this.$(".gallery-sidebar-ad .caption").empty(),this.subviews.facebook.onClickPostBtn(t),t.preventDefault())},showSection:function(e,t){this.resetSections(),this.activeSection=t,this.$(".util-bar-flyout-nav-btn-"+t).addClass("active")},resetSections:function(){this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-pane-success").hide()},resetGallery:function(){this.resetSections(),this.$primary.removeClass("active"),this.$closer.removeClass("active"),this.$cardfilm.addClass("inactive"),this.$sidebar.removeClass("active"),this.$module.css("z-index","auto")},closeSidebar:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=(parseInt(this.$sidebar.outerWidth()+1,10),null);this.$sidebar.hasClass("active")&&(s.trigger("carousel:sidebarClosed"),this.$(".util-bar-flyout-nav-btn").removeClass("active"),i=this.animate(this.$sidebar,"right",0,250,"ease-in-out"),i.done(t.bind(function(){this.resetGallery()},this)),this.teardownAd()),this.$sidebarBtn.addClass("active")},hideSidebar:function(){parseInt(this.$sidebar.outerWidth()+1,10);this.$sidebar.hasClass("active")&&(this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$sidebar.css({right:0,transition:""}),this.resetGallery(),this.teardownAd())},refreshAd:function(){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.refreshPosition&&this.subviews.sponsorshipAd.refreshPosition()},teardownAd:function(){this.subviews.sponsorshipAd&&this.adSetup&&(delete this.adSetup,this.$sponsorshipAd.empty(),this.subviews.sponsorshipAd.destroy(),delete this.subviews.sponsorshipAd)},clickPhoto:function(e){if(this.$sidebarBtn.hasClass("active")){e&&(e.preventDefault(),e.stopPropagation());var t=this.$(".front-gallery.selected"),i=this.$(".front-gallery");this.subviews["gallery"+i.index(t)].openSidebar(),this.$closer.addClass("active"),this.$sidebarBtn.removeClass("active"),this.$primary.hasClass("active")||this.$primary.addClass("active"),this.$cardfilm.removeClass("inactive")}},destroy:function(e){s.off("carousel:switchSlide"),s.off("gallery:hideSidebar"),a.prototype.destroy.call(this,e)}});return h}),define("modules/sports/sports-popup-media-view",["jquery","underscore","backbone","pubsub","baseview","modules/sports/sports-front-galleries","modules/global/brightcove-video","state","ui/loader"],function(e,t,i,s,n,a,o,r,l){var h=n.extend({el:"body",events:{"click .video-popup-close":"hideVideo","click .popup-media-video":"showVideo","click .popup-media-gallery":"showGallery","click .gallery-sidebar-close.active":"hideGallery"},initialize:function(i){n.prototype.initialize.call(this,i),this.$cardfilm=this.$(".sports-popup-media-module .popup-film"),this.$title=this.$(".sports-popup-media-module .gallery-sidebar-title"),this.$video=this.$(".sports-popup-media-module .video-wrapper"),this.$gallery=this.$(".sports-popup-media-module .gallery-wrapper"),this.$galleryLinks=this.$(".sports-popup-media-module .gallery-link-wrapper"),this.$galleryCount=0,t.bindAll(this,"prepareMedia","updateShareTools","lightsOn","lightsOut","hideGallery","showGallery","hideVideo","showVideo"),s.on("carousel:sidebarClosed",t.bind(function(){this.hideGallery()},this)),this.pattern="/popup-media-link",this.prepareMedia(),s.on("showmore:headlines",this.prepareMedia),this.subviews.gallery=new a({el:e(".stagfront-content")}),this.subviews.loader=new l({el:this.$video})},prepareMedia:function(){var t=this;this.$(".hero-asset-open").addClass("hero-asset-popup"),this.$(".anchor, .hero-asset-popup a").each(function(){var t=e(this).attr("href");void 0===t&&(t=e(this).data("href")),void 0!==t&&(0===t.indexOf("/picture-gallery/")?e(this).addClass("popup-media-gallery"):0===t.indexOf("/videos/")&&e(this).addClass("popup-media-video"))}),this.$(".popup-media-gallery").each(function(i){if(i>=t.$galleryCount){var s=e(this).attr("href"),n=s.split("/").slice(-2,-1)[0];e(this).data("id",n);var a='<div class="front-gallery-item"><a id="link'+n+'" class="front-gallery-link" href="'+s+'"></a></div>';t.$galleryLinks.append(a);var o='<div id="'+n+'" class="front-gallery"></div>';t.$(".front-gallery").last().after(o)}}),this.$galleryCount=this.$(".front-gallery-item").length,this.$(".gallery-sidebar-close").addClass("active"),this.hideGallery(),this.hideVideo()},lightsOn:function(){this.$cardfilm.hasClass("inactive")||this.$cardfilm.addClass("inactive")},lightsOut:function(t){e(t.currentTarget);t.preventDefault(),this.$cardfilm.removeClass("inactive")},hideGallery:function(){this.lightsOn(),this.$gallery.hide(),s.trigger("gallery:hideSidebar")},showGallery:function(t){this.lightsOut(t);var i=e(t.currentTarget);this.$galleryLinks.find("#link"+i.data("id")).click();var n=i.find("h1, h3 span").html();this.$title.html(n);var a=e(window).outerWidth();a>1080?this.$gallery.css("left",(a-1080)/2):this.$gallery.css("left",(a-720)/2),this.updateShareTools(i.attr("href")),s.trigger("gallery:clickSidebar"),this.$gallery.show()},hideVideo:function(){this.lightsOn(),this.subviews.video&&this.subviews.video.pauseVideo(),this.$video.hide()},showVideo:function(t){var i=this,s=e(t.currentTarget),n=s.attr("href"),a=e(window).outerWidth();this.$video.css("left",(a-this.$video.width())/2);this.$(".popup-media-video").index(s);this.lightsOut(t),this.$video.show(),this.subviews.loader.show(),r.fetchHtml(n).done(function(e){var t=e.find(".asset .video"),s=i.$(".video-wrapper .video-slot");s.html(t),s.html(s.html().replace("usat_shareFunction","default_shareFunction")),i.subviews.video=new o({el:t,autostart:!0}),i.subviews.loader.hide()})},updateShareTools:function(e){var t=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-facebook");t.data("share-link",t.data("share-link").replace(this.pattern,e));var i=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-twitter");i.attr("href",i.attr("href").replace(this.pattern,e));var s=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-googleplus");s.attr("href",s.attr("href").replace(this.pattern,e));var n=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-linkedin");n.attr("href",n.attr("href").replace(this.pattern,e)),this.pattern=e},destroy:function(){s.off("showmore:headlines"),s.off("carousel:sidebarClosed"),n.prototype.destroy.apply(this,arguments)}});return h}),define("partner/asset-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({backgroundTemplate:"<%= sponsorshipHtml %>",logoTemplate:'<div class="sponsor" style="display:table-cell;"><div class="sponsor-logo-box"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>" class="sponsor-logo-img"><span class="sponsor-logo-byline">Sponsored by <br/><%= imageLogoAlt %></span></div></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null},t),i.prototype.initialize.call(this,t)},destroy:function(e){this.$background&&(this.$background.remove(),this.$background=null),this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupBackground(),this.setupLogo()},setupBackground:function(){"Yes"!==this.options.hasSkin&&this.options.sponsorshipHtml||(this.$background=e(t.template(this.backgroundTemplate,this.options)),this.$el.parent().append(this.$background))},setupLogo:function(){var i=this.$(".content-bar-top .title").eq(0);i.length&&(this.$logo=e(t.template(this.logoTemplate,this.options)),i.after(this.$logo))}});return s}),define("modules/partner/poster-ad-asset",["jquery","underscore","baseview","state","sharedAdPosition","partner/asset-sponsorship","utils"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({initialize:function(e){t.bindAll(this,"onAdReady"),o.getNested(window.site_vars,"ADS","GALLERY","REFRESH")&&(this.pubSub={"carousel:refreshAd":this.refreshAdPosition}),i.prototype.initialize.call(this,e);var s=this.$el.data("sizes");s&&(s=s.split(",")),this.subviews.posterad=new n({el:this.$el,adSizes:s||["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"poster",adType:"sponsorship",defaultPosition:!0,onAdReady:this.onAdReady})},refreshAdPosition:function(){this.subviews.posterad.refreshPosition()},onAdReady:function(t,i){this.subviews.posterad.show(),this.subviews.posterad.$("iframe").css("position","relative"),"sponsorship"===i&&(this.subviews.sponsorshipad&&this.subviews.sponsorshipad.destroy(),this.subviews.sponsorshipad=new a(e.extend({el:s.getActiveApp().$(".asset")},t)),this.subviews.sponsorshipad.render())}});return r}),define("modules/ballot/ballot",["jquery","underscore","pubsub","baseview"],function(e,t,i,s){"use strict";var n=s.extend({events:{"click .ballot-submit-answers":"onSubmitBallot","click .ballot-answer":"selectAnswer"},initialize:function(){s.prototype.initialize.call(this),t.bindAll(this,"onSubmitBallot","onCompleteSubmit"),this.$ballotForm=this.$(".ballot-form"),this.hasSubmitted=!1},onSubmitBallot:function(t){return this.answerSelected?(t.preventDefault(),e.ajax({type:"POST",url:this.$ballotForm.attr("action"),data:this.$ballotForm.serializeArray(),timeout:1e3,complete:this.onCompleteSubmit}),this.$el.addClass("ballot-show-results"),this.$(".ballot-ts-results").show(),this.$(".ballot-answer").removeClass("ballot-inactive ballot-selected"),this.hasSubmitted=!0,void i.trigger("uotrack","ballotsubmitted")):void this.setError("Please select an answer before submitting.")},setError:function(e){this.$(".ballot-error").show().text(e)},hideError:function(){this.$(".ballot-error").hide()},onCompleteSubmit:function(){},selectAnswer:function(t){if(this.answerSelected=!0,this.hideError(),!this.hasSubmitted&&!this.$ballotForm.data("disabled")){var s=e(t.currentTarget),n=s.data("key"),a=s.find(".ballot-answer-input");a.prop("checked",!0);var o=s.parents("ul").eq(0),r=o.find("li");r.each(function(t,i){var a=e(i);n!=e(i).data("key")?a.addClass("ballot-inactive").removeClass("ballot-selected"):s.removeClass("ballot-inactive").addClass("ballot-selected")}),i.trigger("uotrack","ballotanswerselected"),this.$(".ballot-submit-answers").removeClass("ballot-disabled")}}});return n}),define("modules/ugc/ugc-user",["jquery","underscore","baseview","user-manager","pubsub","managers/cachemanager","state","utils"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({initialize:function(){this.pubSub={"user:statuschange":this._onUserStatusChange},t.bindAll(this,"_getFilemobileUserInfo","_getAppServUserInfo"),this._loginPromise=e.Deferred(),this._onUserStatusChange(null,s.getLoginStatus()),i.prototype.initialize.call(this)},_onUserStatusChange:function(t,i){this._loginState=i,"pending"===this._loginPromise.state()||"loggedIn"!==i&&"loggingIn"!==i||(this._loginPromise=e.Deferred()),"loggedIn"===i?(this._loginState="loggingIn",this._loginPromise.resolve(),r.getNested(window.site_vars,"flags","tempo")||n._events["ugc:user:statuschange"]&&this.getUserInfo()):(("loggedOut"===i||"loginFailed"===i)&&(this._loginPromise.reject(),this.logoutUser()),n.trigger("ugc:user:statuschange",i))},getUserInfo:function(){var i=this._loginState;return"loggingIn"===i||"loggedIn"===i||"loggedIn"===s.getLoginStatus()?this._loginPromise.then(t.bind(function(){return r.getNested(window.site_vars,"ugc","tempo")?r.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","ENABLED")?a.getValue("ugcuserinfo",t.bind(this.getGupUserData,this)):a.getValue("ugcuserinfo",this._getAppServUserInfo):a.getValue("filemobileuserinfo",this._getFilemobileUserInfo)},this)):e.Deferred().reject()},getGupUserData:function(){var i=s.getAccount("firefly");return i?i.getGupUserInfo().then(t.bind(function(e){var i=this.normalizeGupData(e);return i.isAnonymous?this._loginState="needMoreData":this.updateAppservTempoAuthor(i).then(t.bind(function(){this._loginState="loggedIn"},this),t.bind(function(){this._loginState="loginFailed"},this)),i},this)):e.Deferred.reject()},getUserManagerUserData:function(){var e=s.getAccount();return e&&e.getUserFirstName()?{firstname:e.getUserFirstName(),lastname:e.getUserLastName(),avatar:e.getUserAvatar()||r.getNested(window.site_vars,"ugc","DEFAULT_AVATAR")}:{}},_getCoreUserInfo:function(){return s.getCoreUserInfo().then(t.bind(function(t){return e.extend({},t,this.getUserManagerUserData())},this),function(){console.warn("failed to get user core info!")})},_getAppServUserInfo:function(){return this._getCoreUserInfo().then(t.bind(function(e){var t=e,i={status:"normal",id:t.AtyponId.toString(),firstName:t.firstname,lastName:t.lastname,email:r.getNested(t,"AtyponData","email"),avatarUrl:t.avatar};this.updateAppservTempoAuthor(i).then(function(t){return e.id=t.id,e},function(){console.warn("unable to get appservice user data!")})},this)).done(t.bind(function(e){this._loginState="loggedIn",n.trigger("ugc:user:statuschange",this._loginState,e)},this)).fail(t.bind(function(){this._loginState="loginFailed",n.trigger("ugc:user:statuschange",this._loginState)},this))},updateAppservTempoAuthor:function(e){return o.fetchData(r.getNested(window.site_vars,"ugc","tempo_appservice")+"/authors",{type:"POST",processData:!1,contentType:"application/json; charset=utf-8",crossDomain:!0,data:JSON.stringify(e)})},_getFilemobileUserInfo:function(){return this._getCoreUserInfo().then(function(t){return o.fetchData("/filemobile/getfmsession/",{type:"POST",data:{coreuserid:t.CoreUserId,atyponsessiontoken:t.AtyponSessionKey}}).then(function(i){if("valid"===i.success.status.state){var s=i.success.response;return t.sessiontoken=s.FileMobileSessionToken,t.id=s.FileMobileId,t}return console.warn("unable to validate filemobile user!"),e.Deferred().reject()},function(){console.warn("unable to get filemobile user data!")})}).done(t.bind(function(e){this._loginState="loggedIn",n.trigger("ugc:user:statuschange",this._loginState,e)},this)).fail(t.bind(function(){this._loginState="loginFailed",n.trigger("ugc:user:statuschange",this._loginState)},this))},getLoginState:function(){return this._loginState},normalizeGupData:function(e){var t={};if(r.getNested(e,"meta","isAuthenticatedInCurrentContext")){var i=r.getNested(e,"response","user"),s=i.fireflyUserId||i.userId||i.id;t={status:"normal",email:i.email,firstName:i.firstName,lastName:i.lastName,id:s.toString()};var n="";if(i.attributes)for(var a=i.attributes,o=0;o<a.length;o++)if("socialProfile_facebook_photo"===a[o].attributeCode){n=a[o].attributeValues[0].attributeValue;break}0===n.length&&(n=r.getNested(window.site_vars,"ugc","DEFAULT_AVATAR")),t.avatarUrl=n}else r.getNested(e,"meta","isAnonymous")&&(t.isAnonymous=!0,t.anonymousId=r.getNested(e,"response","anonymousId"));return t},logoutUser:function(){a.clearValue(r.getNested(window.site_vars,"flags","tempo")?"ugcuserinfo":"filemobileuserinfo")}});return new l}),define("ui/tooltip",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({initialize:function(s){s=e.extend({text:this.$el.data("tooltip-text"),customContainerClass:"ui-tooltip",customPanelClass:"",showEvent:"mouseenter",hideEvent:"mouseleave",onShow:null,onHide:null,position:"right"},s),i.prototype.initialize.call(this,s),this._tooltipText=this.options.text,this.$tooltipPanel=this._buildHtml(this.$el),this.$tooltipPanel.addClass("ui-tooltip-panel-"+this.options.position),t.bindAll(this,"show","hide"),this._addTriggerEvent(this.options.showEvent,this.show),this._addTriggerEvent(this.options.hideEvent,this.hide)},_addTriggerEvent:function(e,t){e&&this.$el.on(e+"."+this.cid,t)},_buildHtml:function(t){var i=e('<div class="'+this.options.customContainerClass+'">');t.wrap(i);var s=e('<div class="ui-tooltip-panel '+this.options.customPanelClass+'">'+this.options.text+"</div>");return s.insertAfter(t),s},isPanelShowing:function(){return this._isPanelShowing},show:function(){this.$tooltipPanel.css(this._getPositionCss(this.options.position)),this.$tooltipPanel.stop().fadeIn(400),this._isPanelShowing=!0,this.options.onShow&&this.options.onShow()},hide:function(){this.$tooltipPanel.stop().fadeOut(400),this._isPanelShowing=!1,this.options.onHide&&this.options.onHide()},_getPositionCss:function(e){var t=10,i=this.$tooltipPanel.outerHeight(),s=this.$tooltipPanel.outerWidth(),n=this.$el.outerWidth(),a=this.$el.outerHeight();return"right"===e?{top:-(i/2)+a/2,left:n+t}:"left"===e?{top:-(i/2)+a/2,right:n+t}:"top"===e?{bottom:a+t,left:-(s/2)+n/2}:"bottom"===e?{top:a+t,right:-(s/2)+n/2}:{}},getText:function(){return this._tooltipText},setText:function(e){this.$tooltipPanel.text(e),this._tooltipText=e,this.isPanelShowing()&&this.$tooltipPanel.css(this._getPositionCss(this.options.position))},destroy:function(e){this.$el.off("."+this.cid),this.$el.unwrap(),this.$tooltipPanel.remove(),i.prototype.destroy.call(this,e)}});return s}),define("modules/ugc/report-abuse",["jquery","underscore","baseview","state","modules/ugc/ugc-user","ui/tooltip","user-manager","easing"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({events:{"click .ugc-media-item-report-abuse-link":"onReportAbuseItemClick"},initialize:function(t){t=e.extend({tooltipOptions:null},t),this.pubSub={"user:statuschange":this.onUserStatusChange},i.prototype.initialize.call(this,t),this.$reportAbuseLinks=this.$(".ugc-media-item-report-abuse-link"),this.reportAbuseSubviewIndex=0,this.subviewPrefix="reportAbuseItem",this.setupReportAbuseItems(this.$reportAbuseLinks)},setupReportAbuseItems:function(e){t.each(e,function(e){this._setupTooltipView(this.getTooltipOptions(e))},this)},getTooltipOptions:function(t){var i=e.extend({el:t,text:this.getReportAbuseText(),position:"left"},this.options.tooltipOptions),s="ugc-media-item-report-abuse",n=s+"-tooltip-panel",a=s+"-tooltip-text";return i.customPanelClass&&(i.customPanelClass=n+" "+i.customPanelClass),i.customTextClass&&(i.customTextClass=a+" "+i.customTextClass),i},_setupTooltipView:function(e){var t=this.subviewPrefix+this.reportAbuseSubviewIndex;this.subviews[t]||(this.subviews[t]=new a(e),this.reportAbuseSubviewIndex++)},getReportAbuseText:function(){return"loggedIn"===n.getLoginState()?this.getLoggedInText():this.getLoggedOutText()},getLoggedOutText:function(){return"Please sign in to report as inappropriate"},getLoggedInText:function(){return"Report as inappropriate"},onReportAbuseItemClick:function(i){var s=e(i.currentTarget),a=this.$reportAbuseLinks.index(s),r=this.subviews[this.subviewPrefix+a],l=s.data(),h="loggedIn"===o.getLoginStatus();!s.hasClass("ugc-media-item-report-abuse-sent")&&h&&n.getUserInfo().done(t.bind(function(e){r.setText("Reporting..."),this.reportAbuse(e.id,l.mediaId).done(t.bind(function(){this.onReportAbuseSuccess(r,s)},this)).fail(t.bind(function(){this.onReportAbuseFail(r,s)},this))},this))},onReportAbuseSuccess:function(e,t){t.removeClass("ugc-media-item-report-abuse-failed"),t.addClass("ugc-media-item-report-abuse-sent"),e.setText("Reported")},onReportAbuseFail:function(e,t){t.addClass("ugc-media-item-report-abuse-failed"),e.setText("There was a problem reporting abuse.")},update:function(e){this.setupReportAbuseItems(e)},onUserStatusChange:function(e,t){var i;i="loggedIn"===t?this.getLoggedInText():this.getLoggedOutText(),this.setTextForItems(i)},setTextForItems:function(e){t.each(this.subviews,function(t){t.setText(e)},this)},reportAbuse:function(e,t){var i={method:"POST",data:{fmuserid:e,mediaitemid:t}};return s.fetchData("/yourtake/reportabuse/",i)}});return r}),define("modules/carousel/carousel-fullscreen",["jquery","exports","underscore","backbone","baseview","utils","state","site-manager","modules/carousel/carousel-autosize"],function(e,t,i,s,n,a,o,r,l){var h=l.extend({initialize:function(t){i.bindAll(this,"handleKeyPress","close"),t=e.extend({scrollerColor:"dark"},t),this.$body=a.get("body"),this.$doc=a.get("document"),this.carousel=t.carousel,this.parent=t.parent,o.registerFullScreenView(this),r.getHeader().setClosedFixed(!0),r.scrollTop(0),this.$doc.on("keydown."+this.cid,this.handleKeyPress),this.$body.on("click."+this.cid,".close",this.close),this.launch(),l.prototype.initialize.call(this,t)},close:function(t){t&&t.preventDefault(),r.getHeader().restoreLastState(),this.animate(this.$el.parent(),"opacity",0,300,"ease-in-out").done(i.bind(function(){this.destroy(!0),o.clearFullScreenView().done(i.bind(function(){if(this.carousel){var t=e(".thumbs li",this.parent);t.eq(this.index).click()}},this))},this))},destroy:function(e){this.$doc.off("."+this.cid),this.$body.off("."+this.cid),e&&this.$el.parent().remove(),l.prototype.destroy.call(this,!1)},launch:function(){var t=e('<article class="gallery fullscreen" style="opacity: 0"><a class="close" href="#"></a><div class="ui-film fullscreen"></div></article>'),i=this.parent.clone();i.find(".viewport").removeClass("hover");var s=i.find(".partner-placement");if(s.length){var n=s.attr("id")+"_fs";s.attr("id",n).attr("data-slot-id",n)}t.append(i),this.$body.append(t),this.animate(t,"opacity",1,300,"ease-in-out"),this.setElement(i)},handleKeyPress:function(e){return 37===e.keyCode?(this.prevSlide(),!1):39===e.keyCode?(this.nextSlide(),!1):27===e.keyCode?(this.close(),!1):void 0
}});return h}),define("modules/global/livevideo",["jquery","underscore","backbone","pubsub","state","utils","modules/global/brightcove-video"],function(e,t,i,s,n,a,o){var r=i.View.extend({events:{"click #close_modal_link":"close"},initialize:function(t){this.m_uiModal={},this.m_uiModalBgrnd={},this.win=a.get("win")[0],this.body=a.get("body"),this.service=t&&t.service?t.service:"/services/livevideos/",this.win.gannett={};var i=this;this.win.gannett.videoplayer_modal={openPopup:function(){var t="/livevideos/popout/",s=e("#videoplayer_modal .video-title").text(),n=e("#videoplayer_modal .sponsor-text").text(),o=e("#videoplayer_modal .video-logo").attr("src"),r=e("#videoplayer_modal").attr("data-assetid");t+="?videoid="+r+"&description="+s+"&sponsor="+n+"&sourcelogo="+o,r&&(a.openPopup(t,640,440),i.close())}}},loadLiveVideo:function(t){var i=this;n.registerFullScreenView(this),n.fetchHtml(this.service+t+"/").done(function(t){i.body.append(t),i.video=new o({el:e("#videoplayer_modal"),autostart:!0,live:!0}),i.m_uiModal=e("#videoplayer_modal"),i.m_uiModalBgrnd=e("#lightbox"),i.m_uiModal.show(),i.m_uiModalBgrnd.fadeIn(300),i.setElement("#videoplayer_modal")})},close:function(){if(this.m_uiModal){n.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal.remove(),this.m_uiModalBgrnd.remove(),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.win.gannett={}}},destroy:function(e){this.video&&this.video.destroy(!0),this.undelegateEvents(),e&&this.remove()}});return r}),define("animatecolors",["jquery"],function(e){function t(e,t,i){var s="rgb"+(Modernizr.rgba?"a":"")+"("+parseInt(e[0]+i*(t[0]-e[0]),10)+","+parseInt(e[1]+i*(t[1]-e[1]),10)+","+parseInt(e[2]+i*(t[2]-e[2]),10);return Modernizr.rgba&&(s+=","+(e&&t?parseFloat(e[3]+i*(t[3]-e[3])):1)),s+=")"}function i(e){var t,i;return(t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(e))?i=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1]:(t=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(e))?i=[17*parseInt(t[1],16),17*parseInt(t[2],16),17*parseInt(t[3],16),1]:(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))?i=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),1]:(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(e))&&(i=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])]),i}var s=["color","backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","outlineColor"];e.each(s,function(s,n){e.Tween.propHooks[n]={get:function(t){return e(t.elem).css(n)},set:function(s){var a=s.elem.style,o=i(e(s.elem).css(n)),r=i(s.end);s.run=function(e){a[n]=t(o,r,e)}}}}),e.Tween.propHooks.borderColor={set:function(n){var a=n.elem.style,o=[],r=s.slice(2,6);e.each(r,function(t,s){o[s]=i(e(n.elem).css(s))});var l=i(n.end);n.run=function(i){e.each(r,function(e,s){a[s]=t(o[s],l,i)})}}}}),define("modules/global/breaking-news",["jquery","underscore","baseview","pubsub","utils","state","modules/global/barrier","modules/global/livevideo","easing","animatecolors"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({events:{"click .bnm-breaking-link":"onClickBreakingLink","click .bnm-close-btn":"onClickCloseBreakingBtn"},breakingColors:{breaking:{normal:"rgb(247,0,0)",highlight:"rgb(191,49,49)"},live:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"},developing:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"}},breakingBarHeight:0,initialize:function(s){s=e.extend({slideSpeed:200,onBreakingNewsChange:null},s),t.bindAll(this,"updateBreakingBar","checkBreakingNewsBarrier"),this.lastUpdate=localStorage.getItem("breakingLastUpdateClosed"),this.initBreakingBar=setTimeout(this.updateBreakingBar,1e3),this.breakingBarPoll=setInterval(this.updateBreakingBar,91e3),this.barrier=new o,i.prototype.initialize.call(this,s)},destroy:function(){clearTimeout(this.initBreakingBar),clearInterval(this.breakingBarPoll),i.prototype.destroy.apply(this,arguments)},getHeight:function(){return this.breakingBarHeight},onClickCloseBreakingBtn:function(){this.closeBreakingBar(!0),s.trigger("uotrack","breakingnewsbarexit")},onClickBreakingLink:function(t){var i=e(t.currentTarget).attr("href");if(i.indexOf("livevideoassetid")>0){"undefined"!=typeof this.currentlivevideo&&this.currentlivevideo.close();var s=new r;s.loadLiveVideo(i.split("#")[1].split("=")[1]),this.currentlivevideo=s,t.preventDefault()}},closeBreakingBar:function(e){return this.breakingBarHeight?(e&&localStorage.setItem("breakingLastUpdateClosed",this.lastUpdate),this.breakingBarHeight=0,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!1),this.animate(this.$el,"height",0,this.options.slideSpeed).done(t.bind(function(){this.$el.css("background-color",""),this.$el.hide(),s.trigger("breakingbar:after:close")},this))):!1},openBreakingBar:function(){this.$el.show();var e=this.$(".bnm-bar").outerHeight();e!=this.breakingBarHeight&&(this.breakingBarHeight=e,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!0),this.animate(this.$el,"height",this.breakingBarHeight,this.options.slideSpeed).done(this.onCompleteOpenBreakingBar))},onCompleteOpenBreakingBar:function(){s.trigger("breakingbar:after:open")},updateBreakingBar:function(){this.busyCheckingBreakingNews||(this.busyCheckingBreakingNews=!0,a.fetchHtml("/services/breaking-news/nav-bar/").done(this.checkBreakingNewsBarrier))},addToBarrier:function(e,t,i){this.barrier.add(e,t,i)},checkBreakingNewsBarrier:function(e){var i=e.find(".bnm-bar");return i.length?void this.barrier.wait().done(t.bind(function(){this.parseBreakingNews(i)},this)):void(this.busyCheckingBreakingNews=!1)},parseBreakingNews:function(e){try{var t=e.data("type"),i=e.data("lastUpdate");if(this.lastUpdate!=i){this.$el.html(e).stop(),this.lastUpdate=i;var s=this.breakingBarHeight>0;if(this.openBreakingBar(),s){var n=this.breakingColors[t].highlight,a=this.breakingColors[t].normal;this.$(".bnm-bar").animate({backgroundColor:n}).animate({backgroundColor:a})}}}catch(o){this.closeBreakingBar()}finally{this.busyCheckingBreakingNews=!1}}});return l}),define("modules/header/site-nav-dropdown",["jquery","underscore","baseview","easing"],function(e,t,i){"use strict";var s=i.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(e){t.bindAll(this,"openDropdown","closeDropdown"),this.fadeSpeed=80,this.showDelay=120,this.$dropdown=this.$(".site-nav-dropdown"),i.prototype.initialize.call(this,e)},onMouseEnter:function(e){clearTimeout(this.hideTimer),this.isMouseOnDropdown=!0,this.openDropdown(e)},onMouseLeave:function(e){this.isMouseOnDropdown=!1,this.hideTimer=setTimeout(t.partial(this.closeDropdown,e),this.hideDelay)},closeDropdown:function(e){!this.isDropdownOpen||"mouseout"==e.type&&this.isMouseOnDropdown||(this.isDropdownOpen=!1,this.animate(this.$dropdown,"opacity",0,this.fadeSpeed).done(t.bind(function(){this.$dropdown.css("display","none")},this)),this.$el.removeClass("site-nav-active-item"))},openDropdown:function(e){this.isDropdownOpen||"mouseover"==e.type&&!this.isMouseOnDropdown||(this.isDropdownOpen=!0,this.$el.addClass("site-nav-active-item"),this.$dropdown.css("display","block"),this.animate(this.$dropdown,"opacity",1,this.fadeSpeed))}});return s}),define("modules/header/site-nav-more-module",["underscore","modules/header/site-nav-dropdown"],function(e,t){"use strict";var i=t.extend({initialize:function(e){this.$navDropdown=this.$(".site-nav-dropdown"),this.$navDropdownList=this.$(".site-nav-more-dropdown-list"),this.$navDropdownItems=this.$(".site-nav-more-dropdown-item"),t.prototype.initialize.call(this,e)},convertColumnLayout:function(e){var t="1col"==e?"2col":"1col";this.$navDropdown.removeClass("site-nav-more-dropdown-"+t).addClass("site-nav-more-dropdown-"+e),this.$navDropdownList.removeClass("site-nav-more-dropdown-list-"+t).addClass("site-nav-more-dropdown-list-"+e),this.$navDropdownItems.removeClass("site-nav-more-dropdown-item-"+t).addClass("site-nav-more-dropdown-item-"+e)}});return i}),define("modules/global/header",["jquery","underscore","base-app","pubsub","utils","state","user-manager","managers/routemanager","modules/global/breaking-news","directAdPosition","modules/header/site-nav-more-module","easing","animatecolors"],function(e,t,i,s,n,a,o,r,l,h,d){"use strict";var c=i.extend({el:".site-header",events:{"click .site-nav-search-link":"onClickNavSearchIcon","click .site-masthead-search-close-btn":"onClickSearchCloseBtn","click .site-masthead-search-btn-div":"onClickSearchBtnDiv"},navHeaderHeight:40,mastheadHeight:80,fixedHeaderThreshold:80,hoverDropdownDelay:120,TWO_COL_THRESHOLD:5,SITE_NAV_HIDDEN_CLASS:"site-nav-item-hidden",SITE_NAV_MORE_VISIBLE_CLASS:"site-nav-more-dropdown-item-visible",initialize:function(){this.isMulti=!!this.$el.attr("data-multi-header"),this.isThirdParty=!!this.$el.attr("data-third-party"),this.$win=n.get("win"),this.$top=n.get("scrollEl"),this.$siteHeaderInnerWrap=this.$(".site-header-inner-wrap"),this.$siteMasthead=this.$(".site-masthead"),this.$searchWrap=this.$(".site-masthead-search-wrap"),this.$navLogo=this.$(".site-nav-logo-item"),this.$navLogoLink=this.$(".site-nav-logo-link"),this.$navMoreItem=this.$(".site-nav-more-item"),this.$navLogoImg=this.$navLogo.find(".site-nav-logo-img"),this.$searchCancelBtn=this.$(".site-masthead-search-close-btn"),this.navLogoImgWidth=this.$navLogoImg.outerWidth(!0),this.$specialOffersMastheadAd=this.$(".site-masthead-special-offers-ad"),this.$subscribeWrap=this.$(".site-masthead-subscribe-wrap"),this.$siteMoreDropdownItems=this.$(".site-nav-more-dropdown-item:not(.site-nav-more-dropdown-item-hidden)"),this.$searchInput=this.$$(".site-masthead-search-form-input"),this.navHeight=this.$siteHeaderInnerWrap.outerHeight(),this.minHeight=this.$el.outerHeight(),t.bindAll(this,"onBreakingNewsChange","onFixingScroll","onClosingScroll","_handleOnAdReady","_onResizeWindow"),this.slideSpeed=200,n.set("headerHeight",this.navHeight),this.slideEasing="ease-out";var e=this.$el.data("open"),s=this.$el.data("fixed"),a=this.$el.data("default-open")||!1,o=this.$el.data("default-fixed")||!1;void 0===e&&(e=a),void 0===s&&(s=o),this.state={open:e,defaultOpen:a,fixed:s,defaultFixed:o,hasFixingScroller:!1,hasClosingScroller:!1},this.pubSub={"user:statuschange":this._loginStatus,"page:load":this._onPageLoad,"header:open":this.navAutoFitItems,"header:closed":this.navAutoFitItems},i.prototype.initialize.apply(this,arguments),this.start(),s||(this._setState({hasFixingScroller:!0}),n.getScrollPosition()&&this.onFixingScroll())},start:function(){this.loadHeaderModules(),this.subviews.breakingbar=new l({el:this.$(".bnm-container"),slideSpeed:this.slideSpeed,onBreakingNewsChange:this.onBreakingNewsChange}),this.moreLayout="1col",this.isThirdParty||(this.subviews.moreModule=new d({el:this.$navMoreItem[0]}));var e=t.throttle(this._onResizeWindow,500);this.$win.on("resize."+this.cid,e),this.navAutoFitStart()},navAutoFitStart:function(){this.$siteNavDynamicPrimaryItems=this.$(".site-nav-primary-item:not(.site-nav-more-item,.site-nav-logo-item,.site-nav-always-visible-item,.site-nav-spacer-item)"),this.$siteNavAlwaysVisibleItems=this.$(".site-nav-always-visible-item,.site-nav-secondary-item"),this.siteNavDynamicItemsWidths=this.getNavGroupWidths(this.$siteNavDynamicPrimaryItems),this.siteNavAlwaysVisibleItemsWidths=this.getNavGroupWidths(this.$siteNavAlwaysVisibleItems),this.siteNavMoreItemWidth=this.$navMoreItem.outerWidth(),this.siteNavAlwaysVisibleItemsTotalWidth=t.reduce(this.siteNavAlwaysVisibleItemsWidths,function(e,t){return e+t},0),this.siteNavLogoWidth=this.navLogoImgWidth-10,this.isThirdParty||(this.hiddenPrimaryItemsCount=0),this._updateMastheadWidth(),this.navRevealed||(this.isThirdParty||0!==this.hiddenPrimaryItemsCount||this.$navMoreItem.addClass(this.SITE_NAV_HIDDEN_CLASS),this.$(".site-nav-item").addClass("site-nav-item-visible"),this.navRevealed=!0)},navAutoFitItems:function(){var e=this.state.open?0:this.siteNavLogoWidth,t=this.isThirdParty?0:this.siteNavMoreItemWidth,i=this.siteNavAlwaysVisibleItemsTotalWidth+e,s=this.siteNavDynamicItemsWidths.length;this.firstHiddenNavItemIndex||(this.firstHiddenNavItemIndex=s);for(var n=0;n<this.siteNavDynamicItemsWidths.length;n++){var a=this.siteNavDynamicItemsWidths[n];if(i+a>this.mastheadWidth){if(i+t<=this.mastheadWidth){s=n;break}for(var o=n-1;o>=0;o--){var r=this.siteNavDynamicItemsWidths[o];if(i+t-r<=this.mastheadWidth){s=o;break}i-=r}break}i+=a}if(s!==this.firstHiddenNavItemIndex){var l=s<this.firstHiddenNavItemIndex,h=l?s:this.firstHiddenNavItemIndex,d=l?this.firstHiddenNavItemIndex:s;this.togglePrimaryNavItems(s,h,d),this.toggleMoreNavItems(s,h,d),this.firstHiddenNavItemIndex=s}},togglePrimaryNavItems:function(e,t,i){this.$siteNavDynamicPrimaryItems.slice(t,i).toggleClass(this.SITE_NAV_HIDDEN_CLASS)},toggleMoreNavItems:function(e,t,i){if(!this.isThirdParty){var s=e<this.firstHiddenNavItemIndex,n=this.siteNavDynamicItemsWidths.length-e,a=this.willMoreDropdownAppear(n)||this.willMoreDropdownHide(n);if(this.$siteMoreDropdownItems.slice(t,i).toggleClass(this.SITE_NAV_MORE_VISIBLE_CLASS),a){var o=0===n;this.$navMoreItem.toggleClass(this.SITE_NAV_HIDDEN_CLASS,o),this.allPrimaryNavItemsShown=!s}this.hiddenPrimaryItemsCount=n,this._updateMoreColumnLayout()}},willMoreDropdownAppear:function(e){return 0===e&&this.hiddenPrimaryItemsCount>0},willMoreDropdownHide:function(e){return 0===this.hiddenPrimaryItemsCount&&e>0},getNavGroupWidths:function(i){return t.map(i,function(t){return e(t).outerWidth()})},_updateMastheadWidth:function(){var e=this.$siteMasthead.outerWidth();if(e!==this.mastheadWidth){var t=e>this.mastheadWidth?"wider":"narrower";this.mastheadWidth=e,"wider"===t&&this.allPrimaryNavItemsShown||this.navAutoFitItems()}},_updateMoreColumnLayout:function(){this.isThirdParty||(this.hiddenPrimaryItemsCount>this.TWO_COL_THRESHOLD&&"2col"!=this.moreLayout?(this.subviews.moreModule.convertColumnLayout("2col"),this.moreLayout="2col"):"1col"!=this.moreLayout&&(this.subviews.moreModule.convertColumnLayout("1col"),this.moreLayout="1col"))},_onPageLoad:function(e){this._buildSpecialOffersMastheadAd(),this._onResizeWindow(e)},_onResizeWindow:function(){this._updateMastheadWidth()},_buildSpecialOffersMastheadAd:function(){if(this.$specialOffersMastheadAd.length){var e,i=a.getActivePageInfo().numPageViewsLeft,s=o.getAccount("firefly");void 0!==i&&(e={pwvr:i>0?i:"0"}),this.subviews.specialOffersMastheadAd?e&&(this.subviews.specialOffersMastheadAd.setTargeting(e),this.subviews.specialOffersMastheadAd.refreshPosition()):s?s.getUserInfo().done(t.bind(function(t){t.hasMarketAccess||this._applyMastheadDirectPositionAd(e)},this)).fail(t.bind(function(){this._applyMastheadDirectPositionAd(e)},this)):this._applyMastheadDirectPositionAd(e)}},_applyMastheadDirectPositionAd:function(e){this.subviews.specialOffersMastheadAd=new h({el:this.$specialOffersMastheadAd,adSizes:[122,50],adPlacement:"consumer_sales-masthead",onAdReady:this._handleOnAdReady,targeting:e})},_handleOnAdReady:function(){this.$subscribeWrap.remove(),this.$specialOffersMastheadAd.addClass("site-masthead-subscribe-wrap-visible"),this.subviews.specialOffersMastheadAd.showAd()},destroy:function(){this._unregisterFixingScroller(),this.$win.off("."+this.cid),clearTimeout(this.headerTransparencyTimeout),i.prototype.destroy.call(this)},_loginStatus:function(e,t,i){"firefly"===e&&("loggedIn"===t&&i&&i.hasMarketAccess?this.$subscribeWrap.removeClass("site-masthead-subscribe-wrap-visible"):"loggingIn"!==t&&this.$subscribeWrap.addClass("site-masthead-subscribe-wrap-visible"))},isFixedAndClosed:function(e){return!(e.open||!e.fixed||e.hasFixingScroller||e.hasClosingScroller)},_setState:function(e){var i,n="";t.each(e,function(t,s){this.state[s]!==t&&("fixed"===s?t?(this.$siteHeaderInnerWrap.addClass("site-header-inner-wrap-fixed"),n+=" header:fixed"):(this.$siteHeaderInnerWrap.removeClass("site-header-inner-wrap-fixed"),n+=" header:unfixed"):"open"===s?(i=this.state.fixed===!0&&(void 0===e.fixed||e.fixed===!0)||void 0!==e.hasFixingScroller&&this.state.hasFixingScroller!==e.hasFixingScroller,this._setMasthead(t,i),n+=t?" header:open":" header:closed"):"hasFixingScroller"===s?t?this._registerFixingScroller():this._unregisterFixingScroller():"hasClosingScroller"===s?t?this._registerClosingScroller():this._unregisterClosingScroller():console.warn("Unknown state key: "+s))},this),this._checkTransition(this.state,e),t.extend(this.state,e),n&&s.trigger(n)},_checkTransition:function(t,i){i=e.extend({},t,i);var s=this.isFixedAndClosed(t),n=this.isFixedAndClosed(i),a=t.open!==i.open;s!==n&&(n?this._transitionToCloseFixed(a):this._transitionFromCloseFixed(a))},_transitionToCloseFixed:function(e){this.navHeight=this.navHeaderHeight,this.updateHeaderMinHeight(e)},_transitionFromCloseFixed:function(e){this.navHeight=this.navHeaderHeight+this.mastheadHeight,this.updateHeaderMinHeight(e)},_registerFixingScroller:function(){this.isMulti||(this.hasFixingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasFixingScroller=!0,this.$win.on("scroll.headerFixingScroller",t.throttle(this.onFixingScroll,20))))},_unregisterFixingScroller:function(){this.hasFixingScroller=!1,this.$win.off(".headerFixingScroller")},onFixingScroll:function(){var e=n.getScrollPosition()>=this.mastheadHeight;e!==this.state.fixed&&this._setState(e?{open:!1,fixed:!0}:{open:!0,fixed:!1})},_registerClosingScroller:function(){this.isApple||this.isMulti||(this.hasClosingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasClosingScroller=!0,this.$win.on("scroll.headerClosingScroller",t.throttle(this.onClosingScroll,20))))},_unregisterClosingScroller:function(){this.hasClosingScroller=!1,this.$win.off(".headerClosingScroller")},onClosingScroll:function(){this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0)},loadHeaderModules:function(){this.$(".headermodules").each(t.bind(function(t,i){try{var s=JSON.parse(e(i).html()).js_modules||[];this.buildModules(s)}catch(n){console.error("Failure loading header modules",n)}},this))},onClickNavSearchIcon:function(e){e.preventDefault(),this.$searchInput.focus(),this.state.open||(this._setState({open:!0,fixed:!0,hasClosingScroller:!0}),this.$searchCancelBtn.addClass("site-masthead-search-close-btn-visible"),this.transparencySetup&&this.headerIsTransparent&&this.toggleTransparency(!1))},scrollTop:function(e,t){if(!t)if(this.state.open){var i=n.getScrollPosition();if(e<this.fixedHeaderThreshold&&i<this.fixedHeaderThreshold)return i}else this.state.hasFixingScroller&&e<this.fixedHeaderThreshold&&(e=this.fixedHeaderThreshold);return this.$top.scrollTop(e),e},isFixed:function(){return this.state.fixed},isOpen:function(){return this.state.open},setOpenFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!0,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},getFixedHeight:function(){return this.isFixedAndClosed(this.state)?this.minHeight:this.minHeight-this.mastheadHeight},setFixingScroller:function(e){this._setState(e?{hasFixingScroller:!0,hasClosingScroller:!1}:{hasFixingScroller:!1,hasClosingScroller:!1})},setClosedFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!1,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},restoreLastState:function(){this.lastState&&(this._setState(this.lastState),this.lastState=null)},restoreDefaultState:function(){this._setState(this.state.defaultFixed?{open:this.state.defaultOpen,fixed:this.state.defaultFixed,hasFixingScroller:!this.state.defaultFixed,hasClosingScroller:!1}:{hasFixingScroller:!0,hasClosingScroller:!1})},onClickSearchBtnDiv:function(t){e(t.currentTarget).parents("form").trigger("submit")},onClickSearchCloseBtn:function(){a.getActiveApp().isSearchPage?r.goTo("/"):(this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0))},_collapseMasthead:function(e){e?this.animate(this.$searchWrap,"height",0,this.slideSpeed,this.slideEasing).always(t.bind(function(){this.$searchCancelBtn.length&&this.$searchCancelBtn.removeClass("site-masthead-search-close-btn-visible")},this)):this.$searchWrap.css("height",0),this.toggleNavLogo(!0,!0)},_expandMasthead:function(e){e?this.animate(this.$searchWrap,"height",this.mastheadHeight+"px",this.slideSpeed,this.slideEasing).done(t.bind(function(){this.$searchInput.focus()},this)):this.$searchWrap.css("height",this.mastheadHeight),this.toggleNavLogo(!0,!1)},_setMasthead:function(e,t){e?this._expandMasthead(t):this._collapseMasthead(t)},getExpandedHeight:function(){return this.minHeight},getScrollOffset:function(){return this.isFixed()?this.minHeight!=this.navHeaderHeight?this.minHeight-this.navHeaderHeight:this.minHeight:0},getFixedThreshold:function(){return this.fixedHeaderThreshold},getCollapsedHeight:function(){return this.navHeaderHeight},getCurrentHeight:function(){return this.navHeight},toggleNavLogo:function(e,t){var i=t?1:0,s=t?this.navLogoImgWidth:0;this.$navLogoImg.css("opacity",i),this.$navLogoLink.css("width",s)},updateHeaderMinHeight:function(e){this.minHeight=this.navHeight+(this.subviews.breakingbar?this.subviews.breakingbar.getHeight():0),e?this.animate(this.$el,"min-height",this.minHeight,this.slideSpeed):this.$el.css("min-height",this.minHeight)},onBreakingNewsChange:function(e){this.updateHeaderMinHeight(),e?s.trigger("breakingbar:before:open",this.minHeight,this.options.slideSpeed):s.trigger("breakingbar:before:close",this.minHeight,this.options.slideSpeed)},updateNavigation:function(e){var t,i,n,a="site-nav-active-span",o="site-nav-active-item";for(this.$("."+a).removeClass(a),this.$("."+o).removeClass(o),e=e||"home",n=e.indexOf("?"),-1!==n&&(e=e.substring(0,n)),"/"===e[0]&&(e=e.substring(1)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e=e.replace(/[^_a-zA-Z0-9\-/]/g,""),t=e?e.split("/"):["home"];t.length&&(i=this.$(".site-nav-"+t.join("-")+"-item"),!i.length);)t=t.splice(0,t.length-1);var r=t.join("-");s.trigger("update:navigation",r),i&&i.length&&(this.$(".site-nav-"+r+"-span").addClass(a),i.addClass(o))},setupTransparency:function(){this.siteHeaderInnerWrapBg=this.$siteHeaderInnerWrap.css("background"),this.$siteHeaderInnerWrap.addClass("transparent-transition").css("background",""),this.transparencySetup=!0},destroyTransparency:function(){this.$siteHeaderInnerWrap.removeClass("transparent-transition"),this.$el.removeClass("transparent-header"),this.transparencySetup=!1,this.headerTransparencyTimeout=t.delay(t.bind(function(){this.$siteHeaderInnerWrap.css("background",this.siteHeaderInnerWrapBg)},this),350)},toggleTransparency:function(e){this.transparencySetup||this.setupTransparency(),e?(this.$el.addClass("transparent-header"),this.headerIsTransparent=!0):(this.$el.removeClass("transparent-header"),this.headerIsTransparent=!1)}});return c}),define("fwinfo",["jquery","underscore"],function(){function e(){if(!n&&(n={},document.cookie.match(/\bfwutil=([^\;]*)/))){var e,t,a,o=RegExp.$1.split(i),r=o.length;for(e=0;r>e;e++)t=o[e].split(s),a=t.length,2==a&&(n[t[0]]=decodeURIComponent(t[1]))}}function t(){var e,t="fwutil=",a="";for(e in n)n.hasOwnProperty(e)&&(t+=a+e+s+encodeURIComponent(n[e]),a=i);document.cookie=t+";path=/"}var i="~",s=":",n=null,a={setsessionvalue:function(i,s){n||e(),n[i]=s,t()},getsessionvalue:function(t){return n||e(),n[t]},getandclearsessionvalue:function(e){var t=a.getsessionvalue(e);return t?(a.setsessionvalue(e,""),t):null}};return a}),define("api/analytics",["pubsub"],function(e){return{trackEvent:function(t,i){e.trigger("track",{label:t,url:i})},trackPageView:function(t){e.trigger("analytics:pageload",{ssts:t.ssts||"bugpages",cst:t.cst||"undefined",contenttype:t.contentType,pathName:t.pathName})}}}),define("analytics/settealium",["jquery","underscore","pubsub","fwinfo","utils","managers/routemanager","user-manager","api/analytics"],function(e,t,i,s,n,a,o){function r(e,t){c?c.push([e,t]):l(e,t)}function l(e,t){for(var i in t)t.hasOwnProperty(i)&&t[i]&&(t[i]=(""+t[i]).toLowerCase());window.utag.track(e,t)}function h(e){if(-1!=e.indexOf("|")){var t="n/a",i=[p.data.contenttype||t,p.data.section||t,e];e=i.join("|"),/[|](\d+|n\/a)$/.test(e)||(e+="|"+t)}return e}var d={},c=[],u=function(){window.tealium_url&&this.initialize(window.tealium_url)};u.prototype={initialize:function(e){this.data={},this.pubSub={"analytics:pageload":this.page_load,heattrack:this.heattrack,abtesttrack:this.abtesttrack,cxresptrack:this.cxresptrack,"page:load":this.page_load,"site:refresh":this.site_refresh,"slide:change":this.slide_change,"user:logout":this.clear_user_data,uotrack:this.uotrack,"video:load":this.video_load,track:this.track,vitrack:this.vitrack},i.attach(this.pubSub,this),n.loadScript(e,"utag").done(function(){t.each(c,function(e){l(e[0],e[1])}),c=null}).fail(t.bind(function(){c=null,this.destroy()},this))},ready:function(){},destroy:function(){i.unattach(this.pubSub,this)},relevant_data:function(e,t){var i=e.cst.replace(/\/\/*$/,"").split("/"),n=new Date(18e5*parseInt((new Date).getTime()/18e5,10)),a=n.getHours(),o=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1,r=window.location.search.match(/[?&]csp=([^&]*)/i)&&RegExp.$1,l=e.ssts.split("/"),h="";return this.clickName=o||s.getandclearsessionvalue("clickName"),this.clickPage=s.getandclearsessionvalue("clickPage"),e.ab_test_id&&(h=e.ab_test_id+"|"+(e.ab_test_variant||"control")),{assetid:e.assetid,atyponuserid:p.data.atypon_id,blogname:e.blogname||"",brandview_sponsor:e.sponsorname||"",byline:e.byline||"",category:i[0],clickName:this.clickName,clickPage:this.clickPage,contenttype:e.contenttype,cst:i.slice(0,3).join(":"),dayofweek:"sunday monday tuesday wednesday thursday friday saturday".split(" ")[(new Date).getDay()],eventtype:t,gcionid:document.cookie.match(/\bGCIONID=([^;]*)/)&&RegExp.$1,halfhour:1+(a+11)%12+":"+function(e){return e.substr(e.length-2)}("0"+n.getMinutes())+(a>11?" pm":" am"),linkTrackVars:"prop1",numPageViewsLeft:e.numPageViewsLeft,pathName:e.pathName||"",prevpath:s.getandclearsessionvalue("prevpath"),priority_asset:e.priority_asset||"",published_date:e.published_date||"",referrerhost:o?document.referrer.split("/")[2]:"",refreshed:s.getandclearsessionvalue("refreshed"),searchkeywords:e.searchkeywords,section:l[0],ssts:l.join(":"),subcategory:i.slice(0,2).join(":"),subsection:l.slice(0,2).join(":"),templatetype:e.templatetype,topic:l.slice(0,3).join(":"),typeofday:((new Date).getDay()+8)%7>1?"weekday":"weekend",user_status:p.data.user_status||"",coreuserid:p.data.core_user_id||"",videoincluded:e.videoincluded||"no",taxonomykeywords:e.taxonomykeywords||"",gallerytitle:e.gallerytitle||"",galleryindex:e.galleryindex||"",queryparamtrack:r||"",viralVideoDomain:"",videoContentProvider:"",videoFulllengthUrl:"",videoName:"",videoPlayerName:"",keywords:"",videoDuration:"",milestonetrack:"",videotranscript:"",noinitialanalytics:e.noinitialanalytics||"",ab_test_id:e.ab_test_id||"",ab_test_variant:h}},clear_user_data:function(){p.data={}},page_load:function(e){var t;e.noinitialanalytics||(d=t=p.relevant_data(e,"page:load"),p.data.contenttype=t.contenttype,p.data.section=t.section,s.setsessionvalue("prevpath",document.location.pathname),"loggingIn"===o.getLoginStatus()||"loggedIn"===o.getLoginStatus()?o.getCoreUserInfo().then(function(e){p.data.atypon_id=t.atyponuserid=e.AtyponId,p.data.core_user_id=t.coreuserid=e.CoreUserId,p.data.user_status=t.user_status=e.UserLicenseType;var i=o.getAccount("firefly");n.getNested(i,"user","hasMarketAccess")&&(p.data.numPageViewsLeft=t.numPageViewsLeft="authorized"),r("view",t)},function(){r("view",t)}):(p.data.user_status=t.user_status="none",r("view",t)))},track:function(e){e=e||{};var t=e.url,i=this._getLabel(e.event,e.label);t&&a.getInfo(t)?this.heattrack(i):i&&this.uotrack(i)},_getLabel:function(t,i){if(t){var s=e(t.currentTarget);return s.data("trackLabel")||s.data("uotrack")||s.data("ht")||i}return i},uotrack:function(e){"string"!=typeof e&&(console.error("uotrack has been given a non-string event argument",e),e=(e||{}).prop41||"somethingbad");var t=e.match(/{% *[a-z0-9_]* *%}/gi);if(t)for(var i=0;i<t.length;i++){var s=t[i],n=s.match(/{% *([a-z0-9_]*) *%}/)&&RegExp.$1;e=e.replace(s,d[n])}e=h(e);var a={clickName:e,clickPage:location.href,eventtype:"uotrack",linkTrackEvents:"None",linkTrackVars:"prop41,prop64"};r("link",a)},vitrack:function(e){"object"!=typeof e&&(console.error("vitrack has been given a non-object event argument",e),e=(e||{}).prop9||"somethingbad");var t={milestonetrack:e.percentage,eventtype:"vitrack",linkTrackEvents:"None",linkTrackVars:"prop9",video_url:e.video_url};r("link",t)},abtesttrack:function(e){var t={ab_test_variant_success:e,eventtype:"abtesttrack",linkTrackEvents:"event76",linkTrackVars:"prop27"};r("link",t)},cxresptrack:function(e){var t={cx_dc_resp:e,eventtype:"cxresptrack",linkTrackEvents:"None",linkTrackVars:"eVar37"};r("link",t)},site_refresh:function(e){s.setsessionvalue("refreshed",e)},heattrack:function(e){e&&(e=h(e),s.setsessionvalue("clickName",e)),s.setsessionvalue("clickPage",location.href)},slide_change:function(e){var t,i,n=d;try{t=e.cst.split("/"),i=e.ssts.split("/")}catch(a){return void console.error("Invalid page",a.stack||a.stacktrace||a.message)}n.byline="",n.clickName=s.getandclearsessionvalue("clickName"),n.contenttype=e.contenttype,n.videoincluded=e.videoincluded||"no",n.gallerytitle=e.gallery_title,n.galleryindex=e.gallery_index,n.assetid=e.gallery_id,n.eventtype="slide:change",n.templatetype="",n.category=t[0],n.cst=t.slice(0,3).join(":"),n.published_date=e.publishedDate||"",n.refreshed="",n.section=i[0],n.ssts=i.join(":"),n.subcategory=t.slice(0,2).join(":"),n.subsection=i.slice(0,2).join(":"),n.topic=i.slice(0,3).join(":"),n.pathName=e.pathName||"",n.viralVideoDomain="",n.videoContentProvider="",n.videoFulllengthUrl="",n.videoName="",n.videoDuration="",n.videoPlayerName="",n.keywords="",n.milestonetrack="",n.videotranscript="",r("view",n)},video_load:function(e){var t=d,i=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1;t.byline="",t.clickName=i||s.getandclearsessionvalue("clickName"),t.clickPage=s.getandclearsessionvalue("clickPage"),t.category=e.category||"",t.cst=e.cst||"",t.assetid=e.assetid||"",t.published_date=e.publishedDate||"",t.refreshed="",t.section=e.section||"",t.ssts=e.ssts||"",t.subcategory=e.subcategory||"",t.subsection=e.subsection||"",t.topic=e.topic||"",t.videoPlayerName=e.videoplayername||"",t.prevpath=s.getandclearsessionvalue("prevpath"),t.completion=e.completion||"",t.keywords=e.keywords||"",t.taxonomykeywords=e.keywords||"",t.contenttype=e.contenttype||"",t.videoName=e.videoName||"",t.videoDuration=e.videoDuration||"",t.eventtype=e.eventtype||"",t.pathName=e.pathName||"",t.videoContentID=e.contentid||"",t.viralVideoDomain=e.viralVideoDomain||"",t.videoContentProvider=e.videocontentprovider||"",t.templatetype=e.templatetype||"",t.noinitialanalytics=!1,t.videoincluded="yes",t.videoFulllengthUrl=e.videoFulllengthUrl||"",t.milestonetrack=e.milestonetrack||"",t.videotranscript=e.videotranscript||"",r("view",t),s.setsessionvalue("prevpath",document.location.pathname)}};var p=new u;return p}),define("user-accounts/base-user-account",["jquery","underscore","pubsub","baseview","managers/cachemanager"],function(e,t,i,s,n){"use strict";var a=s.extend({initialize:function(e){t.bindAll(this,"_handleGetCoreUserInfo","logout"),s.prototype.initialize.call(this,e)},getUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return this._handleGetUserInfo()},this)):e.Deferred().reject("account not logged in")},_handleGetUserInfo:function(){return console.error("getUserInfo failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},getCoreUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return n.getValue("coreuserinfo",this._handleGetCoreUserInfo).done(function(t){e.cookie("atyponid",t.AtyponId,{expires:14,path:"/",domain:window.site_vars.base_url}),e.cookie("sessionKey",t.AtyponSessionKey,{path:"/",domain:window.site_vars.base_url})
})},this)):e.Deferred().reject("account not logged in")},_handleGetCoreUserInfo:function(){return e.Deferred(t.bind(function(t){e.ajax("/user-service/getcoreuser/"+this.getUserId()+"/"+this.getName(),{type:"POST",data:{token:this.getUserToken()}}).done(function(e){e&&e.success&&e.success.status?"valid"===e.success.status.state?t.resolve(e.success.response):t.reject(e.success.status.message):t.reject("unable to get core user data, invalid response!")}).fail(function(){t.reject("unable to get core user data!")})},this)).promise()},login:function(e){var i=this.getLoginStatus();return"loggingOut"===i?this.logoutPromise.then(t.bind(function(){return this.login(e)},this),t.bind(function(){return this.login(e)},this)):("loggedIn"!==i&&"loggingIn"!==i&&this._triggerLogin(e),this.loginPromise)},_triggerLogin:function(e){this.loginPromise=this._handleLogin(e),"pending"===this.loginPromise.state()&&this._onLoginStatusChange(),this.loginPromise.always(t.bind(function(){this._onLoginStatusChange.apply(this,arguments)},this))},getLoginStatus:function(){return this.logoutPromise?"loggingOut":this.loginPromise?"rejected"===this.loginPromise.state()?"loginFailed":"pending"===this.loginPromise.state()?"loggingIn":"loggedIn":"loggedOut"},_onLoginStatusChange:function(){i.trigger.apply(i,["user:statuschange",this.getName(),this.getLoginStatus()].concat(Array.prototype.slice.call(arguments,0)))},_handleLogin:function(){return console.error("Login failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},_flushCaches:function(){n.clearValue("coreuserinfo")},logout:function(){var t=this.getLoginStatus();return"loggingOut"===t?this.logoutPromise:"loggingIn"===t?this.loginPromise.then(this.logout,this.logout):"loggedOut"!==t?this._triggerLogout():e.Deferred().resolve()},_triggerLogout:function(){this._flushCaches(),this.loginPromise=null;var e=this._handleLogout().always(t.bind(function(){this.logoutPromise=null,this._onLoginStatusChange()},this));return"pending"===e.state()&&(this.logoutPromise=e,this._onLoginStatusChange()),e},_handleLogout:function(){return e.Deferred().resolve()},whenLoggedIn:function(){return this.loginPromise?this.loginPromise:e.Deferred().reject()},getUserToken:function(){return""},getUserId:function(){return""},getUserAvatar:function(){return""},getUserFirstName:function(){return""},getUserLastName:function(){return""},getName:function(){throw"No name defined"}});return a}),define("user-accounts/facebook-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","third-party-apis/facebook/facebook","cookie"],function(e,t,i,s,n,a){"use strict";var o=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},n.registerAccount(this)},_handleGetUserInfo:function(){return a.loadScript().then(function(){return e.Deferred(function(e){FB.api("/me?fields=name,first_name,last_name,gender,picture",function(t){!t||t.error?(console.error("Facebook returned erroneous response!",t),e.reject(t)):e.resolve(t)})})})},_handleLogin:function(e){var i;return i=e?this._getLoginStatus():this._loginUser(),i.then(t.bind(function(e){return this.sessionToken=e.accessToken,this._handleGetUserInfo()},this)).done(t.bind(function(e){this.user=e},this)).fail(t.bind(function(e){"unknown"===e&&this.logout()},this))},_getLoginStatus:function(){return a.loadScript().then(function(){return e.Deferred(function(e){FB.getLoginStatus(function(t){"connected"===t.status?e.resolve(t.authResponse):e.reject(t.status)})})})},_loginUser:function(){return a.loadScript().then(function(){return e.Deferred(function(e){FB.login(function(t){"connected"===t.status?e.resolve(t.authResponse):e.reject(t.status)},{scope:a.getUserPermissions()})})})},_handleLogout:function(){return this.user={},this.sessionToken=null,a.loadScript().then(function(){FB.logout()})},getName:function(){return"facebook"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.first_name},getUserLastName:function(){return this.user.last_name}});return new o}),define("third-party-apis/google/googleplus",["jquery","underscore","third-party-apis/base-third-party-api"],function(e,t,i){"use strict";var s=i.extend({initialize:function(){var e=this.getApiSiteConfig("GOOGLEPLUS");e&&(this._clientid=e.CLIENTID,this._plusonejslib=e.JSLIBURL,this._cookiePolicy=e.COOKIEPOLICY,this._appPackageName=e.APPPACKAGENAME,this._logoutUrl=e.LOGOUT_URL),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=e.Deferred(),this.setupOnLoadCallbacks("afterLoadGPScript",t.bind(function(){this._loadGooglePlusApi().done(t.bind(function(){this._loadScriptPromise.resolve()},this))},this)),e.ajax(this._plusonejslib,{data:{onload:"afterLoadGPScript"},cache:!0,dataType:"script"})),this._loadScriptPromise.promise()},_loadGooglePlusApi:function(){var i=e.Deferred();return gapi.client.load("plus","v1",t.bind(function(){gapi.auth.init(function(){i.resolve()})},this)),i.promise()},getUserInfo:function(){var t=e.Deferred();return this.userInfo?t.resolveWith(this,[this.userInfo]):this.loadScript().done(function(){var e=gapi.client.plus.people.get({userId:"me"});e.execute(function(e){e.error?(console.error("Google returned erroneous response!",e),t.reject()):t.resolveWith(this,[e])})}),t.promise()},signInUser:function(){var i=e.Deferred();return this.loadScript().done(t.bind(function(){gapi.auth.authorize({client_id:this._clientid,requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",apppackagename:this._appPackageName,approvalprompt:"force",immediate:!1},t.bind(function(e){e.access_token?i.resolveWith(this,[e]):e.error&&(console.log("There was an error: "+e.error),i.rejectWith(this,[e]))},this))},this)),i.promise()},signOutUser:function(i){var s=e.Deferred();return this.loadScript().done(t.bind(function(){e.ajax({type:"GET",url:this._logoutUrl,data:{token:i},async:!1,contentType:"application/json",dataType:"jsonp",success:function(){s.resolve()},error:function(){s.reject()}})},this)),s.promise()},getAuthStatus:function(){var i=e.Deferred();return this.loadScript().done(t.bind(function(){gapi.auth.authorize({client_id:this._clientid,scope:"https://www.googleapis.com/auth/plus.login",immediate:!0},function(e){i.resolve(e)})},this)),i.promise()}});return new s}),define("user-accounts/googleplus-user-account",["jquery","underscore","user-manager","user-accounts/base-user-account","third-party-apis/google/googleplus","cookie"],function(e,t,i,s,n){"use strict";var a=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},i.registerAccount(this)},_handleGetUserInfo:function(){return n.getUserInfo().done(t.bind(function(e){this.user=e},this))},_handleLogin:function(e){var i=e?"getAuthStatus":"signInUser";return n[i]().then(t.bind(function(e){return this.sessionToken=e.access_token,this._handleGetUserInfo()},this)).fail(t.bind(function(){this.logout()},this))},_handleLogout:function(){return this.sessionToken?n.signOutUser(this.sessionToken):e.Deferred().resolve()},getName:function(){return"google"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.image?this.user.image.url:""},getUserFirstName:function(){return this.user.name?this.user.name.givenName:""},getUserLastName:function(){return this.user.name?this.user.name.familyName:""}});return new a}),define("modules/sports/sports-more-teams",["jquery","underscore","backbone","baseview","utils","easing"],function(e,t,i,s,n){var a=s.extend({events:{"click .sp-more-teams-next-arrow":"onArrowClick","click .sp-more-teams-prev-arrow":"onArrowClick","click .sp-more-teams-nav-item-link":"onPaginationLinkClick"},initialize:function(){s.prototype.initialize.call(this,this.options),t.bindAll(this,"setup","update"),this.$viewport=this.$(".sp-more-teams-viewport"),this.$divisions=this.$viewport.find(".sp-more-teams-division"),this.divisionsCount=this.$divisions.length,this.$scroller=this.$(".sp-more-teams-scroll"),this.$arrows=this.$(".sp-more-teams-next-arrow, .sp-more-teams-prev-arrow"),this.$indicator=this.$(".sp-more-teams-nav-indicator"),this.$paginationLinks=this.$(".sp-more-teams-nav-item-link"),this.$navBelt=this.$(".sp-more-teams-nav-belt"),this.$navItemWrapper=this.$(".sp-more-teams-nav-item-wrap"),this.$navItems=this.$navItemWrapper.find(".sp-more-teams-nav-item"),this.$win=n.get("win");var e=t.throttle(this.update,1e3);this.$win.on("resize."+this.cid,e),this.currentDivisionIndex=this.$divisions.index(this.$divisions.filter(".current")),this.setup()},setup:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.scrollTo(this.currentDivisionIndex)},update:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.moveScroller(this.getAnimPosition(this.currentDivisionIndex)),this.moveIndicator(this.currentDivisionIndex)},_addNavItemSpacing:function(){var i,s=this.$navItemWrapper.width(),n=this.$navItems.length,a=0;this.$navItems.each(function(){a+=e(this).outerWidth()}),i=(s-a)/(2*n-2),i=parseInt(i,0),t.each(this.$navItems,function(t,s){var n=e(t),a=s+1,o=i+"px";1===a?n.css("margin-right",o):a===this.$navItems.length?n.css("margin-left",o):(n.css("margin-right",o),n.css("margin-left",o))},this)},_addTileSpacing:function(){t.each(this.$divisions,function(t){var i,s=e(t),n=s.find(".sp-more-teams-division-team-tile"),a=n.length,o=100/a;i=parseInt(this.$viewport.width(),0),s.width(i),n.each(function(){e(this).width(o+"%")})},this)},_setupTicks:function(){var i=this.$navBelt,s=i.find(".sp-more-teams-nav-indicator-tick"),n=s.eq(0).width(),a=s.length-1;t.each(s,function(t,s){var o=i.width()/a*s-n/2;e(t).css("left",o+"px")},this)},onArrowClick:function(t){var i,s=e(t.currentTarget),n=this.divisionsCount-1;t.preventDefault(),s.hasClass("sp-more-teams-prev-arrow")?(i=this.currentDivisionIndex-1,n>i&&this.scrollTo(i)):(i=this.currentDivisionIndex+1,i>0&&this.scrollTo(i))},onPaginationLinkClick:function(t){var i=this.$paginationLinks.index(e(t.currentTarget));t.preventDefault(),this.scrollTo(i)},scrollTo:function(e){var i,s=this.$divisions.eq(e),n=this.divisionsCount-1;s.hasClass("active")||(i=this.getAnimPosition(e),this.$divisions.removeClass("active"),this.$arrows.show(),0===n?(this.$arrows.filter(".sp-more-teams-next-arrow").hide(),this.$arrows.filter(".sp-more-teams-prev-arrow").hide()):e===n?this.$arrows.filter(".sp-more-teams-next-arrow").hide():0===e&&this.$arrows.filter(".sp-more-teams-prev-arrow").hide(),this.moveScroller(i).done(t.bind(function(){s.addClass("active"),this.moveIndicator(e)},this)),this.currentDivisionIndex=e)},moveScroller:function(i){return e.Deferred(t.bind(function(e){this.$scroller.stop().animate({left:i+"px"},200,"easeInOutQuad",function(){e.resolve()})},this))},moveIndicator:function(e){var t,i=this.$navItems.length-1;t=this.$navBelt.width()/i*e-this.$indicator.width()/2,this.$indicator.stop().animate({left:t+"px"},100,"linear"),this.$paginationLinks.removeClass("sp-more-teams-nav-item-link-active"),this.$paginationLinks.eq(e).addClass("sp-more-teams-nav-item-link-active")},getAnimPosition:function(e){return-1*this.$viewport.outerWidth()*e},destroy:function(e){this.$win.off("."+this.cid),s.prototype.destroy.call(this,e)}});return a}),define("modules/interactive-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(e,t,i,s,n,a){var o=i.extend({events:{"click .story-poll-choices .story-poll-vote-btn":"registerVote","click .story-poll-results-btn":"revealResults","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.poll_id=this.$el.attr("data-pollid"),this.user_id="unauthenticated",e.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var s=this.$(".quickpoll-results"),n=this.$(".story-poll-choices"),o=this.$(".story-poll-chart"),r="/polls/get/"+this.poll_id+"/";a.fetchData(r).done(t.bind(function(a){var r=t.pluck(a[0].answer,"count"),l=t.reduce(r,function(e,t){return e+parseFloat(t)},0),h=0===l?!0:!1,d=0;isNaN(i)||(l+=1,e.cookie(this.poll_id,!0)),t.each(a[0].answer,function(e,t){var s;h?s=i==t?100:0:(i==t+1&&(e.count+=1),s=Math.round(parseFloat(e.count)/l*100)),d+=s,e.percent=s,e.percent_width=.8*s});var c=t.template(s.html(),{data:a[0],total:l});n.hide(),o.html(c).fadeIn(),e.cookie(this.poll_id)&&e(".poll-vote-results .story-poll-vote-wrapper").hide(),o.css("height","auto")},this))},registerVote:function(){var e=this.$(".story-poll-answer:checked").val(),i="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+e+"/";return a.fetchData(i,{method:"post"}).done(t.bind(function(t){t&&(s.trigger("uotrack","pollvote"),this.revealResults(e))},this)),!1},revealChoices:function(){var e=this.$(".story-poll-choices"),t=this.$(".story-poll-chart");t.hide(),e.fadeIn()}});return o}),define("user-accounts/firefly-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","utils","third-party-apis/firefly/firefly","cookie"],function(e,t,i,s,n,a,o){"use strict";var r=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},n.registerAccount(this),n.loginUser("firefly")},_handleGetUserInfo:function(){return o.getUserInfo().done(t.bind(function(e){this.user=e},this))},_handleGetCoreUserInfo:function(){return o.getUserInfo().then(t.bind(function(e){for(var t={CoreUserId:a.getNested(e,"userService","coreUserId"),AtyponSessionKey:this.getUserToken(),GooglePlusId:void 0,AtyponId:e.userId,UserLicenseType:e.userLicenseType,FaceBookId:void 0,FileMobileId:void 0},i=a.getNested(e,"userService","identities")||[],s=0;s<i.length;s++){var n=i[s];"Facebook"===n.ProviderName?t.FaceBookId=n.ProviderUserId:"Google"===n.ProviderName?t.GooglePlusId=n.ProviderUserId:"Filemobile"===n.ProviderName&&(t.FileMobileId=n.ProviderUserId)}return t},this))},getUserInfo:function(){return o.getUserInfo()},getGupUserInfo:function(){return o.getGupUserInfo()},getViewsCookie:function(){return o.getFireflyViewsCookie()||{}},_handleLogin:function(e){var i;return i=e?"getLoginStatus":"loginUser",o[i]().then(t.bind(function(){return this._handleGetUserInfo()},this),t.bind(function(){this.logout()},this))},_handleLogout:function(){return this.getUserToken()?o.logoutUser(this.sessionToken):e.Deferred().resolve()},getName:function(){return"firefly"},getUserToken:function(){return e.cookie("sessionKey")},getUserId:function(){return this.user.userId},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.firstName},getUserLastName:function(){return this.user.lastName}});return new r}),define("modules/global/expired-card",["jquery","underscore","baseview","pubsub","state","utils"],function(e,t,i,s,n,a){var o=i.extend({events:{"click .cc-close_modal_link, .cc-remind-later-link":"close","click .cc-payment-button":"updatePaymentClick"},initialize:function(e){this.licenseId=e.licenseId||"",this.body=a.get("body"),n.registerFullScreenView(this),this.buildModal()},buildModal:function(){var t=this;n.fetchHtml("/services/expired-license/").done(function(i){t.modal_html=i,t.body.append(i),t.m_uiModal=e("#cc_modal"),t.m_uiModalBgrnd=e("#lightbox"),t.m_uiModal.show(),t.m_uiModalBgrnd.fadeIn(300),t.setElement("#cc_modal")})},updatePaymentClick:function(e){e.preventDefault(),a.openPopup(e.currentTarget.href+"?licenseId="+this.licenseId,screen.width,screen.height),this.close()},close:function(){if(this.m_uiModal){this.setLocalTimestamp(),n.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.modal_html=null}},setLocalTimestamp:function(){var e=new Date;localStorage["expired-credit-card"]=e.getTime()},destroy:function(e){this.modal_html&&this.modal_html.remove(),i.prototype.destroy.call(this,e)}});return o}),define("modules/users/site-nav-firefly-module",["jquery","underscore","modules/header/site-nav-dropdown","pubsub","utils","user-manager","state","user-accounts/firefly-user-account","modules/global/expired-card","admanager"],function(e,t,i,s,n,a,o,r,l,h){"use strict";var d=i.extend({events:{"click .ff-insider":"onClickInsider",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(e){this.pubSub={"page:load":this.updateRedirectURLs,"user:statuschange":this.showLoggedInStatus},this.$siteNavDropdown=this.$(".site-nav-dropdown"),this.$navSpan=this.$(".site-nav-firefly-span"),this.$name=this.$(".site-nav-firefly-user-display-name"),h.getActiveSlotStatistics().done(t.bind(function(e){if(!this.destroyed&&!e.high_impact&&"loggedIn"==a.getLoginStatus()&&n.getNested(window.site_vars,"flags","expired_credit_card_modal")){var i=a.getAccount("firefly");i&&i.getUserInfo().done(t.bind(function(e){this.destroyed||this.checkCreditCardStatus(e)},this))}},this)),i.prototype.initialize.call(this,e)},updateRedirectURLs:function(){var t=n.getPageUrl(),i="?onSuccessRedirectURL="+encodeURIComponent(t);e(".sam-returns").each(function(t,s){var n=e(s),a=n.attr("href");if("string"==typeof a){var o=a.split(/[\?\&]/),r="";o.length>2&&(r="&"+o.slice(2).join("&")),n.attr("href",o[0]+i+r)}})},showLoggedInStatus:function(e,t,i){"firefly"===e&&(this.$navSpan&&this.$navSpan.addClass("loaded"),"loggedIn"===t?this.showLoggedInUser(i):"loggingIn"!==t&&this.showLoggedOutUser())},checkCreditCardStatus:function(e){if(!e)return!1;var i=new Date;if(i.getTime()<parseInt(localStorage.getItem("expired-credit-card"))+864e5)return!1;var s,a=n.getNested(window.site_vars,"market_id"),o=e.licenses;t.each(o,function(e){e.marketId==a&&(s=e)}),this._verifyExpiredLicense(s)&&this._setupExpiredCardSubview(s.licenseId)},onClickInsider:function(){s.trigger("uotrack","myaccount|insider")},_verifyExpiredLicense:function(e){var t=new Date;return e&&e.creditCardExpirationMonth&&e.creditCardExpirationYear?e.lastPaymentFailed?!0:t.getFullYear()>parseInt(e.creditCardExpirationYear,10)?!0:t.getFullYear()==parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>e.creditCardExpirationMonth?!0:t.getFullYear()>=parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>=e.creditCardExpirationMonth&&t.getDate()>=15?!0:!1:!1},_setupExpiredCardSubview:function(e){this.subviews.expiredcard=new l({licenseId:e})},showLoggedOutUser:function(){this.$siteNavDropdown.removeClass("authenticated subscribed"),this.$name.html("")},showLoggedInUser:function(e){var t=a.getAccount("firefly");this.$siteNavDropdown.addClass("authenticated"),e.hasMarketAccess&&this.$siteNavDropdown.addClass("subscribed"),this.$name.html(t.getUserFirstName()+" "+t.getUserLastName())}});return d}),define("modules/travel/travel-featured-content",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,a){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=e(this.$el).find(".travel-featured-content-wrapper"),this.viewport=this.moveMe.parent(),this.slides=e(this.$el).find(".travel-featured-content-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.slides.length>1&&(this.subviews.paginator=new a({el:e(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("form/dropdown",["jquery","underscore","form/base-form-element","ui/dropdown"],function(e,t,i,s){"use strict";var n=i.extend({events:{change:"onChange"},initialize:function(n){n=e.extend({onSelect:null,dropdownContentClass:null},n),t.bindAll(this,"refresh","onDivDropdownSelect"),this.$el.hide(),this.selectOptionItems=this.$("option"),this.dropdownDiv=this._buildDropdownHtml(this.selectOptionItems),this.$el.attr("tabindex","-1"),this.dropdownDiv.insertAfter(this.$el),i.prototype.initialize.call(this,n),this.subviews.dropdown=new s({el:this.dropdownDiv,onSelect:this.onDivDropdownSelect})},_buildDropdownHtml:function(t){var i=e('<div class="'+this.$el.attr("class")+'"></div>');this.options.dropdownContentClass&&i.addClass(this.options.dropdownContentClass);var s=e('<div class="ui-dropdown-value ui-btn"></div>'),n=e('<div class="ui-dropdown-content"></div>'),a=this._buildDropdownHtmlItems(t);return i.attr("class",this.$el.attr("class")),i.attr("tabindex",this.$el.attr("tabindex")||0),i.append(s).append(n),n.append(a),i},_buildDropdownHtmlItems:function(i){var s=e('<ul class="ui-dropdown-items-container"></ul>');return i.each(t.bind(function(t,i){var n=e(i),a=n.val(),o=n.html(),r=e('<li class="ui-dropdown-item" data-value="'+a+'">'+o+"</li>");n.is(":selected")&&r.attr("data-selected","selected"),s.append(r)},this)),s},refresh:function(t){var i=this._buildDropdownHtmlItems(e(t));this.subviews.dropdown.refresh(i.html()),this.$el.html(t)},getUIElement:function(){return this.dropdownDiv},getType:function(){return"dropdown"},reset:function(){this.subviews.dropdown.reset(),this.$el.val("")},onDivDropdownSelect:function(e,t,i){this.$el.val(e),this.options.onSelect&&this.options.onSelect(e,t,i)},onChange:function(){this.subviews.dropdown.setValue(this.$el.val())},destroy:function(e){this.dropdownDiv.remove(),i.prototype.destroy.call(this,e)}});return n}),define("form/checkbox",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{click:"onCheckboxInputClick"},initialize:function(s){s=e.extend({onClick:null},s),i.prototype.initialize.call(this,s),t.bindAll(this,"onCheckboxClick"),this.checkboxDiv=this._buildDivCheckbox(this.$el),this.isCheckedByDefault=this.$el.is(":checked")},_buildDivCheckbox:function(i){var s=e('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-checkbox-checked"),i.is(":disabled")&&s.addClass("ui-checkbox-disabled"),s.on("keydown."+this.cid+" click."+this.cid,t.bind(function(e){"keydown"===e.type?this.onKeyDown(e):this.onCheckboxClick(e)},this));var a=i.attr("tabindex");i.attr("tabindex","-1"),a?s.attr("tabindex",a):s.attr("tabindex","0");var o=this._buildDivCheckboxLabel(n);return s.append(o),n.hide(),s.insertAfter(i),s},_buildDivCheckboxLabel:function(t){var i=e('<span class="ui-checkbox-label"></span>');return i.text(t.length?t.text():this.$el.val()),i},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;(32===t||13===t)&&(e.preventDefault(),this.onCheckboxClick(e))},check:function(){this.checkboxDiv.addClass("ui-checkbox-checked"),this.$el.prop("checked",!0)},unCheck:function(){this.checkboxDiv.removeClass("ui-checkbox-checked"),this.$el.prop("checked",!1)},onCheckboxClick:function(){var e;this.checkboxDiv.hasClass("ui-checkbox-checked")?(this.unCheck(),e=!1):(this.check(),e=!0),this.options.onClick&&this.options.onClick(this.checkboxDiv,e)},getUIElement:function(){return this.checkboxDiv},getType:function(){return"checkbox"},reset:function(){this.isCheckedByDefault?this.check():this.unCheck()},onCheckboxInputClick:function(e){this.onCheckboxClick(e)},destroy:function(e){this.checkboxDiv.off("."+this.cid),this.checkboxDiv.remove(),i.prototype.destroy.call(this,e)}});return s}),define("form/radio-button",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{click:"onRadioInputClick"},initialize:function(t){t=e.extend({onClick:null},t),i.prototype.initialize.call(this,t),this.radioDiv=this._buildDivRadio(this.$el)},_buildDivRadio:function(i){var s=e('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-radio-selected"),i.is("disabled")&&s.addClass("ui-radio-disabled"),s.on("keydown."+this.cid+" click."+this.cid,t.bind(function(e){"keydown"===e.type?this.onKeyDown(e):this.onRadioClick(e)},this));var a=i.attr("tabindex");i.attr("tabindex","-1"),a?s.attr("tabindex",a):s.attr("tabindex","0");var o=this._buildDivRadioLabel(n);return s.append(o),n.hide(),s.insertAfter(i),s},_buildDivRadioLabel:function(t){var i=e('<span class="ui-radio-label"></span>');return i.text(t.length?t.text():this.$el.val()),i},select:function(){this.radioDivs||(this.radioDivs=this.$el.closest("form").find("div.ui-radio[data-name="+this.$el.attr("name")+"]")),this.radioDivs.removeClass("ui-radio-selected"),this.radioDiv.addClass("ui-radio-selected"),this.options.onClick&&this.options.onClick(this.radioDiv)},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;(32===t||13===t)&&(e.preventDefault(),this.onRadioClick(e))},onRadioClick:function(e){e.preventDefault(),this.radioDiv.hasClass("ui-radio-selected")||(this.select(),this.$el.prop("checked",!0))},onRadioInputClick:function(e){this.onRadioClick(e)},getUIElement:function(){return this.radioDiv},getType:function(){return"radio"},destroy:function(e){this.radioDiv.off("."+this.cid),this.radioDiv.remove(),i.prototype.destroy.call(this,e)}});return s}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/core",["jquery"],e):e(jQuery)}(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;n<a.length;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/datepicker",["jquery","./core"],e):e(jQuery)}(function(e){function t(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
}function s(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",n)}function n(){e.datepicker._isDisabledDatepicker(o.inline?o.dpDiv.parent()[0]:o.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function a(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}e.extend(e.ui,{datepicker:{version:"1.11.1"}});var o;return e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return a(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;n<e.length;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,o){var r,l,h,d,c,u=this._dialogInst;return u||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),u=this._dialogInst=this._newInst(this._dialogInput,!1),u.settings={},e.data(this._dialogInput[0],"datepicker",u)),a(u.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(u,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,h/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",u),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,o,r,l,h=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):h?"all"===i?e.extend({},h.settings):this._get(h,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),void(h&&(this._curInst===h&&this._hideDatepicker(),o=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),a(h.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(h.settings.minDate=this._formatDate(h,r)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),h),this._autoSize(h),this._setDate(h,o),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(i){if(i=i.target||i,"input"!==i.nodeName.toLowerCase()&&(i=e("input",i.parentNode)[0]),!e.datepicker._isDisabledDatepicker(i)&&e.datepicker._lastInput!==i){var s,n,o,r,l,h,d;s=e.datepicker._getInst(i),e.datepicker._curInst&&e.datepicker._curInst!==s&&(e.datepicker._curInst.dpDiv.stop(!0,!0),s&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(s,"beforeShow"),o=n?n.apply(i,[i,s]):{},o!==!1&&(a(s.settings,o),s.lastVal=null,e.datepicker._lastInput=i,e.datepicker._setDateFromField(s),e.datepicker._inDialog&&(i.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(i),e.datepicker._pos[1]+=i.offsetHeight),r=!1,e(i).parents().each(function(){return r|="fixed"===e(this).css("position"),!r}),l={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(s),l=e.datepicker._checkOffset(s,l,r),s.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),s.inline||(h=e.datepicker._get(s,"showAnim"),d=e.datepicker._get(s,"duration"),s.dpDiv.css("z-index",t(e(i))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[h]?s.dpDiv.show(h,e.datepicker._get(s,"showOptions"),d):s.dpDiv[h||"show"](h?d:null),e.datepicker._shouldFocusInput(s)&&s.input.focus(),e.datepicker._curInst=s))}},_updateDatepicker:function(t){this.maxRows=4,o=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),a=s[1],r=17,l=t.dpDiv.find("."+this._dayOverClass+" a");l.length>0&&n.apply(l.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),a>1&&t.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",r*a+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),h=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+a>h&&h>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var n,a,o,r,l=0,h=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),c=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,u=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,b=-1,y=!1,w=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},_=function(e){var t=w(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=new RegExp("^\\d{"+n+","+s+"}"),o=i.substring(l).match(a);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},C=function(t,s,n){var a=-1,o=e.map(w(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(l,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],l+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;n<t.length;n++)if(y)"'"!==t.charAt(n)||w("'")?x():y=!1;else switch(t.charAt(n)){case"d":v=_("d");break;case"D":C("D",c,u);break;case"o":b=_("o");break;case"m":m=_("m");break;case"M":m=C("M",p,f);break;case"y":g=_("y");break;case"@":r=new Date(_("@")),g=r.getFullYear(),m=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((_("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,v=r.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(l<i.length&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=g?0:-100)),b>-1)for(m=1,v=b;;){if(a=this._getDaysInMonth(g,m-1),a>=v)break;m++,v-=a}if(r=this._daylightSavingAdjust(new Date(g,m-1,v)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=s+1<e.length&&e.charAt(s+1)===t;return i&&s++,i},h=function(e,t,i){var s=""+t;if(l(e))for(;s.length<i;)s="0"+s;return s},d=function(e,t,i,s){return l(e)?s[t]:i[t]},c="",u=!1;if(t)for(s=0;s<e.length;s++)if(u)"'"!==e.charAt(s)||l("'")?c+=e.charAt(s):u=!1;else switch(e.charAt(s)){case"d":c+=h("d",t.getDate(),2);break;case"D":c+=d("D",t.getDay(),n,a);break;case"o":c+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=h("m",t.getMonth()+1,2);break;case"M":c+=d("M",t.getMonth(),o,r);break;case"y":c+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?c+="'":u=!0;break;default:c+=e.charAt(s)}return c},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=t+1<e.length&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;t<e.length;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":r+=parseInt(h[1],10);break;case"w":case"W":r+=7*parseInt(h[1],10);break;case"m":case"M":o+=parseInt(h[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(h[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}h=l.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"===o.toString()?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,l,h,d,c,u,p,f,g,m,v,b,y,w,_,C,x,S,k,T,$,A,D,P,I,M,L,E,F,N,R,B,O,z=new Date,j=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth(),z.getDate())),H=this._get(e,"isRTL"),U=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),G=this._get(e,"showCurrentAtPos"),Y=this._get(e,"stepMonths"),X=1!==V[0]||1!==V[1],Z=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),K=this._getMinMaxDate(e,"min"),J=this._getMinMaxDate(e,"max"),Q=e.drawMonth-G,et=e.drawYear;if(0>Q&&(Q+=12,et--),J)for(t=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-V[0]*V[1]+1,J.getDate())),t=K&&K>t?K:t;this._daylightSavingAdjust(new Date(et,Q,1))>t;)Q--,0>Q&&(Q=11,et--);for(e.drawMonth=Q,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Q-Y,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Q+Y,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?Z:j,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",h=U?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(H?l:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(H?"":l)+"</div>":"",d=parseInt(this._get(e,"firstDay"),10),d=isNaN(d)?0:d,c=this._get(e,"showWeek"),u=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),g=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),b=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),w="",C=0;C<V[0];C++){for(x="",this.maxRows=4,S=0;S<V[1];S++){if(k=this._daylightSavingAdjust(new Date(et,Q,e.selectedDay)),T=" ui-corner-all",$="",X){if($+="<div class='ui-datepicker-group",V[1]>1)switch(S){case 0:$+=" ui-datepicker-group-first",T=" ui-corner-"+(H?"right":"left");break;case V[1]-1:$+=" ui-datepicker-group-last",T=" ui-corner-"+(H?"left":"right");break;default:$+=" ui-datepicker-group-middle",T=""}$+="'>"}for($+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===C?H?a:s:"")+(/all|right/.test(T)&&0===C?H?s:a:"")+this._generateMonthYearHeader(e,Q,et,K,J,C>0||S>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",_=0;7>_;_++)D=(_+d)%7,A+="<th scope='col'"+((_+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+u[D]+"'>"+p[D]+"</span></th>";for($+=A+"</tr></thead><tbody>",P=this._getDaysInMonth(et,Q),et===e.selectedYear&&Q===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,P)),I=(this._getFirstDayOfMonth(et,Q)-d+7)%7,M=Math.ceil((I+P)/7),L=X&&this.maxRows>M?this.maxRows:M,this.maxRows=L,E=this._daylightSavingAdjust(new Date(et,Q,1-I)),F=0;L>F;F++){for($+="<tr>",N=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(E)+"</td>":"",_=0;7>_;_++)R=m?m.apply(e.input?e.input[0]:null,[E]):[!0,""],B=E.getMonth()!==Q,O=B&&!b||!R[0]||K&&K>E||J&&E>J,N+="<td class='"+((_+d+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(E.getTime()===k.getTime()&&Q===e.selectedMonth&&e._keyEvent||y.getTime()===E.getTime()&&y.getTime()===k.getTime()?" "+this._dayOverClass:"")+(O?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!v?"":" "+R[1]+(E.getTime()===Z.getTime()?" "+this._currentClass:"")+(E.getTime()===j.getTime()?" ui-datepicker-today":""))+"'"+(B&&!v||!R[2]?"":" title='"+R[2].replace(/'/g,"&#39;")+"'")+(O?"":" data-handler='selectDay' data-event='click' data-month='"+E.getMonth()+"' data-year='"+E.getFullYear()+"'")+">"+(B&&!v?"&#xa0;":O?"<span class='ui-state-default'>"+E.getDate()+"</span>":"<a class='ui-state-default"+(E.getTime()===j.getTime()?" ui-state-highlight":"")+(E.getTime()===Z.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+"' href='#'>"+E.getDate()+"</a>")+"</td>",E.setDate(E.getDate()+1),E=this._daylightSavingAdjust(E);$+=N+"</tr>"}Q++,Q>11&&(Q=0,et++),$+="</tbody></table>"+(X?"</div>"+(V[0]>0&&S===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=$}w+=x}return w+=h,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var l,h,d,c,u,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),b=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",w="";if(a||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;12>d;d++)(!l||d>=s.getMonth())&&(!h||d<=n.getMonth())&&(w+="<option value='"+d+"'"+(d===t?" selected='selected'":"")+">"+r[d]+"</option>");w+="</select>"}if(b||(y+=w+(!a&&m&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(c=this._get(e,"yearRange").split(":"),u=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?u+parseInt(e,10):parseInt(e,10);return isNaN(t)?u:t},f=p(c[0]),g=Math.max(f,p(c[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),b&&(y+=(!a&&m&&v?"":"&#xa0;")+w),y+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,l=this._get(e,"yearRange");
return l&&(i=l.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||t.getFullYear()<=r)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.1",e.datepicker}),define("form/datepicker",["jquery","underscore","form/base-form-element","managers/routemanager","utils","libs/jqueryui/datepicker"],function(e,t,i,s,n){"use strict";var a=i.extend({el:".ui-date-picker",initialize:function(s){t.bindAll(this,"show","hide","onButtonClick","onCalendarDateSelect","setDate"),s.onSelect&&(s.customOnSelect=s.onSelect),s.onSelect=this.onCalendarDateSelect,this._setupDatePicker(this.$el,s),s=e.extend({calendarPanelClass:"ui-light",urlPath:this.$el.data("url-path")},s),s.buttonSelector&&(this.button=this._setupButton(s.buttonSelector)),this.body=n.get("body"),this.calendarPanel=this.body.find("#ui-datepicker-div"),this.calendarPanel.addClass(s.calendarPanelClass+" ui-date-picker-calendar-panel"),i.prototype.initialize.call(this,s)},onCalendarDateSelect:function(i,n){var a=this.options.urlPath,o=new Date(n.selectedYear,n.selectedMonth,n.selectedDay);if(a){if(-1!==a.indexOf("<%=")){var r=a.split("<%=");r.shift();for(var l={},h=0;h<r.length;h++){var d=r[h].match("[a-zA-Z]+")[0];l[d]=e.datepicker.formatDate(d,o)}a=t.template(a,l)}s.goTo(a)}this.options.customOnSelect&&this.options.customOnSelect(i,n)},setDate:function(t,i){t=i?e.datepicker.formatDate(i,t):e.datepicker.formatDate(this.options.dateFormat,t),this.$el.datepicker("setDate",t)},show:function(){this.$el.datepicker("show")},hide:function(){this.$el.datepicker("hide")},_setupDatePicker:function(e,t){e.datepicker(t)},_setupButton:function(i){var s=e(i);return s.on("click."+this.cid,t.bind(function(){this.onButtonClick()},this)),s},onButtonClick:function(){this.show(),this.options.onButtonClick&&this.options.onButtonClick(this.button,this.$el)},getType:function(){return"datepicker"},destroy:function(){this.button&&this.button.off("."+this.cid),this.$el.datepicker("destroy"),i.prototype.destroy.apply(this,arguments)}});return a}),define("form/base-form",["jquery","underscore","baseview","form/input-field","form/autocomplete","form/dropdown","form/checkbox","form/radio-button","form/datepicker"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=i.extend({events:{submit:"onFormSubmit"},initialize:function(h){h=e.extend({formOptions:null},h),this.formNameMap={},i.prototype.initialize.call(this,h),this.$formItems=this.$(".ui-text-input, .ui-textarea, .ui-dropdown, .ui-radio, .ui-checkbox, .ui-date-picker"),this.$formItems.each(t.bind(function(t,i){var h,d=e(i);this.options.formOptions&&(h=this._getCustomOptions(d,this.options.formOptions)),!d.hasClass("ui-text-input")&&!d.hasClass("ui-textarea")||d.hasClass("ui-date-picker")?d.hasClass("ui-dropdown")?this._setupView(d,a,t,h):d.hasClass("ui-radio")?this._setupView(d,r,t,h):d.hasClass("ui-checkbox")?this._setupView(d,o,t,h):d.hasClass("ui-date-picker")&&this._setupView(d,l,t,h):d.data("autocomplete-url")||d.hasClass("ui-autocomplete")?this._setupView(d,n,t,h):this._setupView(d,s,t,h)},this)),this._setupRequiredFields()},_getCustomOptions:function(i,s){return e.isArray(s)||(s=[s]),t.filter(s,function(t){return i[0]===e(t.el)[0]?!0:!1})[0]},_setupRequiredFields:function(){t.each(this.subviews,function(e){e.isRequired()&&e.getUIElement().addClass("ui-form-field-required")})},getFormObjectsByName:function(e){return this.formNameMap[e]},_setupView:function(e,t,i,s){s||(s={el:e});var n="formItem"+i,a=e.attr("name");this.subviews[n]=new t(s),this.formNameMap[a]?this.formNameMap[a].push(this.subviews[n]):this.formNameMap[a]=[this.subviews[n]]},_handlePlaceholders:function(i){var s=[];e.each(i,function(t,i){var n=e(i),a=n.val();a===n.attr("placeholder")&&(s.push({field:n,value:a}),n.val(""))}),t.defer(function(){t.each(s,function(e){e.field.val(e.value)})})},onFormSubmit:function(){if(!Modernizr.input.placeholder){var e=this.$('[placeholder*=""]');e&&this._handlePlaceholders(e)}},resetForm:function(){this.reset()},reset:function(){this.triggerEvent("reset")}});return h}),define("modules/travel/tripology",["jquery","underscore","baseview","state","pubsub","form/base-form"],function(e,t,i,s,n,a){"use strict";var o=i.extend({el:".tripology-wrapper",events:{},initialize:function(e){t.bindAll(this,"departureSelect","arriveSelect"),i.prototype.initialize.call(this,e),this.$tripologyForm=this.$(".tripology-form"),this.departBoxName=this.$("#depart_loc"),this.departBoxID=this.$("#depart_loc_1"),this.destinationBoxName=this.$("#arrive_loc"),this.destinationBoxID=this.$("#arrive_loc_1"),this.pinfo=s.getActivePageInfo(),this.section=this.pinfo.section_name,this._setupForm(),this.$("form").submit(function(){n.trigger("uotrack","tripologysearch")})},_setupForm:function(){var i=[],s=this;i.push({el:e(".depart.tripology-auto"),resultDisplayTemplate:"<%= displayname %>",onSelect:s.departureSelect,maxResults:5,ajaxOptions:{dataType:"jsonp"},onParseResults:s.formatResults}),i.push({el:e(".arrive.tripology-auto"),resultDisplayTemplate:"<%= displayname %>",onSelect:s.arriveSelect,maxResults:5,ajaxOptions:{dataType:"jsonp"},onParseResults:s.formatResults}),this.$(".ui-date-picker").each(t.bind(function(t,s){var n=e(s),a=n.parent().find(".ui-date-picker-btn");i.push({el:n,buttonSelector:a,calendarPanelClass:"ui-light",changeMonth:!0,changeYear:!0,minDate:null,maxDate:null,showOtherMonths:!0,selectOtherMonths:!0,showMonthAfterYear:!0,dateFormat:"m/d/yy",dayNamesMin:["S","M","T","W","T","F","S"]})},this)),this.$tripologyForm.each(t.bind(function(t,s){this.subviews["form"+t]=new a({el:e(s),formOptions:i})},this)),this.$tripologyForm.submit(function(){return s.tripologyFormSubmit(),!1});var n=new Date,o=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear();this.$(".trip-depart").val("Depart: "+o),this.$(".trip-return").val("Return: "+o)},tripologyFormSubmit:function(){var t=(e(".tripology-form").serializeArray(),e(".tripology-form :input")),i={};t.each(function(){i[this.name]=e(this).val()});var s=i.departure_date.replace("Depart: ",""),n=i.return_date.replace("Return: ",""),a=new Date(s),o=new Date(n),r=Math.abs(o.getTime()-a.getTime()),l=Math.ceil(r/864e5),h="http://www.tripology.com/trip/step1/?",d=(i.departure_location_0,i.departure_location_1),c=(i.destination_0,i.destination_1),u=s,p=l||1,f=e("#flights_box").is(":checked"),g=e("#cruise_box").is(":checked"),m=e("#hotels_box").is(":checked"),v=e("#transportation_box").is(":checked"),b=e("#cars_box").is(":checked");d&&(h+="&departure_location_1="+d),c&&(h+="&destination_1="+c),u&&(h+="&departure_date="+u),p&&(h+="&duration="+p),f&&(h+="&flight=on"),g&&(h+="&cruise=on"),m&&(h+="&hotel=on"),(v||b)&&(h+="&transportation=on"),window.open(h)},formatResults:function(e){var i=[];return t.each(e,function(e){var t=e[0],s=e[1],n={displayname:t,id:s};i.push(n)}),i},departureSelect:function(e,t){this.departBoxName.val(t.displayname),this.departBoxID.val(t.id)},arriveSelect:function(e,t){this.destinationBoxName.val(t.displayname),this.destinationBoxID.val(t.id)}});return o}),define("modules/stories/utility-bar-flyout",["jquery","underscore","backbone","baseview","pubsub","utils","managers/routemanager","site-manager","modules/scroller/vertical-scroll"],function(e,t,i,s,n,a,o,r,l){var h=s.extend({events:{"click .util-bar-flyout-close-ribbon":"close",click:"onClickFlyout"},initialize:function(e){t.bindAll(this,"onBodyClick","onWindowResize"),this.$body=a.get("body"),this.$win=a.get("win"),this.$flyout=this.$(".util-bar-flyout"),this.pubSub=this.pubSub||{},this.pubSub["breakingbar:after:open"]=this.onWindowResize,s.prototype.initialize.call(this,e)},onWindowResize:function(){var e=this.getAvailableVerticalSpace();this.updateFlyoutHeight(e),this.options.noFlyoutScroll||this.updateFlyoutScroller()},getAvailableVerticalSpace:function(){var e=r.getHeader(),t=0;return e&&e.isFixed()===!0?t=e.getCollapsedHeight():e&&e.isFixed()===!1&&(t=e.getCurrentHeight()),this.$win.height()-t},getContentHeight:function(){return this.$scrollableContent.outerHeight()},updateFlyoutHeight:function(e){this.$flyout.css("height",e)},updateFlyoutScroller:function(){this.subviews.vscroll?this.subviews.vscroll.refresh():this.subviews.vscroll=new l({el:this.$flyout})},open:function(e){this.$scrollableContent=this.$(".scrollable-content").eq(0),this.$(".util-bar-btn").removeClass("active"),this.$btn=this.$(e?".util-bar-btn-"+e:".util-bar-btn"),this.$btn.addClass("active"),this.$body.on("click."+this.cid,this.onBodyClick),this.$win.on("resize."+this.cid,t.throttle(this.onWindowResize,50)),this.$flyout.css({left:40,visibility:"visible"}).addClass("open"),e&&this.showSection("share"==e?"facebook":e),this.onWindowResize(),e&&n.trigger("uotrack","utilitybar"+e+"open")},close:function(){this.destroy()},onBodyClick:function(t){var i=e(t.target);i.hasClass("util-bar-noclose")||(!t.isDefaultPrevented()||o.isAjax(i.attr("href")))&&this.close()},onClickFlyout:function(t){var i=e(t.target);i.hasClass("util-bar-noclose")||i.closest("a").attr("href")||t.preventDefault()},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),this.$btn&&this.$btn.removeClass("active"),this.$flyout.css({left:"-1000px",visibility:"hidden"}).removeClass("open"),s.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return h}),define("modules/stories/utility-bar-module-firefly",["jquery","underscore","backbone","pubsub","third-party-apis/firefly/firefly","modules/stories/utility-bar-flyout","directAdPosition","state","utils","user-manager"],function(e,t,i,s,n,a,o,r,l,h){"use strict";var d=a.extend({initialize:function(i){i=e.extend({noFlyoutScroll:!0},i),t.bindAll(this,"fireflyFlyoutAdReady"),this.events=t.extend({},a.prototype.events,this.events),this.$title=this.$(".util-bar-flyout-firefly-title"),this.$subBtn=this.$(".util-bar-flyout-firefly-subscribe-btn"),this.$fireflyFlyoutAd=this.$(".util-bar-flyout-firefly-ad"),this.messaging=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutMessageOverrides"),this.gps_tracking=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","gps"),this.viewsCookie=n.getFireflyViewsCookie(),a.prototype.initialize.call(this,i),this._buildSpecialOffersFireflyFlyoutAd()},_buildSpecialOffersFireflyFlyoutAd:function(){var e=h.getAccount("firefly");this.subviews.fireflyFlyoutAd||(e?e.getUserInfo().done(t.bind(function(e){e.hasMarketAccess||this._applySpecialOffersDirectPositionAd()},this)).fail(t.bind(function(){this._applySpecialOffersDirectPositionAd()},this)):this._applySpecialOffersDirectPositionAd())},_applySpecialOffersDirectPositionAd:function(){this.subviews.fireflyFlyoutAd=new o({el:this.$fireflyFlyoutAd,targeting:{pwvr:this.viewsCookie?this.viewsCookie.viewsRemaining.toString():"0"},adSizes:[264,200],adPlacement:"consumer_sales-flyout",onAdReady:this.fireflyFlyoutAdReady})},fireflyFlyoutAdReady:function(){this.$subBtn.addClass("hidden"),this.$fireflyFlyoutAd.removeClass("hidden"),this.subviews.fireflyFlyoutAd.showAd()},setTitle:function(e,t){this.$title.text(e),t?this.$title.addClass("util-bar-flyout-firefly-title-large"):this.$title.removeClass("util-bar-flyout-firefly-title-large")},setGPS:function(e){var t=this.$subBtn.attr("href");t=t.replace(/(gps-source)=.*/,"$1="+e),this.$subBtn.attr("href",t)},open:function(){if(s.trigger("uotrack","UtilityBarFireflyOpen"),this.viewsCookie)if(1===this.viewsCookie.viewCount)this.setTitle(this.messaging.first),this.setGPS(this.gps_tracking.first);else if(0===this.viewsCookie.viewsRemaining)this.setTitle(this.messaging.last),this.setGPS(this.gps_tracking.last);else{var e,i,n=this.viewsCookie.viewsRemaining,o=!1;o=t.find(l.getNested(this.messaging,"extra_overrides"),function(e){return e.view_remaining===n}),o?(e=o.message,i=this.gps_tracking.custom):(e=this.viewsCookie.viewsRemaining>1?this.viewsCookie.viewsRemaining+this.messaging.tweener:this.viewsCookie.viewsRemaining+this.messaging.tweener_singular,i=this.viewsCookie.viewsRemaining>1?this.gps_tracking.tweener:this.gps_tracking.tweener_singular),this.setTitle(e,!0),this.setGPS(i)}a.prototype.open.call(this)},close:function(){s.trigger("uotrack","UtilityBarFireflyClose"),this.destroy()}});return d}),define("modules/travel/shermans",["jquery","underscore","backbone","state","baseview"],function(e,t,i,s,n){"use strict";var a=n.extend({initialize:function(e){this.$dealsList=this.$(".shermans-deal-list"),this.$placeholder=this.$(".shermans-placeholder"),n.prototype.initialize.call(this,e),s.fetchData("http://api.deals.shermanstravel.com/v1/deals?consumer_key=8a3c1b45da1e6e8e919bd0d42d7a130e9bbaea645886122733bd7f23802f0b0c",{dataType:"jsonp"}).done(t.bind(function(e){this.displayDeals(e.deals)},this)).fail(t.bind(function(){this.$placeholder.html("No deals..")},this))},displayDeals:function(e){t.each(e,t.bind(function(e){e.title.length>45&&(e.title=e.title.slice(0,44)+"...");var t='<li><a href="'+e.url+'" target="_blank">'+e.title+"</a></li>";this.$dealsList.append(t)},this)),this.$placeholder.hide()}});return a}),define("modules/rentals-listing-row",["jquery","baseview","state","directAdPosition"],function(e,t,i,s){var n=t.extend({events:{"click .js-rlpm-more-apts":"scrollDownToMoreApartments"},initialize:function(){t.prototype.initialize.call(this);var e=this.$(".js-rlpm-ad-pos")[0],i=this.$(".js-rlpm-ad-pos")[1];e&&(this.subviews.adPositionOne=this.createAdPosition(e)),i&&(this.subviews.adPositionTwo=this.createAdPosition(i))},scrollDownToMoreApartments:function(){e("html, body").animate({scrollTop:this.$el.offset().top+this.$el.outerHeight(!0)+300},500)},handleCardSizeChange:function(e){e.sidebarOpen===!0?this.$(".js-rlpm-more-apts").addClass("rlpm-more-apts-hide"):this.$(".js-rlpm-more-apts").removeClass("rlpm-more-apts-hide")},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},createAdPosition:function(t){return new s({el:e(t),adSizes:[330,330],adPlacement:e(t).data("adtag"),subSection:"",pageInfo:i.getActivePageInfo()})}});return n}),define("modules/topics/topics-videos",["jquery","underscore","baseview","utils"],function(e,t,i,s){var n=i.extend({events:{"click .tpasvm-more-link":"onClickMore"},initialize:function(e){this.$moreLink=this.$(".tpasvm-more-link"),this.$moreWrap=this.$(".tpasvm-items-more"),i.prototype.initialize.call(this,e)},onClickMore:function(){if(this.$moreWrap.is(":visible"))this.$moreWrap.slideUp(),this.$moreLink.text("More Videos");else{this.$moreWrap.slideDown(),this.$moreLink.text("Less Videos");var e=this.$moreWrap.find(".tpavm-image");s.lazyLoadImage(e,"data-src",!0)}}});return n}),define("modules/fronts/sidebar-poster-ad",["jquery","underscore","baseview","pubsub","state","sharedAdPosition","directAdPosition"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({initialize:function(s){t.bindAll(this,"onSidebarAdReady");var n=this.$el;this.layoutType=this._getLayoutType(),s=e.extend({adType:n.attr("data-ad-type")||"sidebar",adPlacement:n.attr("data-ad-placement")||"poster_front",adSizes:n.attr("data-ad-sizes")||"mediumrectangle,halfpage"},s),i.prototype.initialize.call(this,s)},_initAds:function(){var e=this.options,t=e.adSizes;t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:n.getActivePageInfo(),adSizes:t,onAdReady:this.onSidebarAdReady,adType:e.adType};this.subviews.sidebarAd||(this.subviews.sidebarAd=new o(i))},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},onSidebarAdReady:function(){this.subviews.sidebarAd.showAd(),this.refreshSidebar()},refreshSidebar:function(){n.getActiveApp().triggerEvent("refreshSidebarScroll")},_onHideSidebarAd:function(){this.subviews.sidebarAd&&"sidebar"===this.layoutType&&(this.hide(),this.$(".sidebar-wrapper").css("top",0),this.refreshSidebar())},showHidePosterAds:function(e){e.belowHeroAd&&"primary"===this.layoutType&&"poster_front"==this.options.adPlacement&&this._initAds(),e.belowTheFoldAd&&"primary"===this.layoutType&&"poster_front_btf"==this.options.adPlacement&&this._initAds(),e.sidebarAds&&"sidebar"===this.layoutType?(this.show(),this._initAds()):this._onHideSidebarAd()},onCardWidthChange:function(e){this.showHidePosterAds(e)},renderCardInfo:function(e){this.showHidePosterAds(e)}});return r}),define("modules/travel/travel-guides",["jquery","underscore","baseview","state","utils","ui/generic-paginator","ui/dropdown"],function(e,t,i,s,n,a,o){var r=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=e(this.$el).find(".travel-gdc-wrapper"),this.viewport=this.moveMe.parent(),this.slides=e(this.$el).find(".travel-gdc-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.subviews.dropdown=new o({el:this.$(".travel-gdc-list")}),this.slides.length>1&&(this.subviews.paginator=new a({el:e(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return r}),define("modules/fronts/blog-promo",["jquery","underscore","baseview","state","utils","ui/generic-paginator","modules/fronts/featured-content"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({el:".blog-promo-module",events:{"click .blogs-show-all":"showAll","click .close-all-blogs":"showAll"},initialize:function(t){t=e.extend({transition:{interval:15e3},displayNum:4},t),i.prototype.initialize.call(this,t),this.$numberBlogs=this.$(".blog-promo-content-wrap").length,this.$numberBlogs>0?(this.$seeAllBtnWrap=this.$(".blogs-show-all-wrap"),this.$closeAllBtn=this.$(".promo-button-container"),this.$allBlogsContainer=this.$(".show-all-blogs"),this.$blogChangeContainerHeight=this.$(".inner-show-all-blogs").height()+80,this.subviews.featuredcontent=new o(t)):this.hide()},showAll:function(){0===this.$allBlogsContainer.height()?(this.animate(this.$allBlogsContainer,"height",this.$blogChangeContainerHeight,350,"ease-in-out").done(t.bind(function(){this.$closeAllBtn.show()},this)),this.$seeAllBtnWrap.addClass("active")):(this.$closeAllBtn.hide(),this.animate(this.$allBlogsContainer,"height",0,350,"ease-in-out"),this.$seeAllBtnWrap.removeClass("active"))}});return r}),define("modules/cxense-recommends/cxense-recommends",["jquery","underscore","state","utils","modules/cxense-recommends/cxense-base"],function(e,t,i,s,n){var a=n.extend({initialize:function(e){this.$itemsWrap=this.$(".cx-item-wrap"),e.cxenseWidgetId=this.$itemsWrap.data("cxense-widget-id"),e.getRecsOnInit=!1,n.prototype.initialize.call(this,e)},renderRecs:function(e){this.$itemsWrap.hide().html(e).fadeIn(1e3,this._refreshSidebarScroller)},renderCxenseModule:function(){this.setCxenseWidth(this.currentCardInfo),this.$itemsWrap.children("li").length||this._getRecs()},additionalFormatItemForTemplate:function(e){return{headline:s.smartTruncate(e.title,70)}},setCxenseWidth:function(e){e.sidebarWidth<340?this.$itemsWrap.removeClass("live-feed-wide"):this.$itemsWrap.addClass("live-feed-wide"),this._refreshSidebarScroller()},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.renderCxenseModule()},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.setCxenseWidth(e)},_refreshSidebarScroller:function(){i.getActiveApp().triggerEvent("refreshSidebarScroll")},openSideBar:function(){this.renderCxenseModule()}});return a}),define("modules/rentals-apartments-ad",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,s,n){var a=t.extend({events:{"click .js-rad-search-btn":"aptAffWidget"},renderedAd:!1,renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rad-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag"),subSection:"",pageInfo:i.getActivePageInfo()})},handleCardSizeChange:function(e){e.sidebarAds===!0?(this.$(".js-rad-sidebar-ad").removeClass("rad-hide-ad"),this.renderAd()):this.$(".js-rad-sidebar-ad").addClass("rad-hide-ad"),e.sidebarOpen===!0?(this.$(".js-rad-wrap[data-layout-type=primary]").addClass("rad-dynamic-height").removeClass("rad-wrap-margin"),this.$(".js-rad-google-ad").removeClass("rad-dynamic-margin"),this.$(".js-rad-wrap-primary").removeClass("rad-top-border")):(e.sidebarAds===!1&&this.renderAd(),this.$(".js-rad-wrap[data-layout-type=primary]").removeClass("rad-dynamic-height").addClass("rad-wrap-margin"),this.$(".js-rad-google-ad").addClass("rad-dynamic-margin"),this.$(".js-rad-wrap-primary").addClass("rad-top-border"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},aptAffWidget:function(){var t,i,s,a,o;return t=this.$(".js-rad-form-city").val(),i=this.$(".js-rad-form-bedrooms").val(),s=this.$(".js-rad-form-bathrooms").val(),a=this.$(".js-rad-form-rent").val(),o="http://www.apartments.com/search/?query="+t,t?(i&&(o+="&bedchkvalue="+i),s&&(o+="&bathchkvalue="+s),a&&(o+="&rentmax="+a),o+="&stype=CityStateOrZip",n.goTo(o)):e(".js-rad-form-city").focus(),!1}});return a}),define("modules/sports/sports-countdown",["jquery","underscore","backbone","baseview"],function(e,t,i,s){var n=s.extend({initialize:function(){this.$countdown=this.$(".sports-countdown"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-this.startDate)),this.dateDiffInSeconds>0&&this.startCountdown()},startCountdown:function(){this.timer=setInterval(e.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var e=Math.floor(this.dateDiffInSeconds/this.secondsInDay),t=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(t/this.secondsInHour),s=t%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),a=Math.ceil(s%this.secondsInMinute);return this.$countdown.find("#days").text(10>e?"0"+e:e),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>a?"0"+a:a),this.dateDiffInSeconds<=0?void clearInterval(this.timer):void 0},this),1e3)}});return n}),define("modules/stories/expandable-photo",["jquery","underscore","baseview","utils","modules/myCapture/myCapture"],function(e,t,i,s,n){var a=i.extend({events:{"click .expandable-collapsed":"expandPhoto","click .expandable-open":"collapsePhoto"},sized:!1,expandPhoto:function(){var e=this.$(".single-photo"),t=this.$(".image-credit-wrap");if(s.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&!this.subviews.mycapture&&(this.subviews.mycapture=new n({el:this.$el})),this.subviews.mycapture&&e.find(".js-mycapture-btn-small").length&&this.subviews.mycapture.switchMyCaptureBtn(this),!this.sized){var i=this.$el.next();i.length?i.css("padding-top",this.$el.outerHeight()+20):this.$el.parent().height(this.$el.outerHeight()),this.$el.css("position","absolute"),this.sized=!0}t.hide(),e.animate({width:"540px"},350,function(){t.fadeIn(250)}),e.removeClass("expandable-collapsed").addClass("expandable-open")},collapsePhoto:function(i){if(!e(i.target).is(".js-mycapture-btn")){var s=this.$(".single-photo"),n=this.$(".image-credit-wrap");this.subviews.mycapture&&n.find(".js-mycapture-btn").length&&this.subviews.mycapture.switchMyCaptureBtn(this),n.hide(),s.removeClass("expandable-open"),s.animate({width:"180px"},350,t.bind(function(){n.fadeIn()},this)),s.removeClass("expandable-open").addClass("expandable-collapsed")}}});return a}),define("modules/partner/sponsor-logo-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){var s=this.$el;t=e.extend({adType:s.attr("data-ad-type")||"sponsor_logo_module",adPlacement:s.attr("data-ad-placement")||"sponsor_logo_module",adSizes:s.attr("data-ad-sizes")||"sponsor_logo_medium"},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("modules/travel/travel-dest-nav",["jquery","baseview","ui/dropdown"],function(e,t,i){"use strict";var s=t.extend({initialize:function(e){t.prototype.initialize.call(this,e),this.subviews.dropdown=new i({el:this.$(".tdn-list")})}});return s}),define("modules/home-finder/home-carousel",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"click .mpa-hf-ft-next-btn":"nextHouse","click .mpa-hf-ft-previous-btn":"previousHouse"},initialize:function(s){s=e.extend({auto:!0,time:5e3},s),this.$featuredHouses=this.$(".mpa-hf-wrap"),this.$houses=this.$featuredHouses.find(".mpa-hf-ft-block"),this.totalHouses=this.$houses.length,this.$paginatorBullets=this.$(".paginator-indicator-bullet"),this.$activePaginator=this.$(".paginator-indicator-target"),this.subviews={},this.indexSelector=0,this.homesPerSlide=3,this.carousel={houses:[],width:[0]},t.bindAll(this,"goTo","goToNextHome"),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),this.createCarousel(this.$houses),this.controlsCarousel(),i.prototype.initialize.call(this,s)},nextHouse:function(){this._getSlideIn(),this._fadeInSlide()},previousHouse:function(){this._getSlideOut(),this._fadeInSlide()},createCarousel:function(t){var i=this,s=0;e.each(t,function(t){i.carousel.houses.push(this),s+=i._getWidth(e(this)),(parseInt(t)+1)%i.homesPerSlide===0&&i.carousel.width.push(s)})},resetAutoRotate:function(){clearInterval(this.slideChangeInterval)},goToNextHome:function(){this.indexSelector++,this.goTo(this.indexSelector)},goTo:function(e){e>=this.totalHouses/this.homesPerSlide?e=0:0>e&&(e=this.totalHouses-1),this.indexSelector=e,this.$paginatorBullets.removeClass("active"),this.$(".paginator-indicator-bullet").eq(this.indexSelector).addClass("active"),this.controlsCarousel(),this.animate(this.$featuredHouses,"right",this.carousel.width[e],200,"ease-in-out")},_fadeInSlide:function(){this.goTo(this.indexSelector)},controlsCarousel:function(){var t=e(".mpa-hf-ft-previous-btn"),i=e(".mpa-hf-ft-next-btn");t.toggleClass("mpa-closed",0===this.indexSelector),i.toggleClass("mpa-closed",this.indexSelector==this.$activePaginator.length-1),this.resetAutoRotate()},_getSlideIn:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().next().index()},_getSlideOut:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().prev().index()},_getWidth:function(e){return e.outerWidth()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return a}),define("modules/videos/video-gallery",["jquery","underscore","baseview","pubsub","utils","state","modules/carousel/gallery","modules/videos/brightcove-video","modules/carousel/thumbs","ui/tooltip","modules/stories/taboola-recommendations","modules/scroller/horizontal-scroll"],function(e,t,i,s,n,a,o,r,l,h,d,c){"use strict";var u=i.extend({events:{"click .carousel-prev":"onClickPrevArrow","click .carousel-next":"onClickNextArrow"},initialize:function(a){a=e.extend({viewportSelector:".gallery-viewport",slidesContainerSelector:".gallery-slides",slidesSelector:".gallery-slide",hoverTransition:0,scrollerColor:"light",thumbsSelector:".vgm-thumbs",tooltipOptions:null},a),t.bindAll(this,"_transitionSlides","_getOnStatusChangeMethod","_getOnClickPlayVideoMethod","goToNextVideo","getIntermediateRecommendation"),this.$viewport=this.$(a.viewportSelector),this.$slidesContainer=this.$viewport.find(a.slidesContainerSelector),this.$slides=this.$slidesContainer.find(a.slidesSelector),this.$arrows=this.$(".carousel-prev, .carousel-next"),this.$title=this.$(".video-gallery-page-title"),this.subviewPrefix="galleryItem";var r=e.extend(a,{animations:{useCSSTransitions:!1}});i.prototype.initialize.call(this,r),this.index=this.$(".vgm-thumb-item.active").index(),this.subviews.gallery=new o({el:this.$el,slideTransition:200,ads:!1,index:0,lookAheadAmount:3,transitionSlides:this._transitionSlides}),this._initializeThumbs(a.hoverTransition,a.scrollerColor,a.thumbsSelector),this._initializeTooltips(this.$(".vgm-thumb-image")),this.subviews.scrollbar||(this.subviews.scrollbar=new c({el:this.$el,color:this.options.scrollerColor,padding:2}));var l=this.$(".vgm-thumb-item.active");l.length&&this.subviews.scrollbar.scrollToElement(l,!1,300),this.goTo(this.index).done(t.bind(function(){var e=n.getNested(this.getPlayerSubview(this.index),"player","autoplay");(void 0===e||e)&&(this.startVideo(this.index),s.trigger("uotrack","videoplaylist|nextauto"))},this))},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new l({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},_initializeTooltips:function(i){t.each(i,function(t,i){this._setupTooltipView(t,e(t).data("duration"),i)},this)},_setupTooltipView:function(t,i,s){var n=e.extend({el:t,text:i,customContainerClass:"vgm-ui-tooltip",position:"bottom"},this.options.tooltipOptions),a=this.subviewPrefix+s;this.subviews[a]||(this.subviews[a]=new h(n))},onVideoStatusChange:function(e,t){if("mediaComplete"===e.type){var i=this.getActiveSlideIndex(),s=i+1,a=this.$slides.length-1;if(n.getNested(this.getPlayerSubview(i),"player","gannett_continuous_endslate")&&!this.subviews["intermediateEndslate"+i])return void this.displayEndslate();a>=s&&this.goToNextVideo()}this.getActiveSlideIndex()===t||"mediaBegin"!==e.type&&"mediaPlay"!==e.type||this.enterBackgroundState(t)},onClickPrevArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()-1;
this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),s.trigger("uotrack","videoplaylist|prev")},this))},onClickNextArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()+1;this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),s.trigger("uotrack","videoplaylist|next")},this))},switchSlide:function(e){var i=this.getActiveSlideIndex();this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),s.trigger("uotrack","videoplaylist"+(e+1)),void 0!==i&&this.enterBackgroundState(i)},this))},startVideo:function(e){var t=this.getPlayerSubview(e);t&&t.playVideo()},enterBackgroundState:function(e){var t=this.getPlayerSubview(e);t&&t.reset()},goTo:function(e){var i=this.getActiveSlideIndex();return this.updateArrows(e),this._activeSlide=e,this.subviews.gallery.goToSlide(e).done(t.bind(function(){var t=this.subviews["video"+e],s=this.$slides.eq(e).find(".ui-video");!t&&void 0!==e&&s.length&&(this.subviews["video"+e]=new r({el:s[0],onStatusChange:this._getOnStatusChangeMethod(e),onClickPlay:this._getOnClickPlayVideoMethod(e),overrideGetRecommendations:this.getIntermediateRecommendation,autoPlay:!1})),void 0!==i&&this.enterBackgroundState(i)},this))},getIntermediateRecommendation:function(){var e=this.getActiveSlideIndex(),t="",i=e+1,s=this.$slides.length-1,n=this.getPlayerSubview(e);s>=i?(t=this.$slides.eq(i).find(".ui-video-data").html(),this.videoresponse=JSON.parse(t)):i>s&&(this.subviews.TaboolaOutbrain||(this.subviews.TaboolaOutbrain=new d,this.subviews.TaboolaOutbrain.renderEndslate(n.video.url,n.video.brightcove_id)))},displayEndslate:function(){var e=this.getActiveSlideIndex(),t=e+1,i=this.$slides.length-1,s=this.getPlayerSubview(e),n=this.$slides.eq(e).find(".video-endslate");i>=t?s.player.gannett_continuous_endslate&&(this.subviews["intermediateEndslate"+e]||(this.subviews["intermediateEndslate"+e]=new d({videoResponse:this.videoresponse,endCountdown:this.goToNextVideo}),this.subviews["intermediateEndslate"+e].populateEndslate(n,s.player.mediatemplate))):t>i&&s.player.gannett_continuous_endslate&&this.subviews.TaboolaOutbrain.populateEndslate(n,s.player.mediatemplate)},goToNextVideo:function(){var e=this.getActiveSlideIndex()+1;this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),s.trigger("uotrack","videoplaylist|nextauto")},this))},_transitionSlides:function(e){var t=this.$viewport.outerWidth(),i=t*e*-1,s=this.$slidesContainer;return this.animate(s,"left",i+"px",250,"easeInOutQuad")},getPlayerSubview:function(e){return this.subviews["video"+e]},_getOnClickPlayVideoMethod:function(e){return t.bind(function(t){this.onClickPlayVideo(t,e)},this)},onClickPlayVideo:function(e,t){this.startVideo(t)},_getOnStatusChangeMethod:function(e){return t.bind(function(t){this.onVideoStatusChange(t,e)},this)},getActiveSlideIndex:function(){return this._activeSlide},updateArrows:function(e){var t;this.$slides.length<=1||(this.$arrows.addClass("gallery-nav-active"),0===e?t="prev":e===this.$slides.length-1&&(t="next"),this.$arrows.filter(".carousel-"+t).removeClass("gallery-nav-active"))}});return u}),define("modules/longform/longform-inline-share",["jquery","baseview","pubsub"],function(e,t,i){"use strict";var s=t.extend({events:{"click .lf-share-item":"onSocialButtonClick"},onSocialButtonClick:function(t){e(t.target).hasClass("lf-share-comments")?(i.trigger("onClickShare","comments"),t.preventDefault()):e(t.target).hasClass("lf-share-email")&&(i.trigger("onClickShare","email"),t.preventDefault())}});return s}),define("touchswipe",["jquery"],function(e){function t(t){return!t||void 0!==t.allowPageScroll||void 0===t.swipe&&void 0===t.swipeStatus||(t.allowPageScroll=h),t||(t={}),t=e.extend({},e.fn.swipe.defaults,t),this.each(function(){var s=e(this),n=s.data(y);n||(n=new i(this,t),s.data(y,n))})}function i(t,i){function w(t){if(!(O()||e(t.target).closest(i.excludedElements,et).length>0)){t=t.originalEvent;var s,n=b?t.touches[0]:t;return tt=f,b?it=t.touches.length:t.preventDefault(),G=0,Y=null,Q=null,X=0,Z=0,K=0,J=1,st=j(),!b||it===i.fingers||i.fingers===p||R()?(st[0].start.x=st[0].end.x=n.pageX,st[0].start.y=st[0].end.y=n.pageY,nt=F(),2==it&&(st[1].start.x=st[1].end.x=t.touches[1].pageX,st[1].start.y=st[1].end.y=t.touches[1].pageY,Z=K=D(st[0].start,st[1].start)),(i.swipeStatus||i.pinchStatus)&&(s=S(t,tt))):(x(t),s=!1),s===!1?(tt=v,S(t,tt),s):(z(!0),et.bind(W,_),et.bind(q,C),void 0)}}function _(e){if(e=e.originalEvent,tt!==m&&tt!==v){var t,s=b?e.touches[0]:e;if(st[0].end.x=b?e.touches[0].pageX:s.pageX,st[0].end.y=b?e.touches[0].pageY:s.pageY,at=F(),Y=E(st[0].start,st[0].end),b&&(it=e.touches.length),tt=g,2==it&&(0==Z?(st[1].start.x=e.touches[1].pageX,st[1].start.y=e.touches[1].pageY,Z=K=D(st[0].start,st[1].start)):(st[1].end.x=e.touches[1].pageX,st[1].end.y=e.touches[1].pageY,K=D(st[0].end,st[1].end),Q=I(st[0].end,st[1].end)),J=P(Z,K)),it!==i.fingers&&i.fingers!==p&&b)tt=v,S(e,tt);else if($(e,Y),G=M(st[0].start,st[0].end),X=A(st[0].start,st[0].end),(i.swipeStatus||i.pinchStatus)&&(t=S(e,tt)),!i.triggerOnTouchEnd){var n=!T();k()===!0?(tt=m,t=S(e,tt)):n&&(tt=v,S(e,tt))}t===!1&&(tt=v,S(e,tt))}}function C(e){if(e=e.originalEvent,e.touches&&e.touches.length>0)return!0;if(e.preventDefault(),at=F(),0!=Z&&(K=D(st[0].end,st[1].end),J=P(Z,K),Q=I(st[0].end,st[1].end)),G=M(st[0].start,st[0].end),Y=E(st[0].start,st[0].end),X=A(),i.triggerOnTouchEnd||i.triggerOnTouchEnd===!1&&tt===g){tt=m;var t=B()||!R(),s=it===i.fingers||i.fingers===p||!b,n=0!==st[0].end.x,a=s&&n&&t;if(a){var o=T(),r=k();r!==!0&&null!==r||!o?o&&r!==!1||(tt=v,S(e,tt)):S(e,tt)}else tt=v,S(e,tt)}else tt===g&&(tt=v,S(e,tt));et.unbind(W,_,!1),et.unbind(q,C,!1),z(!1)}function x(){it=0,at=0,nt=0,Z=0,K=0,J=1,z(!1)}function S(e,t){var h=void 0;if(i.swipeStatus&&(h=i.swipeStatus.call(et,e,t,Y||null,G||0,X||0,it)),i.pinchStatus&&B()&&(h=i.pinchStatus.call(et,e,t,Q||null,K||0,X||0,it,J)),t===v&&(!i.click||1!==it&&b||!isNaN(G)&&0!==G||(h=i.click.call(et,e,e.target))),t==m){switch(i.swipe&&(h=i.swipe.call(et,e,Y,G,X,it,i)),Y){case s:i.swipeLeft&&(h=i.swipeLeft.call(et,e,Y,G,X,it,i));break;case n:i.swipeRight&&(h=i.swipeRight.call(et,e,Y,G,X,it,i));break;case a:i.swipeUp&&(h=i.swipeUp.call(et,e,Y,G,X,it,i));break;case o:i.swipeDown&&(h=i.swipeDown.call(et,e,Y,G,X,it,i))}switch(Q){case r:i.pinchIn&&(h=i.pinchIn.call(et,e,Q||null,K||0,X||0,it,J));break;case l:i.pinchOut&&(h=i.pinchOut.call(et,e,Q||null,K||0,X||0,it,J))}}return(t===v||t===m)&&x(e),h}function k(){return null!==i.threshold?G>=i.threshold:null}function T(){var e;return e=i.maxTimeThreshold&&X>=i.maxTimeThreshold?!1:!0}function $(e,t){if(i.allowPageScroll===h||R())e.preventDefault();else{var r=i.allowPageScroll===d;switch(t){case s:(i.swipeLeft&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case n:(i.swipeRight&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case a:(i.swipeUp&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault();break;case o:(i.swipeDown&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault()}}}function A(){return at-nt}function D(e,t){var i=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);return Math.round(Math.sqrt(i*i+s*s))}function P(e,t){var i=t/e*1;return i.toFixed(2)}function I(){return 1>J?l:r}function M(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function L(e,t){var i=e.x-t.x,s=t.y-e.y,n=Math.atan2(s,i),a=Math.round(180*n/Math.PI);return 0>a&&(a=360-Math.abs(a)),a}function E(e,t){var i=L(e,t);return 45>=i&&i>=0?s:360>=i&&i>=315?s:i>=135&&225>=i?n:i>45&&135>i?o:a}function F(){var e=new Date;return e.getTime()}function N(){et.unbind(U,w),et.unbind(V,x),et.unbind(W,_),et.unbind(q,C),z(!1)}function R(){return i.pinchStatus||i.pinchIn||i.pinchOut}function B(){return Q&&R()}function O(){return et.data(y+"_intouch")===!0?!0:!1}function z(e){e=e===!0?!0:!1,et.data(y+"_intouch",e)}function j(){for(var e=[],t=0;5>=t;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},delta:{x:0,y:0}});return e}var H=b||!i.fallbackToMouseEvents,U=H?"touchstart":"mousedown",W=H?"touchmove":"mousemove",q=H?"touchend":"mouseup",V="touchcancel",G=0,Y=null,X=0,Z=0,K=0,J=1,Q=0,et=e(t),tt="start",it=0,st=null,nt=0,at=0;try{et.bind(U,w),et.bind(V,x)}catch(ot){e.error("events not supported "+U+","+V+" on jQuery.swipe")}this.enable=function(){return et.bind(U,w),et.bind(V,x),et},this.disable=function(){return N(),et},this.destroy=function(){return N(),et.data(y,null),et}}var s="left",n="right",a="up",o="down",r="in",l="out",h="none",d="auto",c="horizontal",u="vertical",p="all",f="start",g="move",m="end",v="cancel",b="ontouchstart"in window,y="TouchSwipe",w={fingers:1,threshold:75,maxTimeThreshold:null,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,triggerOnTouchEnd:!0,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(i){var s=e(this),n=s.data(y);if(n&&"string"==typeof i){if(n[i])return n[i].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(n||"object"!=typeof i&&i))return t.apply(this,arguments);return s},e.fn.swipe.defaults=w,e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:g,PHASE_END:m,PHASE_CANCEL:v},e.fn.swipe.directions={LEFT:s,RIGHT:n,UP:a,DOWN:o,IN:r,OUT:l},e.fn.swipe.pageScroll={NONE:h,HORIZONTAL:c,VERTICAL:u,AUTO:d},e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:p}}),define("modules/interactives/interactive-ads",["jquery","underscore","backbone","pubsub","utils","baseview","directAdPosition"],function(e,t,i,s,n,a,o){var r=a.extend({initialize:function(e){a.prototype.initialize.call(this,e),this.$el.length>0&&this.setupAds()},setupAds:function(){var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic};this.subviews.sponsorshipAd=new o({el:this.$el,adPlacement:"sponsor_logo/interactive",adSizes:["sponsor_logo"],targeting:t})}});return r}),define("modules/interactives/interactive-templates",["jquery","underscore","state","pubsub","utils","baseview","ui/loader","modules/global/brightcove-video","ui/generic-paginator","touchswipe","meteredAdPosition","adLogger","modules/interactives/interactive-ads"],function(e,t,i,s,n,a,o,r,l,h,d,c,u){var p=a.extend({el:".interactive",events:{"click .slide-nav.prev, .slide-nav.next":"onArrowClick","click .navigation li":"onNavClick"},initialize:function(i){t.bindAll(this,"beforePaginatorClick","goTo"),i=e.extend({ads:!1,adSponsor:!1,adTransition:!1,ignoreFirstNav:!1,interactiveType:"",isFramed:!1,standAlone:!1},i),this.$leftArrow=this.$(".slide-nav.prev"),this.$rightArrow=this.$(".slide-nav.next"),this.$viewport=this.$(".viewport"),this.$slideContainer=this.$viewport.find(".slides"),this.$slides=this.$slideContainer.find(".slide"),this.$navigation=this.$(".navigation"),this.$navigationItems=this.$navigation.find("li"),this.slideNum=this.$slides.length,e(this.$slides[this.$slides.length-1]).hasClass("partner-slide-ad")&&(this.slideNum-=1),this.slideWidth=this.$slides.outerWidth(),this.slideHeight=this.$slides.outerHeight(),this.slideWidthPad="sequencer"===this.options.interactiveType?this.$(".stage").outerWidth()-this.slideWidth:0,this.maxSlides=this.slideNum,this.$slideContainer.width(this.maxSlides*this.slideWidth),this.currentSlideIndex=0,this.subviews={},this.setupSwipes(),this.$viewport.hasClass("slide")&&this.$slides.css({display:"inline-block"}),a.prototype.initialize.call(this,i),this.subviews.video=[],this.subviews.paginator=new l({onBeforePaginator:this.beforePaginatorClick,el:this.$(".paginator"),onGoTo:this.goTo}),this.setupAds()},beforePaginatorClick:function(e){var t=e<this.currentSlideIndex?"left":"right";return!this.showingAd&&this.shouldShowAd()?(this.showAd(t),!1):(this.options.isFramed!==!0&&this.trackPageView(),!0)},goTo:function(e){this._switchSlides(this._getSlideIn(e),this._getSlideOut())},onArrowClick:function(t){var i=e(t.currentTarget).is(this.$leftArrow)?"left":"right";return"chronology"!==this.options.interactiveType&&"beforeandafter"!==this.options.interactiveType||this.options.isFramed===!0||this.trackPageView(),!this.showingAd&&this.shouldShowAd()?(this.showAd(i),!1):this.showingAd&&this.showingAd.index()===this.currentSlideIndex?(this.subviews.paginator.goToPage("left"===i?this.currentSlideIndex-1:this.currentSlideIndex),!1):("left"===i?this.previousSlide():this.nextSlide(),!1)},onNavClick:function(t){var i=e(t.currentTarget),s=i.parent().find("li"),n=s.index(i);return 0===n&&this.options.ignoreFirstNav?!1:(this.options.ignoreFirstNav&&n--,this.goTo(n),!1)},onSwipeSlide:function(e,t,i,s,n,a){"right"===t||"down"===t?a.self.previousSlide():a.self.nextSlide()},previousSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex>0?this.currentSlideIndex-1:this.slideNum-1;this.goTo(e)}else this.subviews.paginator.goToPrevPage(this.currentSlideIndex)},nextSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex<this.slideNum-1?this.currentSlideIndex+1:0;this.goTo(e)}else this.subviews.paginator.goToNextPage(this.currentSlideIndex)},setupAds:function(){if(this.options.ads){this.subviews.interactiveAds=new u({el:this.$(".interactive-sponsor")});var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic},i=this.$viewport.width(),s=this.$viewport.height();450>s||600>i?c.logWarn("Advertisement viewport is too small: "+i+"x"+s):(this.$adSlide=this.$(".partner-slide-ad"),this.$adSlide.length>0&&(this.options.adTransition=!0,this.$adContents=this.$adSlide.find(".interactive-ad"),this.subviews.ad=new d({el:this.$adContents,adPlacement:"transition_interactive/"+e.cst,adSizes:["elastic"],meterThreshold:"transition_interactive",rateMeterId:"asset_"+e.interactiveId,targeting:t})))}},setupSwipes:function(){if(Modernizr.touch&&"beforeandafter"!==this.options.interactiveType&&"timeline"!==this.options.interactiveType){var e=this;this.$slideContainer.swipe({self:e,swipe:e.onSwipeSlide})}},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(e){var i=this._getSlideOut();if(this.showingAd=this.$adSlide,this.$adContents.show(),i[0]!==this.showingAd[0]){var s=this.showingAd.detach();"left"===e?s.insertBefore(i):"right"===e&&s.insertAfter(i),this.$slides=this.$slideContainer.find(".slide"),this._switchSlides(this.showingAd,i,e).done(t.bind(function(){this.$slides.removeClass("active"),this.subviews.ad.playAd()},this))}},trackClick:function(e){this.trackFirstClick(),s.trigger("uotrack",e)},trackFirstClick:function(){this.firstClick||(s.trigger("uotrack",this.options.interactiveType+"firstclick"),this.firstClick=!0)},trackPageView:function(){this.trackFirstClick();var t={contenttype:this.$el.data("contenttype"),pathName:this.trackPathName("")},n=i.getActivePageInfo();t=e.extend(n,t),s.trigger("analytics:pageload",t)},trackPathName:function(e){var t;return t=this.options.standAlone===!0?document.location.pathname:"/interactive/"+this.$el.data("interactive-id")+"/",t=this.options.interactiveType+t+this.$el.data("seoTitle")+"/"+e},_getSlideOut:function(){var e;return e=this.showingAd&&this.showingAd.length>0?this.showingAd:this.$slides.eq(this.currentSlideIndex)},_getSlideIn:function(e){this.options.adTransition&&this.$adSlide.index()<=e&&(e+=1);var t=this.$slides.eq(e);return t},_switchSlides:function(i,s){var n,a=s.index(),o=i.index(),l=this.slideWidth*o,h=this.slideHeight*o,d=this.options.adTransition&&this.$adSlide.index()<this.maxSlides?!0:!1;s===this.showingAd&&this.subviews.ad.stopAd(),0===o?(this.$leftArrow.addClass("invisible"),this.$rightArrow.removeClass("invisible")):o===this.maxSlides-1&&!d||o===this.maxSlides&&d?(this.$leftArrow.removeClass("invisible"),this.$rightArrow.addClass("invisible")):(this.$leftArrow.removeClass("invisible"),this.$rightArrow.removeClass("invisible")),t.each(this.subviews.video,function(e){e.destroy(!1,!0)}),this.subviews.video=[];var c=o;if(this.options.ignoreFirstNav&&c++,this.$navigationItems.removeClass("active").eq(c).addClass("active"),this.$viewport.hasClass("slide")||this.$viewport.hasClass("slide-transition"))n=this.animate(this.$slideContainer,"left",-1*l+this.slideWidthPad+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("vslide-transition"))n=this.animate(this.$slideContainer,"top",-1*h+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("fade")||this.$viewport.hasClass("fade-transition")){var u=this.$slides.eq(o),p=this.$slides.eq(a);o!==a?(p.css({"z-index":1}),u.css({"z-index":2,opacity:0,display:"block"}),n=this.animate(u,"opacity",1,400,"linear").done(function(){p.css({opacity:0,display:"none"})})):(u.css({opacity:0,display:"block"}),n=this.animate(u,"opacity",1,400,"linear"))}this.$slides.removeClass("active").eq(o).addClass("active");var f=this;return e.each(this.$slides.eq(o).find(".video"),function(){var t=new r({el:e(this).get(0),autostart:!0});f.subviews.video.push(t)}),this.currentSlideIndex=o,n}});return p}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/widget",["jquery"],e):e(jQuery)}(function(e){var t=0,i=Array.prototype.slice;return e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,l={},h=t.split(".")[0];return t=t.split(".")[1],n=h+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[h]=e[h]||{},a=e[h][t],o=e[h][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}()):void(l[t]=s)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},l,{constructor:o,namespace:h,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var s,n,a=i.call(arguments,1),o=0,r=a.length;r>o;o++)for(s in a[o])n=a[o][s],a[o].hasOwnProperty(s)&&void 0!==n&&(t[s]=e.isPlainObject(n)?e.isPlainObject(t[s])?e.widget.extend({},t[s],n):e.widget.extend({},n):n);return t},e.widget.bridge=function(t,s){var n=s.prototype.widgetFullName||t;e.fn[t]=function(a){var o="string"==typeof a,r=i.call(arguments,1),l=this;return a=!o&&r.length?e.widget.extend.apply(null,[a].concat(r)):a,this.each(o?function(){var i,s=e.data(this,n);return"instance"===a?(l=s,!1):s?e.isFunction(s[a])&&"_"!==a.charAt(0)?(i=s[a].apply(s,r),i!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+a+"'")}:function(){var t=e.data(this,n);t?(t.option(a||{}),t._init&&t._init()):e.data(this,n,new s(a,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,s){s=e(s||this.defaultElement||this)[0],this.element=e(s),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),s!==this&&(e.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===s&&this.destroy()}}),this.document=e(s.style?s.ownerDocument:s.document||s),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;a<s.length-1;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+a.eventNamespace,d=l[2];d?n.delegate(d,h,r):i.bind(h,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/mouse",["jquery","./widget"],e):e(jQuery)}(function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,a="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return n&&!a&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return s._mouseMove(e)},this._mouseUpDelegate=function(e){return s._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/draggable",["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.document[0],s=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(n){}return this.helper||s.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(s.iframeFix===!0?"iframe":s.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s
},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],void(s&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),l=e.pageX,h=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=s.options,a=e.extend({},i,{item:s.element});s.sortables=[],e(n.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,a))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,i,s){var n=this;e.each(s.sortables,function(){var a=!1,o=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",t),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",t),s.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,l,h,d,c,u,p,f=s.options,g=f.snapTolerance,m=i.offset.left,v=m+s.helperProportions.width,b=i.offset.top,y=b+s.helperProportions.height;for(u=s.snapElements.length-1;u>=0;u--)l=s.snapElements[u].left,h=l+s.snapElements[u].width,d=s.snapElements[u].top,c=d+s.snapElements[u].height,l-g>v||m>h+g||d-g>y||b>c+g||!e.contains(s.snapElements[u].item.ownerDocument,s.snapElements[u].item)?(s.snapElements[u].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(d-y)<=g,a=Math.abs(c-b)<=g,o=Math.abs(l-v)<=g,r=Math.abs(h-m)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top-s.margins.top),a&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top-s.margins.top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left-s.margins.left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=Math.abs(d-b)<=g,a=Math.abs(c-y)<=g,o=Math.abs(l-m)<=g,r=Math.abs(h-v)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top-s.margins.top),a&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top-s.margins.top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left-s.margins.left)),!s.snapElements[u].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable}),define("modules/interactives/before-after",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable"],function(e,t,i,s,n,a){var o=n.extend({events:function(){var e={"click .image-container":"handleClick"};return e[(Modernizr.touch?"touchstart":"click")+" .before-after-caption-toggle"]="toggleCaption",e},initialize:function(i){i=e.extend({animateIntro:!0,introDelay:1e3,introDuration:1500,introPosition:.5,cursor:"e-resize"},i),n.prototype.initialize.call(this,i),this.$el.length&&(this.subviews.template=new a({el:this.$el,interactiveType:"beforeandafter",isFramed:i.isFramed,standAlone:i.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),Modernizr.touch?require(["touchpunch"],t.bind(this._setup,this)):this._setup())},destroy:function(){this.$(".before-after-drag-handle").draggable("destroy"),n.prototype.destroy.apply(this,arguments)},_setup:function(){this.destroyed||t.each(this.$(".image-container"),function(t,i){this._setupBeforeAfter(e(t),i)},this)},toggleCaption:function(t){var i=e(t.currentTarget),s=i.closest(".slide").find(".meta"),n=s.is(":visible");s.fadeToggle(function(){i.text(n?"Show Caption":"Hide Caption")}),this.options.isFramed||this.subviews.template.trackClick(n?"beforeandafter_caption_off":"beforeandafter_caption_on")},handleClick:function(t){var i=e(t.currentTarget),s=e(".before-after-drag-handle",i),n=s.width()/2;this.subviews.template.trackFirstClick();var a=t.pageX-i.offset().left;e(".before-after-drag-handle",i).stop().css("left",a-n+"px"),e(".before-after-before-wrapper",i).stop().width(a+"px")},_setupBeforeAfter:function(t,i){function s(){h.width(parseInt(e(this).css("left"),10)+r/2)}var n=t,a=this.options,o=e(".before-after-draw-handle-image",n),r=o.width(),l=e(".before-after-drag-handle",n),h=e(".before-after-before-wrapper",n),d=h.width(),c=h.height(),u=d*a.introPosition;o.css({cursor:a.cursor,top:c/2-o.height()/2+"px"}),l.draggable({containment:n,drag:s,stop:s,axis:"x"}),a.animateIntro&&0===i?this.animateIntro(h,l,d,u):(l.css({left:u-r/2+"px"}),h.width(u))},animateIntro:function(e,t,i,s){var n=this.options,a=t.width()/2;t.css("left",i-a+"px"),setTimeout(function(){t.animate({left:s-a+"px"},n.introDuration),e.animate({width:s+"px"},n.introDuration)},n.introDelay)}});return o}),define("modules/home-finder/home-ads",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,s,n){var a=i.extend({renderedAd:!1,renderAd:function(){this.renderedAd||(this.renderedAd=!0,this.$(".mpa-hf-ads").each(t.bind(function(e,t){this.subviews.adPositionOne=this.createAdPosition(t)},this)))},createAdPosition:function(t){var i=e(t),s=i.data("adtag"),a=s.search("poster_front")?[300,135]:[300,250];return new n({el:i,adSizes:a,adPlacement:s})},handleCardSizeChange:function(e){var t=this.$(".mpa-hf-wrap[data-layout-type=primary]");e.sidebarOpen===!1?(this.renderAd(),t.removeClass("mpa-closed")):(e.sidebarAds===!0&&this.renderAd(),t.addClass("mpa-closed"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return a}),define("modules/sports/sports-tickets",["jquery","underscore","pubsub","baseview"],function(e,t,i,s){"use strict";var n=s.extend({events:{"click .sports-tickets-submit":"triggerOmniture"},triggerOmniture:function(){i.trigger("uotrack","TicketCityModuleExit")},initialize:function(e){s.prototype.initialize.call(this,e),this.$el.width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override"),window.onresize=function(){this.$(".sports-tickets-sidebar-content").parent().width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override")}}});return n}),define("modules/partner/leaderboard-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){var s=this.$el;t=e.extend({adType:s.attr("data-ad-type")||"leaderboard",adPlacement:s.attr("data-ad-placement")||"leaderboard_btf",adSizes:s.attr("data-ad-sizes")||"leaderboard"},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("modules/stories/assigned-content",["jquery","underscore","baseview","form/dropdown","ui/generic-paginator"],function(e,t,i,s,n){var a=i.extend({initialize:function(e){t.bindAll(this,"goTo","onFilterDropdownSelect"),this.subviews={},this.$itemsContainer=this.$(".acnsb-items-container"),this.$items=this.$(".acnsb-item"),this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.dropdown=new s({el:this.$(".acnsb-dropdown"),onSelect:this.onFilterDropdownSelect}),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},onFilterDropdownSelect:function(e){var t,i;this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=e&&this.$items.not("."+e).hide(),t=this.$items.filter(":visible").length,8>=t?this.$(".acnsb-container").addClass("nopagination"):(this.$(".acnsb-container").removeClass("nopagination"),i=Math.floor(t/8),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"top",234*-e+"px",450,"ease-in-out")}});return a}),define("modules/ggm-jobs-search/ggm-jobs-search",["jquery","underscore","baseview","form/dropdown"],function(e,t,i,s){"use strict";var n=i.extend({events:{submit:"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmmtjm-select")})}});return n}),define("apps/overlay/pages/olympics-widgets",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({events:{"click .schedule-norm":"reduceSchedule","click .schedule-wide":"expandSchedule","click .widget-switch-block":"switchWidget"},initialize:function(s){e.extend(s,{numberRetries:12,refreshInterval:5e3},s),i.prototype.initialize.call(this,s),t.bindAll(this,"checkWidgetResults"),this.$widget=this.$(".olympics-primary-widget"),this.$widget.length||(this.$widget=this.$(".olympics-sidebar-widget")),this.createWidget()},reduceSchedule:function(t){var i=e(t.currentTarget);i.hasClass("schedule-norm")&&(e(".card-primary-wrapper").css("width","840px"),e(".card-full-width .sidebar").show(),i.addClass("schedule-wide"),i.removeClass("schedule-norm"),i.html("Full Width Schedule"))},expandSchedule:function(t){var i=e(t.currentTarget);i.hasClass("schedule-wide")&&(e(".card-full-width .sidebar").hide(),e(".card-primary-wrapper").css("width","100%"),i.addClass("schedule-norm"),i.removeClass("schedule-wide"),i.html("Display Sidebar"))},createWidget:function(){var t=["athlete","country","day","discipline","event"],i=this.$widget;this.$widget.find(".widget-wrapper").each(function(){for(var s=e(this),n={el:"#"+s.attr("id"),highlight:"USA"},a=0;a<t.length;++a)s.data(t[a])?n[t[a]]=s.data(t[a]).toString():i.data(t[a])&&(n[t[a]]=i.data(t[a]).toString());switch(console.log(n),e(this).data("widget")){case"medals":n.sort="total",i.data("country")||i.data("discipline")?new Reuters.Olympics.View.MedalTable(n):new Reuters.Olympics.View.MedalCount(n);break;case"schedule":new Reuters.Olympics.View.Schedule(n);break;case"results":new Reuters.Olympics.View.Results(n)}}),this.numRetries=this.options.numberRetries},checkWidgetResults:function(){var t=this.$(".rightrail.widget");if(this.$(".olympics-primary-widget")){var i=!1,s=this.$(".olympics-primary-widget .widget-empty");this.$(".olympics-primary-widget .widget-wrapper").each(function(){var t=e(this);0===t.html().length||t.html().indexOf("error")>0||t.html().indexOf("no results")>0?t.hide():(t.show(),i=!0)}),i||this.numRetries>1?s.hide():s.show()}this.$(".olympics-sidebar-widget").each(function(){var i=e(this),s=!0,n=i.closest(".card-sidebar");i.find(".widget-wrapper").each(function(){var t=e(this);0===t.html().length||t.html().indexOf("error")>0||t.html().indexOf("no results")>0?t.hasClass("toggle")||t.hide():(t.hasClass("toggle")||t.show(),s=!1)}),s?(n.hide(),t.hide()):(n.show(),t.show());{var a=i.data("max-rows"),o=i.data("max-labels");i.data("max-phases")}a&&(e(this).find(".scheduleUnit").each(function(t){t>=a&&e(this).hide()}),e(this).find(".resultsTable").each(function(){e(this).find(".label").each(function(t){if(t>o){var i=e(this).closest("tr");i.hasClass("resultRow")||i.hide()}}),e(this).find(".resultRow").each(function(t){t>=a&&e(this).hide()})}))}),this.$(".reutersOlympicsWidget .widgetBody").removeClass("constrainHeight"),this.numRetries--,this.numRetries>0&&(this.widgetTimer=setTimeout(this.checkWidgetResults,this.options.refreshInterval))},switchWidget:function(t){var i=this.$(".widget-switch-results .widget-wrapper"),s=this.$(".widget-switch-block"),n=e(t.currentTarget),a=s.index(n);i.addClass("hide"),i.eq(a).removeClass("hide"),s.removeClass("selected"),n.addClass("selected")},destroy:function(){this.numRetries=0,this.widgetTimer&&clearTimeout(this.widgetTimer),i.prototype.destroy.call(this)}});return s}),define("modules/travel/flight-search",["jquery","underscore","pubsub","state","baseview","form/base-form","form/autocomplete"],function(e,t,i,s,n,a,o){"use strict";var r=n.extend({events:{"submit form":"flightSearchFormSubmit","click .flight-tracker-search-btn":"flightSearchButtonClick","click .expand-arrow":"expandDetailsClick","click .expand-view":"expandDetailsClick","blur .required":"requiredBlur"},initialize:function(i){i=e.extend(!0,{type:!1},i),this.statusi={A:"En Route",C:"Canceled",D:"Diverted",DN:"Data source needed",L:"Landed",NO:"Not Operational",R:"Redirected",S:"Scheduled",U:"Unknown"},this.searchResultsTemplate=e("#search-results-template");var s=new Date;s=s.getHours(),s%2!==0&&(s+=1),this.$("#flightTime").val(s),t.bindAll(this,"renderResults"),this.pubSub={"popup:click":this.flightStatsSearch},n.prototype.initialize.call(this,i);var r=!1;t.each(this.$("form"),function(i,s){var n=e(i);this.subviews["flightSearchForm"+s]=new a({el:n}),n.hasClass("flight-tracker-form-active")&&(r=n.data("search-type"));var l=s;t.each(n.find(".airport-code"),function(t,i){this.subviews["airportAutoComplete"+l+"-"+i]=new o({el:e(t),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airports/search/<%=query%>/"})},this),t.each(n.find(".airline-code"),function(t,i){this.subviews["airlineAutoComplete"+l+"-"+i]=new o({el:e(t),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airlines/search/<%=query%>/"})},this)},this),r&&(this.options.type=r),this.options.type||(this.options.type="flight"),this.currentSearchType=this.options.type,this.$(".flight-tracker-"+this.options.type+"-form-wrap").addClass("flight-tracker-form-active"),this.$(".flight-tracker-search-btn."+this.options.type).addClass("active")},flightSearchFormSubmit:function(s){var n=e(s.currentTarget),a=0;if(n.find(".required").each(function(){var t=e(this);""===t.val()&&(t.addClass("input-error"),a++)}),0!==a)return!1;if(!n.attr("action")){s.preventDefault();var o={};t.each(n.serializeArray(),function(e){o[e.name]=e.value},this),this.flightStatsSearch(this.currentSearchType,o)}i.trigger("uotrack","flighttrackermap")},getFlightSearchUrl:function(e,i){var s=this.$el.attr("data-fs-baseurl")+"flightstatus/rest/v2/jsonp/",n=this.$el.attr("data-fs-appid"),a=this.$el.attr("data-fs-appkey"),o=new Date,r=o.getFullYear(),l=o.getDate(),h=o.getMonth()+1,d=o.getHours(),c=r+"/"+h+"/"+l,u="?appId="+n+"&appKey="+a+"&extendedOptions=useInlinedReferences";return"flight"===e?s+="flight/status/"+i.airline_name+"/"+i.flight_number+"/dep/"+c+u:"route"===e?s+="route/status/"+i.origin_airport+"/"+i.dest_airport+"/dep/"+c+u+"&utc=false&maxFlights=100":"airport"===e?(t.isUndefined(i.flight_time)&&(i.flight_time=d),s+="airport/status/"+i.airport_code+"/"+i.flight_type+"/"+c+"/"+i.flight_time+u+"&numHours=2"):s="",s},flightStatsSearch:function(e,i){var n=this.getFlightSearchUrl(e,i);this.fetch&&this.fetch.abort(),this.fetch=s.fetchData(n,{dataType:"jsonp"}).done(t.bind(function(t){this.renderResults(t.flightStatuses,e,i)},this)).fail(t.bind(function(){this.$(".flight-tracker-results").html('<div class="error">There is no matching flight data.</div>')},this))},flightSearchButtonClick:function(t){var i=e(t.currentTarget),s=i.attr("data-search-type");this.currentSearchType!==s&&(this.$(".flight-tracker-search-btn").removeClass("active"),i.addClass("active"),this.$(".flight-tracker-"+this.currentSearchType+"-form-wrap").removeClass("flight-tracker-form-active"),this.$(".flight-tracker-"+s+"-form-wrap").addClass("flight-tracker-form-active"),this.currentSearchType=s)},requiredBlur:function(t){var i=e(t.currentTarget);""!==i.val()&&i.removeClass("input-error")},renderResults:function(e,i,s){var n=this.statusi;if(t.each(e,function(e){if(e.status=n[e.status],e.color="green",t.isUndefined(e.delays))e.delays="On-time";else{var i=0;t.each(e.delays,function(e){i+=e}),e.delays=i+" min",e.color="yellow"}"Canceled"===e.status&&(e.color="red"),t.isUndefined(e.departureAirport.stateCode)&&(e.departureAirport.stateCode=e.departureAirport.countryCode),t.isUndefined(e.arrivalAirport.stateCode)&&(e.arrivalAirport.stateCode=e.arrivalAirport.countryCode)}),e.length){e={results:e};var a=t.template(this.searchResultsTemplate.html(),e),o="Results for "+i+" search:";s.flight_type_full&&s.airport_name&&(o=s.flight_type_full+": "+s.airport_name),this.$(".flight-tracker-results").empty().append('<div class="search-title">'+o+"</div>").append(a)}else this.$(".flight-tracker-results").html('<div class="error">No matching flight data found.</div>')},expandDetailsClick:function(t){var i=e(t.target).attr("data-flightid"),s=this.$(".detail-view-"+i);s.hasClass("open")?(s.hide().removeClass("open"),e(t.target).removeClass("active")):(s.show().addClass("open"),e(t.target).addClass("active"))}});return r}),!function(e){var t={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){}};e.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){e(this).bxSlider(n)}),this;var a={},o=this;t.el=this;var r=e(window).width(),l=e(window).height(),h=function(){a.settings=e.extend({},s,n),a.settings.slideWidth=parseInt(a.settings.slideWidth),a.children=o.children(a.settings.slideSelector),a.children.length<a.settings.minSlides&&(a.settings.minSlides=a.children.length),a.children.length<a.settings.maxSlides&&(a.settings.maxSlides=a.children.length),a.settings.randomStart&&(a.settings.startSlide=Math.floor(Math.random()*a.children.length)),a.active={index:a.settings.startSlide},a.carousel=a.settings.minSlides>1||a.settings.maxSlides>1,a.carousel&&(a.settings.preloadImages="all"),a.minThreshold=a.settings.minSlides*a.settings.slideWidth+(a.settings.minSlides-1)*a.settings.slideMargin,a.maxThreshold=a.settings.maxSlides*a.settings.slideWidth+(a.settings.maxSlides-1)*a.settings.slideMargin,a.working=!1,a.controls={},a.interval=null,a.animProp="vertical"==a.settings.mode?"top":"left",a.usingCSS=a.settings.useCSS&&"fade"!=a.settings.mode&&function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return a.cssPrefix=t[i].replace("Perspective","").toLowerCase(),a.animProp="-"+a.cssPrefix+"-transform",!0;return!1}(),"vertical"==a.settings.mode&&(a.settings.maxSlides=a.settings.minSlides),o.data("origStyle",o.attr("style")),o.children(a.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))}),d()},d=function(){o.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),a.viewport=o.parent(),a.loader=e('<div class="bx-loading" />'),a.viewport.prepend(a.loader),o.css({width:"horizontal"==a.settings.mode?100*a.children.length+215+"%":"auto",position:"relative"}),a.usingCSS&&a.settings.easing?o.css("-"+a.cssPrefix+"-transition-timing-function",a.settings.easing):a.settings.easing||(a.settings.easing="swing"),m(),a.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),a.viewport.parent().css({maxWidth:f()}),a.settings.pager||a.viewport.parent().css({margin:"0 auto 0px"}),a.children.css({"float":"horizontal"==a.settings.mode?"left":"none",listStyle:"none",position:"relative"}),a.children.css("width",g()),"horizontal"==a.settings.mode&&a.settings.slideMargin>0&&a.children.css("marginRight",a.settings.slideMargin),"vertical"==a.settings.mode&&a.settings.slideMargin>0&&a.children.css("marginBottom",a.settings.slideMargin),"fade"==a.settings.mode&&(a.children.css({position:"absolute",zIndex:0,display:"none"}),a.children.eq(a.settings.startSlide).css({zIndex:50,display:"block"})),a.controls.el=e('<div class="bx-controls" />'),a.settings.captions&&k(),a.active.last=a.settings.startSlide==v()-1,a.settings.video&&o.fitVids();var t=a.children.eq(a.settings.startSlide);"all"==a.settings.preloadImages&&(t=a.children),a.settings.ticker?a.settings.pager=!1:(a.settings.pager&&C(),a.settings.controls&&x(),a.settings.auto&&a.settings.autoControls&&S(),(a.settings.controls||a.settings.autoControls||a.settings.pager)&&a.viewport.after(a.controls.el)),c(t,u)},c=function(t,i){var s=t.find("img, iframe").length;if(0==s)return void i();var n=0;t.find("img, iframe").each(function(){e(this).is("img")&&e(this).attr("src",e(this).attr("src")+"?timestamp="+(new Date).getTime()),e(this).load(function(){setTimeout(function(){++n==s&&i()},0)})})},u=function(){if(a.settings.infiniteLoop&&"fade"!=a.settings.mode&&!a.settings.ticker){var t="vertical"==a.settings.mode?a.settings.minSlides:a.settings.maxSlides,i=a.children.slice(0,t).clone().addClass("bx-clone"),s=a.children.slice(-t).clone().addClass("bx-clone");
o.append(i).prepend(s)}a.loader.remove(),y(),"vertical"==a.settings.mode&&(a.settings.adaptiveHeight=!0),a.viewport.height(p()),o.redrawSlider(),a.settings.onSliderLoad(a.active.index),a.initialized=!0,a.settings.responsive&&e(window).bind("resize",H),a.settings.auto&&a.settings.autoStart&&F(),a.settings.ticker&&N(),a.settings.pager&&I(a.settings.startSlide),a.settings.controls&&E(),a.settings.touchEnabled&&!a.settings.ticker&&B()},p=function(){var t=0,s=e();if("vertical"==a.settings.mode||a.settings.adaptiveHeight)if(a.carousel){var n=1==a.settings.moveSlides?a.active.index:a.active.index*b();for(s=a.children.eq(n),i=1;i<=a.settings.maxSlides-1;i++)s=s.add(n+i>=a.children.length?a.children.eq(i-1):a.children.eq(n+i))}else s=a.children.eq(a.active.index);else s=a.children;return"vertical"==a.settings.mode?(s.each(function(){t+=e(this).outerHeight()}),a.settings.slideMargin>0&&(t+=a.settings.slideMargin*(a.settings.minSlides-1))):t=Math.max.apply(Math,s.map(function(){return e(this).outerHeight(!1)}).get()),t},f=function(){var e="100%";return a.settings.slideWidth>0&&(e="horizontal"==a.settings.mode?a.settings.maxSlides*a.settings.slideWidth+(a.settings.maxSlides-1)*a.settings.slideMargin:a.settings.slideWidth),e},g=function(){var e=a.settings.slideWidth,t=a.viewport.width();return 0==a.settings.slideWidth||a.settings.slideWidth>t&&!a.carousel||"vertical"==a.settings.mode?e=t:a.settings.maxSlides>1&&"horizontal"==a.settings.mode&&(t>a.maxThreshold||t<a.minThreshold&&(e=(t-a.settings.slideMargin*(a.settings.minSlides-1))/a.settings.minSlides)),e},m=function(){var e=1;if("horizontal"==a.settings.mode&&a.settings.slideWidth>0)if(a.viewport.width()<a.minThreshold)e=a.settings.minSlides;else if(a.viewport.width()>a.maxThreshold)e=a.settings.maxSlides;else{var t=a.children.first().width();e=Math.floor(a.viewport.width()/t)}else"vertical"==a.settings.mode&&(e=a.settings.minSlides);return e},v=function(){var e=0;if(a.settings.moveSlides>0)if(a.settings.infiniteLoop)e=a.children.length/b();else for(var t=0,i=0;t<a.children.length;)++e,t=i+m(),i+=a.settings.moveSlides<=m()?a.settings.moveSlides:m();else e=Math.ceil(a.children.length/m());return e},b=function(){return a.settings.moveSlides>0&&a.settings.moveSlides<=m()?a.settings.moveSlides:m()},y=function(){if(a.children.length>a.settings.maxSlides&&a.active.last&&!a.settings.infiniteLoop){if("horizontal"==a.settings.mode){var e=a.children.last(),t=e.position();w(-(t.left-(a.viewport.width()-e.width())),"reset",0)}else if("vertical"==a.settings.mode){var i=a.children.length-a.settings.minSlides,t=a.children.eq(i).position();w(-t.top,"reset",0)}}else{var t=a.children.eq(a.active.index*b()).position();a.active.index==v()-1&&(a.active.last=!0),void 0!=t&&("horizontal"==a.settings.mode?w(-t.left,"reset",0):"vertical"==a.settings.mode&&w(-t.top,"reset",0))}},w=function(e,t,i,s){if(a.usingCSS){var n="vertical"==a.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";o.css("-"+a.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==t?(o.css(a.animProp,n),o.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){o.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),M()})):"reset"==t?o.css(a.animProp,n):"ticker"==t&&(o.css("-"+a.cssPrefix+"-transition-timing-function","linear"),o.css(a.animProp,n),o.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){o.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),w(s.resetValue,"reset",0),R()}))}else{var r={};r[a.animProp]=e,"slide"==t?o.animate(r,i,a.settings.easing,function(){M()}):"reset"==t?o.css(a.animProp,e):"ticker"==t&&o.animate(r,speed,"linear",function(){w(s.resetValue,"reset",0),R()})}},_=function(){for(var t="",i=v(),s=0;i>s;s++){var n="";a.settings.buildPager&&e.isFunction(a.settings.buildPager)?(n=a.settings.buildPager(s),a.pagerEl.addClass("bx-custom-pager")):(n=s+1,a.pagerEl.addClass("bx-default-pager")),t+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}a.pagerEl.html(t)},C=function(){a.settings.pagerCustom?a.pagerEl=e(a.settings.pagerCustom):(a.pagerEl=e('<div class="bx-pager" />'),a.settings.pagerSelector?e(a.settings.pagerSelector).html(a.pagerEl):a.controls.el.addClass("bx-has-pager").append(a.pagerEl),_()),a.pagerEl.delegate("a","click",P)},x=function(){a.controls.next=e('<a class="bx-next" href="">'+a.settings.nextText+"</a>"),a.controls.prev=e('<a class="bx-prev" href="">'+a.settings.prevText+"</a>"),a.controls.next.bind("click",T),a.controls.prev.bind("click",$),a.settings.nextSelector&&e(a.settings.nextSelector).append(a.controls.next),a.settings.prevSelector&&e(a.settings.prevSelector).append(a.controls.prev),a.settings.nextSelector||a.settings.prevSelector||(a.controls.directionEl=e('<div class="bx-controls-direction" />'),a.controls.directionEl.append(a.controls.prev).append(a.controls.next),a.controls.el.addClass("bx-has-controls-direction").append(a.controls.directionEl))},S=function(){a.controls.start=e('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+a.settings.startText+"</a></div>"),a.controls.stop=e('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+a.settings.stopText+"</a></div>"),a.controls.autoEl=e('<div class="bx-controls-auto" />'),a.controls.autoEl.delegate(".bx-start","click",A),a.controls.autoEl.delegate(".bx-stop","click",D),a.settings.autoControlsCombine?a.controls.autoEl.append(a.controls.start):a.controls.autoEl.append(a.controls.start).append(a.controls.stop),a.settings.autoControlsSelector?e(a.settings.autoControlsSelector).html(a.controls.autoEl):a.controls.el.addClass("bx-has-controls-auto").append(a.controls.autoEl),L(a.settings.autoStart?"stop":"start")},k=function(){a.children.each(function(){var t=e(this).find("img:first").attr("title");void 0!=t&&(""+t).length&&e(this).append('<div class="bx-caption"><span>'+t+"</span></div>")})},T=function(e){a.settings.auto&&o.stopAuto(),o.goToNextSlide(),e.preventDefault()},$=function(e){a.settings.auto&&o.stopAuto(),o.goToPrevSlide(),e.preventDefault()},A=function(e){o.startAuto(),e.preventDefault()},D=function(e){o.stopAuto(),e.preventDefault()},P=function(t){a.settings.auto&&o.stopAuto();var i=e(t.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=a.active.index&&o.goToSlide(s),t.preventDefault()},I=function(t){var i=a.children.length;return"short"==a.settings.pagerType?(a.settings.maxSlides>1&&(i=Math.ceil(a.children.length/a.settings.maxSlides)),void a.pagerEl.html(t+1+a.settings.pagerShortSeparator+i)):(a.pagerEl.find("a").removeClass("active"),void a.pagerEl.each(function(i,s){e(s).find("a").eq(t).addClass("active")}))},M=function(){if(a.settings.infiniteLoop){var e="";0==a.active.index?e=a.children.eq(0).position():a.active.index==v()-1&&a.carousel?e=a.children.eq((v()-1)*b()).position():a.active.index==a.children.length-1&&(e=a.children.eq(a.children.length-1).position()),"horizontal"==a.settings.mode?w(-e.left,"reset",0):"vertical"==a.settings.mode&&w(-e.top,"reset",0)}a.working=!1,a.settings.onSlideAfter(a.children.eq(a.active.index),a.oldIndex,a.active.index)},L=function(e){a.settings.autoControlsCombine?a.controls.autoEl.html(a.controls[e]):(a.controls.autoEl.find("a").removeClass("active"),a.controls.autoEl.find("a:not(.bx-"+e+")").addClass("active"))},E=function(){1==v()?(a.controls.prev.addClass("disabled"),a.controls.next.addClass("disabled")):!a.settings.infiniteLoop&&a.settings.hideControlOnEnd&&(0==a.active.index?(a.controls.prev.addClass("disabled"),a.controls.next.removeClass("disabled")):a.active.index==v()-1?(a.controls.next.addClass("disabled"),a.controls.prev.removeClass("disabled")):(a.controls.prev.removeClass("disabled"),a.controls.next.removeClass("disabled")))},F=function(){a.settings.autoDelay>0?setTimeout(o.startAuto,a.settings.autoDelay):o.startAuto(),a.settings.autoHover&&o.hover(function(){a.interval&&(o.stopAuto(!0),a.autoPaused=!0)},function(){a.autoPaused&&(o.startAuto(!0),a.autoPaused=null)})},N=function(){var t=0;if("next"==a.settings.autoDirection)o.append(a.children.clone().addClass("bx-clone"));else{o.prepend(a.children.clone().addClass("bx-clone"));var i=a.children.first().position();t="horizontal"==a.settings.mode?-i.left:-i.top}w(t,"reset",0),a.settings.pager=!1,a.settings.controls=!1,a.settings.autoControls=!1,a.settings.tickerHover&&!a.usingCSS&&a.viewport.hover(function(){o.stop()},function(){var t=0;a.children.each(function(){t+="horizontal"==a.settings.mode?e(this).outerWidth(!0):e(this).outerHeight(!0)});var i=a.settings.speed/t,s="horizontal"==a.settings.mode?"left":"top",n=i*(t-Math.abs(parseInt(o.css(s))));R(n)}),R()},R=function(e){speed=e?e:a.settings.speed;var t={left:0,top:0},i={left:0,top:0};"next"==a.settings.autoDirection?t=o.find(".bx-clone").first().position():i=a.children.first().position();var s="horizontal"==a.settings.mode?-t.left:-t.top,n="horizontal"==a.settings.mode?-i.left:-i.top,r={resetValue:n};w(s,"ticker",speed,r)},B=function(){a.touch={start:{x:0,y:0},end:{x:0,y:0}},a.viewport.bind("touchstart",O)},O=function(e){if(a.working)e.preventDefault();else{a.touch.originalPos=o.position();var t=e.originalEvent;a.touch.start.x=t.changedTouches[0].pageX,a.touch.start.y=t.changedTouches[0].pageY,a.viewport.bind("touchmove",z),a.viewport.bind("touchend",j)}},z=function(e){var t=e.originalEvent,i=Math.abs(t.changedTouches[0].pageX-a.touch.start.x),s=Math.abs(t.changedTouches[0].pageY-a.touch.start.y);if(3*i>s&&a.settings.preventDefaultSwipeX?e.preventDefault():3*s>i&&a.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=a.settings.mode&&a.settings.oneToOneTouch){var n=0;if("horizontal"==a.settings.mode){var o=t.changedTouches[0].pageX-a.touch.start.x;n=a.touch.originalPos.left+o}else{var o=t.changedTouches[0].pageY-a.touch.start.y;n=a.touch.originalPos.top+o}w(n,"reset",0)}},j=function(e){a.viewport.unbind("touchmove",z);var t=e.originalEvent,i=0;if(a.touch.end.x=t.changedTouches[0].pageX,a.touch.end.y=t.changedTouches[0].pageY,"fade"==a.settings.mode){var s=Math.abs(a.touch.start.x-a.touch.end.x);s>=a.settings.swipeThreshold&&(a.touch.start.x>a.touch.end.x?o.goToNextSlide():o.goToPrevSlide(),o.stopAuto())}else{var s=0;"horizontal"==a.settings.mode?(s=a.touch.end.x-a.touch.start.x,i=a.touch.originalPos.left):(s=a.touch.end.y-a.touch.start.y,i=a.touch.originalPos.top),!a.settings.infiniteLoop&&(0==a.active.index&&s>0||a.active.last&&0>s)?w(i,"reset",200):Math.abs(s)>=a.settings.swipeThreshold?(0>s?o.goToNextSlide():o.goToPrevSlide(),o.stopAuto()):w(i,"reset",200)}a.viewport.unbind("touchend",j)},H=function(){var t=e(window).width(),i=e(window).height();(r!=t||l!=i)&&(r=t,l=i,o.redrawSlider())};return o.goToSlide=function(t,i){if(!a.working&&a.active.index!=t)if(a.working=!0,a.oldIndex=a.active.index,a.active.index=0>t?v()-1:t>=v()?0:t,a.settings.onSlideBefore(a.children.eq(a.active.index),a.oldIndex,a.active.index),"next"==i?a.settings.onSlideNext(a.children.eq(a.active.index),a.oldIndex,a.active.index):"prev"==i&&a.settings.onSlidePrev(a.children.eq(a.active.index),a.oldIndex,a.active.index),a.active.last=a.active.index>=v()-1,a.settings.pager&&I(a.active.index),a.settings.controls&&E(),"fade"==a.settings.mode)a.settings.adaptiveHeight&&a.viewport.height()!=p()&&a.viewport.animate({height:p()},a.settings.adaptiveHeightSpeed),a.children.filter(":visible").fadeOut(a.settings.speed).css({zIndex:0}),a.children.eq(a.active.index).css("zIndex",51).fadeIn(a.settings.speed,function(){e(this).css("zIndex",50),M()});else{a.settings.adaptiveHeight&&a.viewport.height()!=p()&&a.viewport.animate({height:p()},a.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!a.settings.infiniteLoop&&a.carousel&&a.active.last)if("horizontal"==a.settings.mode){var r=a.children.eq(a.children.length-1);n=r.position(),s=a.viewport.width()-r.outerWidth()}else{var l=a.children.length-a.settings.minSlides;n=a.children.eq(l).position()}else if(a.carousel&&a.active.last&&"prev"==i){var h=1==a.settings.moveSlides?a.settings.maxSlides-b():(v()-1)*b()-(a.children.length-a.settings.maxSlides),r=o.children(".bx-clone").eq(h);n=r.position()}else if("next"==i&&0==a.active.index)n=o.find("> .bx-clone").eq(a.settings.maxSlides).position(),a.active.last=!1;else if(t>=0){var d=t*b();n=a.children.eq(d).position()}if("undefined"!=typeof n){var c="horizontal"==a.settings.mode?-(n.left-s):-n.top;w(c,"slide",a.settings.speed)}}},o.goToNextSlide=function(){if(a.settings.infiniteLoop||!a.active.last){var e=parseInt(a.active.index)+1;o.goToSlide(e,"next")}},o.goToPrevSlide=function(){if(a.settings.infiniteLoop||0!=a.active.index){var e=parseInt(a.active.index)-1;o.goToSlide(e,"prev")}},o.startAuto=function(e){a.interval||(a.interval=setInterval(function(){"next"==a.settings.autoDirection?o.goToNextSlide():o.goToPrevSlide()},a.settings.pause),a.settings.autoControls&&1!=e&&L("stop"))},o.stopAuto=function(e){a.interval&&(clearInterval(a.interval),a.interval=null,a.settings.autoControls&&1!=e&&L("start"))},o.getCurrentSlide=function(){return a.active.index},o.getSlideCount=function(){return a.children.length},o.redrawSlider=function(){a.children.add(o.find(".bx-clone")).outerWidth(g()),a.viewport.css("height",p()),a.settings.ticker||y(),a.active.last&&(a.active.index=v()-1),a.active.index>=v()&&(a.active.last=!0),a.settings.pager&&!a.settings.pagerCustom&&(_(),I(a.active.index))},o.destroySlider=function(){a.initialized&&(a.initialized=!1,e(".bx-clone",this).remove(),a.children.each(function(){void 0!=e(this).data("origStyle")?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")}),void 0!=e(this).data("origStyle")?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style"),e(this).unwrap().unwrap(),a.controls.el&&a.controls.el.remove(),a.controls.next&&a.controls.next.remove(),a.controls.prev&&a.controls.prev.remove(),a.pagerEl&&a.pagerEl.remove(),e(".bx-caption",this).remove(),a.controls.autoEl&&a.controls.autoEl.remove(),clearInterval(a.interval),a.settings.responsive&&e(window).unbind("resize",H))},o.reloadSlider=function(e){void 0!=e&&(n=e),o.destroySlider(),h()},h(),this}}(jQuery),define("bxslider",function(){}),define("modules/sports/sports-story-video",["jquery","underscore","state","pubsub","backbone","baseview","directAdPosition","modules/global/brightcove-video","modules/stories/share-facebook","bxslider"],function(e,t,i,s,n,a,o,r,l){"use strict";var h=r.extend({events:function(){var e=r.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .sports-video-promo-link":"createPlayer"})},initialize:function(i){r.prototype.initialize.call(this,i),this.$spVideoObj=e(".sp-video-player-modal"),this.isPlaying=!1,this.$globalHeaderEl=e("body header:first"),this.$overlayCloseEl=e(".close-wrap"),this.activeVideoId="",this.modalHtml='<div id="sp-videomodal-overlay" class="sp-videomodal-overlay"></div>',this.modalHtml+='<div id="sp-videomodal-container" class="sp-videomodal-container">',this.modalHtml+='<a id="sp-videomodal-close" class="sp-videomodal-close" title="Close"></a>',this.modalHtml+='<div id="sp-videomodal-wrapper" class="sp-videomodal-wrapper loading">',this.modalHtml+="</div></div>",this.$promoEl="",this.videoType="",this.cuedVideoId="",this.autoRotate=!0,this.subviews={},t.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this._initAd()},_buildBrightCoveLoadCallback:function(){e(".sp-video-player-modal").length>0&&(this.$brightcove=e(".sp-video-player-modal .BrightcoveExperience"),this.brightcoveId=e(".sp-video-player-modal .BrightcoveExperience").attr("id")),window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.brightcove.createExperiences(),window.BCLoad?console.log("BCLoad is already here"):window.BCLoad=function(e){window.BCCallbacks[e]?window.BCCallbacks[e](e):console.log("received brightcove callback for video that does not exist: "+e)}},_initAd:function(){var e=this.$(".sp-player-sponsor");e.length&&(this.subviews.ad=new o({el:e,adSizes:["sponsor_logo"],adPlacement:"video_sponsor_logo",pageInfo:i.getActivePageInfo()}))},updateTrackingDataObj:function(e){this.$videoObj=e},createPlayer:function(i){""===this.$promoEl&&(i.preventDefault(),this.$promoEl=e(i.currentTarget)),"undefined"!=typeof window.brightcove?this.fetchPlaylist(this.$promoEl):this.loadScripts(t.bind(this.createPlayer,this))},loadVideoById:function(t,i){this.updateTrackingDataObj(i),this.closeShare(),this.updateActiveItem(i),this.modVP.loadVideoByID(t),this.populateUtilityShare(e(i).find("a"))},fetchPlaylist:function(s){this.showModal();var n=e(s).data("playlistid"),a=e(s).data("playerid"),o=e(s).data("playerkey"),r=e(s).data("awspath");this.modifyGlobalElements();var l="/sports/services/sports-video/playlist/"+a+"/"+n+"/"+o+"/?awspath="+r,h=this.launchVideoPromo;i.fetchHtml(l).done(t.bind(h,this))},launchVideoPromo:function(t){e("#sp-videomodal-wrapper").html(t),e("#sp-videomodal-wrapper").removeClass("loading"),this.$videoObj=e(".sp-video-player-modal .player"),this._buildBrightCoveLoadCallback(),this.initPlaylistCarousel(),this.initShareEvents()},initPlaylistCarousel:function(){this.$sliderEl=e(".sp-video-player-modal .bxslider"),this.$sliderEl.bxSlider({slideWidth:128,minSlides:1,maxSlides:6,pager:!1,slideMargin:10,onSliderLoad:t.bind(function(){this.initPlaylistItems()},this),onSlideAfter:t.bind(function(){this.$sliderEl.find("a[data-id='"+this.activeVideoId+"']").parent().addClass("active")},this)})},initPlaylistItems:function(){this.$spVideoObj=e(".sp-video-player-modal"),this.activeEl=e(".sp-video-player-modal .bxslider .active"),this.activeVideoId=this.activeEl.find("a").data("id"),this.$nextEl=e(".sp-video-player-modal .bxslider .active").next(),this.nextAsset=e(".sp-video-player-modal .bxslider .active").next().find("a").data("id"),e(".sp-video-player-modal .bxslider .item a").click(t.bind(function(t){t.preventDefault();var i=e(t.currentTarget).data("id"),s=e(t.currentTarget).data("title");e(t.currentTarget).parent().siblings().removeClass("active"),e(t.currentTarget).parent().addClass("active"),e(".sp-video-player-modal .asset-title").html(s),this.loadVideoById(i,e(t.currentTarget).parent())},this))},modifyGlobalElements:function(){this.$globalHeaderEl.css("position","relative").css("z-index","1000"),this.$overlayCloseEl.hide()},resetGlobalElements:function(){this.$globalHeaderEl.css("position","interit").css("z-index","auto"),this.$overlayCloseEl.show()},initShareEvents:function(){this.subviews.shareTools=new l({el:".sp-video-player-modal"}),e(".util-bar-btn-facebook").click(t.bind(function(){this.pausePlayer()},this)),e(".util-bar-flyout-close-ribbon").click(t.bind(function(){this.unpausePlayer()},this))},populateUtilityShare:function(t){var i=e(t).data("title"),s=e(t).data("desc"),n=e(t).data("shorturl"),a=e(t).data("pageurl"),o="https://twitter.com/intent/tweet?url="+n+"&via=USATODAY&text="+i,r="//plus.google.com/share?url="+n,l="http://www.linkedin.com/shareArticle?url="+n+"&mini=true",h="";h=e(t).find("figure").length>0?e(t).find("figure").find("img").attr("src"):e(t).data("imageurl"),this.$spVideoObj.find(".util-bar-flyout-nav-btn-twitter").attr("href",o),this.$spVideoObj.find(".util-bar-flyout-nav-btn-googleplus").attr("href",r),this.$spVideoObj.find(".util-bar-flyout-nav-btn-linkedin").attr("href",l),this.$spVideoObj.find(".util-bar-share-message-facebook").data("link",a),this.$spVideoObj.find(".util-bar-share-message-facebook").data("title",i),this.$spVideoObj.find(".util-bar-share-message-facebook").data("image",h),this.$spVideoObj.find(".util-bar-share-form-email textarea").html(i+"on USAToday.com: "+n),this.$spVideoObj.find(".util-bar-share-summary-title").html(i),this.$spVideoObj.find(".util-bar-share-summary-description").html(s),this.$spVideoObj.find(".util-bar-share-summary-image").data("src",h),this.$spVideoObj.find(".util-bar-share-summary-image").attr("src",h),this.$spVideoObj.find(".util-bar-share-loading-facebook").data("image",h)},pausePlayer:function(){i.startRefreshTimer();this.modVP.getIsPlaying(t.bind(function(e){this.isPlaying=e===!1?!1:!0},this));this.modVP.pause(!0)},unpausePlayer:function(){i.stopRefreshTimer(),this.isPlaying===!0&&this.modVP.pause(!1)},showModal:function(){var i=e(document).scrollTop()+30;e("body").append(this.modalHtml),e("#sp-videomodal-container").css("top",i+"px"),e("#sp-videomodal-overlay").fadeIn("slow",function(){e("#sp-videomodal-container").fadeIn("slow")}),e("#sp-videomodal-overlay").click(t.bind(function(e){this.closeModal(e)},this)),e("#sp-videomodal-close").click(t.bind(function(e){this.closeModal(e)},this))},setNextAsset:function(t){e(t).next(".item").length>0?(this.nextAsset=e(t).next().find("a").data("id"),this.$nextEl=e(t).next()):(this.nextAsset=e(t).siblings().filter(":first").find("a").data("id"),this.$nextEl=e(t).siblings().filter(":first"))},updateActiveItem:function(t){this.activeEl=t,this.activeVideoId=e(t).find("a").data("id"),e(t).siblings().removeClass("active"),e(t).addClass("active"),this.setNextAsset(e(t))},closeShare:function(){e(".util-bar-flyout-share-video").hasClass("open")&&e(".util-bar-flyout-close-ribbon").trigger("click")},closeModal:function(){this.modExp.removeEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.resetGlobalElements(),e("#sp-videomodal-overlay").fadeOut("fast",function(){e(this).remove()}),e("#sp-videomodal-container").fadeOut("fast",function(){e(this).remove()})},onVideoComplete:function(){if(this.$activeEl=this.$nextEl,this.autoRotate!==!1&&(this.loadVideoById(this.nextAsset,this.$nextEl),e(".sp-video-player-modal").length>0)){var t=e(".sp-video-player-modal .bx-viewport").innerWidth(),i=e(".sp-video-player-modal .bx-viewport").offset().left,s=i+t,n=e(this.$activeEl).offset().left;n>s&&e(".sp-video-player-modal .bx-next").trigger("click"),e(".sp-video-player-modal .asset-title").text(e(this.$nextEl).find("a").data("title"))}},onBrightCoveLoad:function(){r.prototype.onBrightCoveLoad.apply(this,arguments),this.videoType=this.player.type},onTemplateReady:function(){r.prototype.onTemplateReady.apply(this,arguments),"html"===this.videoType&&this.modVP.canPlayWithoutInteraction()?this.modVP.cueVideoByID(this.cuedVideoId):this.modVP.loadVideoByID(this.cuedVideoId)},destroy:function(){a.prototype.destroy.apply(this,arguments)}});return h}),define("modules/sports/sports-front-video",["jquery","underscore","state","backbone","baseview","directAdPosition","modules/sports/sports-story-video","modules/stories/share-facebook"],function(e,t,i,s,n,a,o,r){var l=o.extend({events:function(){var e=o.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .sp-video-player .playlist .item a":"initVideoAsset","click .video-still-play":"loadScripts","click .sp-video-player .util-bar-btn-facebook-video":"pausePlayer","click .sp-video-player .util-bar-flyout-close-ribbon":"unpausePlayer"})},initialize:function(i){o.prototype.initialize.call(this,i),this.$spVideoObj=e(".sp-video-player"),this.$brightcove=e(".sp-video-player .BrightcoveExperience"),this.$embed=e(".sp-video-player .embed"),this.brightcoveId=this.$embed.data("brightcoveid"),this.playerId=this.$embed.data("playerid"),this.playerKey=this.$embed.data("playerkey"),this.defaultVideoId=this.$embed.data("videoid"),this.activeEl=e(".sp-video-player .active"),this.$nextEl=e(".sp-video-player .active").next(),this.nextAsset=e(".sp-video-player .active").next().find("a").data("id"),this.playlistLength=e(".sp-video-player .item").length,this.$playerEl=e(".sp-video-player .player"),this.$videoStillEl=e(".sp-video-player .video-still"),this.videoStillVisible=!0,this.$videoObj=this.$playerEl,this.cuedVideoId=this.$spVideoObj.first().data("id"),this.videoType="",this.autoRotate=this.$playerEl.data("autorotate"),this.adServerUrl=this.$embed.data("adserverurl"),this.subviews={},this.$sponsorlogo=e(".sp-player-sponsor"),t.bindAll(this,"_buildBrightCoveLoadCallback","swapStillToVideo","onTemplateReady","onBrightCoveLoad","onVideoComplete","onVideoStart","pausePlayer","unpausePlayer","isPlayingHandler","determineCompletion"),this.$embed.empty(),this.$videoStillEl.show(),this.updateActiveItem(e(".sp-video-player .item").first()),window.swfobject.hasFlashPlayerVersion("1")&&e(".sp-video-player .player .embed").hide(),this.embedHtml='<object id="'+this.brightcoveId+'" class="BrightcoveExperience">',this.embedHtml+='<param name="bgcolor" value="#FFFFFF" />',this.embedHtml+='<param name="width" value="464" />',this.embedHtml+='<param name="height" value="262" />',this.embedHtml+='<param name="playerID" value="'+this.playerId+'" />',this.embedHtml+='<param name="playerKey" value="'+this.playerKey+'" />',this.embedHtml+='<param name="autoStart" value="true" />',this.embedHtml+='<param name="isVid" value="true" />',this.embedHtml+='<param name="isUI" value="true" />',this.embedHtml+='<param name="wmode" value="transparent" />',this.embedHtml+='<param name="htmlFallback" value="true" />',this.embedHtml+='<param name="usat_hasEmbed" value="true" />',this.embedHtml+='<param name="usat_shareFunction" value="function(){setTimeout(&quot;$(\'.util-bar-btn-facebook-video\').click();&quot;, 1)}" />',this.embedHtml+='<param name="dynamicStreaming" value="true" />',this.embedHtml+='<param name="@videoPlayer" value="'+this.defaultVideoId+'" />',this.embedHtml+='<param name="includeAPI" value="true" />',this.embedHtml+='<param name="templateLoadHandler" value="BCLoad" />',""!==this.adServerUrl&&(this.embedHtml+='<param name="adServerURL" value="'+this.adServerUrl+'" />'),this.embedHtml+="</object>",e(".sp-video-player .player .embed").html(this.embedHtml)},initVideoAsset:function(t){t.preventDefault();var i=e(t.currentTarget).data("id"),s=e(t.currentTarget).parent();this.videoStillVisible===!0?(e(t.currentTarget).parent().hasClass("item")&&e("#"+this.brightcoveId).find('param[name="@videoPlayer"]').val(i),this.loadScripts(t)):this.loadVideoById(i,s)},loadVideoById:function(t,i){this.updateTrackingDataObj(e(i)),this.cuedVideoId=t,this.closeShare(),this.updateActiveItem(i),this.modVP.loadVideoByID(t),this.populateUtilityShare(e(i).find("a"))},loadScripts:function(e){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],t.bind(function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),this._buildBrightCoveLoadCallback(),this.swapStillToVideo(e)):console.log("Error loading Brightcove")},this))},swapStillToVideo:function(s){i.stopRefreshTimer(),this.initShareEvents(),this.videoStillVisible=!1,this.$videoStillEl.fadeOut("fast",t.bind(function(){if(e(s.currentTarget).parent().hasClass("item")){{var t=e(s.currentTarget).data("id");e(s.currentTarget).parent()}this.cuedVideoId=t,this.updateTrackingDataObj(e(s.currentTarget).parent()),this.updateActiveItem(e(s.currentTarget).parent()),this.populateUtilityShare(e(s.currentTarget))}this.$embed.css("display","block"),this.populateUtilityShare(e(this.activeEl).find("a"))},this))},initShareEvents:function(){this.subviews.shareTools=new r({el:".sp-video-player"})},destroy:function(){if(this.$sponsorlogo.empty(),i.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),this.modVP&&window.site_vars.SMARTPLAYER&&(this.modVP.getIsPlaying(this.isPlayingHandler),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===t.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0;try{delete window.BCCallbacks,delete window.BCLoad}catch(e){}}}else console.warn("BCCallbacks no longer available on video destroy");n.prototype.destroy.apply(this,arguments)}});return l}),define("modules/stories/sponsored-series-topbar",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({animationTime:200,events:{"click .close-drawer":"closeDrawer","click nav ul li a":"toggleDrawer"},closeDrawer:function(){return this.$navAnchors.removeClass("open"),this.$drawer.slideUp(this.animationTime,t.bind(function(){this.$drawer.removeClass("open").removeAttr("style"),this.$openSection.removeClass("open").removeAttr("style"),this.$openSection=null},this)),!1},initialize:function(t){this.options=e.extend({},t),this.$navAnchors=this.$("nav ul li a"),this.$drawer=this.$(".drawer"),this.$sectionAbout=e(".sponsor-about",this.$drawer),this.$sectionResources=e(".sponsor-resources",this.$drawer),this.$sectionVideos=e(".sponsor-videos",this.$drawer)},toggleDrawer:function(i){var s=e(i.target);if(s.hasClass("open"))this.closeDrawer();else{this.$navAnchors.removeClass("open"),s.addClass("open");var n=null;switch(s.attr("href")){case"#sponsor-about":n=this.$sectionAbout;break;case"#sponsor-resources":n=this.$sectionResources;break;case"#sponsor-videos":n=this.$sectionVideos}this.$openSection?this.$openSection.slideUp(this.animationTime,t.bind(function(){this.$openSection.removeClass("open").removeAttr("style"),n.slideDown(this.animationTime,t.bind(function(){n.addClass("open").removeAttr("style")},this))},this)):(n.addClass("open").removeAttr("style"),this.$drawer.slideDown(this.animationTime,t.bind(function(){this.$drawer.addClass("open").removeAttr("style")},this))),this.$openSection=n}return!1}});return s}),define("modules/book-reviews/books-three-up",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","directAdPosition"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"booksThreeUpAdReady"),this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new a({el:this.$("#ListFilter")})},renderCardInfo:function(e){if(this.booksThreeUpAd=this.$(".books-three-up-ad-module"),this.booksThreeUpAd.length)if(e.belowHeroAd){var t={el:this.booksThreeUpAd.find(".books-three-up-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.booksThreeUpAdReady};this.subviews.booksThreeUpAd=new o(t)}else this.booksThreeUpAd.hide()},booksThreeUpAdReady:function(){this.$el.addClass("has-poster-ad"),this.subviews.booksThreeUpAd.playAd()
},submitBooklistSearchForm:function(e){e.preventDefault();var t=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+t+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;n.goTo(s)}});return r}),define("modules/twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(e,t,i,s,n){"use strict";var a=s.extend({initialize:function(t){t=e.extend({layoutType:null},t),this.$twitterEl=this.$(".twm-wrapper"),this.isFixed=this.$el.closest(".sidebar-fixed-content").length,s.prototype.initialize.call(this,t)},renderCardInfo:function(e){"sidebar"===this.options.layoutType&&e.sidebarOpen&&this.addScrollbar()},openSideBar:function(){this.renderCardInfo({sidebarOpen:!0})},destroy:function(e){e&&this.$twitterEl.empty(),s.prototype.destroy.call(this,!1)},onSidebarScrollableHeightChange:function(i,s){if("sidebar"===this.options.layoutType){var n=t.reduce(this.$el.siblings(".card-sidebar"),function(t,i){return t+e(i).outerHeight()},0);this.$el.css("height",(this.isFixed?i:s)-n),this.refreshScrollbar()}},refreshScrollbar:function(){this.subviews&&this.subviews.scrollbar&&this.subviews.scrollbar.refresh(),"sidebar"!==this.options.layoutType||this.isFixed||i.getActiveApp().triggerEvent("refreshSidebarScroll")},addScrollbar:function(){this.subviews.scrollbar=new n({el:this.$(".twitter-sidebar-content"),color:"light",lockPageScroll:!0,fadeout:!0})}});return a}),define("modules/car-search",["jquery","underscore","baseview","state","form/base-form","ui/button-toggle"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"submit .cars-form-wrap":"onFormSubmit","click .cars-form-radio":"onNewUsedToggleSelect"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"onNewUsedToggleSelect","onMakeDropdownSelect","onModelDropdownSelect"),this.form=this.$(".cars-form-wrap"),this.baseFormUrl=this.form.attr("action"),this.form.attr("action",this._buildFormUrl(this.baseFormUrl)),this.subviews.carSearchForm=new n({el:this.form,formOptions:[{el:this.$(".cars-make-dropdown"),onSelect:this.onMakeDropdownSelect},{el:this.$(".cars-model-dropdown"),onSelect:this.onModelDropdownSelect}]})},onNewUsedToggleSelect:function(i){var n=e(i.currentTarget).data("value"),a="/services/cars/dropdown/"+n+"/all";s.fetchData(a).done(t.bind(function(t){this.parseDropdown("formItem2",e.parseHTML(t));var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)},this)),this.setNewUsedHiddenValues(n),this.form.attr("action",this._buildFormUrl(this.baseFormUrl))},_buildFormUrl:function(e){var t=this.$(".ui-radio-selected").data("value"),i=e;return i+="used"===t?"for-sale/searchresults.action":"go/search/newBuyIndex.jsp"},setNewUsedHiddenValues:function(e){"used"===e?(this.$("input:hidden[name='stkTyp']").val("U"),this.$("input:hidden[name='tracktype']").val("usedcc")):(this.$("input:hidden[name='stkTyp']").val("N"),this.$("input:hidden[name='tracktype']").val("newcc"))},getDropdownResetHtml:function(e){return'<option class="uotrack" value="All" selected="selected">'+e+"</option>"},onMakeDropdownSelect:function(e,i){var n,a,o=this.$(".ui-radio-selected").data("value");n="All"===e?"All":i,this.currentMakeSelectValue=n,a="/services/cars/dropdown/"+o+"/"+t.escape(n.toLowerCase()),s.fetchData(a).done(t.bind(function(t){if("All"===e){var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)}else this.parseDropdown("formItem3",t)},this)),this.setMakeHiddenValues(e,i)},onModelDropdownSelect:function(e,t){this.setModelHiddenValues(e,t)},setMakeHiddenValues:function(e,t){this.$("input:hidden[name='AmbMkId']").val(e),this.$("input:hidden[name='AmbMkNm']").val(t),this.$("input:hidden[name='mkId']").val(e)},setModelHiddenValues:function(e,t){this.$("input:hidden[name='AmbMdId']").val(e),this.$("input:hidden[name='AmbMdNm']").val(t),this.$("input:hidden[name='mdId']").val(e)},parseDropdown:function(e,t){this.subviews.carSearchForm.subviews[e].refresh(t)},onFormSubmit:function(e){var t=this.$(".cars-form-input-zip"),i=/^\d{5}(?:[-\s]\d{4})?$/,s=this.$("#cars-form-make-select option:selected").val(),n=this.$("#cars-form-model-select option:selected").val();i.test(t.val())?t.removeClass("ui-form-field-error"):(e.preventDefault(),t.addClass("ui-form-field-error")),"All"===s&&(this.$("#cars-form-make-select option:selected").removeAttr("value"),this.setMakeHiddenValues("","")),"All"===n&&(this.$("#cars-form-model-select option:selected").removeAttr("value"),this.setModelHiddenValues("",""))},destroy:function(e){this.form.attr("action",this.baseFormUrl),i.prototype.destroy.call(this,e)}});return a}),define("modules/money/market-symbol-search",["jquery","underscore","baseview","state","utils","pubsub","form/autocomplete","directAdPosition"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({events:{submit:"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"onStockSelect"),this._initAd(),this.$lookupInput=this.$(".money-markets-stock-lookup-input"),this.subviews.autocomplete=new o({el:this.$lookupInput,resultDisplayTemplate:"<%= Symbol %> - <%= Name %>",resultValueTemplate:"<%= Symbol %>",onSelect:this.onStockSelect})},_initAd:function(){var e=this.$(".mss-quote-ad");e.length&&(this.subviews.ad=new r({el:e,adSizes:[88,31],adPlacement:"sponsor_logo",adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},onStockSelect:function(e,t){var i=this.parseStockPath(t.SymbolType);this.setStockPath(i),this.$el.is("form")?this.$el.submit():this.$("form").submit()},setStockPath:function(e){this.$$(".money-markets-stock-lookup-path-input").val(e),this.triggerABTestingEvent()},getStockPath:function(){return this.$$(".money-markets-stock-lookup-path-input").val()},parseStockPath:function(e){var t="stocks";if(e)switch(e){case"C":t="stocks";break;case"F":t="mutual-funds";break;case"G":t="etfs"}return t},onFormSubmit:function(e){if(!this.getStockPath()&&(e.preventDefault(),this.$lookupInput.val())){var i=this.$lookupInput.val().toUpperCase();s.fetchData(this.$lookupInput.data("autocomplete-url")+i).done(t.bind(function(e){e&&e.length&&(t.each(e,function(e){e.Symbol===i&&(this.setStockPath(this.parseStockPath(e.SymbolType)),this.$lookupInput.val(i))},this),this.$el.submit())},this))}},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";a.trigger("abtesttrack",t)}},destroy:function(e){this.$$(".money-markets-stock-lookup-path-input").val(""),this.$lookupInput.blur(),i.prototype.destroy.call(this,e)}});return l}),define("modules/fronts/elections-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(e,t,i,s,n,a){"use strict";var o=s.extend({el:".elections-module-container",events:{"click .epm-selector":"displayChanger","click .epm-counter-div":"changeSlide","click .epm-module-link":"trackFull"},initialize:function(e){s.prototype.initialize.call(this,e),this.loadData("senate")},loadData:function(e){var i=this,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/key-race-index.json";a.fetchData(s).done(t.bind(function(t){"key"==e?i.keyRaces(e,t):i.fillBars(e,t)},this))},fillBars:function(e,t){n.trigger("uotrack","elections2014"+e+".m");var i=0,s=0,a=100,o=[];"governor"==e?(s=25,i=50,o=t.govdata[0]):"house"==e?(s=100,i=435,o=t.housedata[0]):(s=100,i=100,o=t.senatedata[0]);var r=o.dem*a/i,l=o.leandem*a/i,h=o.repub*a/i,d=o.leanrepub*a/i,c=o.other*a/i;"house"!=e&&(s+=50),setTimeout(function(){this.$(".epm-democrat ").animate({width:r+"%"},50),this.$(".epm-lean-democrat ").animate({width:l+"%"},50),this.$(".epm-republican").animate({width:h+"%"},50),this.$(".epm-lean-republican").animate({width:d+"%"},50),this.$(".epm-tossup").animate({width:c+"%"},50)},100),this.$("#democrat ").html(o.dem),this.$("#lean-democrat ").html(o.leandem),this.$("#republican").html(o.repub),this.$("#lean-republican").html(o.leanrepub),this.$("#tossup").html(o.other)},keyRaces:function(e,t){n.trigger("uotrack","elections2014"+e+".m");var i=0;if(0===this.$(".epm-carousel-li").length){for(var s=t.races,a="",o="",r="",l="",h="",d=1;d<s.length;d++){{var c=s[d],u=c.stp,p=u.toLowerCase(),f=0;s.length-1}"RL"==c.lean?(o="r-lean",r="Lean Republican"):"DL"==c.lean?(o="d-lean",r="Lean Democrat"):"T"==c.lean?(o="t-lean",r="Tossup"):(o="t-lean",r="No Lean"),l="";for(var g=0;g<c.cand.length;g++){var m=c.cand[g];2>f&&(l+="<p class='epm-candidate "+m.pty+" "+m.inc+"'>"+m.lname+"</p>"),f++}var v="/pages/interactives/elections-forecast-2014/#/race/",b="<a class='epm-candidate-box' target='_blank' href='"+v+c.id+"'>";b+="<div class='epm-candidate-state "+o+"'>"+c.st+"<span class='epm-state-holder state-icon state-lg-"+p+"'></span></div>",b+="<div class='epm-candidate-candidates'>",b+="<div class='epm-lean-container "+o+"'>"+r+"</div>",b+="<span class='epm-candidate-container'>"+l+"</span></div>",b+="</a>",d%3===0?(h+=b,a+="<li class='epm-carousel-li'>"+h+"</li>",h="",i++):h+=b}""!==h&&(a+="<li class='epm-carousel-li'>"+h+"</li>",i++),this.$(".epm-key-races-container").append(a),this.slideCalc(i)}},displayChanger:function(t){var i=e(t.target).attr("id");this.$(".epm-races-holder, .epm-key-races, .epm-governor-numbers, .epm-house-numbers, .epm-senate-numbers").hide(),"key"==i?(this.loadData("key"),this.$(".epm-map").hide(),this.$(".epm-key-races").show()):(this.loadData(i),this.$(".epm-map").show(),this.$(".epm-races-holder").show(),this.$(".epm-"+i+"-numbers").show()),this.$(".epm-selector").removeClass("selected"),this.$("#"+i).addClass("selected")},slideCalc:function(e){var t=522*e+"px";if(this.$(".epm-key-races-container").width(t),0===this.$(".epm-counter-div").length){for(var i="<div class='selected epm-counter-div' id='slide-0'></div>",s=e-1,n=0;s>n;n++){var a=n+1;i+="<div class='epm-counter-div' id='slide-"+a+"'></div>"}this.$(".epm-module-navigation").append(i)}var o=this.$(".elections-module-navigation").width(),r=510-o,l=r/2+"px";this.$(".epm-module-navigation").css("margin-left",l)},changeSlide:function(t){this.$(".epm-counter-div").removeClass("selected"),e(t.target).addClass("selected");var i=e(t.target).attr("id"),s=i.split("-"),n=s[1],a=522*n+"px";this.$(".epm-key-races-container").animate({marginLeft:"-"+a},500)},trackFull:function(){n.trigger("uotrack","elections2014full")}});return o}),document.createElement("canvas").getContext||!function(){function e(){return this.context_||(this.context_=new w(this))}function t(e,t){var i=z.call(arguments,2);return function(){return e.apply(t,i.concat(z.call(arguments)))}}function i(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function s(e,t,i){e.namespaces[t]||e.namespaces.add(t,i,"#default#VML")}function n(e){if(s(e,"g_vml_","urn:schemas-microsoft-com:vml"),s(e,"g_o_","urn:schemas-microsoft-com:office:office"),!e.styleSheets.ex_canvas_){var t=e.createStyleSheet();t.owningElement.id="ex_canvas_",t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function a(e){var t=e.srcElement;switch(e.propertyName){case"width":t.getContext().clearRect(),t.style.width=t.attributes.width.nodeValue+"px",t.firstChild.style.width=t.clientWidth+"px";break;case"height":t.getContext().clearRect(),t.style.height=t.attributes.height.nodeValue+"px",t.firstChild.style.height=t.clientHeight+"px"}}function o(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function l(e,t){for(var i=r(),s=0;3>s;s++)for(var n=0;3>n;n++){for(var a=0,o=0;3>o;o++)a+=e[s][o]*t[o][n];i[s][n]=a}return i}function h(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.globalAlpha=e.globalAlpha,t.font=e.font,t.textAlign=e.textAlign,t.textBaseline=e.textBaseline,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_,t.lineScale_=e.lineScale_}function d(e){var t=e.indexOf("(",3),i=e.indexOf(")",t+1),s=e.substring(t+1,i).split(",");return(4!=s.length||"a"!=e.charAt(3))&&(s[3]=1),s}function c(e){return parseFloat(e)/100}function u(e,t,i){return Math.min(i,Math.max(t,e))}function p(e){var t,i,s,n,a,o;if(n=parseFloat(e[0])/360%360,0>n&&n++,a=u(c(e[1]),0,1),o=u(c(e[2]),0,1),0==a)t=i=s=o;else{var r=.5>o?o*(1+a):o+a-o*a,l=2*o-r;t=f(l,r,n+1/3),i=f(l,r,n),s=f(l,r,n-1/3)}return"#"+H[Math.floor(255*t)]+H[Math.floor(255*i)]+H[Math.floor(255*s)]}function f(e,t,i){return 0>i&&i++,i>1&&i--,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}function g(e){if(e in V)return V[e];var t,i=1;if(e=String(e),"#"==e.charAt(0))t=e;else if(/^rgb/.test(e)){for(var s,n=d(e),t="#",a=0;3>a;a++)s=-1!=n[a].indexOf("%")?Math.floor(255*c(n[a])):+n[a],t+=H[u(s,0,255)];i=+n[3]}else if(/^hsl/.test(e)){var n=d(e);t=p(n),i=n[3]}else t=q[e]||e;return V[e]={color:t,alpha:i}}function m(e){if(Y[e])return Y[e];var t=document.createElement("div"),i=t.style;try{i.font=e}catch(s){}return Y[e]={style:i.fontStyle||G.style,variant:i.fontVariant||G.variant,weight:i.fontWeight||G.weight,size:i.fontSize||G.size,family:i.fontFamily||G.family}}function v(e,t){var i={};for(var s in e)i[s]=e[s];var n=parseFloat(t.currentStyle.fontSize),a=parseFloat(e.size);return i.size="number"==typeof e.size?e.size:-1!=e.size.indexOf("px")?a:-1!=e.size.indexOf("em")?n*a:-1!=e.size.indexOf("%")?n/100*a:-1!=e.size.indexOf("pt")?a/.75:n,i.size*=.981,i}function b(e){return e.style+" "+e.variant+" "+e.weight+" "+e.size+"px "+e.family}function y(e){return X[e]||"square"}function w(e){this.m_=r(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*B,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=e;var t="width:"+e.clientWidth+"px;height:"+e.clientHeight+"px;overflow:hidden;position:absolute",i=e.ownerDocument.createElement("div");i.style.cssText=t,e.appendChild(i);var s=i.cloneNode(!1);s.style.backgroundColor="red",s.style.filter="alpha(opacity=0)",e.appendChild(s),this.element_=i,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function _(e,t,i,s){e.currentPath_.push({type:"bezierCurveTo",cp1x:t.x,cp1y:t.y,cp2x:i.x,cp2y:i.y,x:s.x,y:s.y}),e.currentX_=s.x,e.currentY_=s.y}function C(e,t){var i=g(e.strokeStyle),s=i.color,n=i.alpha*e.globalAlpha,a=e.lineScale_*e.lineWidth;1>a&&(n*=a),t.push("<g_vml_:stroke",' opacity="',n,'"',' joinstyle="',e.lineJoin,'"',' miterlimit="',e.miterLimit,'"',' endcap="',y(e.lineCap),'"',' weight="',a,'px"',' color="',s,'" />')}function x(e,t,i,s){var n=e.fillStyle,a=e.arcScaleX_,o=e.arcScaleY_,r=s.x-i.x,l=s.y-i.y;if(n instanceof $){var h=0,d={x:0,y:0},c=0,u=1;if("gradient"==n.type_){var p=n.x0_/a,f=n.y0_/o,m=n.x1_/a,v=n.y1_/o,b=S(e,p,f),y=S(e,m,v),w=y.x-b.x,_=y.y-b.y;h=180*Math.atan2(w,_)/Math.PI,0>h&&(h+=360),1e-6>h&&(h=0)}else{var b=S(e,n.x0_,n.y0_);d={x:(b.x-i.x)/r,y:(b.y-i.y)/l},r/=a*B,l/=o*B;var C=M.max(r,l);c=2*n.r0_/C,u=2*n.r1_/C-c}var x=n.colors_;x.sort(function(e,t){return e.offset-t.offset});for(var k=x.length,T=x[0].color,D=x[k-1].color,P=x[0].alpha*e.globalAlpha,I=x[k-1].alpha*e.globalAlpha,L=[],E=0;k>E;E++){var F=x[E];L.push(F.offset*u+c+" "+F.color)}t.push('<g_vml_:fill type="',n.type_,'"',' method="none" focus="100%"',' color="',T,'"',' color2="',D,'"',' colors="',L.join(","),'"',' opacity="',I,'"',' g_o_:opacity2="',P,'"',' angle="',h,'"',' focusposition="',d.x,",",d.y,'" />')}else if(n instanceof A){if(r&&l){var N=-i.x,R=-i.y;t.push("<g_vml_:fill",' position="',N/r*a*a,",",R/l*o*o,'"',' type="tile"',' src="',n.src_,'" />')}}else{var O=g(e.fillStyle),z=O.color,j=O.alpha*e.globalAlpha;t.push('<g_vml_:fill color="',z,'" opacity="',j,'" />')}}function S(e,t,i){var s=e.m_;return{x:B*(t*s[0][0]+i*s[1][0]+s[2][0])-O,y:B*(t*s[0][1]+i*s[1][1]+s[2][1])-O}}function k(e){return isFinite(e[0][0])&&isFinite(e[0][1])&&isFinite(e[1][0])&&isFinite(e[1][1])&&isFinite(e[2][0])&&isFinite(e[2][1])}function T(e,t,i){if(k(t)&&(e.m_=t,i)){var s=t[0][0]*t[1][1]-t[0][1]*t[1][0];e.lineScale_=R(N(s))}}function $(e){this.type_=e,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function A(e,t){switch(P(e),t){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=t;break;default:D("SYNTAX_ERR")}this.src_=e.src,this.width_=e.width,this.height_=e.height}function D(e){throw new I(e)}function P(e){e&&1==e.nodeType&&"IMG"==e.tagName||D("TYPE_MISMATCH_ERR"),"complete"!=e.readyState&&D("INVALID_STATE_ERR")}function I(e){this.code=this[e],this.message=e+": DOM Exception "+this.code}var M=Math,L=M.round,E=M.sin,F=M.cos,N=M.abs,R=M.sqrt,B=10,O=B/2,z=(+navigator.userAgent.match(/MSIE ([\d.]+)?/)[1],Array.prototype.slice);n(document);var j={init:function(e){var i=e||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",t(this.init_,this,i))},init_:function(e){for(var t=e.getElementsByTagName("canvas"),i=0;i<t.length;i++)this.initElement(t[i])},initElement:function(t){if(!t.getContext){t.getContext=e,n(t.ownerDocument),t.innerHTML="",t.attachEvent("onpropertychange",a),t.attachEvent("onresize",o);var i=t.attributes;i.width&&i.width.specified?t.style.width=i.width.nodeValue+"px":t.width=t.clientWidth,i.height&&i.height.specified?t.style.height=i.height.nodeValue+"px":t.height=t.clientHeight}return t}};j.init();for(var H=[],U=0;16>U;U++)for(var W=0;16>W;W++)H[16*U+W]=U.toString(16)+W.toString(16);var q={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},V={},G={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},Y={},X={butt:"flat",round:"round"},Z=w.prototype;Z.clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},Z.beginPath=function(){this.currentPath_=[]},Z.moveTo=function(e,t){var i=S(this,e,t);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.lineTo=function(e,t){var i=S(this,e,t);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.bezierCurveTo=function(e,t,i,s,n,a){var o=S(this,n,a),r=S(this,e,t),l=S(this,i,s);_(this,r,l,o)},Z.quadraticCurveTo=function(e,t,i,s){var n=S(this,e,t),a=S(this,i,s),o={x:this.currentX_+2/3*(n.x-this.currentX_),y:this.currentY_+2/3*(n.y-this.currentY_)},r={x:o.x+(a.x-this.currentX_)/3,y:o.y+(a.y-this.currentY_)/3};_(this,o,r,a)},Z.arc=function(e,t,i,s,n,a){i*=B;var o=a?"at":"wa",r=e+F(s)*i-O,l=t+E(s)*i-O,h=e+F(n)*i-O,d=t+E(n)*i-O;r!=h||a||(r+=.125);var c=S(this,e,t),u=S(this,r,l),p=S(this,h,d);this.currentPath_.push({type:o,x:c.x,y:c.y,radius:i,xStart:u.x,yStart:u.y,xEnd:p.x,yEnd:p.y})},Z.rect=function(e,t,i,s){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath()},Z.strokeRect=function(e,t,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath(),this.stroke(),this.currentPath_=n},Z.fillRect=function(e,t,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath(),this.fill(),this.currentPath_=n},Z.createLinearGradient=function(e,t,i,s){var n=new $("gradient");return n.x0_=e,n.y0_=t,n.x1_=i,n.y1_=s,n},Z.createRadialGradient=function(e,t,i,s,n,a){var o=new $("gradientradial");return o.x0_=e,o.y0_=t,o.r0_=i,o.x1_=s,o.y1_=n,o.r1_=a,o},Z.drawImage=function(e){var t,i,s,n,a,o,r,l,h=e.runtimeStyle.width,d=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var c=e.width,u=e.height;if(e.runtimeStyle.width=h,e.runtimeStyle.height=d,3==arguments.length)t=arguments[1],i=arguments[2],a=o=0,r=s=c,l=n=u;else if(5==arguments.length)t=arguments[1],i=arguments[2],s=arguments[3],n=arguments[4],a=o=0,r=c,l=u;else{if(9!=arguments.length)throw Error("Invalid number of arguments");a=arguments[1],o=arguments[2],r=arguments[3],l=arguments[4],t=arguments[5],i=arguments[6],s=arguments[7],n=arguments[8]}var p=S(this,t,i),f=[],g=10,m=10;if(f.push(" <g_vml_:group",' coordsize="',B*g,",",B*m,'"',' coordorigin="0,0"',' style="width:',g,"px;height:",m,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var v=[];v.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",L(p.x/B),",","Dy=",L(p.y/B),"");var b=p,y=S(this,t+s,i),w=S(this,t,i+n),_=S(this,t+s,i+n);b.x=M.max(b.x,y.x,w.x,_.x),b.y=M.max(b.y,y.y,w.y,_.y),f.push("padding:0 ",L(b.x/B),"px ",L(b.y/B),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",v.join(""),", sizingmethod='clip');")}else f.push("top:",L(p.y/B),"px;left:",L(p.x/B),"px;");f.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',B*s,"px;"," height:",B*n,'px"',' cropleft="',a/c,'"',' croptop="',o/u,'"',' cropright="',(c-a-r)/c,'"',' cropbottom="',(u-o-l)/u,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",f.join(""))},Z.stroke=function(e){for(var t=10,i=10,s=5e3,n={x:null,y:null},a={x:null,y:null},o=0;o<this.currentPath_.length;o+=s){var r=[];r.push("<g_vml_:shape",' filled="',!!e,'"',' style="position:absolute;width:',t,"px;height:",i,'px;"',' coordorigin="0,0"',' coordsize="',B*t,",",B*i,'"',' stroked="',!e,'"',' path="');for(var l=o;l<Math.min(o+s,this.currentPath_.length);l++){l%s==0&&l>0&&r.push(" m ",L(this.currentPath_[l-1].x),",",L(this.currentPath_[l-1].y));var h,d=this.currentPath_[l];switch(d.type){case"moveTo":h=d,r.push(" m ",L(d.x),",",L(d.y));break;case"lineTo":r.push(" l ",L(d.x),",",L(d.y));break;case"close":r.push(" x "),d=null;break;case"bezierCurveTo":r.push(" c ",L(d.cp1x),",",L(d.cp1y),",",L(d.cp2x),",",L(d.cp2y),",",L(d.x),",",L(d.y));break;case"at":case"wa":r.push(" ",d.type," ",L(d.x-this.arcScaleX_*d.radius),",",L(d.y-this.arcScaleY_*d.radius)," ",L(d.x+this.arcScaleX_*d.radius),",",L(d.y+this.arcScaleY_*d.radius)," ",L(d.xStart),",",L(d.yStart)," ",L(d.xEnd),",",L(d.yEnd))}d&&((null==n.x||d.x<n.x)&&(n.x=d.x),(null==a.x||d.x>a.x)&&(a.x=d.x),(null==n.y||d.y<n.y)&&(n.y=d.y),(null==a.y||d.y>a.y)&&(a.y=d.y))}r.push(' ">'),e?x(this,r,n,a):C(this,r),r.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",r.join(""))}},Z.fill=function(){this.stroke(!0)},Z.closePath=function(){this.currentPath_.push({type:"close"})},Z.save=function(){var e={};h(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=l(r(),this.m_)},Z.restore=function(){this.aStack_.length&&(h(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},Z.translate=function(e,t){var i=[[1,0,0],[0,1,0],[e,t,1]];T(this,l(i,this.m_),!1)},Z.rotate=function(e){var t=F(e),i=E(e),s=[[t,i,0],[-i,t,0],[0,0,1]];T(this,l(s,this.m_),!1)},Z.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t;var i=[[e,0,0],[0,t,0],[0,0,1]];T(this,l(i,this.m_),!0)},Z.transform=function(e,t,i,s,n,a){var o=[[e,t,0],[i,s,0],[n,a,1]];T(this,l(o,this.m_),!0)},Z.setTransform=function(e,t,i,s,n,a){var o=[[e,t,0],[i,s,0],[n,a,1]];T(this,o,!0)},Z.drawText_=function(e,t,s,n,a){var o=this.m_,r=1e3,l=0,h=r,d={x:0,y:0},c=[],u=v(m(this.font),this.element_),p=b(u),f=this.element_.currentStyle,g=this.textAlign.toLowerCase();switch(g){case"left":case"center":case"right":break;case"end":g="ltr"==f.direction?"right":"left";break;case"start":g="rtl"==f.direction?"right":"left";break;default:g="left"}switch(this.textBaseline){case"hanging":case"top":d.y=u.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":d.y=-u.size/2.25}switch(g){case"right":l=r,h=.05;break;case"center":l=h=r/2}var y=S(this,t+d.x,s+d.y);c.push('<g_vml_:line from="',-l,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!a,'" stroked="',!!a,'" style="position:absolute;width:1px;height:1px;">'),a?C(this,c):x(this,c,{x:-l,y:0},{x:h,y:u.size});var w=o[0][0].toFixed(3)+","+o[1][0].toFixed(3)+","+o[0][1].toFixed(3)+","+o[1][1].toFixed(3)+",0,0",_=L(y.x/B)+","+L(y.y/B);c.push('<g_vml_:skew on="t" matrix="',w,'" ',' offset="',_,'" origin="',l,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',i(e),'" style="v-text-align:',g,";font:",i(p),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",c.join(""))},Z.fillText=function(e,t,i,s){this.drawText_(e,t,i,s,!1)},Z.strokeText=function(e,t,i,s){this.drawText_(e,t,i,s,!0)},Z.measureText=function(e){if(!this.textMeasureEl_){var t='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",t),this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(i.createTextNode(e)),{width:this.textMeasureEl_.offsetWidth}},Z.clip=function(){},Z.arcTo=function(){},Z.createPattern=function(e,t){return new A(e,t)},$.prototype.addColorStop=function(e,t){t=g(t),this.colors_.push({offset:e,color:t.color,alpha:t.alpha})};var K=I.prototype=new Error;K.INDEX_SIZE_ERR=1,K.DOMSTRING_SIZE_ERR=2,K.HIERARCHY_REQUEST_ERR=3,K.WRONG_DOCUMENT_ERR=4,K.INVALID_CHARACTER_ERR=5,K.NO_DATA_ALLOWED_ERR=6,K.NO_MODIFICATION_ALLOWED_ERR=7,K.NOT_FOUND_ERR=8,K.NOT_SUPPORTED_ERR=9,K.INUSE_ATTRIBUTE_ERR=10,K.INVALID_STATE_ERR=11,K.SYNTAX_ERR=12,K.INVALID_MODIFICATION_ERR=13,K.NAMESPACE_ERR=14,K.INVALID_ACCESS_ERR=15,K.VALIDATION_ERR=16,K.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=j,CanvasRenderingContext2D=w,CanvasGradient=$,CanvasPattern=A,DOMException=I}(),define("libs/flot/excanvas",function(){}),function(e){e.color={},e.color.make=function(t,i,s,n){var a={};return a.r=t||0,a.g=i||0,a.b=s||0,a.a=null!=n?n:1,a.add=function(e,t){for(var i=0;i<e.length;++i)a[e.charAt(i)]+=t;return a.normalize()},a.scale=function(e,t){for(var i=0;i<e.length;++i)a[e.charAt(i)]*=t;return a.normalize()},a.toString=function(){return a.a>=1?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")"},a.normalize=function(){function e(e,t,i){return e>t?e:t>i?i:t}return a.r=e(0,parseInt(a.r),255),a.g=e(0,parseInt(a.g),255),a.b=e(0,parseInt(a.b),255),a.a=e(0,a.a,1),a},a.clone=function(){return e.color.make(a.r,a.b,a.g,a.a)},a.normalize()},e.color.extract=function(t,i){var s;do{if(s=t.css(i).toLowerCase(),""!=s&&"transparent"!=s)break;t=t.parent()}while(!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==s&&(s="transparent"),e.color.parse(s)},e.color.parse=function(i){var s,n=e.color.make;if(s=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10));if(s=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),parseFloat(s[4]));if(s=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]));if(s=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]),parseFloat(s[4]));if(s=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return n(parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16));if(s=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return n(parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16));var a=e.trim(i).toLowerCase();return"transparent"==a?n(255,255,255,0):(s=t[a]||[0,0,0],n(s[0],s[1],s[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,i){var s=i.children("."+t)[0];if(null==s&&(s=document.createElement("canvas"),s.className=t,e(s).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(i),!s.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");s=window.G_vmlCanvasManager.initElement(s)}this.element=s;var n=this.context=s.getContext("2d"),a=window.devicePixelRatio||1,o=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;
this.pixelRatio=a/o,this.resize(i.width(),i.height()),this.textContainer=null,this.text={},this._textCache={}}function i(i,n,a,o){function r(e,t){t=[mt].concat(t);for(var i=0;i<e.length;++i)e[i].apply(this,t)}function l(){for(var i={Canvas:t},s=0;s<o.length;++s){var n=o[s];n.init(mt,i),n.options&&e.extend(!0,nt,n.options)}}function h(t){e.extend(!0,nt,t),t&&t.colors&&(nt.colors=t.colors),null==nt.xaxis.color&&(nt.xaxis.color=e.color.parse(nt.grid.color).scale("a",.22).toString()),null==nt.yaxis.color&&(nt.yaxis.color=e.color.parse(nt.grid.color).scale("a",.22).toString()),null==nt.xaxis.tickColor&&(nt.xaxis.tickColor=nt.grid.tickColor||nt.xaxis.color),null==nt.yaxis.tickColor&&(nt.yaxis.tickColor=nt.grid.tickColor||nt.yaxis.color),null==nt.grid.borderColor&&(nt.grid.borderColor=nt.grid.color),null==nt.grid.tickColor&&(nt.grid.tickColor=e.color.parse(nt.grid.color).scale("a",.22).toString());var s,n,a,o={style:i.css("font-style"),size:Math.round(.8*(+i.css("font-size").replace("px","")||13)),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(o.lineHeight=1.15*o.size,a=nt.xaxes.length||1,s=0;a>s;++s)n=nt.xaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=e.extend(!0,{},nt.xaxis,n),nt.xaxes[s]=n,n.font&&(n.font=e.extend({},o,n.font),n.font.color||(n.font.color=n.color));for(a=nt.yaxes.length||1,s=0;a>s;++s)n=nt.yaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=e.extend(!0,{},nt.yaxis,n),nt.yaxes[s]=n,n.font&&(n.font=e.extend({},o,n.font),n.font.color||(n.font.color=n.color));for(nt.xaxis.noTicks&&null==nt.xaxis.ticks&&(nt.xaxis.ticks=nt.xaxis.noTicks),nt.yaxis.noTicks&&null==nt.yaxis.ticks&&(nt.yaxis.ticks=nt.yaxis.noTicks),nt.x2axis&&(nt.xaxes[1]=e.extend(!0,{},nt.xaxis,nt.x2axis),nt.xaxes[1].position="top"),nt.y2axis&&(nt.yaxes[1]=e.extend(!0,{},nt.yaxis,nt.y2axis),nt.yaxes[1].position="right"),nt.grid.coloredAreas&&(nt.grid.markings=nt.grid.coloredAreas),nt.grid.coloredAreasColor&&(nt.grid.markingsColor=nt.grid.coloredAreasColor),nt.lines&&e.extend(!0,nt.series.lines,nt.lines),nt.points&&e.extend(!0,nt.series.points,nt.points),nt.bars&&e.extend(!0,nt.series.bars,nt.bars),null!=nt.shadowSize&&(nt.series.shadowSize=nt.shadowSize),null!=nt.highlightColor&&(nt.series.highlightColor=nt.highlightColor),s=0;s<nt.xaxes.length;++s)m(dt,s+1).options=nt.xaxes[s];for(s=0;s<nt.yaxes.length;++s)m(ct,s+1).options=nt.yaxes[s];for(var l in gt)nt.hooks[l]&&nt.hooks[l].length&&(gt[l]=gt[l].concat(nt.hooks[l]));r(gt.processOptions,[nt])}function d(e){st=c(e),v(),b()}function c(t){for(var i=[],s=0;s<t.length;++s){var n=e.extend(!0,{},nt.series);null!=t[s].data?(n.data=t[s].data,delete t[s].data,e.extend(!0,n,t[s]),t[s].data=n.data):n.data=t[s],i.push(n)}return i}function u(e,t){var i=e[t+"axis"];return"object"==typeof i&&(i=i.n),"number"!=typeof i&&(i=1),i}function p(){return e.grep(dt.concat(ct),function(e){return e})}function f(e){var t,i,s={};for(t=0;t<dt.length;++t)i=dt[t],i&&i.used&&(s["x"+i.n]=i.c2p(e.left));for(t=0;t<ct.length;++t)i=ct[t],i&&i.used&&(s["y"+i.n]=i.c2p(e.top));return void 0!==s.x1&&(s.x=s.x1),void 0!==s.y1&&(s.y=s.y1),s}function g(e){var t,i,s,n={};for(t=0;t<dt.length;++t)if(i=dt[t],i&&i.used&&(s="x"+i.n,null==e[s]&&1==i.n&&(s="x"),null!=e[s])){n.left=i.p2c(e[s]);break}for(t=0;t<ct.length;++t)if(i=ct[t],i&&i.used&&(s="y"+i.n,null==e[s]&&1==i.n&&(s="y"),null!=e[s])){n.top=i.p2c(e[s]);break}return n}function m(t,i){return t[i-1]||(t[i-1]={n:i,direction:t==dt?"x":"y",options:e.extend(!0,{},t==dt?nt.xaxis:nt.yaxis)}),t[i-1]}function v(){var t,i=st.length,s=-1;for(t=0;t<st.length;++t){var n=st[t].color;null!=n&&(i--,"number"==typeof n&&n>s&&(s=n))}s>=i&&(i=s+1);var a,o=[],r=nt.colors,l=r.length,h=0;for(t=0;i>t;t++)a=e.color.parse(r[t%l]||"#666"),t%l==0&&t&&(h=h>=0?.5>h?-h-.2:0:-h),o[t]=a.scale("rgb",1+h);var d,c=0;for(t=0;t<st.length;++t){if(d=st[t],null==d.color?(d.color=o[c].toString(),++c):"number"==typeof d.color&&(d.color=o[d.color].toString()),null==d.lines.show){var p,f=!0;for(p in d)if(d[p]&&d[p].show){f=!1;break}f&&(d.lines.show=!0)}null==d.lines.zero&&(d.lines.zero=!!d.lines.fill),d.xaxis=m(dt,u(d,"x")),d.yaxis=m(ct,u(d,"y"))}}function b(){function t(e,t,i){t<e.datamin&&t!=-b&&(e.datamin=t),i>e.datamax&&i!=b&&(e.datamax=i)}var i,s,n,a,o,l,h,d,c,u,f,g,m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=m,t.datamax=v,t.used=!1}),i=0;i<st.length;++i)o=st[i],o.datapoints={points:[]},r(gt.processRawData,[o,o.data,o.datapoints]);for(i=0;i<st.length;++i){if(o=st[i],f=o.data,g=o.datapoints.format,!g){if(g=[],g.push({x:!0,number:!0,required:!0}),g.push({y:!0,number:!0,required:!0}),o.bars.show||o.lines.show&&o.lines.fill){var y=!!(o.bars.show&&o.bars.zero||o.lines.show&&o.lines.zero);g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),o.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0)}o.datapoints.format=g}if(null==o.datapoints.pointsize){o.datapoints.pointsize=g.length,h=o.datapoints.pointsize,l=o.datapoints.points;var w=o.lines.show&&o.lines.steps;for(o.xaxis.used=o.yaxis.used=!0,s=n=0;s<f.length;++s,n+=h){u=f[s];var _=null==u;if(!_)for(a=0;h>a;++a)d=u[a],c=g[a],c&&(c.number&&null!=d&&(d=+d,isNaN(d)?d=null:1/0==d?d=b:d==-1/0&&(d=-b)),null==d&&(c.required&&(_=!0),null!=c.defaultValue&&(d=c.defaultValue))),l[n+a]=d;if(_)for(a=0;h>a;++a)d=l[n+a],null!=d&&(c=g[a],c.autoscale&&(c.x&&t(o.xaxis,d,d),c.y&&t(o.yaxis,d,d))),l[n+a]=null;else if(w&&n>0&&null!=l[n-h]&&l[n-h]!=l[n]&&l[n-h+1]!=l[n+1]){for(a=0;h>a;++a)l[n+h+a]=l[n+a];l[n+1]=l[n-h+1],n+=h}}}}for(i=0;i<st.length;++i)o=st[i],r(gt.processDatapoints,[o,o.datapoints]);for(i=0;i<st.length;++i){o=st[i],l=o.datapoints.points,h=o.datapoints.pointsize,g=o.datapoints.format;var C=m,x=m,S=v,k=v;for(s=0;s<l.length;s+=h)if(null!=l[s])for(a=0;h>a;++a)d=l[s+a],c=g[a],c&&c.autoscale!==!1&&d!=b&&d!=-b&&(c.x&&(C>d&&(C=d),d>S&&(S=d)),c.y&&(x>d&&(x=d),d>k&&(k=d)));if(o.bars.show){var T;switch(o.bars.align){case"left":T=0;break;case"right":T=-o.bars.barWidth;break;case"center":T=-o.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+o.bars.align)}o.bars.horizontal?(x+=T,k+=T+o.bars.barWidth):(C+=T,S+=T+o.bars.barWidth)}t(o.xaxis,C,S),t(o.yaxis,x,k)}e.each(p(),function(e,t){t.datamin==m&&(t.datamin=null),t.datamax==v&&(t.datamax=null)})}function y(){i.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove(),"static"==i.css("position")&&i.css("position","relative"),at=new t("flot-base",i),ot=new t("flot-overlay",i),lt=at.context,ht=ot.context,rt=e(ot.element).unbind();var s=i.data("plot");s&&(s.shutdown(),ot.clear()),i.data("plot",mt)}function w(){nt.grid.hoverable&&(rt.mousemove(q),rt.bind("mouseleave",V)),nt.grid.clickable&&rt.click(G),r(gt.bindEvents,[rt])}function _(){bt&&clearTimeout(bt),rt.unbind("mousemove",q),rt.unbind("mouseleave",V),rt.unbind("click",G),r(gt.shutdown,[rt])}function C(e){function t(e){return e}var i,s,n=e.options.transform||t,a=e.options.inverseTransform;"x"==e.direction?(i=e.scale=pt/Math.abs(n(e.max)-n(e.min)),s=Math.min(n(e.max),n(e.min))):(i=e.scale=ft/Math.abs(n(e.max)-n(e.min)),i=-i,s=Math.max(n(e.max),n(e.min))),e.p2c=n==t?function(e){return(e-s)*i}:function(e){return(n(e)-s)*i},e.c2p=a?function(e){return a(s+e/i)}:function(e){return s+e/i}}function x(e){var t=e.options,i=e.ticks||[],s=t.labelWidth||0,n=t.labelHeight||0,a=s||"x"==e.direction?Math.floor(at.width/(i.length||1)):null;legacyStyles=e.direction+"Axis "+e.direction+e.n+"Axis",layer="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+legacyStyles,font=t.font||"flot-tick-label tickLabel";for(var o=0;o<i.length;++o){var r=i[o];if(r.label){var l=at.getTextInfo(layer,r.label,font,null,a);s=Math.max(s,l.width),n=Math.max(n,l.height)}}e.labelWidth=t.labelWidth||s,e.labelHeight=t.labelHeight||n}function S(t){var i,s=t.labelWidth,n=t.labelHeight,a=t.options.position,o=t.options.tickLength,r=nt.grid.axisMargin,l=nt.grid.labelMargin,h="x"==t.direction?dt:ct,d=e.grep(h,function(e){return e&&e.options.position==a&&e.reserveSpace});if(e.inArray(t,d)==d.length-1&&(r=0),null==o){var c=e.grep(h,function(e){return e&&e.reserveSpace});i=0==e.inArray(t,c),o=i?"full":5}isNaN(+o)||(l+=+o),"x"==t.direction?(n+=l,"bottom"==a?(ut.bottom+=n+r,t.box={top:at.height-ut.bottom,height:n}):(t.box={top:ut.top+r,height:n},ut.top+=n+r)):(s+=l,"left"==a?(t.box={left:ut.left+r,width:s},ut.left+=s+r):(ut.right+=s+r,t.box={left:at.width-ut.right,width:s})),t.position=a,t.tickLength=o,t.box.padding=l,t.innermost=i}function k(e){"x"==e.direction?(e.box.left=ut.left-e.labelWidth/2,e.box.width=at.width-ut.left-ut.right+e.labelWidth):(e.box.top=ut.top-e.labelHeight/2,e.box.height=at.height-ut.bottom-ut.top+e.labelHeight)}function T(){var t,i=nt.grid.minBorderMargin,s={x:0,y:0};if(null==i)for(i=0,t=0;t<st.length;++t)i=Math.max(i,2*(st[t].points.radius+st[t].points.lineWidth/2));s.x=s.y=Math.ceil(i),e.each(p(),function(e,t){var i=t.direction;t.reserveSpace&&(s[i]=Math.ceil(Math.max(s[i],("x"==i?t.labelWidth:t.labelHeight)/2)))}),ut.left=Math.max(s.x,ut.left),ut.right=Math.max(s.x,ut.right),ut.top=Math.max(s.y,ut.top),ut.bottom=Math.max(s.y,ut.bottom)}function $(){var t,i=p(),s=nt.grid.show;for(var n in ut){var a=nt.grid.margin||0;ut[n]="number"==typeof a?a:a[n]||0}r(gt.processOffset,[ut]);for(var n in ut)ut[n]+="object"==typeof nt.grid.borderWidth?s?nt.grid.borderWidth[n]:0:s?nt.grid.borderWidth:0;if(e.each(i,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,A(t)}),s){var o=e.grep(i,function(e){return e.reserveSpace});for(e.each(o,function(e,t){D(t),P(t),I(t,t.ticks),x(t)}),t=o.length-1;t>=0;--t)S(o[t]);T(),e.each(o,function(e,t){k(t)})}pt=at.width-ut.left-ut.right,ft=at.height-ut.bottom-ut.top,e.each(i,function(e,t){C(t)}),s&&N(),U()}function A(e){var t=e.options,i=+(null!=t.min?t.min:e.datamin),s=+(null!=t.max?t.max:e.datamax),n=s-i;if(0==n){var a=0==s?1:.01;null==t.min&&(i-=a),(null==t.max||null!=t.min)&&(s+=a)}else{var o=t.autoscaleMargin;null!=o&&(null==t.min&&(i-=n*o,0>i&&null!=e.datamin&&e.datamin>=0&&(i=0)),null==t.max&&(s+=n*o,s>0&&null!=e.datamax&&e.datamax<=0&&(s=0)))}e.min=i,e.max=s}function D(t){var i,n=t.options;i="number"==typeof n.ticks&&n.ticks>0?n.ticks:.3*Math.sqrt("x"==t.direction?at.width:at.height);var a=(t.max-t.min)/i,o=-Math.floor(Math.log(a)/Math.LN10),r=n.tickDecimals;null!=r&&o>r&&(o=r);var l,h=Math.pow(10,-o),d=a/h;if(1.5>d?l=1:3>d?(l=2,d>2.25&&(null==r||r>=o+1)&&(l=2.5,++o)):l=7.5>d?5:10,l*=h,null!=n.minTickSize&&l<n.minTickSize&&(l=n.minTickSize),t.delta=a,t.tickDecimals=Math.max(0,null!=r?r:o),t.tickSize=n.tickSize||l,"time"==n.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,i=[],n=s(e.min,e.tickSize),a=0,o=Number.NaN;do t=o,o=n+a*e.tickSize,i.push(o),++a;while(o<e.max&&o!=t);return i},t.tickFormatter=function(e,t){var i=t.tickDecimals?Math.pow(10,t.tickDecimals):1,s=""+Math.round(e*i)/i;if(null!=t.tickDecimals){var n=s.indexOf("."),a=-1==n?0:s.length-n-1;if(a<t.tickDecimals)return(a?s:s+".")+(""+i).substr(1,t.tickDecimals-a)}return s}),e.isFunction(n.tickFormatter)&&(t.tickFormatter=function(e,t){return""+n.tickFormatter(e,t)}),null!=n.alignTicksWithAxis){var c=("x"==t.direction?dt:ct)[n.alignTicksWithAxis-1];if(c&&c.used&&c!=t){var u=t.tickGenerator(t);if(u.length>0&&(null==n.min&&(t.min=Math.min(t.min,u[0])),null==n.max&&u.length>1&&(t.max=Math.max(t.max,u[u.length-1]))),t.tickGenerator=function(e){var t,i,s=[];for(i=0;i<c.ticks.length;++i)t=(c.ticks[i].v-c.min)/(c.max-c.min),t=e.min+t*(e.max-e.min),s.push(t);return s},!t.mode&&null==n.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),f=t.tickGenerator(t);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(t.tickDecimals=p)}}}}function P(t){var i=t.options.ticks,s=[];null==i||"number"==typeof i&&i>0?s=t.tickGenerator(t):i&&(s=e.isFunction(i)?i(t):i);var n,a;for(t.ticks=[],n=0;n<s.length;++n){var o=null,r=s[n];"object"==typeof r?(a=+r[0],r.length>1&&(o=r[1])):a=+r,null==o&&(o=t.tickFormatter(a,t)),isNaN(a)||t.ticks.push({v:a,label:o})}}function I(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function M(){at.clear(),r(gt.drawBackground,[lt]);var e=nt.grid;e.show&&e.backgroundColor&&E(),e.show&&!e.aboveData&&F();for(var t=0;t<st.length;++t)r(gt.drawSeries,[lt,st[t]]),R(st[t]);r(gt.draw,[lt]),e.show&&e.aboveData&&F(),at.render(),X()}function L(e,t){for(var i,s,n,a,o=p(),r=0;r<o.length;++r)if(i=o[r],i.direction==t&&(a=t+i.n+"axis",e[a]||1!=i.n||(a=t+"axis"),e[a])){s=e[a].from,n=e[a].to;break}if(e[a]||(i="x"==t?dt[0]:ct[0],s=e[t+"1"],n=e[t+"2"]),null!=s&&null!=n&&s>n){var l=s;s=n,n=l}return{from:s,to:n,axis:i}}function E(){lt.save(),lt.translate(ut.left,ut.top),lt.fillStyle=it(nt.grid.backgroundColor,ft,0,"rgba(255, 255, 255, 0)"),lt.fillRect(0,0,pt,ft),lt.restore()}function F(){var t,i,s,n;lt.save(),lt.translate(ut.left,ut.top);var a=nt.grid.markings;if(a)for(e.isFunction(a)&&(i=mt.getAxes(),i.xmin=i.xaxis.min,i.xmax=i.xaxis.max,i.ymin=i.yaxis.min,i.ymax=i.yaxis.max,a=a(i)),t=0;t<a.length;++t){var o=a[t],r=L(o,"x"),l=L(o,"y");null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),r.to<r.axis.min||r.from>r.axis.max||l.to<l.axis.min||l.from>l.axis.max||(r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),(r.from!=r.to||l.from!=l.to)&&(r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),r.from==r.to||l.from==l.to?(lt.beginPath(),lt.strokeStyle=o.color||nt.grid.markingsColor,lt.lineWidth=o.lineWidth||nt.grid.markingsLineWidth,lt.moveTo(r.from,l.from),lt.lineTo(r.to,l.to),lt.stroke()):(lt.fillStyle=o.color||nt.grid.markingsColor,lt.fillRect(r.from,l.to,r.to-r.from,l.from-l.to))))}i=p(),s=nt.grid.borderWidth;for(var h=0;h<i.length;++h){var d,c,u,f,g=i[h],m=g.box,v=g.tickLength;if(g.show&&0!=g.ticks.length){for(lt.lineWidth=1,"x"==g.direction?(d=0,c="full"==v?"top"==g.position?0:ft:m.top-ut.top+("top"==g.position?m.height:0)):(c=0,d="full"==v?"left"==g.position?0:pt:m.left-ut.left+("left"==g.position?m.width:0)),g.innermost||(lt.strokeStyle=g.options.color,lt.beginPath(),u=f=0,"x"==g.direction?u=pt+1:f=ft+1,1==lt.lineWidth&&("x"==g.direction?c=Math.floor(c)+.5:d=Math.floor(d)+.5),lt.moveTo(d,c),lt.lineTo(d+u,c+f),lt.stroke()),lt.strokeStyle=g.options.tickColor,lt.beginPath(),t=0;t<g.ticks.length;++t){var b=g.ticks[t].v;u=f=0,isNaN(b)||b<g.min||b>g.max||"full"==v&&("object"==typeof s&&s[g.position]>0||s>0)&&(b==g.min||b==g.max)||("x"==g.direction?(d=g.p2c(b),f="full"==v?-ft:v,"top"==g.position&&(f=-f)):(c=g.p2c(b),u="full"==v?-pt:v,"left"==g.position&&(u=-u)),1==lt.lineWidth&&("x"==g.direction?d=Math.floor(d)+.5:c=Math.floor(c)+.5),lt.moveTo(d,c),lt.lineTo(d+u,c+f))}lt.stroke()}}s&&(n=nt.grid.borderColor,"object"==typeof s||"object"==typeof n?("object"!=typeof s&&(s={top:s,right:s,bottom:s,left:s}),"object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),s.top>0&&(lt.strokeStyle=n.top,lt.lineWidth=s.top,lt.beginPath(),lt.moveTo(0-s.left,0-s.top/2),lt.lineTo(pt,0-s.top/2),lt.stroke()),s.right>0&&(lt.strokeStyle=n.right,lt.lineWidth=s.right,lt.beginPath(),lt.moveTo(pt+s.right/2,0-s.top),lt.lineTo(pt+s.right/2,ft),lt.stroke()),s.bottom>0&&(lt.strokeStyle=n.bottom,lt.lineWidth=s.bottom,lt.beginPath(),lt.moveTo(pt+s.right,ft+s.bottom/2),lt.lineTo(0,ft+s.bottom/2),lt.stroke()),s.left>0&&(lt.strokeStyle=n.left,lt.lineWidth=s.left,lt.beginPath(),lt.moveTo(0-s.left/2,ft+s.bottom),lt.lineTo(0-s.left/2,0),lt.stroke())):(lt.lineWidth=s,lt.strokeStyle=nt.grid.borderColor,lt.strokeRect(-s/2,-s/2,pt+s,ft+s))),lt.restore()}function N(){e.each(p(),function(e,t){if(t.show&&0!=t.ticks.length){var i,s,n,a,o,r=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",h="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,d=t.options.font||"flot-tick-label tickLabel";at.removeText(h);for(var c=0;c<t.ticks.length;++c)i=t.ticks[c],!i.label||i.v<t.min||i.v>t.max||("x"==t.direction?(a="center",s=ut.left+t.p2c(i.v),"bottom"==t.position?n=r.top+r.padding:(n=r.top+r.height-r.padding,o="bottom")):(o="middle",n=ut.top+t.p2c(i.v),"left"==t.position?(s=r.left+r.width-r.padding,a="right"):s=r.left+r.padding),at.addText(h,s,n,i.label,d,null,null,a,o))}})}function R(e){e.lines.show&&B(e),e.bars.show&&j(e),e.points.show&&O(e)}function B(e){function t(e,t,i,s,n){var a=e.points,o=e.pointsize,r=null,l=null;lt.beginPath();for(var h=o;h<a.length;h+=o){var d=a[h-o],c=a[h-o+1],u=a[h],p=a[h+1];if(null!=d&&null!=u){if(p>=c&&c<n.min){if(p<n.min)continue;d=(n.min-c)/(p-c)*(u-d)+d,c=n.min}else if(c>=p&&p<n.min){if(c<n.min)continue;u=(n.min-c)/(p-c)*(u-d)+d,p=n.min}if(c>=p&&c>n.max){if(p>n.max)continue;d=(n.max-c)/(p-c)*(u-d)+d,c=n.max}else if(p>=c&&p>n.max){if(c>n.max)continue;u=(n.max-c)/(p-c)*(u-d)+d,p=n.max}if(u>=d&&d<s.min){if(u<s.min)continue;c=(s.min-d)/(u-d)*(p-c)+c,d=s.min}else if(d>=u&&u<s.min){if(d<s.min)continue;p=(s.min-d)/(u-d)*(p-c)+c,u=s.min}if(d>=u&&d>s.max){if(u>s.max)continue;c=(s.max-d)/(u-d)*(p-c)+c,d=s.max}else if(u>=d&&u>s.max){if(d>s.max)continue;p=(s.max-d)/(u-d)*(p-c)+c,u=s.max}(d!=r||c!=l)&&lt.moveTo(s.p2c(d)+t,n.p2c(c)+i),r=u,l=p,lt.lineTo(s.p2c(u)+t,n.p2c(p)+i)}}lt.stroke()}function i(e,t,i){for(var s=e.points,n=e.pointsize,a=Math.min(Math.max(0,i.min),i.max),o=0,r=!1,l=1,h=0,d=0;;){if(n>0&&o>s.length+n)break;o+=n;var c=s[o-n],u=s[o-n+l],p=s[o],f=s[o+l];if(r){if(n>0&&null!=c&&null==p){d=o,n=-n,l=2;continue}if(0>n&&o==h+n){lt.fill(),r=!1,n=-n,l=1,o=h=d+n;continue}}if(null!=c&&null!=p){if(p>=c&&c<t.min){if(p<t.min)continue;u=(t.min-c)/(p-c)*(f-u)+u,c=t.min}else if(c>=p&&p<t.min){if(c<t.min)continue;f=(t.min-c)/(p-c)*(f-u)+u,p=t.min}if(c>=p&&c>t.max){if(p>t.max)continue;u=(t.max-c)/(p-c)*(f-u)+u,c=t.max}else if(p>=c&&p>t.max){if(c>t.max)continue;f=(t.max-c)/(p-c)*(f-u)+u,p=t.max}if(r||(lt.beginPath(),lt.moveTo(t.p2c(c),i.p2c(a)),r=!0),u>=i.max&&f>=i.max)lt.lineTo(t.p2c(c),i.p2c(i.max)),lt.lineTo(t.p2c(p),i.p2c(i.max));else if(u<=i.min&&f<=i.min)lt.lineTo(t.p2c(c),i.p2c(i.min)),lt.lineTo(t.p2c(p),i.p2c(i.min));else{var g=c,m=p;f>=u&&u<i.min&&f>=i.min?(c=(i.min-u)/(f-u)*(p-c)+c,u=i.min):u>=f&&f<i.min&&u>=i.min&&(p=(i.min-u)/(f-u)*(p-c)+c,f=i.min),u>=f&&u>i.max&&f<=i.max?(c=(i.max-u)/(f-u)*(p-c)+c,u=i.max):f>=u&&f>i.max&&u<=i.max&&(p=(i.max-u)/(f-u)*(p-c)+c,f=i.max),c!=g&&lt.lineTo(t.p2c(g),i.p2c(u)),lt.lineTo(t.p2c(c),i.p2c(u)),lt.lineTo(t.p2c(p),i.p2c(f)),p!=m&&(lt.lineTo(t.p2c(p),i.p2c(f)),lt.lineTo(t.p2c(m),i.p2c(f)))}}}}lt.save(),lt.translate(ut.left,ut.top),lt.lineJoin="round";var s=e.lines.lineWidth,n=e.shadowSize;if(s>0&&n>0){lt.lineWidth=n,lt.strokeStyle="rgba(0,0,0,0.1)";var a=Math.PI/18;t(e.datapoints,Math.sin(a)*(s/2+n/2),Math.cos(a)*(s/2+n/2),e.xaxis,e.yaxis),lt.lineWidth=n/2,t(e.datapoints,Math.sin(a)*(s/2+n/4),Math.cos(a)*(s/2+n/4),e.xaxis,e.yaxis)}lt.lineWidth=s,lt.strokeStyle=e.color;var o=H(e.lines,e.color,0,ft);o&&(lt.fillStyle=o,i(e.datapoints,e.xaxis,e.yaxis)),s>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),lt.restore()}function O(e){function t(e,t,i,s,n,a,o,r){for(var l=e.points,h=e.pointsize,d=0;d<l.length;d+=h){var c=l[d],u=l[d+1];null==c||c<a.min||c>a.max||u<o.min||u>o.max||(lt.beginPath(),c=a.p2c(c),u=o.p2c(u)+s,"circle"==r?lt.arc(c,u,t,0,n?Math.PI:2*Math.PI,!1):r(lt,c,u,t,n),lt.closePath(),i&&(lt.fillStyle=i,lt.fill()),lt.stroke())}}lt.save(),lt.translate(ut.left,ut.top);var i=e.points.lineWidth,s=e.shadowSize,n=e.points.radius,a=e.points.symbol;if(0==i&&(i=1e-4),i>0&&s>0){var o=s/2;lt.lineWidth=o,lt.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,n,null,o+o/2,!0,e.xaxis,e.yaxis,a),lt.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,n,null,o/2,!0,e.xaxis,e.yaxis,a)}lt.lineWidth=i,lt.strokeStyle=e.color,t(e.datapoints,n,H(e.points,e.color),0,!1,e.xaxis,e.yaxis,a),lt.restore()}function z(e,t,i,s,n,a,o,r,l,h,d,c){var u,p,f,g,m,v,b,y,w;d?(y=v=b=!0,m=!1,u=i,p=e,g=t+s,f=t+n,u>p&&(w=p,p=u,u=w,m=!0,v=!1)):(m=v=b=!0,y=!1,u=e+s,p=e+n,f=i,g=t,f>g&&(w=g,g=f,f=w,y=!0,b=!1)),p<r.min||u>r.max||g<l.min||f>l.max||(u<r.min&&(u=r.min,m=!1),p>r.max&&(p=r.max,v=!1),f<l.min&&(f=l.min,y=!1),g>l.max&&(g=l.max,b=!1),u=r.p2c(u),f=l.p2c(f),p=r.p2c(p),g=l.p2c(g),o&&(h.beginPath(),h.moveTo(u,f),h.lineTo(u,g),h.lineTo(p,g),h.lineTo(p,f),h.fillStyle=o(f,g),h.fill()),c>0&&(m||v||b||y)&&(h.beginPath(),h.moveTo(u,f+a),m?h.lineTo(u,g+a):h.moveTo(u,g+a),b?h.lineTo(p,g+a):h.moveTo(p,g+a),v?h.lineTo(p,f+a):h.moveTo(p,f+a),y?h.lineTo(u,f+a):h.moveTo(u,f+a),h.stroke()))}function j(e){function t(t,i,s,n,a,o,r){for(var l=t.points,h=t.pointsize,d=0;d<l.length;d+=h)null!=l[d]&&z(l[d],l[d+1],l[d+2],i,s,n,a,o,r,lt,e.bars.horizontal,e.bars.lineWidth)}lt.save(),lt.translate(ut.left,ut.top),lt.lineWidth=e.bars.lineWidth,lt.strokeStyle=e.color;var i;switch(e.bars.align){case"left":i=0;break;case"right":i=-e.bars.barWidth;break;case"center":i=-e.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+e.bars.align)}var s=e.bars.fill?function(t,i){return H(e.bars,e.color,t,i)}:null;t(e.datapoints,i,i+e.bars.barWidth,0,s,e.xaxis,e.yaxis),lt.restore()}function H(t,i,s,n){var a=t.fill;if(!a)return null;if(t.fillColor)return it(t.fillColor,s,n,i);var o=e.color.parse(i);return o.a="number"==typeof a?a:.4,o.normalize(),o.toString()}function U(){if(i.find(".legend").remove(),nt.legend.show){for(var t,s,n=[],a=[],o=!1,r=nt.legend.labelFormatter,l=0;l<st.length;++l)t=st[l],t.label&&(s=r?r(t.label,t):t.label,s&&a.push({label:s,color:t.color}));if(nt.legend.sorted)if(e.isFunction(nt.legend.sorted))a.sort(nt.legend.sorted);else if("reverse"==nt.legend.sorted)a.reverse();else{var h="descending"!=nt.legend.sorted;a.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=h?1:-1})}for(var l=0;l<a.length;++l){var d=a[l];l%nt.legend.noColumns==0&&(o&&n.push("</tr>"),n.push("<tr>"),o=!0),n.push('<td class="legendColorBox"><div style="border:1px solid '+nt.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+d.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+d.label+"</td>")}if(o&&n.push("</tr>"),0!=n.length){var c='<table style="font-size:smaller;color:'+nt.grid.color+'">'+n.join("")+"</table>";if(null!=nt.legend.container)e(nt.legend.container).html(c);else{var u="",p=nt.legend.position,f=nt.legend.margin;null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?u+="top:"+(f[1]+ut.top)+"px;":"s"==p.charAt(0)&&(u+="bottom:"+(f[1]+ut.bottom)+"px;"),"e"==p.charAt(1)?u+="right:"+(f[0]+ut.right)+"px;":"w"==p.charAt(1)&&(u+="left:"+(f[0]+ut.left)+"px;");var g=e('<div class="legend">'+c.replace('style="','style="position:absolute;'+u+";")+"</div>").appendTo(i);if(0!=nt.legend.backgroundOpacity){var m=nt.legend.backgroundColor;null==m&&(m=nt.grid.backgroundColor,m=m&&"string"==typeof m?e.color.parse(m):e.color.extract(g,"background-color"),m.a=1,m=m.toString());var v=g.children();e('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+u+"background-color:"+m+';"> </div>').prependTo(g).css("opacity",nt.legend.backgroundOpacity)}}}}}function W(e,t,i){var s,n,a,o=nt.grid.mouseActiveRadius,r=o*o+1,l=null;for(s=st.length-1;s>=0;--s)if(i(st[s])){var h=st[s],d=h.xaxis,c=h.yaxis,u=h.datapoints.points,p=d.c2p(e),f=c.c2p(t),g=o/d.scale,m=o/c.scale;if(a=h.datapoints.pointsize,d.options.inverseTransform&&(g=Number.MAX_VALUE),c.options.inverseTransform&&(m=Number.MAX_VALUE),h.lines.show||h.points.show)for(n=0;n<u.length;n+=a){var v=u[n],b=u[n+1];if(null!=v&&!(v-p>g||-g>v-p||b-f>m||-m>b-f)){var y=Math.abs(d.p2c(v)-e),w=Math.abs(c.p2c(b)-t),_=y*y+w*w;r>_&&(r=_,l=[s,n/a])}}if(h.bars.show&&!l){var C="left"==h.bars.align?0:-h.bars.barWidth/2,x=C+h.bars.barWidth;for(n=0;n<u.length;n+=a){var v=u[n],b=u[n+1],S=u[n+2];null!=v&&(st[s].bars.horizontal?p<=Math.max(S,v)&&p>=Math.min(S,v)&&f>=b+C&&b+x>=f:p>=v+C&&v+x>=p&&f>=Math.min(S,b)&&f<=Math.max(S,b))&&(l=[s,n/a])}}}return l?(s=l[0],n=l[1],a=st[s].datapoints.pointsize,{datapoint:st[s].datapoints.points.slice(n*a,(n+1)*a),dataIndex:n,series:st[s],seriesIndex:s}):null}function q(e){nt.grid.hoverable&&Y("plothover",e,function(e){return 0!=e.hoverable})}function V(e){nt.grid.hoverable&&Y("plothover",e,function(){return!1})}function G(e){Y("plotclick",e,function(e){return 0!=e.clickable})}function Y(e,t,s){var n=rt.offset(),a=t.pageX-n.left-ut.left,o=t.pageY-n.top-ut.top,r=f({left:a,top:o});r.pageX=t.pageX,r.pageY=t.pageY;var l=W(a,o,s);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+n.left+ut.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+n.top+ut.top,10)),nt.grid.autoHighlight){for(var h=0;h<vt.length;++h){var d=vt[h];d.auto!=e||l&&d.series==l.series&&d.point[0]==l.datapoint[0]&&d.point[1]==l.datapoint[1]||J(d.series,d.point)}l&&K(l.series,l.datapoint,e)}i.trigger(e,[r,l])}function X(){var e=nt.interaction.redrawOverlayInterval;return-1==e?void Z():void(bt||(bt=setTimeout(Z,e)))}function Z(){bt=null,ht.save(),ot.clear(),ht.translate(ut.left,ut.top);var e,t;for(e=0;e<vt.length;++e)t=vt[e],t.series.bars.show?tt(t.series,t.point):et(t.series,t.point);ht.restore(),r(gt.drawOverlay,[ht])}function K(e,t,i){if("number"==typeof e&&(e=st[e]),"number"==typeof t){var s=e.datapoints.pointsize;t=e.datapoints.points.slice(s*t,s*(t+1))}var n=Q(e,t);-1==n?(vt.push({series:e,point:t,auto:i}),X()):i||(vt[n].auto=!1)}function J(e,t){if(null==e&&null==t)return vt=[],void X();if("number"==typeof e&&(e=st[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var s=Q(e,t);-1!=s&&(vt.splice(s,1),X())}function Q(e,t){for(var i=0;i<vt.length;++i){var s=vt[i];if(s.series==e&&s.point[0]==t[0]&&s.point[1]==t[1])return i}return-1}function et(t,i){var s=i[0],n=i[1],a=t.xaxis,o=t.yaxis,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(!(s<a.min||s>a.max||n<o.min||n>o.max)){var l=t.points.radius+t.points.lineWidth/2;ht.lineWidth=l,ht.strokeStyle=r;var h=1.5*l;s=a.p2c(s),n=o.p2c(n),ht.beginPath(),"circle"==t.points.symbol?ht.arc(s,n,h,0,2*Math.PI,!1):t.points.symbol(ht,s,n,h,!1),ht.closePath(),ht.stroke()}}function tt(t,i){var s="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),n=s,a="left"==t.bars.align?0:-t.bars.barWidth/2;ht.lineWidth=t.bars.lineWidth,ht.strokeStyle=s,z(i[0],i[1],i[2]||0,a,a+t.bars.barWidth,0,function(){return n},t.xaxis,t.yaxis,ht,t.bars.horizontal,t.bars.lineWidth)}function it(t,i,s,n){if("string"==typeof t)return t;for(var a=lt.createLinearGradient(0,s,0,i),o=0,r=t.colors.length;r>o;++o){var l=t.colors[o];if("string"!=typeof l){var h=e.color.parse(n);null!=l.brightness&&(h=h.scale("rgb",l.brightness)),null!=l.opacity&&(h.a*=l.opacity),l=h.toString()}a.addColorStop(o/(r-1),l)}return a}var st=[],nt={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},at=null,ot=null,rt=null,lt=null,ht=null,dt=[],ct=[],ut={left:0,right:0,top:0,bottom:0},pt=0,ft=0,gt={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},mt=this;mt.setData=d,mt.setupGrid=$,mt.draw=M,mt.getPlaceholder=function(){return i},mt.getCanvas=function(){return at.element},mt.getPlotOffset=function(){return ut},mt.width=function(){return pt},mt.height=function(){return ft},mt.offset=function(){var e=rt.offset();return e.left+=ut.left,e.top+=ut.top,e},mt.getData=function(){return st},mt.getAxes=function(){var t={};return e.each(dt.concat(ct),function(e,i){i&&(t[i.direction+(1!=i.n?i.n:"")+"axis"]=i)}),t},mt.getXAxes=function(){return dt},mt.getYAxes=function(){return ct},mt.c2p=f,mt.p2c=g,mt.getOptions=function(){return nt},mt.highlight=K,mt.unhighlight=J,mt.triggerRedrawOverlay=X,mt.pointOffset=function(e){return{left:parseInt(dt[u(e,"x")-1].p2c(+e.x)+ut.left,10),top:parseInt(ct[u(e,"y")-1].p2c(+e.y)+ut.top,10)}},mt.shutdown=_,mt.resize=function(){var e=i.width(),t=i.height();at.resize(e,t),ot.resize(e,t)},mt.hooks=gt,l(mt),h(a),y(),d(n),$(),M(),w();var vt=[],bt=null}function s(e,t){return t*Math.floor(e/t)}var n=Object.prototype.hasOwnProperty;t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var i=this.element,s=this.context,n=this.pixelRatio;this.width!=e&&(i.width=e*n,i.style.width=e+"px",this.width=e),this.height!=t&&(i.height=t*n,i.style.height=t+"px",this.height=t),s.restore(),s.save(),s.scale(n,n)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(n.call(e,t)){var i=this.getTextLayer(t),s=e[t];i.hide();for(var a in s)if(n.call(s,a)){var o=s[a];for(var r in o)if(n.call(o,r)){for(var l,h=o[r].positions,d=0;l=h[d];d++)l.active?l.rendered||(i.append(l.element),l.rendered=!0):(h.splice(d--,1),l.rendered&&l.element.detach());0==h.length&&delete o[r]}}i.show()}},t.prototype.getTextLayer=function(t){var i=this.text[t];return null==i&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),i=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),i},t.prototype.getTextInfo=function(t,i,s,n,a){var o,r,l,h;if(i=""+i,o="object"==typeof s?s.style+" "+s.variant+" "+s.weight+" "+s.size+"px/"+s.lineHeight+"px "+s.family:s,r=this._textCache[t],null==r&&(r=this._textCache[t]={}),l=r[o],null==l&&(l=r[o]={}),h=l[i],null==h){var d=e("<div></div>").html(i).css({position:"absolute","max-width":a,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof s?d.css({font:o,color:s.color}):"string"==typeof s&&d.addClass(s),h=l[i]={width:d.outerWidth(!0),height:d.outerHeight(!0),element:d,positions:[]},d.detach()}return h},t.prototype.addText=function(e,t,i,s,n,a,o,r,l){var h=this.getTextInfo(e,s,n,a,o),d=h.positions;"center"==r?t-=h.width/2:"right"==r&&(t-=h.width),"middle"==l?i-=h.height/2:"bottom"==l&&(i-=h.height);for(var c,u=0;c=d[u];u++)if(c.x==t&&c.y==i)return void(c.active=!0);c={active:!0,rendered:!1,element:d.length?h.element.clone():h.element,x:t,y:i},d.push(c),c.element.css({top:Math.round(i),left:Math.round(t),"text-align":r})},t.prototype.removeText=function(e,t,i,s,a,o){if(null==s){var r=this._textCache[e];if(null!=r)for(var l in r)if(n.call(r,l)){var h=r[l];for(var d in h)if(n.call(h,d))for(var c,u=h[d].positions,p=0;c=u[p];p++)c.active=!1}}else for(var c,u=this.getTextInfo(e,s,a,o).positions,p=0;c=u[p];p++)c.x==t&&c.y==i&&(c.active=!1)
},e.plot=function(t,s,n){var a=new i(e(t),s,n,e.plot.plugins);return a},e.plot.version="0.8.1",e.plot.plugins=[],e.fn.plot=function(t,i){return this.each(function(){e.plot(this,t,i)})}}(jQuery),define("libs/flot/jquery.flot",function(){}),define("modules/interactives/interactive-base",["jquery","underscore","baseview","utils","modules/interactives/interactive-ads","libs/flot/jquery.flot"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"plothover .chart-area":"lazyHover"},initialize:function(e){var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),i.prototype.initialize.call(this,e),this.initializeDom(),this.flotData=this.getFlotData(this.datasetItems),this.graph.length&&null!==this.flotData&&void 0!==this.flotData&&(t&&(this.subviews.interactiveAds=new n({el:this.$(".interactive-sponsor")})),this.redraw(),this.$chartHover.css("color",this.mainColor))},redraw:function(){e.plot(this.graph,this.flotData,this.getFlotOptions()),this.calculateBoundVal()},initializeDom:function(){this.chartData=JSON.parse(this.$(".chartData").html()||"{}"),this.datasetItems=s.getNested(this.chartData,"datasets","item")||[],this.chartColors=this.getChartColors(),this.$chartHover=this.$(".chart-hover"),this.$chartArea=this.$(".chart-area"),this.graph=this.$(".graph"),this.colorsArray=(this.$el.data("colors")||"").split("|"),this.colorsArray.length>=6?this.mainColor=this.colorsArray[2]:1==this.colorsArray.length&&(this.mainColor=this.colorsArray[0])},getChartColors:function(){return(this.$el.data("colors")||"rgb(100,100,100)").split("|")},numberWithCommas:function(e){return e.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")},_createTicks:function(e){return t.map(e.split("|"),function(e,t){return[t,e]})},calculateBoundVal:function(){this.hoverLeftBoundVal=this.hoverLeftBound(),this.hoverRightBoundVal=this.hoverRightBound(),this.hoverTopBoundVal=this.hoverTopBound(),this.hoverBottomBoundVal=this.hoverBottomBound()},hoverLeftBound:function(){return this.$el.width()/2},hoverRightBound:function(){return this.$el.width()/2},hoverTopBound:function(){return this.$el.height()/5},hoverBottomBound:function(){return this.$el.height()/5},getHoverPrefix:function(){return this.chartData.beforelabel||""},getHoverSuffix:function(){return this.chartData.afterlabel||""},_getHoverClass:function(e){return e.pageX>this.hoverRightBoundVal/2&&e.pageX<this.hoverLeftBoundVal/2?e.pageY<this.hoverTopBoundVal?"top":e.pageY>this.hoverBottomBoundVal?"bottom":void 0:e.pageX<this.hoverLeftBoundVal?"middleleft":e.pageX>this.hoverRightBoundVal?"middleright":""},_getHoverPosition:function(e,t){return t.pageX>this.hoverRightBoundVal/2&&t.pageX<this.hoverLeftBoundVal/2?t.pageY<this.hoverTopBoundVal?{top:e.pageY,left:e.pageX-this.$chartHover.outerWidth(!0)/2}:t.pageY>this.hoverBottomBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0),left:e.pageX-this.$chartHover.outerWidth(!0)/2}:void 0:t.pageX<this.hoverLeftBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX}:t.pageX>this.hoverRightBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX-this.$chartHover.outerWidth(!0)}:null},lazyHover:function(){this.lazyDebounce||(this.lazyDebounce=t.throttle(this._hover,20)),this.lazyDebounce.apply(this,arguments)},_hover:function(e,t,i){if(i&&t&&e&&i.series){var s={pageY:t.pageY-this.$el.offset().top,pageX:t.pageX-this.$el.offset().left},n={pageY:t.pageY-this.$chartArea.offset().top,pageX:t.pageX-this.$chartArea.offset().left},a=this._getHoverClass(s),o="pointer-"+a.replace("middle",""),r=""!==this._getHoverLabel(i)?"<h3>"+this._getHoverLabel(i)+"</h3>":"",l='<div class="'+o+'"></div>'+r+"<h4>"+this._getHoverBody(i)+"</h4>",h=this._getHoverPosition(n,s);this.$chartHover.show(),this.$chartHover.html(l),h&&a?this.$chartHover.css(h).attr("class",a+"-hover chart-hover"):this.$chartHover.hide()}else this.$chartHover.hide()},_getHoverBody:function(e){var t=s.addCommas(""+parseFloat(s.getNested(e,"series","percent")||0).toFixed(0));return t+"%"},_getHoverLabel:function(e){return e.series.label},getFlotOptions:function(){return{series:{},grid:{hoverable:!0,clickable:!0},legend:{show:!1}}},getFlotData:function(e){return t.map(e,function(e,t,i){var n=this.mainColor;return i.length>1&&(n=this.chartColors[t%this.chartColors.length]),{label:s.getNested(e,"label")||"",data:parseFloat(e.value),color:n}},this)},destroy:function(e,t){var s=(this.graph.data()||{}).plot;s&&s.shutdown&&s.shutdown(),i.prototype.destroy.call(this,e,t)}});return a}),function(e){function t(t){function n(e,t){t.series.pie.show&&(t.grid.show=!1,"auto"==t.series.pie.label.show&&(t.series.pie.label.show=t.legend.show?!1:!0),"auto"==t.series.pie.radius&&(t.series.pie.radius=t.series.pie.label.show?.75:1),t.series.pie.tilt>1&&(t.series.pie.tilt=1),t.series.pie.tilt<0&&(t.series.pie.tilt=0),e.hooks.processDatapoints.push(r),e.hooks.drawOverlay.push(C),e.hooks.draw.push(c))}function a(e,t){var i=e.getOptions();i.series.pie.show&&i.grid.hoverable&&t.unbind("mousemove").mousemove(g),i.series.pie.show&&i.grid.clickable&&t.unbind("click").click(m)}function o(e){for(var t=0;t<e.length;++t){var i=parseFloat(e[t].data[0][1]);i&&(D+=i)}}function r(t){E||(E=!0,S=t.getCanvas(),k=e(S).parent(),s=t.getOptions(),t.setData(d(t.getData())))}function l(){L=k.children().filter(".legend").children().width(),T=Math.min(S.width,S.height/s.series.pie.tilt)/2,A=S.height/2+s.series.pie.offset.top,$=S.width/2,"auto"==s.series.pie.offset.left?s.legend.position.match("w")?$+=L/2:$-=L/2:$+=s.series.pie.offset.left,T>$?$=T:$>S.width-T&&($=S.width-T)}function h(e){for(var t=0;t<e.length;++t)"number"==typeof e[t].data?e[t].data=[[1,e[t].data]]:("undefined"==typeof e[t].data||"undefined"==typeof e[t].data[0])&&("undefined"!=typeof e[t].data&&"undefined"!=typeof e[t].data.label&&(e[t].label=e[t].data.label),e[t].data=[[1,0]]);return e}function d(e){e=h(e),o(e);for(var t=0,i=0,n=s.series.pie.combine.color,a=[],r=0;r<e.length;++r)e[r].data[0][1]=parseFloat(e[r].data[0][1]),e[r].data[0][1]||(e[r].data[0][1]=0),e[r].data[0][1]/D<=s.series.pie.combine.threshold?(t+=e[r].data[0][1],i++,n||(n=e[r].color)):a.push({data:[[1,e[r].data[0][1]]],color:e[r].color,label:e[r].label,angle:2*e[r].data[0][1]*Math.PI/D,percent:e[r].data[0][1]/D*100});return i>0&&a.push({data:[[1,t]],color:n,label:s.series.pie.combine.label,angle:2*t*Math.PI/D,percent:t/D*100}),a}function c(t,i){function n(e){ctx.save(),ctx.translate($,A),ctx.beginPath(),ctx.arc(0,0,e+4,90,2*Math.PI,!0),ctx.lineWidth=1,ctx.strokeStyle=F,ctx.stroke(),ctx.restore()}function a(){ctx.clearRect(0,0,S.width,S.height),k.children().filter(".pieLabel, .pieLabelBackground").remove()}function o(){var e=5,t=15,i=10,n=.02;if(s.series.pie.radius>1)var a=s.series.pie.radius;else var a=T*s.series.pie.radius;if(!(a>=S.width/2-e||a*s.series.pie.tilt>=S.height/2-t||i>=a)){ctx.save(),ctx.translate(e,t),ctx.globalAlpha=n,ctx.fillStyle="#000",ctx.translate($,A),ctx.scale(1,s.series.pie.tilt);for(var o=1;i>=o;o++)ctx.beginPath(),ctx.arc(0,0,a,0,2*Math.PI,!1),ctx.fill(),a-=o;ctx.restore()}}function r(){function t(e,t,i){0>=e||(i?ctx.fillStyle=t:(ctx.strokeStyle=t,ctx.lineJoin="miter"),ctx.beginPath(),Math.abs(e-2*Math.PI)>1e-9&&ctx.moveTo(0,0),ctx.arc(0,0,a,o,o+e,!1),ctx.closePath(),o+=e,i?ctx.fill():ctx.stroke())}function i(){function t(t,i,a){if(0!=t.data[0][1]){var o,r=s.legend.labelFormatter,l=s.series.pie.label.formatter;o=r?r(t.label,t):t.label,l&&(o=l(o,t));var h=(i+t.angle+i)/2,d=$+Math.round(Math.cos(h)*n),c=A+Math.round(Math.sin(h)*n)*s.series.pie.tilt,u='<span class="pieLabel" id="pieLabel'+a+'" style="position:absolute;top:'+c+"px;left:"+d+'px;">'+o+"</span>";k.append(u);var p=k.children("#pieLabel"+a),f=c-p.height()/2,g=d-p.width()/2;if(p.css("top",f),p.css("left",g),(0-f>0||0-g>0||S.height-(f+p.height())<0||S.width-(g+p.width())<0)&&(P=!0),0!=s.series.pie.label.background.opacity){var m=s.series.pie.label.background.color;null==m&&(m=t.color);var v="top:"+f+"px;left:"+g+"px;";e('<div class="pieLabelBackground" style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+v+"background-color:"+m+';"> </div>').insertBefore(p).css("opacity",s.series.pie.label.background.opacity)}}}var i=startAngle;if(s.series.pie.label.radius>1)var n=s.series.pie.label.radius;else var n=T*s.series.pie.label.radius;for(var a=0;a<h.length;++a)h[a].percent>=100*s.series.pie.label.threshold&&t(h[a],i,a),i+=h[a].angle}if(startAngle=Math.PI*s.series.pie.startAngle,s.series.pie.radius>1)var a=s.series.pie.radius;else var a=T*s.series.pie.radius;ctx.save(),ctx.translate($,A),ctx.scale(1,s.series.pie.tilt),ctx.save();for(var o=startAngle,r=0;r<h.length;++r)h[r].startAngle=o,t(h[r].angle,h[r].color,!0);ctx.restore(),ctx.save(),ctx.lineWidth=s.series.pie.stroke.width,o=startAngle;for(var r=0;r<h.length;++r)t(h[r].angle,s.series.pie.stroke.color,!1);ctx.restore(),u(ctx),s.series.pie.label.show&&i(),ctx.restore(),n(a)}if(k){ctx=i,l();for(var h=t.getData(),d=0;P&&I>d;)P=!1,d>0&&(T*=M),d+=1,a(),s.series.pie.tilt<=.8&&o(),r();d>=I&&(a(),k.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')),t.setSeries&&t.insertLegend&&(t.setSeries(h),t.insertLegend())}}function u(e){s.series.pie.innerRadius>0&&(e.save(),innerRadius=s.series.pie.innerRadius>1?s.series.pie.innerRadius:T*s.series.pie.innerRadius,e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=s.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=s.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.stroke(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.arc(0,0,innerRadius/1.2,90,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=F,e.stroke(),e.restore())}function p(e,t){for(var i=!1,s=-1,n=e.length,a=n-1;++s<n;a=s)(e[s][1]<=t[1]&&t[1]<e[a][1]||e[a][1]<=t[1]&&t[1]<e[s][1])&&t[0]<(e[a][0]-e[s][0])*(t[1]-e[s][1])/(e[a][1]-e[s][1])+e[s][0]&&(i=!i);return i}function f(e,i){for(var s=t.getData(),n=t.getOptions(),a=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius,o=0;o<s.length;++o){var r=s[o];if(r.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,a,r.startAngle,r.startAngle+r.angle,!1),ctx.closePath(),x=e-$,y=i-A,ctx.isPointInPath){if(ctx.isPointInPath(e-$,i-A))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:o}}else if(p1X=a*Math.cos(r.startAngle),p1Y=a*Math.sin(r.startAngle),p2X=a*Math.cos(r.startAngle+r.angle/4),p2Y=a*Math.sin(r.startAngle+r.angle/4),p3X=a*Math.cos(r.startAngle+r.angle/2),p3Y=a*Math.sin(r.startAngle+r.angle/2),p4X=a*Math.cos(r.startAngle+r.angle/1.5),p4Y=a*Math.sin(r.startAngle+r.angle/1.5),p5X=a*Math.cos(r.startAngle+r.angle),p5Y=a*Math.sin(r.startAngle+r.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y],p(arrPoly,arrPoint))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:o};ctx.restore()}}return null}function g(e){v("plothover",e)}function m(e){v("plotclick",e)}function v(e,i){var n=t.offset(),a=parseInt(i.pageX-n.left),o=parseInt(i.pageY-n.top),r=f(a,o);if(s.grid.autoHighlight)for(var l=0;l<N.length;++l){var h=N[l];h.auto!=e||r&&h.series==r.series||w(h.series)}r&&b(r.series,e);var d={pageX:i.pageX,pageY:i.pageY};k.trigger(e,[d,r])}function b(e,i){"number"==typeof e&&(e=series[e]);var s=_(e);-1==s?(N.push({series:e,auto:i}),t.triggerRedrawOverlay()):i||(N[s].auto=!1)}function w(e){null==e&&(N=[],t.triggerRedrawOverlay()),"number"==typeof e&&(e=series[e]);var i=_(e);-1!=i&&(N.splice(i,1),t.triggerRedrawOverlay())}function _(e){for(var t=0;t<N.length;++t){var i=N[t];if(i.series==e)return t}return-1}function C(e,t){function s(e){e.angle<0||(t.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(e.angle-2*Math.PI)>1e-9&&t.moveTo(0,0),t.arc(0,0,a,e.startAngle,e.startAngle+e.angle,!1),t.closePath(),t.fill())}var n=e.getOptions(),a=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius;for(t.save(),t.translate($,A),t.scale(1,n.series.pie.tilt),i=0;i<N.length;++i)s(N[i].series);u(t),t.restore()}var S=null,k=null,T=null,$=null,A=null,D=0,P=!0,I=10,M=.95,L=0,E=!1,F="#ebebeb",N=[];t.hooks.processOptions.push(n),t.hooks.bindEvents.push(a)}var s={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(e,t){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+t.color+';">'+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}},pattern:null}};e.plot.plugins.push({init:t,options:s,name:"pie",version:"1.0"})}(jQuery),define("libs/flot/jquery.flot.usat.pie",function(){}),define("modules/interactives/pie-chart",["jquery","underscore","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.usat.pie"],function(e,t,i,s){"use strict";var n=s.extend({isDonut:function(){return"true"===this.chartData.donutPresent},_getHoverBody:function(e){return this.isDonut()?[this.getHoverPrefix(),i.addCommas(i.getNested(e,"datapoint",1,0,1)),this.getHoverSuffix()].join(" "):s.prototype._getHoverBody.apply(this,arguments)},getFlotOptions:function(){var e=s.prototype.getFlotOptions.apply(this,arguments);return e.series.pie={show:!0,stroke:{color:"#fff",width:2},innerRadius:0,radius:1},this.isDonut()&&(e.series.pie.innerRadius=.48),e},hoverLeftBound:function(){return this.isDonut()?this.graph.width()/3:this.graph.width()/2},hoverRightBound:function(){return this.isDonut()?this.graph.width()/3*2:this.graph.width()/2}});return n}),define("modules/sports/sports-news",["jquery","underscore","utils","state","pubsub","baseview"],function(e,t,i,s,n,a){var o=a.extend({initialize:function(e){a.prototype.initialize.call(this,e),this.$newsBlock=this.$(".sp-news-wrap"),this.loadTaxonomyNews(this.$newsBlock.data("url"))},loadTaxonomyNews:function(e){var i=this;s.fetchHtml(e,{timeout:1e5}).done(t.bind(function(e){e&&e.length&&(i.$(".card-suspender-title").removeClass("hide"),i.$newsBlock.html(e))},this))},destroy:function(e){a.prototype.destroy.call(this,e)}});return o}),define("modules/rentals-local-rentals",["jquery","baseview","state","directAdPosition"],function(e,t,i,s){var n=t.extend({renderedAd:!1,renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rlr-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag"),subSection:"",pageInfo:i.getActivePageInfo()})},handleCardSizeChange:function(e){e.sidebarAds===!0?(this.renderAd(),this.$(".js-rentals-sidebar-ad").removeClass("rlr-hide-ad")):this.$(".js-rentals-sidebar-ad").addClass("rlr-hide-ad"),e.sidebarOpen===!0?(this.$(".js-rlr-wrap[data-layout-type=primary]").addClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").removeClass("rlr-dynamic-margin").addClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").removeClass("rlr-top-border")):(e.sidebarAds===!1&&this.renderAd(),this.$(".js-rlr-wrap[data-layout-type=primary]").removeClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").addClass("rlr-dynamic-margin").removeClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").addClass("rlr-top-border"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return n}),define("modules/longform/longform-series-bottom",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({el:".longform-bottom-series",events:{"click .series-bucket-prev":"doPrevTransition","click .series-bucket-next":"doNextTransition"},initialize:function(){this.$seriesBucketSet=this.$(".series-bucket-item-set"),this.$seriesBucketItem=this.$("div.series-bucket-item"),this.$seriesBucketNext=this.$(".series-bucket-next"),this.$seriesBucketPrev=this.$(".series-bucket-prev"),this.$seriesBucketPrev.addClass("inactive-item"),this.$bucketItemPadding=10*this.$seriesBucketItem.length,this.$widthOfBucket=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding},doNextTransition:function(){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)-200;this.$widthOfBucket-(600-this.$bucketItemPadding)===Math.abs(t)?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item")}):this.$widthOfBucket-400>Math.abs(t)&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item"),e.$seriesBucketPrev.removeClass("inactive-item")})},doPrevTransition:function(){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)+200;0===t?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item")}):200!==t&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item"),e.$seriesBucketNext.removeClass("inactive-item")})}});return s}),define("modules/stories/utility-bar-module-share",["jquery","underscore","backbone","utils","state","pubsub","managers/resourcemanager","modules/stories/utility-bar-flyout"],function(e,t,i,s,n,a,o,r){"use strict";var l=r.extend({events:{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn"},initialize:function(e){t.bindAll(this,"onClickFlyoutNavBtn");var i=this.$(".util-bar-share-summary-image");s.lazyLoadImage(i,"data-src",!0),this.events=t.extend({},r.prototype.events,this.events),r.prototype.initialize.call(this,e),this._loadUtilityBarModules()},_loadUtilityBarModules:function(){var e=s.getNested(window.site_vars,"utility_bar_modules");if(e){var i=t.find(e,function(e){return"utility-bar-module-share"===e.name});i&&i.options&&i.options.submodules&&o.fetchPageModules(i.options.submodules).done(t.bind(function(e){this.destroyed||t.each(e,function(e){this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector},e.options))},this)},this))}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),s=e(t.currentTarget).data("share-method"),o="utilitybarshare"+s;a.trigger("uotrack",o),"A"!==i.prop("tagName")&&(t.preventDefault(),s&&n.getActiveApp().$(".util-bar-btn-"+s).trigger("click"))},showSection:function(t){this.activeSection=t,this.$(".util-bar-flyout-section, .util-bar-flyout-pane").hide(),this.$(".util-bar-flyout-pane-share, .util-bar-flyout-section-"+t).show(),this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-nav-btn-"+t).addClass("active"),e(".js-share-email-form-success-pane").hide(),"email"===this.activeSection?e(".js-share-email-form-container").show():e(".js-share-email-form-container").hide()}});return l}),define("modules/travel/hotelme",["jquery","underscore","backbone","state","pubsub","baseview"],function(e,t,i,s,n,a){var o=a.extend({initialize:function(e){s.fetchHtml("/travel/hotelme/").done(t.bind(function(e){this.$el.html(e)},this)),a.prototype.initialize.call(this,e)}});return o}),define("modules/header/site-nav-social-module",["jquery","underscore","modules/header/site-nav-dropdown","utils"],function(e,t,i,s){"use strict";var n=i.extend({initialize:function(){this.initSocialShareButtons(),i.prototype.initialize.apply(this)},initSocialShareButtons:function(){this._loadGooglePlus()},_loadGooglePlus:function(){s.loadScript("https://apis.google.com/js/plusone.js","gapi")}});return n}),define("modules/sports/sports-team-leaders",["jquery","underscore","backbone","baseview","easing"],function(e,t,i,s){var n=s.extend({events:{"click .js-fg-link":"onSuspenderItemClick"},initialize:function(){s.prototype.initialize.call(this,this.options),this.links=this.$(".js-fg-link"),this.viewport=this.$(".sp-team-leaders-viewport"),this.slider=this.$(".sp-team-leaders-slider"),this.views=this.$(".sp-team-leaders-wrap"),this.charts=this.$(".sports-team-statistics-charts"),this.animateGraphs(this.charts.eq(0))},onSuspenderItemClick:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("module-name"),a="selected";t.preventDefault(),this.links.parent().removeClass(a),this.links.filter(i).parent().addClass(a),"team-leaders"===n?(this.views.removeClass("selected"),this.views.filter(".sp-team-leaders-wrap-"+s).addClass(a)):"team-statistics"===n&&(this.$target_stats=this.$(".sports-team-statistics-charts-"+s),this.animateGraphs(this.$target_stats),this.charts.hide(),this.$target_stats.show())},animateGraphs:function(t){var i=100,s=t.find(".sports-team-statistics-chart-group .category"),n=t.find(".sports-team-statistics-chart-group .bar"),a=t.find(".sports-team-statistics-chart-group .value");n.css("height","0%"),s.hide(),a.hide(),s.fadeIn(1e3),n.each(function(t,s){e(s).delay(i).animate({height:e(s).data("percentage")},500,"easeOutElastic"),i+=100}),a.delay(i).fadeIn(1e3)}});return n}),define("modules/fronts/primary-poster-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){var s=this.$el;t=e.extend({adType:s.attr("data-ad-type")||"poster",adPlacement:s.attr("data-ad-placement")||"poster_front",adSizes:s.attr("data-ad-sizes")||"mediumrectangle"},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("uiFlip",["jquery","transformSupport"],function(e){"use strict";var t="uiPageFlip",i={useTransforms:!!e.support.css.transform,transitionTiming:"linear",flipDuration:300,flipFrontSelector:".ui-flip-panel",flipBackSelector:".ui-flip-panel",activePanelClass:"active",perspective:"900px",fadeDuration:200,onFlip:function(){}},s={init:function(s){return this.each(function(){var n=e(this),a=e.extend({},i,s);n.data(t,{busy:!1,settings:a})})},option:function(e,i){var s=this.data(t);if(s&&e){if(!i)return s[e];("function"==typeof i||"onFlip"!==e)&&(s[e]=i)}},flipForward:function(e){var i=this.data(t),s=i.settings,a=this.find(s.flipFrontSelector);return n.transition(this,a.filter(".active"),a.filter(":not(.active)"),!0,s,i,e)},flipBackward:function(e){var i=this.data(t),s=i.settings,a=this.find(s.flipFrontSelector);return n.transition(this,a.filter(".active"),a.filter(":not(.active)"),!1,s,i,e)}},n={transition:function(t,i,s,a,o,r,l){var h;return r.busy?e.Deferred().reject():l?(o.onFlip(s),s.addClass("active"),i.removeClass("active"),e.Deferred().resolve()):(r.busy=!0,s.addClass("active"),h=o.useTransforms?n.flipTransform(t[0],i[0],s[0],a,o):n.fadeTransition(i,s,o),h.done(function(){o.onFlip(s),r.busy=!1,i.removeClass("active")}),h)},flipTransform:function(t,i,s,a,o){n.setupTransition(t,i,s,a,o);var r=e.Deferred();return e.support.css.transition.registerTransitionEndListener(i,r).done(function(){i.style[e.support.css.transform.backfaceVisibilityCssName]="",i.style[e.support.css.transform.styleCssName]="",i.style[e.support.css.transition.cssName]="",i.style[e.support.css.transform.cssName]="",s.style[e.support.css.transform.backfaceVisibilityCssName]="",s.style[e.support.css.transform.styleCssName]="",s.style[e.support.css.transition.cssName]="",s.style[e.support.css.transform.cssName]="",t.style[e.support.css.transform.perspectiveCssName]="",t.style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t="rotateX("+(a?"":"-")+"180deg)";i.style[e.support.css.transform.cssName]=t,s.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,o.flipDuration,o.transitionTiming),s.style[e.support.css.transform.cssName]="rotateX(0deg)"},20),r.promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var s=e.fadeOut(i.fadeDuration).promise();return s.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),s},getTransitionStyle:function(e,t,i,s){var n=e+" "+t+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(t,i,s,a,o){var r="rotateX("+(a?"-":"")+"180deg)";t.style[e.support.css.transform.perspectiveCssName]=o.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,o.flipDuration,o.transitionTiming),i.style[e.support.css.transform.cssName]="rotateX(0deg)",s.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",s.style[e.support.css.transform.styleCssName]="preserve-3d",s.style[e.support.css.transform.cssName]=r}};e.fn.uiFlip=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("modules/fronts/hero",["jquery","underscore","backbone","baseview","pubsub","utils","state","modules/videos/brightcove-video","modules/carousel/carousel","sharedAdPosition","directAdPosition","partner/leavebehind","modules/fronts/primary-poster-ad","uiPageTurn","uiFlip"],function(e,t,i,s,n,a,o,r,l,h,d,c,u){var p=s.extend({events:{"click .slide, .hero-asset-open":"open","click .carousel-thumbs > li":"openTile","click .hero-turn-trigger, .hero-popular .hero-page-trigger":"toggleFrontBack","click .partner-close":"closeAdClick","click .hero-headline-video-close":"toggleFrontVideo","click .js-vid-play-link":"onClickPlay"},destroy:function(e){var t=o.getActiveApp().$(".partner-billboard-ad");t&&t.removeClass("show-slot"),this.adShowing&&this.closeAd(!0),s.prototype.destroy.call(this,e)},initialize:function(i){i=e.extend(!0,{animate:{duration:200},popularCount:this.$el.data("popular-count")||6,shadow:{opacity:".4",duration:200,delay:0}},i),s.prototype.initialize.call(this,i),t.bindAll(this,"onVideoShow","onVideoHide","onAdReady","showHeroAd","beforeAdRender","belowHeroAdReady","onVideoStatusChange","onClickPlay"),this.visibleFace="front",this.$openSidebar=e(".open-sidebar"),this.mostPopularLoaded=!1,this.isPageTurn=this.$el.hasClass("hero-page-turn"),this.isPageTurn?(this.pageTurn={frontIndex:this.$(".hero-page-front").index(),backIndex:this.$(".hero-page-back").index(),adIndex:this.$(".hero-page-ad").index(),videoIndex:this.$(".hero-page-video").index()},this.$el.uiPageTurn({perspective:"1400px"})):this.$el.uiFlip({perspective:"1400px"}),this.adShowing=!1,this.intervalSpeed=this.$el.data("interval"),this.$el.hasClass("carousel")&&(this.subviews.heroCarousel=new l({el:this.$el,ads:!1,hoverTransition:200,thumbsSelector:".carousel-thumbs",rotate:!0,rotateInterval:this.intervalSpeed,autostart:!0})),this.subviews.video=[],this.$(".ui-video").each(t.bind(function(t,i){var s=e(i),n=new r({el:s.parent(),onVideoShow:this.onVideoShow,onVideoHide:this.onVideoHide,onStatusChange:this.onVideoStatusChange,onClickPlay:this.onClickPlay});s.closest(".hero-page-video").length?this.subviews.heroVideo=n:this.subviews.video.push(n)},this));var n=this.$(".poster-ad-primary");if(n.length>0&&(this.subviews.posterAdPrimary=new u({el:n})),this.$(".partner-heroflip-ad").each(t.bind(function(e,t){return e>0?void console.error("why are there multiple ad placements for this hero?"):void(this.subviews.ad=new h({el:t,adSizes:["heroflip"],adPlacement:"high_impact",adType:"heroflip",beforeAdRender:this.beforeAdRender,onAdReady:this.onAdReady}))},this)),this.$(".popular").length){var d="/services/most-popular/hero/"+a.getSectionPath(window.location.pathname)+"/"+this.options.popularCount+"/";o.fetchHtml(d).done(t.bind(function(e){this.$(".popular .ui-placer").html(e),this.$(".hero-turn-trigger").fadeIn(500).addClass("ready"),this.mostPopularLoaded=!0},this))}},renderCardInfo:function(e){if(this.updateTrackingLabels(e),this.belowHeroModule=this.$el.next(".below-hero-ad-module"),this.belowHeroModule.length)if(e.belowHeroAd){var t={el:this.belowHeroModule.find(".below-hero-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.belowHeroAdReady};this.subviews.belowHeroAd=new d(t)}else this.belowHeroModule.hide()},belowHeroAdReady:function(){var e="/services/most-popular/headline-ad/"+a.getSectionPath(window.location.pathname)+"/2/";o.fetchHtml(e).done(t.bind(function(e){this.belowHeroModule.find(".below-hero-popular").html(e),this.belowHeroModule.show(),this.subviews.belowHeroAd.playAd()},this))},beforeAdRender:function(){var e=this.subviews.ad.$el,t=e.height(),i=e.width();this.subviews.ad.setInitialDimensions(i,t)},onAdReady:function(e){var t=o.getActiveApp().$(".partner-billboard-ad");t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText?this.createAdLeaveBehind(this.subviews.ad,e):this.showHeroAd()},createAdLeaveBehind:function(e,t){var i=o.getActiveApp();this.subviews.adLeaveBehind=new c({el:o.getActiveApp().$(".partner-leavebehind"),onShowAd:this.showHeroAd,cards:this.$el.closest(".card-wrap"),isCompact:i.isCurrentCardBumped&&i.isCurrentCardBumped(),maxDisplayed:parseInt(t.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!0,initShow:!0}}),this.subviews.adLeaveBehind.render(e,t)},showHeroAd:function(){return this.adShowing=!0,o.getActiveApp().triggerEvent("onHeroAdOpen"),this.subviews.ad.show(),this.triggerAnimation(t.bind(function(){var e;return e=this.isPageTurn?this.$el.uiPageTurn("goToPage",this.pageTurn.adIndex,!1,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipForward"),e.done(t.bind(function(){this.subviews.ad.playAd()},this)),e},this))},closeAdClick:function(e){e.preventDefault(),this.closeAd()},closeAd:function(e){return this.adShowing=!1,this.subviews.ad.stopAd(),this.triggerAnimation(t.bind(function(){var t;return t=this.isPageTurn?"back"===this.visibleFace?this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex,e,this.$(".partner-placement iframe").length):this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex,e,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipBackward",e)},this)).done(t.bind(function(){o.getActiveApp().triggerEvent("onHeroAdClose"),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()},this)),!1},triggerAnimation:function(e){return o.registerAnimation(e())},onVideoShow:function(){this.$openSidebar.addClass("hidden"),this.$(".hero-turn-trigger").hide()},onVideoHide:function(){this.$openSidebar.removeClass("hidden"),this.mostPopularLoaded&&this.$(".hero-turn-trigger").show()},onVideoStatusChange:function(e){if("mediaComplete"===e.type)this.resetVideo();else if("mediaPlay"===e.type){var t=this.$(".js-live-video-label");t&&t.show()}},onClickPlay:function(){var e=this.$(".js-live-video-label");e&&e.hide(),this.$(".js-hide-during-vid-play").hide(),this.subviews.video[0].playVideo()},resetVideo:function(){var e=this.subviews.video[0];e.showStill(),this.$(".js-hide-during-vid-play").show()},open:function(t){var i=e(t.target),s=e(t.currentTarget),n=s.data("content-type")||"";this.subviews.heroVideo&&(i.hasClass("videoStillPlay")||"video"===n)?(this.toggleFrontVideo(t),t.preventDefault()):i.closest("a").length||(s.find(".hero-story > h1 > a").get(0).click(),t.preventDefault())},openTile:function(t){var i=e(t.currentTarget).index();this.$(".slide:eq("+i+") .hero-story > h1 > a").click()},toggleFrontBack:function(){return this.mostPopularLoaded?(this.triggerAnimation(t.bind(function(){return"back"!==this.visibleFace?(n.trigger("uotrack","mostpopularopen"),this.goToBack()):(n.trigger("uotrack","mostpopularclose"),this.goToFront())},this)),!1):!1},goToFront:function(){return this.visibleFace="front",this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex)},goToBack:function(){return this.visibleFace="back",this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex)},goToVideo:function(){return this.visibleFace="video",this.$el.uiPageTurn("goToPage",this.pageTurn.videoIndex).done(t.bind(function(){this.subviews.heroVideo.playVideo()
},this))},onCardWidthChange:function(e){this.updateTrackingLabels(e)},updateTrackingLabels:function(i){this.$moduleWrap||(this.$moduleWrap=this.$el.closest(".hero-module")),!this.variant&&this.$moduleWrap.data("variant")&&(this.variant=this.$moduleWrap.data("variant")),"4uphp"===this.variant&&(this.trackPrefix||(this.trackPrefix=this.$moduleWrap.find(".hfwmm-list").data("track-prefix")),this.$flexListItems||(this.$flexListItems=this.$moduleWrap.find(".hfwmm-secondary-link,.hfwmm-tertiary-link")),1320===i.cardWidth?t.each(this.$flexListItems,function(t,i){var s=e(t),n=i>2?i-3+1:i+1;s.data("ht",this.trackPrefix+s.data("track-display-type")+n)},this):t.each(this.$flexListItems,function(t,i){var s=e(t);s.data("ht",this.trackPrefix+"stack"+(i+1))},this))},toggleFrontVideo:function(e){return this.subviews.heroVideo?(this.triggerAnimation(t.bind(function(){return"video"!==this.visibleFace?(n.trigger("uotrack","headlinevideoopen"),this.$(".hero-headline-video-close").show(),this.subviews.heroVideo.show(),this.goToVideo()):(this.subviews.heroVideo.onVideoStatusChange(e),this.subviews.heroVideo.hide(),n.trigger("uotrack","headlinevideoclose"),this.$(".hero-headline-video-close").hide(),this.goToFront())},this)),!1):!1}});return p}),define("modules/sports/sports-twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(e,t,i,s,n){"use strict";var a=s.extend({events:{"click .sports-twittertab-option":"twitterTabClicked"},initialize:function(i){return i=e.extend({num_tweets:null,twitter_id:null,layoutType:null,refreshInterval:3e4,failureRefreshInterval:6e4,twitter_cache:12e3},i),"sidebar"===this.options.layoutType&&this.onHideSidebarAd(),this.$twitterTabs=e(".sports-twitter-module .front-gallery-item, .sports-twitter-data"),t.bindAll(this,"createTweetsHTML","loadTweets","twitterTabClicked"),this.twitter_el=this.$(".tweet-list"),this.update=!1,this.continueRefresh=!0,this.handles=e(this.$twitterTabs[0]).attr("tab-target-handles"),this.hashtags=e(this.$twitterTabs[0]).attr("tab-target-hashtags"),this.refreshInterval=e(this.$twitterTabs[0]).attr("tab-target-refresh-rate")||i.refreshInterval,this.failureRefreshInterval=this.twitter_el.attr("data-twitter-failure-refresh-rate")||i.failureRefreshInterval,this.twitter_cache=this.twitter_el.attr("data-twitter-cache-ttl")||i.twitter_cache,this.selectedTab=1,this.$primary=e(".sports-twitter-module .sports-twitter-primary"),this.$suspender=e(".sports-twitter-module .sports-twitter-suspender"),this.$viewport=e(".sports-twitter-module .twitter-scroll-content"),this.row_size=this.options.row_size||this.twitter_el.attr("data-row-size"),this.num_tweets=this.options.num_tweets||this.twitter_el.attr("data-num-tweets"),this.twitterID=i.twitter_id||this.twitter_el.attr("data-twitter-id"),this.twitterID?(this.addscrollBar(),this.loadTweets(),void s.prototype.initialize.call(this,i)):void this.$el.hide()},twitterTabClicked:function(t){this.refreshID&&clearTimeout(this.refreshID);var i=e(t.currentTarget);t.preventDefault(),this.$twitterTabs.removeClass("selected"),i.addClass("selected"),this.refreshInterval=i.attr("tab-target-refresh-rate"),this.handles=i.attr("tab-target-handles"),this.hashtags=i.attr("tab-target-hashtags"),this.twitter_el.html(""),e(".sports-twitter-module .scrollable-content").outerHeight(e(".tweet-list")[0].scrollHeight),this.update=!1,this.refreshScrollbar(),this.$viewport.addClass("loading"),this.loadTweets()},refreshScrollbar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.update===!1&&this.scrollbar.moveDraggerToPosition(0,0))},loadTweets:function(){this.tweetsLoaded=!0;var e=this.twitterID,s=this.num_tweets,n=this.row_size,a=this.createTweetsHTML,o=this.handles,r=this.hashtags,l=(this.refreshInterval,this.update,this.twitter_cache),h=o+"~~"+r,d="/sports/services/sportstwitter/json/"+e+"/"+s+"/"+n+"/"+l+"/"+h+"/";i.fetchHtml(d).done(a).fail(t.bind(function(){this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>"),a("TWITTER SERVER FAILURE")},this)).always(t.bind(function(){this.$viewport.removeClass("loading")},this))},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},createTweetsHTML:function(t){if("TWITTER SERVER FAILURE"===t)this.continueRefresh&&"0"!=this.failureRefreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.failureRefreshInterval));else{if(t&&String(t.html()).length>10){for(var i=e(this.twitter_el.html()),s=!1,n=e(t).find(".tweet"),a=e(i).find(".tweet"),o=0;o<e(n).length;o++)if(e(n[o]).html()!=e(a[o]).html()){s=!0;break}s&&(e(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html(t),e(".sports-twitter-module .scrollable-content").outerHeight(e(".tweet-list")[0].scrollHeight-150),this.refreshScrollbar());var r=this.timeAgo;t.find(".tweet_time_ago").each(function(t,i){e(i).html(r(e(i).html()))})}else e(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>");this.continueRefresh&&"0"!=this.refreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.refreshInterval))}},addscrollBar:function(){this.scrollbar=new n({el:e(".sports-twitter-module .twitter-scroll-content"),color:"dark",padding:2,lockPageScroll:!0,delayScroll:!1,fadeout:!0})},timeAgo:function(e){var t=new Date,i=new Date(e);i.getTime()||(i=Date.parse(e.replace(/( \+)/," UTC$1")));var s=t-i,n=1e3,a=60*n,o=60*a,r=24*o;return isNaN(s)||0>s?"":2*n>s?"right now":a>s?Math.floor(s/n)+" seconds ago":2*a>s?"about 1 minute ago":o>s?Math.floor(s/a)+" minutes ago":2*o>s?"about 1 hour ago":r>s?Math.floor(s/o)+" hours ago":s>r&&2*r>s?"yesterday":365*r>s?Math.floor(s/r)+" days ago":"over a year ago"},destroy:function(e){e&&this.twitter_el.empty(),this.stopRefresh(),s.prototype.destroy.call(this)}});return a}),define("blog/blog-list",["jquery","underscore","backbone","state","modules/global/brightcove-video","baseview"],function(e,t,i,s,n,a){"use strict";var o=a.extend({el:".blog-list-module",events:{"click .button-add-content":"showMore"},initialize:function(){var t=this;this.subviews=this.subviews||{},this.subviews.video=[],this.readMoreBlogsNumber=this.$(".button-add-content").data("next"),e(".stag.hero .video, .blpm-video-container .video").each(function(){var i=new n({el:e(this).parent().get(0)});t.subviews.video.push(i)})},getMoreBlogs:function(e){s.fetchHtml(window.location.pathname+e+"/new").done(t.bind(function(e){this.applyBlogPosts(e)},this)).fail(t.bind(function(){this.$button.removeClass("loading").addClass("inactive").text("No more posts")},this))},showMore:function(t){return e(t.target).hasClass("inactive")?!1:(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.getMoreBlogs(this.readMoreBlogsNumber),void t.preventDefault())},applyBlogPosts:function(t){{var i=this;t.find(".blpm-post").removeClass("active").addClass("inactive"),t.find(".button-add-content")}this.$(".blpm-all-articles").append(t),t.find(".video").each(function(){var t=new n({el:e(this).parent().get(0)});i.subviews.video.push(t)}),this.readMoreBlogsNumber++,this.$button.removeClass("loading").text(this.$button.attr("data-default"))}});return o}),define("modules/longform/longform-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({logoTemplate:'<div class="sponsored-by-text"><%= sponsoredByText %></div><div class="top-series-bucket-header-sponsor"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>"></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null,sponsoredByText:"sponsored by:"},t),i.prototype.initialize.call(this,t),this.$adWrapper=this.$(".top-series-bucket-header-sponsor-wrapper"),this.$header=this.$(".top-series-bucket-header"),this.render()},destroy:function(e){this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupLogo(),this.showBar()},setupLogo:function(){this.$header.height()>30&&this.$adWrapper.css("margin-top",this.$header.height()/2-this.$adWrapper.height()/2),this.$logo=e(t.template(this.logoTemplate,this.options)),this.$adWrapper.html(this.$logo)},showBar:function(){this.$adWrapper.removeClass("hidden"),this.$header.removeClass("hidden")}});return s}),define("modules/longform/longform-featured-series",["jquery","underscore","baseview","utils","sharedAdPosition","state","modules/longform/longform-sponsorship"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({el:".longform-top-series-bucket",events:{"click .top-series-bucket-prev":"doPrevTransition","click .top-series-bucket-next":"doNextTransition"},initialize:function(n){t.bindAll(this,"onAdReady"),this.$win=s.get("win"),n=e.extend({adPlacement:"poster",adSizes:["mediumrectangle"],adType:"sponsorship",defaultPosition:!0},n),this.$sponsorshipAd=this.$(".poster-ad"),this.$seriesBucketSet=this.$(".top-series-bucket-item-set"),this.$seriesBucketItem=this.$("div.top-series-bucket-item"),this.$seriesBucketNext=this.$(".top-series-bucket-next"),this.$seriesBucketPrev=this.$(".top-series-bucket-prev"),this.$currentSeriesArticleArrow=this.$(".arrow-down"),this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketWrapper=this.$(".top-series-bucket-wrapper"),this.$seriesBucketArrow=this.$(".arrow-wrapper"),this.$seriesBucketItemTitle=this.$(".top-series-bucket-item-title"),this.$seriesBucketItemWrap=this.$(".top-series-bucket-item-wrapper"),this.$bucketItemPadding=40*this.$seriesBucketItem.length,this.$widthOfBucket=this._setSeriesSetWidth(),this._setSeriesHeight(),this._findCurrent(),i.prototype.initialize.call(this,n),this.$seriesBucketItem.length>3&&this._calcNavArrowSpacing(),this._buildAd()},doNextTransition:function(){this.$seriesBucketNext.addClass("inactive-item-next"),this.$seriesBucketPrev.addClass("inactive-item-prev");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)-300;this.$widthOfBucket-900===Math.abs(t)?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item-prev")}):this.$widthOfBucket-600>Math.abs(t)&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item-next"),e.$seriesBucketPrev.removeClass("inactive-item-prev")})},doPrevTransition:function(){this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketNext.addClass("inactive-item-next");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)+300;0===t?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item-next")}):300!==t&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item-prev"),e.$seriesBucketNext.removeClass("inactive-item-next")})},_calcNavArrowSpacing:function(){this.$seriesBucketPrev.css("margin-left",(this.$win.width()-850)/2-100),this.$seriesBucketNext.css("margin-right",(this.$win.width()-850)/2-100),this.$seriesBucketPrev.removeClass("hidden"),this.$seriesBucketNext.removeClass("hidden")},_setSeriesSetWidth:function(){var e=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding,t=e;return this.$seriesBucketSet.css("width",t),this.$seriesBucketSet.removeClass("hidden"),e},_setSeriesHeight:function(){var t=this.$seriesBucketWrapper.height(),i=parseInt(this.$seriesBucketArrow.css("top")),s=this.$seriesBucketItem.length,n=0;this.$seriesBucketItemTitle.each(function(){var t=e(this).height();return t>195?!1:void(n+=1)}),n==s&&(t-=24,i-=24,this.$seriesBucketWrapper.css("height",t),this.$seriesBucketArrow.css("top",i))},_findCurrent:function(){var t=0,i=this.$seriesBucketItem.length,s=this;i>3&&this.$seriesBucketItemWrap.each(function(){return e(this).data("currentarticle")&&i-3>t?(s.$seriesBucketSet.css("left",-300*t),t>=1&&s.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):e(this).data("currentarticle")&&3>=i-t?(s.$seriesBucketSet.css("left",-300*(i-3)),s.$seriesBucketNext.addClass("inactive-item-next"),s.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):void(t+=1)})},_buildAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorAd&&(this.subviews.sponsorAd=new n({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,defaultPosition:this.options.defaultPosition,onAdReady:this.onAdReady}))},onAdReady:function(t){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.destroy(),this.subviews.sponsorshipAd=new o(e.extend({el:a.getActiveApp().$(".longform-top-series-bucket")},t))}});return r}),define("modules/fronts/countdown-clock",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,s,n){"use strict";var a=i.extend({timer:0,seconds:0,classes:{sponsor:"countdown-clock-ad"},initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_countdown",adSizes:[100,50],countdownContainer:".countdown-clock-container",digitBoxes:".countdown-timer-digit-container .digit",digitContainer:".countdown-timer-digit-container"},t),this.options=t,this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.layoutType=this._getLayoutType();var s=e(t.countdownContainer).attr("data-type-event_date");i.prototype.initialize.call(this,t),this.seconds=Math.round(new Date(s).getTime()/1e3)-Math.round((new Date).getTime()/1e3),this.$digitBoxes=this.$(t.digitBoxes),this.$digitContainer=this.$(t.digitContainer),this.$primaryTimer=e(".card-primary-suspender.countdown-clock-module"),this.$sidebarTimer=e(".card-sidebar.countdown-clock-module"),this.counterStart(),this.positionTimer()},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},positionTimer:function(){this.$sidebarTimer.length||this.$primaryTimer.css("display","block")},renderCardInfo:function(e){e.sidebarOpen||"primary"!==this.layoutType?e.sidebarOpen&&"sidebar"===this.layoutType&&this._buildSponsorshipAd():(this.$primaryTimer.show(),this._buildSponsorshipAd()),this.currentCardInfo=e},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new n({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},openSideBar:function(){this.currentCardInfo&&this._buildSponsorshipAd()},onCardWidthChange:function(e){e.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=e,e.sidebarOpen&&this.$sidebarTimer.length?"primary"===this.layoutType?this.$primaryTimer.hide():"sidebar"===this.layoutType&&this._buildSponsorshipAd():"primary"===this.layoutType&&(this.$primaryTimer.show(),this._buildSponsorshipAd()))},pad:function(e){for(var t=[],i=e.length;i>0;i--){var s=e[e.length-i]>9?e[e.length-i]:"0"+e[e.length-i];t.push(s.toString())}return t},updateTime:function(t){var i=Math.floor(t/86400),s=Math.floor(t/3600),n=Math.floor(t/60),a=Math.floor(t),o=i,r=s-24*i,l=n-60*s,h=a-60*n,d=0,c="",u=this.$digitContainer,p=this.pad([o,r,l,h]);this.$digitBoxes.each(function(t,i){if(void 0!==p[d]){var s=p[d].split("");e(i).text(t%2===0?s[0]:s[1]),t++,t%2===0&&d++}}),c=u.clone().first(),t--,u.slice(1).html(c.html())},decrementCounter:function(){this.updateTime(this.seconds),(0===this.seconds||isNaN(this.seconds))&&this.counterStop(),this.seconds--},counterStart:function(){clearInterval(this.timer),this.timer=setInterval(this.decrementCounter.bind(this),1e3)},counterStop:function(){clearInterval(this.timer)},destroy:function(e){this.counterStop(),i.prototype.destroy.call(this,e)}});return a}),define("modules/sports/sports-follow-usat",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({events:{},initialize:function(){i.prototype.initialize.apply(this,arguments),e(document).ready(this.followUSATOverlay)},followUSATOverlay:function(){var t=e(".sp-follow-usat-overlay-wrap");if(t.length>0){for(var i="",s="usatfollowus=",n=document.cookie.split(";"),a=0;a<n.length;a++){var o=n[a].trim();if(0===o.indexOf(s)){i=o.substring(s.length,o.length);break}}var r=new Date;r.setTime(r.getTime()+24*t.data("exp")*60*60*1e3);var l="expires="+r.toGMTString();switch(i){case"":document.cookie="usatfollowus=ready; "+l+"; path=/";break;case"ready":if(e(".follow-button-wrap.fb-wrap").length>0&&e(".follow-button-wrap.fb-wrap").append('<iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fusatodaysports&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=21&amp;appId=2530096808" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width:84px;" allowTransparency="true"></iframe>'),e(".follow-button-wrap.tw-wrap").length>0){if(e("#twitter-wjs").length>0)return;var h=/^http:/.test(document.location)?"http":"https",d=e("<script src='"+h+"://platform.twitter.com/widgets.js' id='twitter-wjs'>");e("head").append(d)}e("#follow-usat-box-details").css("top",e("#follow-usat-box-details").offset().top-100+"px"),e("#follow-usat-box-details").css("position","absolute"),e("#follow-usat-film").fadeIn(1e3,function(){e("#follow-usat-box-details").fadeIn(1e3)}),document.cookie="usatfollowus=shown; "+l+"; path=/",e(".sp-details-close").click(function(){e(".sp-follow-usat-overlay-wrap").parent().remove()});break;case"shown":e(".sp-follow-usat-overlay-wrap").parent().remove();break;default:e(".sp-follow-usat-overlay-wrap").parent().remove()}}}});return s}),define("modules/topics/topics-share-tools",["jquery","underscore","baseview","third-party-apis/facebook/facebook"],function(e,t,i,s){var n=i.extend({events:{"click .tpa-social-icon-facebook":"onClickFB"},initialize:function(e){t.bindAll(this,"fbShareCallback"),i.prototype.initialize.call(this,e)},onClickFB:function(i){var n={method:"feed",caption:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link"),picture:e(i.currentTarget).data("image"),name:e(i.currentTarget).data("title"),description:e(i.currentTarget).data("description"),actions:[{name:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link")}]};s.loadScript().done(t.bind(function(){FB.ui(n,this.fbShareCallback)},this))},fbShareCallback:function(){}});return n}),define("modules/weather/weather-dropdown",["jquery","underscore","backbone","baseview","pubsub","utils","state","form/autocomplete","easing","animatecolors","cookie"],function(e,t,i,s,n,a,o,r){"use strict";var l=s.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .weather-nav-dropdown-settings-open-btn":"showSettingsPanel","click .weather-nav-dropdown-settings-close-btn":"hideSettingsPanel","click .weather-nav-location-cancel-btn":"hideSettingsPanel","click .weather-nav-location-set-btn":"onSetButtonClick","submit .weather-nav-location-form":"onSubmitLocationForm","keydown .weather-nav-location-input":"onKeyDown","focus .weather-nav-location-input":"onFocusLocationField","blur .weather-nav-location-input":"onBlurLocationField","click .weather-nav-full-forecast-btn":"onClickFullForecast"},initialize:function(i){t.bindAll(this,"refreshData","onAutoCompleteResultClick"),this.panels=this.$(".weather-nav-dropdown-panel-wrap"),this.frontPanel=this.panels.find(".weather-nav-conditions-panel"),this.frontWeatherLocation=this.frontPanel.find(".weather-nav-location-name"),this.frontWeatherIcon=this.frontPanel.find(".weather-nav-dropdown-wicon"),this.settingsPanel=this.panels.find(".weather-nav-settings-panel"),this.locationField=this.settingsPanel.find(".weather-nav-location-input"),this.dropdownWiconClassName=this.frontWeatherIcon.attr("class"),this.transitionDelay=80,this.body=a.get("body"),this.navBtn=this.$el.parent(".weather"),this.$navLink=this.$el.siblings("a").eq(0),this.$navTempSpan=this.$navLink.find(".site-nav-alt-span"),this.navBtnTemp=this.navBtn.find(".btn-temp"),this.navBtnClassName=this.navBtnTemp.attr("class"),this.pubSub={"weather:newLocation":this._parseData},s.prototype.initialize.call(this,i),this.locationErrorEl=this.$(".weather-nav-location-error"),e.cookie("weatherLocation")?this.refreshData():this.updateWeatherLocation(window.defaultWeatherLocation),this.weatherDataRefresh=setInterval(this.refreshData,3e5)},onSetButtonClick:function(e){e.preventDefault(),this.updateWeatherLocation(this.locationField.val())},onAutoCompleteResultClick:function(){this.updateWeatherLocation(this.locationField.val())},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&this.updateWeatherLocation(this.locationField.val()),this.clearLocationInputError()},onSubmitLocationForm:function(e){e.preventDefault()},onClickFullForecast:function(){this.isMouseOnDropdown=!1,this.closeDropdown()},onMouseEnter:function(){this.isMouseOnDropdown=!0},onMouseLeave:function(){this.locationField.is(":focus")||(this.isMouseOnDropdown=!1,this.closeDropdown())},closeDropdown:function(){this.isMouseOnDropdown||(this.isSettingsPanelActive&&this.hideSettingsPanel(),o.registerAnimation(this.$el.stop().fadeOut(this.transitionDelay,"swing").promise().done(t.bind(function(){this.$el.removeClass("dropdown-active"),this.navBtn.find(".nav-span").removeClass("dropdown-active")},this))),this.body.off("."+this.cid))},openDropdown:function(){o.registerAnimation(this.$el.stop().fadeIn(this.transitionDelay,"swing").promise().done(t.bind(function(){this.$el.addClass("dropdown-active"),this.navBtn.find(".nav-span").addClass("dropdown-active")},this)))},showSettingsPanel:function(){this.$el.hasClass("settings-active")||(this.$el.addClass("settings-active"),this.isSettingsPanelActive=!0),this.subviews.autocomplete||(this.subviews.autocomplete=new r({el:this.locationField,resultDisplayTemplate:"<%= City %>, <%= State %>",resultValueTemplate:"<%= City %>, <%= State %>",onSelect:this.onAutoCompleteResultClick}))},hideSettingsPanel:function(){this.subviews.autocomplete&&this.subviews.autocomplete.resetInput(),this.clearLocationInputError(),this.locationField.blur(),this.$el.hasClass("settings-active")&&(this.$el.removeClass("settings-active"),this.isSettingsPanelActive=!1)},onFocusLocationField:function(){this.locationField.val(""),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&(this.isMouseOnDropdown=!1,this.closeDropdown())},this))},onBlurLocationField:function(){""===this.locationField.val()&&this.locationField.val(this.locationField.data("value"))},setWeatherCookie:function(t){e.cookie("weatherLocation",t,{path:"/",expires:1825})},updateWeatherLocation:function(i){return i&&i!==e.cookie("weatherLocation")?this._fetchData(i).done(t.bind(function(e){this.hideSettingsPanel(),n.trigger("weather:newLocation",e)},this)).fail(t.bind(function(e){this.showLocationInputError(e)},this)):void 0},refreshData:function(){return this._fetchData(e.cookie("weatherLocation"))},_fetchData:function(i){return this.isBusyGettingData||!i?e.Deferred().reject():(i=i.replace(",",""),this.isBusyGettingData=!0,e.Deferred(t.bind(function(e){o.fetchData("/weather/forecast/json/"+i+"/").done(t.bind(function(t){t.length&&t[0]?(this._parseData(t),e.resolveWith(this,[t])):e.rejectWith(this,["No data is available for this location."]),this.isBusyGettingData=!1},this)).fail(t.bind(function(){e.rejectWith(this,["There was an error finding this location. Please try again later."]),this.isBusyGettingData=!1},this))},this)))},showLocationInputError:function(e){this.locationErrorEl.html()!==e&&(this.locationErrorEl.addClass("ui-input-field-error-active"),this.locationErrorEl.text(e),this.locationErrorEl.stop().slideDown(50,"easeInOutQuad"))},clearLocationInputError:function(){this.locationErrorEl.hasClass("ui-input-field-error-active")&&this.locationErrorEl.stop().slideUp(50,"easeInOutQuad").promise().done(t.bind(function(){this.locationErrorEl.removeClass("ui-input-field-error-active"),this.locationErrorEl.empty()},this))},_parseData:function(i){if(i[0].currentConditions){var s=i[0],n=s.currentConditions,a=s.local.city+", "+s.local.adminArea.Text,o="wicon-"+n.weatherIcon,r=parseInt(n.temperature,10),l=this.$navTempSpan.add(this.$("[data-weather]"));l.each(t.bind(function(t,i){var s=e(i);s.html((n[s.data("weather")]||"")+(s.data("weather-suffix")||""))},this)),a.length>20&&this.frontWeatherLocation.addClass("longname"),this.frontWeatherLocation.html(a),r>99&&this.frontWeatherTemp.addClass("three-digit"),this.frontWeatherIcon.attr("class",this.dropdownWiconClassName+" "+o),this.navBtnTemp.attr("class",this.navBtnClassName+" "+o),this.$navTempSpan.addClass("site-nav-visible-alt-span "+o),e.cookie("weatherLocation")!==a&&this.setWeatherCookie(a),this.locationField.data("value",a).val(a)}},destroy:function(e){this.body.off("."+this.cid),clearInterval(this.weatherDataRefresh),s.prototype.destroy.call(this,e)}});return l}),define("modules/weather/site-nav-weather-module",["jquery","underscore","baseview","pubsub","utils","state","modules/weather/weather-dropdown"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({events:{mouseenter:"onHoverWeatherNav",mouseleave:"onHoverWeatherNav","click .site-nav-weather-link":"onClickWeatherNav"},initialize:function(){i.prototype.initialize.apply(this);var e=this.$(".weather-nav-dropdown");this.subviews.weatherDropdown=new o({el:e})},onHoverWeatherNav:function(e){var i=this.$(".site-nav-alt-span");clearTimeout(this.navBtnHoverDelay),i.hasClass("site-nav-visible-alt-span")&&("mouseenter"===e.type?(i.addClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.openDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)):(i.removeClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.closeDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)))},onClickWeatherNav:function(){this.subviews.weatherDropdown.closeDropdown()}});return r}),define("modules/sports/sports-video-ooyala",["jquery","underscore","state","backbone","baseview"],function(e,t,i,s,n){var a=n.extend({events:{"click #ooyalaplaylist li.item":"selectVideo"},initialize:function(){n.prototype.initialize.call(this,this.options),this.settings={disableAds:e("#ooyalaplayer").data("disableads"),wmode:"transparent",enableChannels:!0,autoplay:!1,debug:!0,nextIndex:2,containerId:"ooyalaplayer",playlistContainer:"ooyalaplaylist",videoTitleId:"ooyala-title",playlistId:"ooyalaplaylist",videoPlayer:{},hasPlayed:!1,width:e("#ooyalaplayer").data("width"),height:e("#ooyalaplayer").data("height"),adsetcode:e("#ooyalaplayer").data("adsetcode"),adtagurl:e("#ooyalaplayer").data("adtagurl"),cuedvideoid:"",viewdestroyed:!1},this.firstVideoId=e("#"+this.settings.containerId).data("videoid"),this.playerApiUrl=e("#"+this.settings.containerId).data("playerapiurl"),t.bindAll(this,"createPlayer","loadScripts","selectVideo","playerReceiver","loadVideoById","setNextplaylistItem","clearActiveElement","setActiveElement","getAdOptions"),window.googletag&&this.settings.disableAds!==!0&&window.googletag.cmd.push(function(){window.googletag.pubads().enableSingleRequest(),window.googletag.companionAds().setRefreshUnfilledSlots(!0),window.googletag.enableServices()}),this.loadScripts()},loadScripts:function(){require([this.playerApiUrl],t.bind(function(){"undefined"!=typeof window.OO?this.createPlayer(this.firstVideoId):console.log("Error loading ooyala")},this))},createPlayer:function(e){var i={wmode:this.settings.wmode,enableChannels:!0,autoplay:this.settings.autoplay,width:this.settings.width+"px",height:this.settings.height+"px",debug:this.settings.debug,adSetCode:this.settings.adsetcode,onCreate:t.bind(function(e){window.mb=e.mb,window.mb.subscribe("*","PGATourOoyala",t.bind(function(e){this.playerReceiver(e)},this))},this)};this.settings.disableAds!==!0&&(i["google-ima-ads-manager"]=this.getAdOptions(e)),this.settings.videoPlayer=window.OO.Player.create(this.settings.containerId,e,i)},destroyVideo:function(){this.settings.videoPlayer.destroy()},selectVideo:function(t){this.loadVideoById(e(t.currentTarget).data("videoid")),this.clearActiveElement(),this.setActiveElement(e(t.currentTarget)),this.setNextplaylistItem(e(t.currentTarget))},playerReceiver:function(t){switch(t){case"played":{var s=e("#"+this.settings.playlistId+" li:nth-child("+this.settings.nextIndex+")");s.data("videoid")}e(s).trigger("click");break;case"playbackReady":this.settings.autoplay=!0;break;case"playing":i.stopRefreshTimer();break;case"destroy":this.settings.viewdestroyed===!1&&this.loadVideoById()}},getAdOptions:function(e){var t=this.settings.adtagurl.replace("%s",e),i=(new Date).getTime(),s={adTagUrl:t,additionalAdTagParameters:{correlator:i},showInAdControlBar:!0};return s},loadVideoById:function(e){e?(this.settings.cuedvideoid=e,this.destroyVideo()):this.createPlayer(this.settings.cuedvideoid)},setNextplaylistItem:function(e){this.settings.nextIndex=e.next().attr("data-index")?e.next().data("index"):1},setVideoTitle:function(){var t=this.settings.videoPlayer.getTitle();e("#"+this.settings.videoTitleId).html(t)},clearActiveElement:function(){e("#"+this.settings.playlistId+" li").siblings().removeClass("active")},setActiveElement:function(e){e.addClass("active")},destroy:function(){this.settings.viewdestroyed=!0,this.clearActiveElement(),this.setActiveElement(e("#"+this.settings.playlistId+" li").first()),"function"==typeof this.settings.videoPlayer.destroy&&this.settings.videoPlayer.destroy(),n.prototype.destroy.apply(this,arguments)}});return a}),define("modules/live-newscasts/live-newscasts",["jquery","underscore","baseview","modules/global/livevideo"],function(e,t,i,s){var n=i.extend({events:{"click .newscast-item a":"onLiveNewscastsClick"},onLiveNewscastsClick:function(t){var i=e(t.currentTarget).attr("data-livevideoassetid");if(i){var n=new s({service:"/services/livenewscasts/"});return n.loadLiveVideo(i),!1}}});return n}),define("modules/interactives/overview",["jquery","underscore","backbone","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,s,n,a){var o=n.extend({initialize:function(e){n.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.$el.length&&(this.subviews.template=new a({ads:t,el:this.$el,interactiveType:"chronology",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex))}});return o}),define("modules/trending-map/trending-map",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({el:".tmfwm-wrapper",initialize:function(){t.bindAll(this,"processScroll"),this.$win=s.get("win"),this.$marketBubbles=this.$(".tmfwm-plot.tmfwm-market-bubble"),this.$trendingBubbles=this.$(".tmfwm-plot.tmfwm-trending-bubble"),this.isMapVisible()?this.showMarketBubbles():this.$win.on("scroll."+this.cid,t.throttle(this.processScroll,32))},showMarketBubbles:function(){var e=this;this.animate(this.$marketBubbles,"opacity",1,400,"ease-out").done(function(){e.showTrendingBubbles()}),this.animate(this.$marketBubbles,"transform","scale(1)",800,"ease-out")},showTrendingBubbles:function(){this.animate(this.$trendingBubbles,"opacity",1,600,"ease-out"),this.animate(this.$trendingBubbles,"transform","scale(1)",800,"ease-out")},isMapVisible:function(){return s.getScrollPosition()>=this.$el.offset().top-200},processScroll:function(){this.isMapVisible()&&(this.showMarketBubbles(),this.$win.off("."+this.cid))},destroy:function(){this.$win.off("."+this.cid),i.prototype.destroy.call(this,!0)}});return n}),define("modules/travel/travel-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(e,t,i,s,n,a){var o=i.extend({events:{"submit .travel-poll-form":"registerVote","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.user_id="unauthenticated",this.template=this.$(".travel-poll-wrapper"),this.form=this.$(".travel-poll-form"),this.choices=this.$(".travel-poll-choices"),this.results=this.$(".travel-poll-results"),this.poll_id=this.template.attr("data-pollid"),e.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)
},revealResults:function(i){var s="/polls/get/"+this.poll_id+"/";a.fetchData(s).done(t.bind(function(s){var n=t.pluck(s[0].answer,"count"),a=t.reduce(n,function(e,t){return e+parseFloat(t)},0),o=0===a?!0:!1,r=0;isNaN(i)||e.cookie(this.poll_id,!0),t.each(s[0].answer,function(e,t){var s,n=parseFloat(e.count);o?s=i==t?100:0:(i==t-1&&(e.count+=1),s=Math.round(n/a*100)),e.count_output=n,r+=s,e.percent=s,e.percent_width=.8*s,n>999&&(e.count_output=(Math.round(n/100*10)/10).toString()+"k")});var l=t.template(e(".quickpoll-results").html(),{data:s[0],total:a});this.form.hide(),this.results.html(l),e.cookie(this.poll_id)&&this.$(".poll-vote-results .story-poll-vote-wrapper").hide(),this.results.css("height","auto")},this))},registerVote:function(i){var n=e("input[name=travel-poll-choice]:checked").val(),o="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+n+"/";return i.preventDefault(),a.fetchData(o,{method:"post"}).done(t.bind(function(e){e&&(s.trigger("uotrack","pollvote"),this.revealResults(n))},this)),!1},revealChoices:function(){this.choices=this.$(".story-poll-choices"),this.results=this.$(".story-poll-chart"),this.results.hide(),this.choices.fadeIn()}});return o}),define("modules/fronts/live-feed",["jquery","underscore","baseview","state","utils"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(s){t.bindAll(this,"initMarkup","updateMarkup","fetchUpdate","hideImage");var a=this.$el.attr("data-livefeed")||n.getSectionPath(window.location.pathname),o=this.$el.attr("data-livefeed-site-id"),r=this.$el.attr("data-livefeed-site-prefix");s=e.extend({maxItems:60,itemFetchLimit:40,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",autoUpdate:!0,site_id:o,site_prefix:r,section:a,afterFetchResults:null,ajaxOptions:null},s);var l={count:s.itemFetchLimit};"undefined"!=typeof o&&""!==o&&(l.site_id=s.site_id),"undefined"!=typeof r&&""!==r&&(l.site_prefix=s.site_prefix);var h={url:"/feeds/live/"+a+"/",data:l};this.requestOptions=e.extend(!0,h,s.ajaxOptions),i.prototype.initialize.call(this,s)},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.setLiveFeedWidth(e)},setLiveFeedWidth:function(e){e.sidebarWidth<340?this.$el.removeClass("live-feed-wide"):this.$el.addClass("live-feed-wide"),this.options.dataSrcAttr="data-src-"+e.sidebarWidth,this.loadLazyImages()},openSideBar:function(){this.setupLiveFeed()},closeSideBar:function(){this.stopUpdateCheck()},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.setupLiveFeed()},setupLiveFeed:function(){this.stopUpdateCheck(),this.setLiveFeedWidth(this.currentCardInfo),this.$el.children("li").length?(this.$el.children(".newcontent").removeClass("newcontent"),this.fetchUpdate()):s.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.initMarkup(e),this.afterFetchResultsSuccess(e)},this))},afterFetchResultsSuccess:function(e){this.options.afterFetchResults&&this.options.afterFetchResults(e)},initMarkup:function(e){this.$el.removeClass("livefeed-loading"),this.$el.append(e),this.loadLazyImages(e.find("img")),this.refreshSidebar(),this.options.autoUpdate&&this.startUpdateCheck()},loadLazyImages:function(e){e=e||this.$("img"),n.lazyLoadImage(e,this.options.dataSrcAttr,!0,this.hideImage,this.refreshSidebar)},refreshSidebar:function(){s.getActiveApp().triggerEvent("refreshSidebarScroll")},hideImage:function(e){e.closest(".has-image").removeClass("has-image"),this.refreshSidebar()},fetchUpdate:function(){this.requestOptions.data.date=this.$("li:first").attr("data-timestamp"),s.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.updateMarkup(e),this.afterFetchResultsSuccess(e)},this))},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),a={};n.removeClass("top"),i.each(function(){a[e(this).attr("data-content-id")]=!0}),n.each(function(){s=e(this),a[s.attr("data-content-id")]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass("newcontent"),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>60&&n.slice(60).remove(),this.afterNewContent=setTimeout(t.bind(function(){i.removeClass("newcontent")},this),1e3*this.options.removeNewHighlight),this.refreshSidebar()}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(e){e&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return a}),function(e){function t(e){function t(e,t,n){var o=null;if(i(t)&&(h(t),s(e),a(e),l(t),m>=2)){var r=d(t),v=0;v=u(r)?-1*p(g,r-1,Math.floor(m/2)-1):p(g,Math.floor(m/2),r-2),m%2===0&&(v+=c()),o=f(n,t,v),n.points=o}return o}function i(e){return null!=e.bars&&e.bars.show&&null!=e.bars.order}function s(e){var t=w?e.getPlaceholder().innerHeight():e.getPlaceholder().innerWidth(),i=w?n(e.getData(),1):n(e.getData(),0),s=i[1]-i[0];y=s/t}function n(e,t){for(var i=new Array,s=0;s<e.length;s++)i[0]=e[s].data[0][t],i[1]=e[s].data[e[s].data.length-1][t];return i}function a(e){g=o(e.getData()),m=g.length}function o(e){for(var t=new Array,i=0;i<e.length;i++)null!=e[i].bars.order&&e[i].bars.show&&t.push(e[i]);return t.sort(r)}function r(e,t){var i=e.bars.order,s=t.bars.order;return s>i?-1:i>s?1:0}function l(){v=3,b=v*y}function h(e){e.bars.horizontal&&(w=!0)}function d(e){for(var t=0,i=0;i<g.length;++i)if(e==g[i]){t=i;break}return t+1}function c(){return g[Math.ceil(m/2)].bars.barWidth/2}function u(e){return e<=Math.ceil(m/2)}function p(e,t,i){for(var s=0,n=t;i>=n;n++)s+=e[n].bars.barWidth+2*b;return s}function f(e,t,i){for(var s=e.pointsize,n=e.points,a=0,o=w?1:0;o<n.length;o+=s)n[o]+=i,t.data[a][3]=n[o],a++;return n}var g,m,v,b,y=1,w=!1;e.hooks.processDatapoints.push(t)}var i={series:{bars:{order:null}}};e.plot.plugins.push({init:t,options:i,name:"orderBars",version:"0.2"})}(jQuery),define("libs/flot/jquery.flot.orderBars",function(){}),function(e){function t(e){function t(e){var t=document.createElement("canvas");if(t.getContext&&t.getContext("2d")){e.getCanvas().getContext("2d"),e.width()+100,e.height()+50}}e.hooks.draw.push(t)}var i={};e.plot.plugins.push({init:t,options:i,name:"style ",version:"0.05"})}(jQuery),define("libs/flot/jquery.flot.usat.style",function(){}),define("modules/interactives/bar-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.orderBars","libs/flot/jquery.flot.usat.style"],function(e,t,i,s,n){"use strict";var a=n.extend({initialize:function(e){this.orientation=this.$el.data("orientation"),n.prototype.initialize.call(this,e)},_isMultiBar:function(){return this.datasetItems.length>1},getChartColors:function(){return"horizontal"===this.orientation&&this._isMultiBar()?(this.$el.data("colors")||"").split("|").slice(0,this.datasetItems.length).reverse():(this.$el.data("colors")||"").split("|")},getFlotData:function(e){return t.map(e,function(e,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:n,bars:{borderWidth:30,fillColor:n},data:t.map(e.value,function(e){return e.split(",")})}},this)},_getHoverBody:function(e){return[this.getHoverPrefix(),s.addCommas(s.addCommas(e.datapoint["horizontal"===this.orientation?0:1])),this.getHoverSuffix()].join(" ")},getFlotOptions:function(){var e=this.datasetItems.length+(this.datasetItems.length>1&&s.getNested(this.datasetItems,"0","value","length")>6?4:this.datasetItems.length>1?2:1),t=n.prototype.getFlotOptions.apply(this,arguments),i=1/e;return t.colors=this.chartColors,t.series={bars:{show:!0,barWidth:i,order:"integer"},stack:!1},t.series.bars.align="center",t.grid.borderWidth=1,t.grid.labelMargin=5,t.grid.axisMargin=0,t.grid.autoHighlight=!0,t.grid.borderColor="rgb(237,236,236)","horizontal"===this.orientation?(t.xaxis={position:"bottom",autoscaleMargin:.02,tickFormatter:this.numberWithCommas},t.yaxis={ticks:this._createTicks(this.chartData.datasetLabels||""),position:"left",tickLength:0,autoscaleMargin:.02},t.bars={horizontal:!0}):(t.xaxis={autoscaleMargin:.02,ticks:this._createTicks(this.chartData.datasetLabels||""),position:"bottom",tickLength:0},t.yaxis={position:"left",labelWidth:40,tickFormatter:this.numberWithCommas}),t},_getHoverLabel:function(e){return this._isMultiBar()?e.series.label:""}});return a}),define("modules/stories/google-survey",["jquery","underscore","utils","state","baseview","user-manager","managers/cachemanager","admanager","pubsub"],function(e,t,i,s,n,a,o,r,l){var h=n.extend({initialize:function(e){var o=a.getAccount("firefly"),h=i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY")||{},d=this._getLocation(),c=s.getActivePageInfo();return window.gcsOnSurveyComplete=function(){var e={date:new Date,reliefPeriod:i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","relief_period")||864e5,isSet:function(){return localStorage.getItem("google-survey-complete-datetime")?!0:!1},isExpired:function(){return this.getSavedExpireTime()<this.date.getTime()?!0:!1},createNewExpireTime:function(){return parseInt(this.reliefPeriod,10)+this.date.getTime()},setExpirationTime:function(e){localStorage.setItem("google-survey-complete-datetime",e)},getSavedExpireTime:function(){return parseInt(localStorage.getItem("google-survey-complete-datetime"),10)}};if(e.isSet()&&!e.isExpired())l.trigger("fireflyout:open");else{var t=e.createNewExpireTime();e.setExpirationTime(t)}},window.gcsNoSurveyDelivered=function(){l.trigger("fireflyout:open")},n.prototype.initialize.call(this,e),this.setAlternativeActionResult(d),h.ENABLED&&this.surveyChecksPass(h)&&!c.sponsored_series?void r.getActiveSlotStatistics().done(t.bind(function(e){return t.findWhere(e.high_impact_info,{adType:"gravity"})||this.destroyed?!1:void(o?o.getUserInfo().done(t.bind(function(e){e.hasMarketAccess||this.loadGoogleConsumerSurvey(h,d)},this)).fail(t.bind(function(){this.loadGoogleConsumerSurvey(h,d)},this)):this.loadGoogleConsumerSurvey(h,d))},this)):(l.trigger("fireflyout:open"),!1)},surveyChecksPass:function(e){var t=parseInt(this.getAlternativeActionResult(),10),i=this.getEligibleArticleCount(),s=new Date;if(!e.show_on_article_number||i>=e.show_on_article_number){if(!t)return!0;if(s.getTime()>t+e.relief_period)return!0}else i++,o.setValue("gcs-eligible-page-count",i);return!1},loadGoogleConsumerSurvey:function(e,t){if(e.publisher_id&&t){var i="everything",n="//survey.g.doubleclick.net/survey";s.fetchData(n,{dataType:"script",data:{site:"_"+e.publisher_id,url:t,cid:i,after:"1"}})}},setAlternativeActionResult:function(e){if(e&&e.indexOf("#gcs-aau-success")>-1){var t=new Date;localStorage["gcs-aau-fulfilled"]=t.getTime(),window.location.hash=""}},getAlternativeActionResult:function(){return localStorage.getItem("gcs-aau-fulfilled")},getEligibleArticleCount:function(){return o.getValue("gcs-eligible-page-count",1)},_getLocation:function(){return window.location.href},destroy:function(){e(".t402-prompt-iframe-container").remove(),window.scrollTo(0,1),delete window.gcsOnSurveyComplete,delete window.gcsNoSurveyDelivered,n.prototype.destroy.call(this)}});return h}),define("modules/global/video-carousel",["jquery","underscore","baseview","pubsub","state","modules/global/brightcove-video"],function(e,t,i,s,n,a){"use strict";var o=i.extend({events:{"click .carousel-nav":"onCarouselNavClick","mouseleave .video-carousel-viewport":"carouselMouseOut","mouseenter .video-carousel-viewport":"carouselMouseIn"},initialize:function(s){this.$carouselContainer=this.$(".video-carousel-series"),this.moveMe=this.$carouselContainer,this.viewport=this.moveMe.parent(),this.$slides=this.$carouselContainer.find(".video-carousel-item"),this.totalSlides=this.$slides.length,this.index=this.$(".video-carousel-item-wrap.active").index(),this.subviews={},this.subviews.video=[],this.autoplay=!1,t.bindAll(this,"goToNextVideo"),this.totalSlides>1?this.slideChangeInterval=setInterval(this.goToNextVideo,5e3):this.$(".carousel-nav").hide();var n=this;t.bindAll(this,"bcPlayerLoaded"),e.each(this.$slides.find(".video"),function(){var e=new a({el:this,onVideoComplete:n.goToNextVideo,onVideoLoaded:n.bcPlayerLoaded,autostart:!1});n.subviews.video.push(e)}),this.$el.hasClass("autoplay")&&(this.subviews.video[0].$(".videoStillPlay").click(),clearInterval(this.slideChangeInterval)),i.prototype.initialize.call(this,s)},bcPlayerLoaded:function(){this.autoplay=!0},onCarouselNavClick:function(t){if(t.preventDefault(),this.totalSlides>1){var i=e(t.currentTarget),s=i.hasClass("prev"),n=this.$(".video-carousel-item-wrap.active").index();this.index=n,this.autoplay=!1,s?n--:n++,this.goTo(n)}},goTo:function(e){e>=this.totalSlides?e=0:0>e&&(e=this.totalSlides-1);var t=this.viewport.outerWidth(),i=t*e*-1;this.subviews.video[this.index].player&&this.subviews.video[this.index].resetVideoState(),this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),this.autoplay&&(s.trigger("uotrack","videocarousel|nextauto"),this.subviews.video[e].player||this.subviews.video[e].$(".videoStillPlay").click()),this.updateDom(e)},updateDom:function(e){this.updateNextPrevArrows(e),this.$(".video-carousel-item-wrap").eq(this.index).removeClass("active"),this.$(".video-carousel-item-wrap").eq(e).addClass("active"),this.index=e},goToNextVideo:function(){var e=this.$(".video-carousel-item-wrap.active").index()+1;this.subviews.video[this.index].modVP?this.subviews.video[this.index].modVP.getIsPlaying(t.bind(function(t){t||this.goTo(e)},this)):this.goTo(e)},carouselMouseIn:function(){this.slideChangeInterval&&(clearInterval(this.slideChangeInterval),this.slideChangeInterval=!1)},carouselMouseOut:function(){this.totalSlides>1&&(this.autoplay||this.slideChangeInterval||(this.slideChangeInterval=setInterval(this.goToNextVideo,5e3)))},updateNextPrevArrows:function(e){{var t=this.$(".carousel-prev");this.$(".carousel-next")}0===e?t.hide():t.show()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return o}),define("modules/fronts/suspender-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_front",adSizes:"sponsor_logo_medium"},t),this.visibleWithSidebarOpen="false"!==this.$el.attr("data-visible-with-sidebar-open"),i.prototype.initialize.call(this,t)},openSideBar:function(){this.visibleWithSidebarOpen||this._onHideSidebarAd()},closeSideBar:function(){this.visibleWithSidebarOpen||this._initAds()},_onHideSidebarAd:function(){this.subviews.simpleAd&&(this.subviews.simpleAd.destroy(),this.hide(),this.subviews.simpleAd=!1)},renderCardInfo:function(e){this.visibleWithSidebarOpen?this._initAds():e.sidebarOpen||this._initAds()}});return s}),define("modules/fronts/lottery",["jquery","underscore","baseview","state","utils","ui/dropdown"],function(e,t,i,s,n,a){"use strict";var o=i.extend({initialize:function(n){n=e.extend({refreshDelay:6e3,refresh:!1},n),t.bindAll(this,"updateLottery"),i.prototype.initialize.call(this,n),this.options.refresh?this.subviews.refreshInterval=s.recurringFetchHtml("/lottery/front-module/",null,this.options.refreshDelay,this.updateLottery):s.fetchHtml("/lottery/front-module/").done(this.updateLottery)},updateLottery:function(e){this.$el.html(e),this.setupDropdown()},setupDropdown:function(){this.subviews.selectDropdown&&this.subviews.selectDropdown.destroy(),this.subviews.selectDropdown=new a({el:this.$(".lottery-state-picker-dropdown")})}});return o}),define("modules/ggm-va-loan/ggm-va-loan",["jquery","underscore","baseview","form/dropdown","state","managers/routemanager"],function(e,t,i,s){"use strict";var n=i.extend({events:{"submit .ggmval-form":"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmval-select")})},onFormSubmit:function(e){var t=this.$(".ggmval-input");return/^\d{5}$/.test(t.val())?void t.removeClass("ggmval-input-error"):(t.addClass("ggmval-input-error"),void e.preventDefault())}});return n}),define("modules/travel/travel-tools",["jquery","baseview"],function(e,t){"use strict";var i=t.extend({events:{"click .ttp-tab":"switchTabs","click .ttp-close":"closeTabs"},switchTabs:function(t){var i=e(t.currentTarget),s=i.attr("data-tabtarget"),n=this.$(s),a=this.$(".ttp-tab-content");this.$el.addClass("tt-dashboard-open"),this.$(".ttp-tab").removeClass("ttp-tab-active"),i.addClass("ttp-tab-active"),a.removeClass("ttp-submodule-active").addClass("ttp-submodule"),n.addClass("ttp-submodule-active").removeClass("ttp-submodule")},closeTabs:function(){this.$el.removeClass("tt-dashboard-open"),this.$(".ttp-tab-active").removeClass("ttp-tab-active"),this.$(".ttp-submodule-active").removeClass("ttp-submodule-active").addClass("ttp-submodule")}});return i}),define("modules/sports/sports-headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle","modules/fronts/headline-grid","modules/scroller/vertical-scroll"],function(e,t,i,s,n,a,o,r,l,h){"use strict";var d=l.extend({el:".sp-filter-bar-wrap",events:function(){return e.extend(l.prototype.events,{"click .sp-filter-link":"getFilteredContent","mouseenter .sp-filter-dropdown":"onHoverFilterDropdown","mouseleave .sp-filter-dropdown":"onHoverFilterDropdown"})},initialize:function(e){l.prototype.initialize.call(this,e)},getFilteredContent:function(i){this.$contentFilterId=e(i.currentTarget);var a=this.$contentFilterId.text(),o=this.$contentFilterId.data("url");this.$(".headline-collection-container").addClass("sp-loading-details"),this.$(".headline-collection-container").html(""),this.$(".sp-filter-btn").html(a),s.fetchHtml(o).done(t.bind(function(e){this.$(".headline-collection-container").html(e),this.$(".headline-collection-container").removeClass("sp-loading-details")},this));var r=this.$contentFilterId.data("ht")+a;r&&n.trigger("uotrack",r)},showMore:function(t){if(t.preventDefault(),e(t.target).hasClass("inactive"))return!1;this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i,s=this.$(".headline-page.active:last").next(),o=s.attr("data-itemnum"),r=s.attr("data-items-per-page"),l=Math.round(o/r),h=e(".headline-collection");return i=h.hasClass("listview")?"data-list-src":"data-grid-src",a.lazyLoadImage(s.find("img"),i,!0),n.trigger("uotrack",a.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(s),!0},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),s=i.find(".sp-filter-scroll-wrap");this.subviews.vscroll=new h({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return d}),define("modules/polldaddy-poll",["jquery","underscore","baseview","state"],function(e,t,i,s){"use strict";var n=i.extend({el:".polls-primary-wrapper",events:{"click .pmp-view-results":"toggleLink","click .pmp-answer-option":"submitVote"},initialize:function(e){i.prototype.initialize.call(this,e),this.$q_wrapper=this.$(".poll-question-wrapper"),this.$a_wrapper=this.$(".poll-answer-wrapper"),this.$question=this.$(".pmp-answer-option"),this.$toggle=this.$(".pmp-view-results"),this.$bars=this.$(".pmp-bar"),this.poll_id=this.$question.data("poll"),this.viewResults()},viewResults:function(){this.getVoteValue()===String(this.poll_id)&&(this.$a_wrapper.addClass("pmp-active"),this.$q_wrapper.remove(),this.$toggle.remove())},toggleLink:function(){this.$a_wrapper.hasClass("pmp-active")?(this.$a_wrapper.removeClass("pmp-active"),this.$q_wrapper.addClass("pmp-active")):(this.$q_wrapper.removeClass("pmp-active"),this.$a_wrapper.addClass("pmp-active"))},incBarWidths:function(i){var s=[],n=0;t.each(i.answers.answer,function(e){s.push(e.percent)}),e.each(this.$bars,function(){e(this).width(s[n]+"%"),n++})},submitVote:function(i){i.preventDefault();var n=e(i.target),a=n.data("vote"),o=n.data("poll"),r=this;this.getVoteValue()!==String(o)&&s.fetchData("/polls/post/"+o+"/"+a+"/").done(t.bind(function(e){this.setVoteValue(o),this.incBarWidths(e),r.viewResults()},this))},setVoteValue:function(e){localStorage.setItem("polldaddy_pollvote",e)},getVoteValue:function(){return localStorage.getItem("polldaddy_pollvote")}});return n}),define("modules/stories/utility-bar-module-comments",["jquery","underscore","backbone","pubsub","utils","modules/stories/utility-bar-flyout","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook"],function(e,t,i,s,n,a,o,r){var l=a.extend({initialize:function(i){this.pubSub={"breakingbar:after:open":this.scalePanel},i=e.extend({noFlyoutScroll:!0},i),this.events=t.extend({},a.prototype.events,this.events),a.prototype.initialize.call(this,i)},attachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.subscribe("comment.create",function(){s.trigger("comment:created")}),FB.Event.subscribe("comment.remove",function(){s.trigger("comment:removed")}))})})},unattachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.unsubscribe("comment.create"),FB.Event.unsubscribe("comment.remove"))})})},loadComments:function(){return r.loadScript().done(t.bind(function(){FB.XFBML.parse(this.$scrollable[0]),this.scrollableHeight=this.$scrollable.height(),this.heightPoll=setInterval(t.bind(function(){this.scrollableHeight!==this.$scrollable.height()&&(this.scrollableHeight=this.$scrollable.height(),this.scalePanel())},this),200);var e=!1;-1===navigator.userAgent.indexOf("Chrome")?e=!0:Modernizr.touch&&(this.$scrollWrap.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$scrollWrap.css("-webkit-overflow-scrolling")&&(e=!0)),e?this.$scrollWrap.css("overflow","auto"):this.subviews.vscroll=new o({el:this.$scrollWrap,draggerPaddingTop:0,color:"lighter"})},this))},onWindowResize:function(){this.scalePanel(),a.prototype.onWindowResize.call(this)},scalePanel:function(){this.$scrollWrap.css("height",this.$win.height()-n.get("headerHeight")-115),this.subviews.vscroll&&this.subviews.vscroll.refresh()},open:function(){this.$scrollWrap=this.$(".util-bar-scroll-wrap"),this.$scrollable=this.$(".scrollable-content"),this.$fbPluginWrap=this.$(".facebook-comments-plugin-wrap"),this.$win=n.get("win"),this.loadComments().done(t.bind(function(){this.attachCommentListener(),s.trigger("uotrack","UtilityBarCommentsOpen"),a.prototype.open.call(this)},this))},close:function(){s.trigger("uotrack","UtilityBarCommentsClose"),this.destroy()},destroy:function(e){clearInterval(this.heightPoll),this.unattachCommentListener(),a.prototype.destroy.call(this,e)}});return l}),define("modules/fronts/election-results-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(e,t,i,s,n,a){"use strict";var o=s.extend({el:".elres-module-container",initialize:function(e){s.prototype.initialize.call(this,e),this.drawSenate(),this.drawHouse(),this.drawGov()},drawSenate:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/senate-bar-data.json";a.fetchData(s,{dataType:"json"}).done(t.bind(function(t){if(t){var s=t.senatedata[0],n=s.dem*i/100,a=s.repub*i/100,o=s.other*i/100,r=s.undecided*i/100;e(".elres-sen-democrat").width(n+"%"),e(".elres-sen-republican").width(a+"%"),e(".elres-sen-other").width(o+"%"),e(".elres-sen-undecided").width(r+"%"),e("#elres-sen-dem-num").html(s.dem),e("#elres-sen-rep-num").html(s.repub)}},this))},drawGov:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/gov-bar-data.json";a.fetchData(s,{dataType:"json"}).done(t.bind(function(t){if(t){var s=t.govdata[0],n=s.dem*i/50,a=s.repub*i/50,o=s.other*i/50,r=s.undecided*i/50;e(".elres-gov-democrat").width(n+"%"),e(".elres-gov-republican").width(a+"%"),e(".elres-gov-tossup").width(o+"%"),e(".elres-gov-undecided").width(r+"%"),e("#elres-gov-dem-num").html(s.dem),e("#elres-gov-rep-num").html(s.repub)}},this))},drawHouse:function(){var i=100,s="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/house-bar-data.json";a.fetchData(s,{dataType:"json"}).done(t.bind(function(t){if(t){var s=t.housedata[0],n=s.dem*i/435,a=s.repub*i/435,o=s.other*i/435,r=s.undecided*i/435;e(".elres-house-democrat").width(n+"%"),e(".elres-house-republican").width(a+"%"),e(".elres-house-tossup").width(o+"%"),e(".elres-house-undecided").width(r+"%"),e("#elres-house-dem-num").html(s.dem),e("#elres-house-rep-num").html(s.repub)}},this))}});return o}),define("modules/sports/sports-stn-promo",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),e(document).ready(function(){e('a[href*="story/sports"]').click(function(){"undefined"!=typeof s2nStopPlayer&&e.isFunction(s2nStopPlayer)&&(console.log("s2nStopPlayer exists"),s2nStopPlayer())})})}});return s}),define("modules/travel/travel-email",["jquery","underscore","baseview","state","utils","pubsub"],function(e,t,i,s,n,a){var o=i.extend({updateMessage:function(i){var s;try{i=e.parseJSON(i)}catch(n){i={}}if(i.travelEmailMessage&&(s=i.travelEmailMessage,s.errorControl&&this.travelEmailForm.find('input[name="'+s.errorControl+'"]').addClass("travel-email-form-input-error").attr("placeholder","Required: "+s.errorControl),"travel-email-success"==s.status)){a.trigger("uotrack","travelfrontemail");var o=t.template('<div class="travel-email-confirmation"><div class="travel-email-thank-you"><%= message %></div><div>We\'ll be in touch with you soon.</div></div>'),r=o({message:s.message});this.travelEmailForm.find(".travel-email-wrapper").html(r).addClass("travel-email-submitted"),this.travelEmailForm.find("input").removeClass("travel-email-form-input-error")}},initialize:function(s){this.travelEmailForm=e(this.$el),this.win=n.get("win"),this.win.on("message."+this.cid,t.bind(function(e){var t=window.location.protocol+"//"+window.location.host;e.originalEvent.origin.replace(/\/$/,"")==t&&"undefined"!=e.originalEvent.data.travelEmailMessage&&this.updateMessage(e.originalEvent.data)},this)),i.prototype.initialize.call(this,s)},destroy:function(e){this.win.off("."+this.cid),i.prototype.destroy.call(this,e)}});return o}),define("modules/users/site-nav-user-module",["jquery","underscore","pubsub","utils","modules/header/site-nav-dropdown","user-manager"],function(e,t,i,s,n,a){"use strict";var o=n.extend({ALT_ACTIVE_CLASS:"site-nav-visible-alt-span",WRAP_ACTIVE_CLASS:"site-nav-user-dropdown-wrap-active",events:{"click .site-nav-user-login-btn":"onClickLogin","click .site-nav-user-logout-btn":"onClickLogout"},initialize:function(e){this.pubSub={"user:login":this.showLoggedInUser,"user:logout":this.showLoggedOutUser},t.bindAll(this,"_handleDropdownPanels","showLoggedInUser","showLoggedOutUser"),this.events=t.extend({},n.prototype.events,this.events),this.$loginWrap=this.$(".site-nav-user-logged-in-wrap"),this.$logoutWrap=this.$(".site-nav-user-logged-out-wrap"),this.$siteNavAltSpan=this.$(".site-nav-alt-span"),this.$avatarContainer=this.$(".site-nav-user-avatar-span"),this.$userDisplayName=this.$(".site-nav-user-display-name"),this.$avatar=this.$(".site-nav-user-avatar-image"),n.prototype.initialize.call(this,e),this._handleDropdownPanels()},_handleDropdownPanels:function(){this.isUserLoggedIn?(this.$loginWrap.addClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.removeClass(this.WRAP_ACTIVE_CLASS)):(this.$loginWrap.removeClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.addClass(this.WRAP_ACTIVE_CLASS))},showLoggedOutUser:function(){this.isUserLoggedIn=!1,this._teardownLoggedInMarkup(),this._handleDropdownPanels()},showLoggedInUser:function(){this._setupLoggedInMarkup(a.getAccount()),this.isUserLoggedIn=!0,this._handleDropdownPanels()},_setupLoggedInMarkup:function(e){var t=e.getUserFirstName()+" "+e.getUserLastName();this.$avatar.attr("src",e.getUserAvatar()),this.$avatar.attr("alt",t),this.$siteNavAltSpan.addClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html(t)},_teardownLoggedInMarkup:function(){this.$avatar.attr("src",""),this.$avatar.attr("alt",""),this.$siteNavAltSpan.removeClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html("")},onClickLogout:function(){this.showLoggedOutUser(),a.logoutUser().done(function(){i.trigger("uotrack","headerprofilelogout")})},onClickLogin:function(t){var s=e(t.target).data("user-account");a.loginUser(s).done(function(){i.trigger("uotrack","headerprofilelogin")})},destroy:function(e){this._teardownLoggedInMarkup(),n.prototype.destroy.call(this,e)}});return o}),define("modules/money/job-search",["jquery","underscore","baseview","state","form/base-form"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),s.fetchData("/money/jobs/categories/",{timeout:1e4}).done(t.bind(function(e){this.$(".jobs-form-dropdown").html(e)},this)).always(t.bind(function(){this.subviews.jobSearchForm=new n({el:this.$(".jobs-form-wrap")})},this))}});return a}),define("modules/sports/sports-multipurpose-promo",["jquery","underscore","baseview","pubsub"],function(e,t,i){var s=i.extend({initialize:function(){this.$promo=e("#sports-multipurpose-promo"),this.active_mod=this.$promo.attr("activemod"),"countdown"==this.active_mod&&(this.$countdown=e(".sports-countdown"),this.countdown_transition_target=this.$countdown.data("transitionlink"),this.countdown_preview_target=this.$countdown.data("previewink"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-new Date)),this.dateDiffInSeconds>0?this.startCountdown():this.countdownTransition(this.countdown_transition_target))},startCountdown:function(){this.timer=setInterval(e.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var e=Math.floor(this.dateDiffInSeconds/this.secondsInDay),t=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(t/this.secondsInHour),s=t%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),a=Math.ceil(s%this.secondsInMinute);this.$countdown.find("#days").text(10>e?"0"+e:e),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>a?"0"+a:a),this.dateDiffInSeconds<=0&&this.countdownTransition(this.countdown_transition_target)},this),1e3)},countdownTransition:function(t){clearInterval(this.timer),e("#sports-multipurpose-promo .sports-countdown-img img").attr("src",t),e("#sports-multipurpose-promo #clock_display").hide()},destroy:function(e){clearInterval(this.timer),i.prototype.destroy.call(this,e)}});return s}),function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,n,a,o;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),a=e.childNodes,o=[],s=0,n=a.length;n>s;s++)i=a[s],o.push(this.add_option(i,t,e.disabled));return o},e.prototype.add_option=function(e,t,i){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0
},e}(),e.select_to_array=function(t){var i,s,n,a,o;for(s=new e,o=t.childNodes,n=0,a=o.length;a>n;n++)i=o[n],s.add_node(i);return s.parsed},this.SelectParser=e}.call(this),function(){var e,t;t=this,e=function(){function e(e,t){this.form_field=e,this.options=null!=t?t:{},this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,i;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*e.length),t=e.substring(i,i+1)},e}(),t.AbstractChosen=e}.call(this),function(){var e,t,i,s,n,a={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var s in t)a.call(t,s)&&(e[s]=t[s]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=this,e=jQuery,e.fn.extend({chosen:function(i){var s,n,a;return a=navigator.userAgent.toLowerCase(),n=/(msie) ([\w.]+)/.exec(a)||[],s={name:n[1]||"",version:n[2]||"0"},"msie"===s.name&&("6.0"===s.version||"7.0"===s.version&&7===document.documentMode)?this:this.each(function(){var s;return s=e(this),s.hasClass("chzn-done")?void 0:s.data("chosen",new t(this,i))})}}),t=function(t){function a(){return n=a.__super__.constructor.apply(this,arguments)}return o(a,t),a.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},a.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},a.prototype.set_up_html=function(){var t,s,n,a,o,r;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",t=["chzn-container"],t.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chzn-rtl"),this.f_width=this.form_field_jq.outerWidth(),n={id:this.container_id,"class":t.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title},s=e("<div />",n),s.html(this.is_multiple?'<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>':'<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(s),this.container=e("#"+this.container_id),this.dropdown=this.container.find("div.chzn-drop").first(),a=this.container.height(),o=this.f_width-i(this.dropdown),this.dropdown.css({width:o+"px",top:a+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),r=o-i(this.search_container)-i(this.search_field),this.search_field.css({width:r+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},a.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){e.container_mousedown(t)}),this.container.mouseup(function(t){e.container_mouseup(t)}),this.container.mouseenter(function(t){e.mouse_enter(t)}),this.container.mouseleave(function(t){e.mouse_leave(t)}),this.search_results.mouseup(function(t){e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){e.search_results_mouseout(t)}),this.form_field_jq.bind("liszt:updated",function(t){e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){e.container_mousedown(t)}),this.search_field.blur(function(t){e.input_blur(t)}),this.search_field.keyup(function(t){e.keyup_checker(t)}),this.search_field.keydown(function(t){e.keydown_checker(t)}),this.search_field.focus(function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.click(function(t){e.choices_click(t)}):this.container.click(function(e){e.preventDefault()})},a.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},a.prototype.container_mousedown=function(t){var i;return this.is_disabled?void 0:(i=null!=t?e(t.target).hasClass("search-choice-close"):!1,t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?!this.is_multiple&&t&&(e(t.target)[0]===this.selected_item[0]||e(t.target).parents("a.chzn-single").length)&&(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field()))},a.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},a.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},a.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},a.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},a.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},a.prototype.results_build=function(){var e,t,i,n,a;for(this.parsing=!0,this.results_data=s.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",a=this.results_data,i=0,n=a.length;n>i;i++)t=a[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},a.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},a.prototype.result_do_highlight=function(e){var t,i,s,n,a;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),a=this.search_results.scrollTop(),n=s+a,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=n)return this.search_results.scrollTop(t-s>0?t-s:0);if(a>i)return this.search_results.scrollTop(i)}},a.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},a.prototype.results_show=function(){var e;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return e=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},a.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},a.prototype.set_tab_index=function(){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",e)):void 0},a.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},a.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t),this.search_field.focus()):void 0},a.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},a.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},a.prototype.choices_click=function(t){return t.preventDefault(),!this.active_field||e(t.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},a.prototype.choice_build=function(t){var i,s,n,a=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+t.array_index,this.choices+=1,s=t.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+t.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>',this.search_container.before(s),n=e("#"+i).find("a").first(),n.click(function(e){return a.choice_destroy_link_click(e)}))},a.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),this.is_disabled?t.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(e(t.target)))},a.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},a.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},a.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},a.prototype.result_select=function(e){var t,i,s,n;return this.result_highlight?(t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),n=i.substr(i.lastIndexOf("_")+1),s=this.results_data[n],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.is_multiple?this.choice_build(s):(this.selected_item.find("span").first().text(s.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!e.metaKey&&!e.ctrlKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},a.prototype.result_activate=function(e){return e.addClass("active-result")},a.prototype.result_deactivate=function(e){return e.removeClass("active-result")},a.prototype.result_deselect=function(t){var i,s;return s=this.results_data[t],this.form_field.options[s.options_index].disabled?!1:(s.selected=!1,this.form_field.options[s.options_index].selected=!1,i=e("#"+this.container_id+"_o_"+t),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[s.options_index].value}),this.search_field_scale(),!0)},a.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},a.prototype.winnow_results=function(){var t,i,s,n,a,o,r,l,h,d,c,u,p,f,g,m,v,b;for(this.no_results_clear(),h=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),o=this.search_contains?"":"^",a=new RegExp(o+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),b=this.results_data,f=0,m=b.length;m>f;f++)if(i=b[f],!i.disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,l=i.dom_id,r=e("#"+l),a.test(i.html))t=!0,h+=1;else if(this.enable_split_word_search&&(i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(n=i.html.replace(/\[|\]/g,"").split(" "),n.length))for(g=0,v=n.length;v>g;g++)s=n[g],a.test(s)&&(t=!0,h+=1);t?(d.length?(c=i.html.search(p),u=i.html.substr(0,c+d.length)+"</em>"+i.html.substr(c+d.length),u=u.substr(0,c)+"<em>"+u.substr(c)):u=i.html,r.html(u),this.result_activate(r),null!=i.group_array_index&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(r))}return 1>h&&d.length?this.no_results(d):this.winnow_results_set_highlight()},a.prototype.winnow_results_clear=function(){var t,i,s,n,a;for(this.search_field.val(""),i=this.search_results.find("li"),a=[],s=0,n=i.length;n>s;s++)t=i[s],t=e(t),a.push(t.hasClass("group-result")?t.css("display","auto"):this.is_multiple&&t.hasClass("result-selected")?void 0:this.result_activate(t));return a},a.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},a.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},a.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},a.prototype.keydown_arrow=function(){var t,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},a.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},a.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},a.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},a.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},a.prototype.search_field_scale=function(){var t,i,s,n,a,o,r,l,h;if(this.is_multiple){for(s=0,r=0,a="position:absolute; left: -1000px; top: -1000px; display:none;",o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,h=o.length;h>l;l++)n=o[l],a+=n+":"+this.search_field.css(n)+";";return i=e("<div />",{style:a}),i.text(this.search_field.val()),e("body").append(i),r=i.width()+25,i.remove(),r>this.f_width-10&&(r=this.f_width-10),this.search_field.css({width:r+"px"}),t=this.container.height(),this.dropdown.css({top:t+"px"})}},a.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},a}(AbstractChosen),s.Chosen=t,i=function(e){var t;return t=e.outerWidth()-e.width()},s.get_side_border_padding=i}.call(this),define("chosen",function(){}),define("modules/sports/sports-scores-suspender",["jquery","underscore","backbone","pubsub","state","baseview","modules/scroller/sidebar-scroll","chosen","animatecolors"],function(e,t,i,s,n,a,o){var r=a.extend({events:{"mouseover .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation","touchstart .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation",change:"onChangeLeague","click .game":"gameClicked"},initialize:function(i){e.extend(i,{rotateInterval:5e3,refreshInterval:3e4,leagueFailLimit:3}),a.prototype.initialize.call(this,i),t.bindAll(this,"onScoresLoaded","rotateToNextScore","onUpdateLoaded","scoresSuspenderRefresher"),this.$scroller=this.$(".suspender-scroll-content"),this.$pairings=this.$("#pairings"),this.$noScores=this.$pairings.find(".league.none"),this.padding=parseInt(this.$pairings.css("paddingTop"),10),this.canSlideUp=!0,this.yp=0,this.leagues={},this.scoreType="schedule",this.continueRotate=!0,this.continueRefresh=!0,this.refreshStarted=!1,this.failLeague=null,this.leagueFailCount=1;var s=this.$(".magicscroll").outerHeight(),n=this.$(".bottom-wrapper").outerHeight()+23,o=this.$(".top-wrapper").outerHeight();this.viewport=s-(n+o),this.chosenSelector=this.$(".filter"),this.chosenSelector.chosen({disable_search_threshold:30}),this.startIndex=this.$(".chzn-results .result-selected").index(),this.oldHbox=this.$(".hoverGameFunction"),this.onChangeLeague(),this.addscrollBar()},gameClicked:function(t){this.oldHbox.css("display","none");for(var i=t.target||t.srcElement;i&&!i.id;)i=i.parentNode;var s=e(i).next();s.css("display","block"),this.oldHbox=s},scoresSuspenderRefresher:function(){this.refreshStarted=!0;var e;e="/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(e+="?count="+this.$scroller.data("max-count")),this.fetchData(e,this.onUpdateLoaded,!0)},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},stopRotation:function(){this.continueRotate=!1,this.rotateID&&(this.rotateID=clearInterval(this.rotateID)),this.continueRefresh&&!this.refreshStarted&&(this.refreshStarted=!0,this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))},rotateToNextScore:function(){var e=this.$(".chzn-results .result-selected").next();0===e.length&&(e=this.$(".chzn-results").children(":first")),e.index()===this.startIndex&&this.stopRotation(),e.mouseup()},fetchData:function(e,i,s){s?n.fetchHtml(e).done(i).fail(t.bind(function(){console.log("ERROR: Scores Suspender AJAX load failed!"),this.failLeague==this.league&&(this.leagueFailCount+=1),this.failLeague=this.league,i()},this)):(this.$el.addClass("loading"),n.fetchHtml(e).done(i).fail(t.bind(function(){this.$noScores.show(),i()},this)).always(t.bind(function(){this.$el.removeClass("loading")},this)))},onChangeLeague:function(){if(this.refreshScrollBar(),this.$(".league").hide(),this.league=this.$(".filter").val(),void 0===this.league&&(this.league=this.$el.closest(".card").data("league-id")),void 0===this.league&&(this.league=this.$el.closest(".card").data("subsection-id")),void 0===this.league)return void this.$noScores.show();if(this.leagues[this.league])this.updateDisplay(this.leagues[this.league]);else{var e;e="SMG"===this.$scroller.data("sub-section-name")?"/sports/services/scores-suspender/desktop/"+this.league+"/":"/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(e+="?count="+this.$scroller.data("max-count")),this.fetchData(e,this.onScoresLoaded)}},onUpdateLoaded:function(i){if(i){var s=this.$("#pairings ."+this.league),n=e(i);s.find(".game").each(t.bind(function(t,i){var s=e(i),a=s.attr("id"),o=n.find("#"+a),r=o.find(".suspender_score"),l=s.find(".suspender_score");this.markChangedScores(r,l)},this)),s.html(i),this.addScoreHighlight(s.find(".scoreChangeFont"),"rgb(164, 23, 18)",1500),this.continueRefresh&&this.leagueFailCount<this.options.leagueFailLimit&&(this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))}},markChangedScores:function(i,s){i.each(t.bind(function(t,i){var n=e(i);n.html()!==s.eq(t).html()&&n.addClass("scoreChangeFont")},this))},onScoresLoaded:function(t){var i=this.leagues[this.league]=e(t);i.find(".gameBox").length?(this.$pairings.append(i),this.scoreType="scores",this.updateDisplay(i),this.continueRotate&&location.href.search("sports/$")>0?this.rotateID=setTimeout(this.rotateToNextScore,this.options.rotateInterval):this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval)):(console.log("FAILED: Scores Suspender AJAX retrieved BAD data!"),this.$noScores.show())},updateDisplay:function(e){this.$games=e.find(".game"),this.index=0,this.total=this.$games.length,this.total?e.show():this.$noScores.show();var t=this.$(".all-scores-link");t[0].innerHTML=e.data("text"),t.attr("href",e.data("link")),t.attr("target",e.data("target")),this.refreshScrollBar()},showLeague:function(){this.$(".league").hide();var e=this.$(".filter").val(),t=this.$("."+e);t.show(),this.$games=t.find(".game"),this.index=0,this.total=this.$games.length},addScoreHighlight:function(e,t,i){var s=t||"#FFFF9C",n=i||1e3,a=e.css("color");e.stop().css("color",s).animate({color:a},n).animate({color:s},n).animate({color:a},n)},addscrollBar:function(){this.scrollbar=new o({el:this.$(".suspender-scroll-content"),color:"dark",padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0})},refreshScrollBar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.scrollbar.moveDraggerToPosition(0,0))},destroy:function(){this.scrollbar.destroy(),this.stopRefresh(),this.stopRotation(),a.prototype.destroy.call(this)}});return r}),define("modules/travel/kayak-module",["jquery","underscore","baseview","state","pubsub","form/base-form"],function(e,t,i,s,n,a){"use strict";var o=i.extend({el:".kayak-wrapper",events:{"click .kayak-btn":"kayakWidgetBtnClick","click .flight-select-radio-btn":"onFlightRadioButtonClick","clock .kayak-submit":"onKayakSubmitClick"},initialize:function(e){t.bindAll(this,"kayakWidgetBtnClick","tabTransition","onHotelAutoCompleteSelect","datePickerBeforeShow","datePickerBeforeShowDay"),i.prototype.initialize.call(this,e),this.$kayakHotelId=this.$("#kayak-hotel-id"),this._setupDropdownDates(),this._setupForms(),this.tabAnimHeights=this._getTabHeights(this.$(".kayak-tab")),this.$activeTab=this.$(".kayak-btn.active"),this.tabTransition(this.$(".kayak-btn.active").data("type"),!0),this.$("form").submit(function(){n.trigger("uotrack","kayaksearch")})},onHotelAutoCompleteSelect:function(e,t){this.$kayakHotelId.val(t.hid?t.hid:"")},getTabHeight:function(e){return this.tabAnimHeights[e]},setTabHeight:function(e,t){this.tabAnimHeights[e]=t},kayakWidgetBtnClick:function(t){var i=e(t.currentTarget),s=i.data("type"),a="kayak"+s;n.trigger("heattrack",a),this.tabTransition(s,!1)},tabTransition:function(e){var i=this.$(".kayak-tab-"+e),s=this.$activeTab,n="kayak-tab-active",a=this.getTabHeight(e);s&&i[0]===s[0]||(s&&s.removeClass(n),this.animTabWrapperHeight(a).done(t.bind(function(){this.makeButtonActive(e),i.fadeIn(250,t.bind(function(){i.addClass(n),this.$activeTab=i},this))},this)))},animTabWrapperHeight:function(e){return this.animate(this.$(".kayak-search-widget").stop(),"height",e+"px",150,"linear",0)},makeButtonActive:function(e){var t="active",i=this.$(".kayak-"+e+"-btn");i&&(this.$activeBtn&&this.$activeBtn.removeClass(t),i.addClass(t),this.$activeBtn=i)},onFlightRadioButtonClick:function(t){this.switchView(e(t.currentTarget).val())},switchView:function(e){var i=this.$(".flights-"+e+"-container"),s="kayak-flight-view-active",n=i[0].scrollHeight;this.$(".kayak-flight-view").removeClass(s),this.animTabWrapperHeight(n).done(t.bind(function(){i.fadeIn(250).addClass(s),this.setTabHeight("flights",n)},this))},_setupForms:function(){var i=[];this.$(".kayak-tab-hotels .kayak-auto, .kayak-tab-deals .kayak-auto").each(t.bind(function(t,s){i.push({el:e(s),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,onSelect:this.onHotelAutoCompleteSelect,ajaxOptions:{dataType:"jsonp"}})},this)),this.$(".kayak-tab-flights .kayak-auto").each(function(){i.push({el:e(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= ap %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".kayak-tab-vacations .kayak-auto").each(function(){i.push({el:e(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".ui-date-picker").each(t.bind(function(t,s){var n=e(s),a=n.parent().find(".ui-date-picker-btn");i.push({el:n,buttonSelector:a,calendarPanelClass:"ui-light",changeMonth:!0,changeYear:!0,minDate:null,maxDate:null,showOtherMonths:!0,selectOtherMonths:!0,showMonthAfterYear:!0,dateFormat:"m/d/yy",dayNamesMin:["S","M","T","W","T","F","S"],beforeShow:this.datePickerBeforeShow(e(s)),beforeShowDay:null})},this)),this.$(".kayak-form").each(t.bind(function(t,s){this.subviews["form"+t]=new a({el:e(s),formOptions:i})},this));var s=new Date,n=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();this.$(".kayak-date-picker-field").val(n)},datePickerBeforeShow:function(t){t.find(e(".ui-date-picker-btn")).addClass("kayak-date-picker-flyout"),t.find(e(".ui-date-picker-btn")).addClass("ui-light")},datePickerBeforeShowDay:function(e){var t=e.getDay();return[0!==t,""]},_setupDropdownDates:function(){var e=10,t=["January","February","March","April","May","June","July","August","September","October","November","December"],i=(new Date).getMonth(),s=(new Date).getFullYear(),n=t.length,a=i,o=e+a,r=o-n,l=function(e,t){for(var i=0,s=e.length;s--;)e[i]+=" "+t,i++
},h=function(e){var t=e.substr(e.indexOf(" ")+1);return t},d=[].concat(t.slice(a,o));if(l(d,s),r>0){var c=t.slice(0,r);l(c,s+1),d.push.apply(d,c)}for(var u=0;e>u;u++){var p=h(d[u]),f=i+u+1;f>12&&(f-=12),this.$("#kayakCruiseDateDropdown").append('<option value="'+f+"/1/"+p+'">'+d[u]+"</option>"),f=i+u+1}},_getTabHeights:function(i){var s={};return t.each(i,function(t){var i=e(t),n=i.data("tab-id");if(s[n]=i[0].scrollHeight,"flights"===n){var a=this.$(".flight-select-radio-btn:checked").val(),o=this.$(".flights-"+a+"-container");s.flights=o[0].scrollHeight}},this),s}});return o}),define("modules/travel/travel-experience",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,a){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".exp-travel-wrapper"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new a({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+i+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("modules/fronts/most-popular-primary",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".mppm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1,n=i;this.animate(this.moveMe,"left",n+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return a}),define("modules/fronts/most-popular-sidebar",["jquery","underscore","baseview","utils","state"],function(e,t,i,s,n){"use strict";var a=i.extend({renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.loadLazyImages()},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.loadLazyImages()},onOpenSidebar:function(){this.loadLazyImages()},loadLazyImages:function(){s.lazyLoadImage(this.$("img"),"data-src-"+this.currentCardInfo.sidebarWidth,!0,this.hideImage,this.showImage)},hideImage:function(e){e.parent().css("height",e.next().outerHeight()),n.getActiveApp().triggerEvent("refreshSidebarScroll")},showImage:function(e){e.css("visibility","visible"),n.getActiveApp().triggerEvent("refreshSidebarScroll")}});return a}),define("modules/fronts/most-popular",["jquery","underscore","baseview","modules/fronts/most-popular-primary","modules/fronts/most-popular-sidebar"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(e){this.subviews={},"sidebar"===e.layoutType?this.subviews.sidebar=new n(e):this.subviews.primary=new s(e),i.prototype.initialize.call(this,e)},renderCardInfo:function(e){this.triggerEvent("renderCardInfo",e)}});return a}),define("modules/home-finder/home-search",["jquery","underscore","baseview","utils"],function(e,t,i){"use strict";var s=i.extend({events:{"focus .mpa-hf-form-price-input":"inputFocus","click .mpa-hf-form-label":"generalDropdown","click .mpa-hf-form-price-options .mpa-hf-form-option":"priceClick","change .mpa-hf-form-price-input":"inputChange","click .mpa-hf-filter-option":"criteriaClick","click .mpa-hf-btn":"searchHomeFinder"},initialize:function(){this.actionHomeFinder=["",""],this.$priceFilterPane=this.$(".mpa-hf-price-filter-pane"),this.$priceOptions=this.$(".mpa-hf-form-price-options"),this.$priceLabel=this.$(".mpa-hf-form-price-label"),this.$container=this.$(".mpa-hf-filter-pane"),e("body").on("mouseup."+this.cid,t.bind(function(t){var i=this.$(".mpa-hf-form-label"),s=this.$(".mpa-hf-form-option"),n=this.$(".mpa-hf-form-price-input"),a=this.$(".mpa-hf-input-area");i.is(t.target)||s.is(t.target)||n.is(t.target)||a.is(t.target)||!this.$container.is(":visible")||i.is(e(t.target).parent())||this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},this))},searchHomeFinder:function(){var e=this.$(".mpa-hf-input-area").val().toLowerCase();if(e.indexOf(",")>-1){var i=e.split(/[\s*,\s*]+/);this.actionHomeFinder[0]=i[1].toUpperCase()+"/",this.actionHomeFinder[1]=i[0].charAt(0).toUpperCase()+i[0].slice(1)+"/"}var s=t.reduce(this.actionHomeFinder,function(e,t){return e+t});this.$(".seach-form").attr("action","//www.homefinder.com/"+s)},changeSearchAttribut:function(e,t){if(!isNaN(e))switch(t){case"bed":this.actionHomeFinder[2]="min-bed-"+e+"/";break;case"bath":this.actionHomeFinder[3]="min-bath-"+e+"/";break;case"min_price":this.actionHomeFinder[4]="min-price-"+e+"/";break;case"max_price":this.actionHomeFinder[5]="max-price-"+e+"/"}},generalDropdown:function(t){this.$container.not(".mpa-closed").is(t.currentTarget.nextElementSibling)||this.$container.not(".mpa-closed").addClass("mpa-closed"),e(t.currentTarget.nextElementSibling).toggleClass("mpa-closed"),e(t.currentTarget).hasClass("mpa-hf-form-price-label")&&(this.$(".mpa-hf-form-dropdown-menu[data-price='max']").hasClass("mpa-closed")||this.$(".mpa-hf-form-payment-min").focus())},inputFocus:function(t){var i=e(t.currentTarget),s=i.attr("placeholder").toLowerCase();this.$(".mpa-hf-form-dropdown-menu[data-price='"+s+"']").parent().is(":visible")||this.$priceOptions.toggleClass("mpa-closed")},priceClick:function(t){var i=e(t.currentTarget),s=i.parent(),n=s.parent(),a=n.data("price"),o=s.data("value").replace(/,/g,"");this.priceLabelDisplay(a,o),this.changeSearchAttribut(o,a+"_price"),this.$(".mpa-hf-form-payment-"+a).val(s.data("value")),e(".mpa-hf-form-payment-min").val().length>0&&e(".mpa-hf-form-payment-max").val().length>0&&this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},criteriaClick:function(t){var i=e(t.currentTarget),s=i.parent(),n=s.parent(),a=n.data("criteria");e(".mpa-hf-"+a+"-select").html(s.text()),this.$container.toggleClass("mpa-closed",this.$container.is(":visible")),this.changeSearchAttribut(s.data("value"),a)},inputChange:function(t){var i=e(t.currentTarget),s=i.val().replace(/,/g,""),n=i.attr("placeholder").toLowerCase();this.priceLabelDisplay(n,s),this.changeSearchAttribut(s,n+"_price")},priceLabelDisplay:function(t,i){var s="";this.$(".mpa-hf-form-price").data(t,i),0!==this.$(".mpa-hf-form-price").data("min")&&0!==this.$(".mpa-hf-form-price").data("max")?(this.$(".mpa-hf-form-price-prepend, .mpa-hf-form-price-append").hide(),s=this.priceConvert(e(".mpa-hf-form-price").data("min"))+" - "+this.priceConvert(e(".mpa-hf-form-price").data("max"))):(s=this.priceConvert(e(".mpa-hf-form-price").data(t)),0===e(".mpa-hf-form-price").data("min")?e(".mpa-hf-form-price-prepend").html("Up to "):e(".mpa-hf-form-price-append").html(" +")),e(".mpa-hf-form-price").html(s)},priceConvert:function(e){var t="$";return t+=e>=1e3?e.match(/^(\d.*)\d{3}$/)[1]+"K":e},destroy:function(t){e("body").off("."+this.cid),i.prototype.destroy.call(this,t)}});return s}),define("modules/fronts/blogs",["jquery","underscore","backbone","baseview","pubsub"],function(e,t,i,s){var n=s.extend({events:{"click .scroller":"scroll"},initialize:function(t){this.$moveMe=this.$(".stage ul"),this.totalItems=e("li",this.$moveMe).length,this.$scrollerLeft=this.$(".scroller.left"),this.$scrollerRight=this.$(".scroller.right"),s.prototype.initialize.call(this,t)},scroll:function(t){t&&t.preventDefault();var i=e(t.target);if(i.hasClass("disabled"))return!1;var s=i.hasClass("right"),n=this.$moveMe.data("item-offset"),a=4;Modernizr.mq("screen and (min-width: 1250px)")?a=6:Modernizr.mq("screen and (min-width: 1150px)")&&(a=5),s&&(a=-1*a);var o=a+n;o>0&&(o=0);var r=183*n-1,l=183*a,h=l+r;h=183*o-1,0===o?this.$scrollerLeft.addClass("disabled"):this.$scrollerLeft.removeClass("disabled");var d=Math.abs(o)+Math.abs(a);d>=this.totalItems?(this.$scrollerRight.addClass("disabled"),a+=d-this.totalItems,o=a+n,l=183*a,h=l+r,h=183*o-1):this.$scrollerRight.removeClass("disabled"),this.$moveMe.data("item-offset",o),this.animate(this.$moveMe,"left",h+"px",200,"ease-in")}});return n}),define("modules/sports/sports-module-update",["jquery","underscore","baseview","state","utils","pubsub"],function(e,t,i,s,n,a){"use strict";var o=i.extend({initialize:function(s){t.bindAll(this,"initMarkup","updateMarkup","fetchUpdate"),s=e.extend({getItems:25,maxItems:50,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:null,moreLinkText:null,newContentClass:"newcontent"},s),s.section=this.$el.attr(this.options.dataSection)||n.getSectionPath(window.location.pathname),i.prototype.initialize.call(this,s),this.setupLiveFeed()},setupLiveFeed:function(){var e="/feeds/live/"+this.options.section+"/?count="+this.options.getItems;this.$el.children("li").length?(this.$el.children("."+this.options.newContentClass).removeClass(this.options.newContentClass),this.fetchUpdate()):s.fetchHtml(e).done(this.initMarkup)},initMarkup:function(e){this.$el.removeClass(this.options.dataLoading),this.$el.append(e),this.loadLazyImages(e.find("img")),this.renderMoreLink(),a.trigger("sports:module:update"),this.startUpdateCheck()},loadLazyImages:function(e){e=e||this.$("img"),n.lazyLoadImage(e,this.options.dataSrcAttr,!0,this.hideBrokenHasImage)},renderMoreLink:function(){this.options.moreLink&&this.$el.append('<li class="live-feed-news-item"><a href="'+this.options.moreLink+'" class="livefeed-news-item-link has-more">'+this.options.moreLinkText+"</a></li>")},hideBrokenHasImage:function(){e(this).closest(".has-image").removeClass("has-image"),a.trigger("sports:module:update")},fetchUpdate:function(){var e=this.$("li:first").attr(this.options.dataTimeStamp),t="/feeds/live/"+this.options.section+"/?date="+e;s.fetchHtml(t).done(this.updateMarkup)},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),o={};n.removeClass("top"),i.each(function(){o[e(this).attr(this.options.dataContentId)]=!0}),n.each(function(){s=e(this),o[s.attr(this.options.dataContentId)]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass(this.options.newContentClass),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>this.options.maxItems&&n.slice(this.options.maxItems).remove(),this.renderMoreLink(),this.afterNewContent=setTimeout(t.bind(function(){i.removeClass(this.options.newContentClass)},this),1e3*this.options.removeNewHighlight),a.trigger("sports:module:update")}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(e){e&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return o}),define("modules/sports/sports-latest-player-news",["jquery","underscore","backbone","base-app","modules/sports/sports-module-update"],function(e,t,i,s,n){var a=s.extend({initialize:function(t){s.prototype.initialize.call(this,t);var i=e(this.el).find(".sports-latest-player-news"),a=i.data("livefeed-more-link")||null,o=i.data("livefeed-more-link-text")||"More...";this.subviews.updatemodule=new n({el:".livefeed-news-list",maxItems:5,getItems:5,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:a,moreLinkText:o,newContentClass:"newcontent"})}});return a}),define("modules/topics/topics-timeline",["jquery","underscore","state","baseview","utils","pubsub"],function(e,t,i,s,n,a){var o=s.extend({initialize:function(i){t.bindAll(this,"onScroll"),i=e.extend({enableInfiniteScroll:!0},i),i.enableInfiniteScroll&&(this.$win=n.get("win"),this.$win.on("scroll."+this.cid,t.throttle(this.onScroll,200)),this.$storyWrapper=this.$(".tpatm-wrap"),this.fetchingStories=!1,this.loaderClass="tpatm-loading-icon",this.loader='<div class="'+this.loaderClass+'">Loading...</div>'),s.prototype.initialize.call(this,i)},getMoreStories:function(){var e=this.$(".tpatm-item:last"),s=e.attr("data-more-stories-path");if(s){this.fetchingStories=!0,this.$storyWrapper.append(this.loader),a.trigger("topicarticles:fetching");var n=this.$storyWrapper.find("."+this.loaderClass),o="/topic/ajax/stories/?counter="+this.getStoriesCount()+"&path="+encodeURIComponent(s);e.removeAttr("data-more-stories-path"),i.fetchHtml(o).done(t.bind(function(e){n.remove(),e.hide().appendTo(this.$storyWrapper).fadeIn(1e3),this.fetchingStories=!1,a.trigger("topicarticles:fetched")},this)).fail(t.bind(function(){n.remove()},this))}},getStoriesCount:function(){return this.$(".tpatm-item").length},onScroll:function(){if(!this.fetchingStories){var e=this.$(".tpatm-item").last().position().top,t=this.$storyWrapper.offset().top;n.getScrollPosition()>=e-t&&this.getMoreStories()}return!1},destroy:function(e){this.$win.off("."+this.cid),s.prototype.destroy.call(this,e)}});return o}),define("modules/newsletter-signup/newsletter-signup",["jquery","underscore","baseview","state","user-manager","pubsub","managers/cachemanager"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},el:".newsletter-signup-container",events:{submit:"onFormSubmit"},initialize:function(){this.$nlTitle=this.$(".newsletter-signup-title"),this.$nlForm=this.$(".newsletter-signup-form"),this.$nlFormAction=this.$nlForm.attr("action"),this.$emailField=this.$(".newsletter-signup-email"),this.$emailConfirmField=this.$(".newsletter-signup-email-confirm"),this.$emailFormMsg=this.$(".newsletter-signup-msg"),this.$emailFormMsgTxt=this.$(".newsletter-signup-message-text"),this.$customSuccessMessage=this.$emailFormMsg.data("success-message"),this.$nlCheckboxes=this.$(".newsletter-signup-form .newsletters input"),this.$businessUnitCode=this.$nlForm.data("business-unit"),this.$nlSubmit=this.$(".newsletter-signup-submit"),this.$nlTagline=this.$(".newsletter-signup-tagline"),this.userAccount=n.getAccount("firefly"),this.userAccount&&this.userAccount.getUserInfo().done(t.bind(function(t){t.email&&(this.$currentUserEmail=t.email,this.$emailField.val(this.$currentUserEmail),this.$emailConfirmField.val(this.$currentUserEmail),this.$emailField.prop("type","hidden"),this.$emailConfirmField.prop("type","hidden"),this.$nlSubmit.prop("value","Update"),this.$nlTagline.html("Hello, <strong>"+t.welcomeName+"</strong>. Please select any new newsletters you would like to receive."),this.newsletterLocal=o.getValue(this.$currentUserEmail+"_newsletter",null,1),this.newsletterLocal?e.each(this.newsletterLocal.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)}):(o.clearValue(this.$currentUserEmail+"_newsletter"),s.fetchData(null,{url:"/services/gemsapi/getuser/"+t.email+"/"+this.$businessUnitCode}).done(function(t){t.success===!0&&t.subscriptions&&e.each(t.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)})})))},this))},setSubscriptionsLocal:function(e,t){var i={subscriptions:t};o.setValue(e+"_newsletter",i,10)},onFormSubmit:function(i){if(i.preventDefault(),this.$emailField.val()==this.$emailConfirmField.val()&&this.$emailField.val()&&this.validEmail(this.$emailField.val())){this.$emailFormMsg.hide();var n=[];this.$nlCheckboxes.each(function(t,i){n.push({id:e(i).data("newsletter-id"),signup:e(i).is(":checked")})});var o=JSON.stringify(n);this.$emailFormMsg.removeClass("fail").removeClass("success").addClass("updating"),this.$emailFormMsgTxt.html("Updating subscriptions."),this.$emailFormMsg.show();var r=0;this.userAccount&&this.userAccount.getUserInfo().always(t.bind(function(e){e.email&&(r=1)},this)),s.fetchData(null,{type:"POST",url:this.$nlFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:r,newsletter_choices:o}}).done(t.bind(function(t){if(this.$emailFormMsg.removeClass("updating"),t.success===!0){this.$emailFormMsg.removeClass("fail").addClass("success");var i=this.$el.hasClass("newsletter-signup-sidebar");i&&(this.$nlForm.addClass("hidden"),this.$nlTitle.addClass("hidden"));var s="newsletter-signup|front|"+this.$nlSubmit.data("frontname")+"|choices|",n=[];this.$nlCheckboxes.each(function(t,i){e(i).is(":checked")&&n.push(e(i).data("newsletter-id"))}),this.setSubscriptionsLocal(this.$currentUserEmail,n);var o=n.join("|");s+=o,a.trigger("uotrack",s)}else this.$emailFormMsg.removeClass("success").addClass("fail");t.success&&this.$customSuccessMessage&&(this.$customSuccessMessage=this.$customSuccessMessage.split("||").map(function(e){return'<span class="newsletter-signup-custom-success">'+e+"</span>"}).join(""),t.message=this.$customSuccessMessage),this.$emailFormMsgTxt.html(t.message)},this))}else this.$emailFormMsg.removeClass("updating").removeClass("success").addClass("fail"),this.$emailField.val()!=this.$emailConfirmField.val()&&this.$emailFormMsgTxt.html("Email addresses do not match."),this.$emailField.val()&&this.validEmail(this.$emailField.val())||this.$emailFormMsgTxt.html("Please enter a valid email address."),this.$emailFormMsg.show()}});return r}),define("modules/fronts/assigned-content-nav",["jquery","underscore","baseview","ui/generic-paginator"],function(e,t,i,s){var n=i.extend({events:{"click .acnpm-filter":"filterItems"},initialize:function(e){t.bindAll(this,"goTo"),this.subviews={},this.$itemsContainer=this.$(".acnpm-items-container"),this.$items=this.$(".acnpm-item"),this.itemsPerRow=this.$el.hasClass("six-across")?6:8,this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},filterItems:function(e){e.preventDefault();var t,i,s=e.currentTarget.id;this.$(".acnpm-filter").removeClass("selected").filter(e.currentTarget).addClass("selected"),this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=s&&this.$items.not("."+s).hide(),t=this.$items.filter(":visible").length,i=Math.floor(t/this.itemsPerRow),0===i?this.$(".acnpm-container").addClass("nopagination"):(this.$(".acnpm-container").removeClass("nopagination"),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"left",680*-e+"px",450,"ease-in-out")}});return n}),define("modules/ugc/social-share-facebook",["jquery","underscore","utils","pubsub","baseview","third-party-apis/facebook/facebook"],function(e,t,i,s,n,a){"use strict";var o=n.extend({el:".social-share-modal-form-facebook",events:{"click .social-share-modal-btn-submit-facebook":"socialShareToFacebook","click .social-share-modal-form-submit-fail-try-again-link":"socialShareToFacebook","click .social-share-modal-view-post-link":"onClickPostLink"},initialize:function(i){i=e.extend({data:"",link:"",image:""},i),n.prototype.initialize.call(this,i),t.bindAll(this,"fbShareCallback"),this.setup()},setup:function(){var t=i.getNested(this.options.data,"post","description");this.title=i.getNested(this.options.data,"post","title")||"",this.$fbShareForm=e(".social-share-modal-form-facebook-container"),this.$successPane=e(".social-share-modal-form-submit-success"),this.$successPaneMessage=e(".social-share-modal-form-submit-success-text"),this.$failPane=e(".social-share-modal-form-submit-fail"),this.$loading=e(".social-share-modal-loading-facebook"),e(".social-share-modal-form-facebook-summary-title").html(this.title),e(".social-share-modal-form-facebook-summary-description").html(t),e(".social-share-modal-form-facebook-overview-image").attr("src",this.options.image)},hideConfirmationPane:function(){this.$successPane.hide(),this.$failPane.hide()},showFacebookShareForm:function(){this.$loading.hide(),this.$el.show(),this.$fbShareForm.show()},socialShareToFacebook:function(){this.$loading.show();var e={method:"feed",link:this.options.link,name:this.title};a.loadScript().done(t.bind(function(t){t.ui(e,this.fbShareCallback)},this))},fbShareCallback:function(e){e&&e.post_id?this._onShareSuccess(e.post_id):this._onShareFail()},onClickPostLink:function(t){t.preventDefault();var s=e(t.target).attr("href");i.openPopup(s,1e3,600)},_onShareSuccess:function(e){var t="https://www.facebook.com/"+e.replace("_","/posts/");this.$successPaneMessage.html('A link has been posted to your Facebook feed. <a class="social-share-modal-view-post-link" href="'+t+'">View the post.</a>'),this.$fbShareForm.hide(),this.$failPane.hide(),this.$successPane.show(),s.trigger("uotrack","yourtakefacebook")},_onShareFail:function(){this.$fbShareForm.hide(),this.$loading.hide(),this.$failPane.show()}});return o}),define("modules/stories/share-email",["jquery","underscore","backbone","pubsub","baseview","state","utils","form/input-field"],function(e,t,i,s,n,a,o,r){var l=n.extend({events:{"click .recaptcha_option":"onRecaptcha","click .js-share-email-cancel-btn":"onClickCancelBtn","click .js-share-email-send-btn":"onSubmitEmailForm"},initialize:function(i){i=e.extend({uotrackName:"UtilityBarShareEmail",message:""},i),t.bindAll(this,"initInputs"),this.subviews={},this.initInputs(),this.$emailForm=this.$(".js-share-email-form"),this.$emailFormContainer=this.$(".js-share-email-form-container"),this.$successPane=this.$(".js-share-email-form-success-pane"),this.$shareTextarea=this.$(".js-share-email-form-textarea"),this.$shareTextareaOldVal=this.$shareTextarea.val(),this.setRecaptcha(),this.$emailForm.length&&o.requireSingleUseScript("http://www.google.com/recaptcha/api/challenge?k=6Lf7fuESAAAAAJ3_KMIDbkQySsEE0vMkLXUkq4eY").done(t.delay(this.initInputs,300)),n.prototype.initialize.call(this,i)},initInputs:function(){this.$inputs=this.$(".ui-text-input"),t.each(this.$inputs,function(e,t){this.subviews["input"+t]&&this.subviews["input"+t].destroy(),this.subviews["input"+t]=new r({el:e})},this)},setRecaptcha:function(){e(".recaptcha_widget").remove();var t=e("#recaptcha_widget").html();this.$(".js-email-form-recaptcha-widget").html(t),"modalEmailForm"===this.$el.attr("id")&&e("#recaptcha_response_field").addClass("ui-light")},onSubmitEmailForm:function(i){i.preventDefault();var s=this.$("#recaptcha_response_field");this.isValid(this.$emailForm)&&e.ajax({type:"POST",url:this.$emailForm.attr("action"),data:this.$emailForm.serialize()}).done(t.bind(function(){this.onSuccessfulSubmission()},this)).fail(t.bind(function(){s.addClass("error"),window.Recaptcha.reload()},this))},onSuccessfulSubmission:function(){this.showSuccessPane(),this.triggerEvent("clearInputValue"),this.reloadRecaptcha(),s.trigger("uotrack",this.options.uotrackName)},showSuccessPane:function(){this.hideEmailForm(),this.$successPane.show()},showEmailForm:function(){this.hideConfirmationPane(),this.setupShareText(),this.$el.show(),this.$emailFormContainer.show()},setupShareText:function(){this.$shareTextarea.val(this.options.message+"\n"+this.options.postLink+"\n\n"+this.$shareTextareaOldVal),this.$shareTextarea.height(40)},hideEmailForm:function(){this.$emailFormContainer.hide()},hideConfirmationPane:function(){this.$successPane.hide()},isValid:function(t){var i=!0;return t.children("input,textarea").removeClass("error").each(function(t,s){var n=e(s);n.hasClass("required")&&""===n.val()&&(n.addClass("error"),i=!1)}),i},onClickCancelBtn:function(){"modalEmailForm"===this.$el.attr("id")?a.getActiveApp().$(".social-share-modal-close-btn").trigger("click"):a.getActiveApp().$(".js-share-email-btn").trigger("click")},onRecaptcha:function(t){var i=e(t.currentTarget).data("option");"audio"===i||"image"===i?this.switchRecaptchaType(i):"help"===i?this.showRecaptchaHelp():this.reloadRecaptcha()},switchRecaptchaType:function(e){window.Recaptcha.switch_type(e)},showRecaptchaHelp:function(){window.Recaptcha.showhelp()},reloadRecaptcha:function(){window.Recaptcha.reload()}});return l}),define("modules/ugc/social-share-modal",["jquery","underscore","utils","baseview","modules/ugc/social-share-facebook","modules/stories/share-email"],function(e,t,i,s,n,a){"use strict";var o=s.extend({el:"#social-share-modal",events:{"click .social-share-modal-close-btn":"closeShareModal","click .social-share-modal-btn-facebook":"onClickFacebookBtn","click .social-share-modal-btn-email":"onClickEmailBtn"},initialize:function(t){t=e.extend({data:"",postLink:"",image:""},t),this.backdrop=e(".social-share-modal-background"),s.prototype.initialize.call(this,t),this._setupSocialShareModal()},_setupSocialShareModal:function(){this.setupTwitter(),this.setupGoogle(),this.setupLinkedIn(),this.subviews.socialShareFacebook||(this.subviews.socialShareFacebook=new n({data:this.options.data,link:this.options.postLink,image:this.options.image})),this.updateActiveButton("facebook")},setupTwitter:function(){var t=i.getNested(this.options.data,"post","title")||"",s="https://twitter.com/intent/tweet?url="+this.options.postLink+"&text="+t+"&via=yourtake";e(".social-share-modal-btn-twitter").attr("href",s)},setupGoogle:function(){var t="https://plus.google.com/share?url="+this.options.postLink;e(".social-share-modal-btn-google").attr("href",t)},setupLinkedIn:function(){var t="https://www.linkedin.com/shareArticle?mini=true&url="+this.options.postLink;e(".social-share-modal-btn-linkedin").attr("href",t)},openShareModal:function(){this.$el.fadeIn(300),this.subviews.socialShareFacebook&&(this.subviews.socialShareFacebook.hideConfirmationPane(),this.subviews.socialShareFacebook.showFacebookShareForm(),this.subviews.socialShareFacebook.show()),e(".js-share-email-form-container").hide(),this.updateActiveButton("facebook"),this.backdrop.addClass("show"),this.backdrop.css({"z-index":120,position:"fixed"})},closeShareModal:function(){this.$el.fadeOut(300),this.subviews.shareEmailView&&this.subviews.shareEmailView.hide()},onClickFacebookBtn:function(){this.subviews.socialShareFacebook?this.subviews.socialShareFacebook.hideConfirmationPane():this.subviews.socialShareFacebook=new n({data:this.options.data,link:this.options.postLink,image:this.options.image}),this.subviews.shareEmailView&&this.subviews.shareEmailView.hide(),this.updateActiveButton("facebook"),this.subviews.socialShareFacebook.showFacebookShareForm(),this.subviews.socialShareFacebook.show()},onClickEmailBtn:function(){this.subviews.shareEmailView||(this.subviews.shareEmailView=new a({uotrackName:"yourtakemail",el:"#modalEmailForm",postLink:this.options.postLink,message:i.getNested(this.options,"data","post","title")})),this.subviews.socialShareFacebook&&this.subviews.socialShareFacebook.hide(),this.updateActiveButton("email"),this.subviews.shareEmailView.showEmailForm(),this.subviews.shareEmailView.show()},updateActiveButton:function(t){e(".social-share-modal-icons").find(".active").removeClass("active"),e(".social-share-modal-btn-"+t).addClass("active")}});return o}),define("modules/money/market-summary",["jquery","underscore","baseview","state","pubsub"],function(e,t,i,s,n){"use strict";var a=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.interval="suspender"===e.layoutType?s.recurringFetchHtml("/services/markets/home-widget/",null,6e4,t.bind(function(e){this.$(".market-ss").html(e)},this)):s.recurringFetchHtml("/services/markets/default-quotes/",null,6e4,t.bind(function(e){this.$(".mmtdq").html(e)},this))},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";n.trigger("abtesttrack",t)}},destroy:function(){clearInterval(this.interval),i.prototype.destroy.apply(this,arguments)}});return a}),define("modules/money/market-summary-search",["jquery","underscore","baseview","state","pubsub","modules/money/market-summary","modules/money/market-symbol-search"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.subviews.stocks=new a({el:this.$(".mmtsi-wrap")}),this.subviews.marketsearch=new o({el:this.$(".markets-stock-search-wrap")})},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";n.trigger("abtesttrack",t)}}});return r}),define("modules/partner/slider-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adType:"slider",adPlacement:"slider",adSizes:[160,600]},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("modules/interactives/sequencer",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,s,n,a){var o=n.extend({events:function(){var e=Modernizr.touch?"touchstart":"click",t={"click .navigation li":"navInteraction"};return t[e+" .nav-hide"]="showHidePanel",t},initialize:function(e){n.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.subviews.template=new a({ads:t,el:this.$el,ignoreFirstNav:!0,interactiveType:"sequencer",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),this.subviews.video=[],this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$nav=this.subviews.template.$navigation,this.$navButton=this.$nav.find(".nav-hide-button"),this.$viewport=this.subviews.template.$viewport,this.setupSlides()},setupSlides:function(){if(this.$viewport.hasClass("slide-transition")){var e=this.$slides.eq(0).width()*this.$slides.length;this.$slideContainer.width(e)}else if(this.$viewport.hasClass("vslide-transition")){var t=this.$slides.eq(0).height()*this.$slides.length;this.$slideContainer.height(t)}},showHidePanel:function(){if(this.$navButton.length<1)return!1;var e=this.$nav.hasClass("show"),t=e?"showpanel":"hidepanel";this.animatePanel(e),this.options.isFramed!==!0&&this.subviews.template.trackClick("sequencer"+document.location.pathname+t)},navInteraction:function(){this.$(arguments[0].currentTarget).hasClass("nav-hide")||this.options.isFramed!==!0&&this.subviews.template.trackPageView()},animatePanel:function(e){e?(this.$nav.animate({width:"180px"},350),this.$nav.find(".sq-navigation-text-wrap").fadeIn()):(this.$nav.find(".sq-navigation-text-wrap").fadeOut(),this.$nav.animate({width:"48px"},350)),this.$nav.toggleClass("show")}});return o}),define("modules/live-video-sidebar/live-video-sidebar",["jquery","underscore","baseview","state","modules/global/livevideo"],function(e,t,i,s,n){"use strict";var a=i.extend({events:{"click .lvsm-link":"onClickLiveVideoLink"},initialize:function(e){this.liveVideosRailPoll=s.recurringFetchHtml("/videos/services/live-video-sidebar/",null,91e3,t.bind(function(e){this.$el.html(e)},this)),i.prototype.initialize.call(this,e)},destroy:function(){clearInterval(this.liveVideosRailPoll),i.prototype.destroy.apply(this,arguments)
},onClickLiveVideoLink:function(t){var i=e(t.currentTarget).data("video-id");i&&(this.subviews.live&&this.subviews.live.destroy(!0),this.subviews.live=new n,this.subviews.live.loadLiveVideo(i),t.preventDefault())}});return a}),define("modules/topics/topics-photo-gallery",["jquery","underscore","baseview","utils","pubsub","modules/scroller/horizontal-scroll","modules/scroller/vertical-scroll","site-manager","state","meteredAdPosition"],function(e,t,i,s,n,a,o,r,l,h){var d=i.extend({events:{"click .tpapgm-gallery-nav-next":"_onClickNext","click .tpapgm-gallery-nav-previous":"_onClickPrev","click .tpapgm-collage-link":"_onClickMosaic","click .tpapgm-gallery-slide-link":"_onClickSlide","click .tpapgm-gallery-nav-close":"_onClickClose","click .tpapgm-gallery-nav-fullscreen":"_onClickFullScreen","click .tpapgm-gallery-thumbs-item-link":"_onClickThumb"},selectors:{slides:".tpapgm-gallery-slide:not(.tpapgm-gallery-slide-partner-ad)",slideImage:".tpapgm-gallery-slide-image",thumb:".tpapgm-gallery-thumbs-item"},initialize:function(n){t.bindAll(this,"_handleKeyPress","_onClickThumb","refreshScrollbar"),n=e.extend({enableGalleryAds:!0,debounceSpeed:0,captionsEnabled:!0,thumbsLocation:"top",thumbWidth:80,thumbHeight:45},n),this.$doc=s.get("document"),this.$body=s.get("body"),this.$win=s.get("win"),this.$moduleWrap=this.$(".tpapgm-module-wrap"),this.$gallery=this.$(".tpapgm-gallery-wrap"),this.$collageWrap=this.$(".tpapgm-collage-wrap"),this.$slidesWrap=this.$(".tpapgm-gallery-slides-wrap"),this.$slidesItemsWrap=this.$(".tpapgm-gallery-slides-items-wrap"),this.$arrowNext=this.$(".tpapgm-gallery-nav-next"),this.$arrowPrev=this.$(".tpapgm-gallery-nav-previous"),this.$closeBtn=this.$(".tpapgm-gallery-nav-close"),this.$caption=this.$(".tpapgm-gallery-caption"),this.totalPhotos=this.$gallery.data("total-photos"),this.activeClass="tpapgm-gallery-slide-active",this.loadingClass="tpapgm-gallery-slide-loading",this.fullscreenClass="tpapgm-gallery-wrap-fullscreen",this.fetchingImages=!1,this.$thumbsWrap=this.$(".tpapgm-gallery-thumbs-wrap"),this.$thumbsList=this.$(".tpapgm-gallery-thumbs-list"),this.thumbTemplate=this.$(".tpapgm-thumb-template").html(),this.thumbActiveClass="tpapgm-gallery-thumbs-item-active",this.slidesCount=this.$(this.selectors.slides).length,this.activeIndex=1,this.adActiveClass="slide-partner-active",this.arrowDebounce=t.debounce(function(e){this.goToSlide(e)},n.debounceSpeed,!0),i.prototype.initialize.call(this,n),this._bindKeys(),n.enableGalleryAds&&this._initializeAds()},_initializeAds:function(){var e=l.getActivePageInfo();this.$adSlide=this.$(".tpapgm-gallery-slide-partner-ad"),this.$adContents=this.$(".tpapgm-gallery-slide-partner-ad .partner-placement"),this.showingAd=!1,this.subviews.ad=new h({el:this.$adContents,adPlacement:"transition_gallery",adSizes:["elastic"],meterThreshold:"transition_gallery",rateMeterId:"topic_"+e.topic})},shouldShowAd:function(){return!this.showingAd&&this.subviews.ad&&this.subviews.ad.shouldShowAd()},setAdDimensions:function(){this.subviews.ad.resizeAd(this.$adSlide.width(),this.$adSlide.height())},_updateSlidesCount:function(){return this.slidesCount=this.$(this.selectors.slides).length,this.slidesCount},_getActiveSlide:function(){return this.$(this.selectors.slides).eq(this.activeIndex)},_setActiveSlide:function(e){this.activeIndex=e;var t=this._getActiveSlide();return t.addClass(this.activeClass),t},openGallery:function(e){this._setActiveSlide(e),this._updateSlide(),this.lazyLoadPhotos(),this.$collageWrap.hide(),this.$gallery.show(),this._bindKeys(),this.loadThumbs(),this._trackSlideChange(),this.subviews.ad&&this.subviews.ad.setInitialDimensions(this.$adSlide.width(),this.$adSlide.height())},openFullScreen:function(){n.trigger("topicgallery:open"),this.$gallery.addClass(this.fullscreenClass),this.$body.css("overflow","hidden"),this.lazyLoadPhotos(),r.getHeader().setClosedFixed(!0),this.refreshScrollbar(),this.fetchImages(),this.$win.on("resize."+this.cid,t.throttle(this.refreshScrollbar,2e3,{leading:!1,trailing:!1})),this.subviews.ad&&this.setAdDimensions()},refreshScrollbar:function(){this.subviews.scrollbar.refresh()},lazyLoadPhotos:function(){var t=this._getActiveSlide(),i=t.find("img"),n=t.prevAll("*:lt(2)").find("img"),a=t.nextAll("*:lt(2)").find("img"),o=this._isFullScreen()?"data-src-large":"data-src",r=this.loadingClass;this.$(this.selectors.slides+"."+r).removeClass(r),i=i.add(n).add(a);var l=function(t){e(t).closest(".tpapgm-gallery-slide").removeClass(r)};s.lazyLoadImage(i,o,!0,null,l)&&i.each(function(t,i){e(i).closest(".tpapgm-gallery-slide").addClass(r)})},loadThumbs:function(){for(var e=this.$(this.selectors.slides),i=t.template(this.thumbTemplate),s=this.$thumbsWrap.data("pos"),n=this.$thumbsList.find(this.selectors.thumb).length,r=n;r<this.slidesCount;r++){var l=e.eq(r).find(this.selectors.slideImage),h=i({active:r==this.activeIndex?this.thumbActiveClass:"",thumbSrc:l.data("thumb-src"),alt:l.data("caption"),current:r+1,total:this.totalPhotos});this.$thumbsList.append(h)}this.subviews.scrollbar?this.refreshScrollbar():this.subviews.scrollbar="top"==s||"bottom"==s?new a({el:this.$thumbsWrap,color:"light",draggerPaddingLeft:4,draggerPaddingRight:4}):new o({el:this.$thumbsWrap,color:"light",draggerPaddingTop:10,draggerPaddingBottom:0}),this.subviews.scrollbar.scrollToElement(this.$("."+this.thumbActiveClass),!0,0,"linear")},closeGallery:function(){n.trigger("topicgallery:close"),this._isFullScreen()&&(this.$body.css("overflow","auto"),this.$gallery.removeClass(this.fullscreenClass),this.lazyLoadPhotos(),r.getHeader().restoreLastState(),this.refreshScrollbar(),this.$win.off("."+this.cid),this.subviews.ad&&this.setAdDimensions())},nextSlide:function(){this.activeIndex+1<this.slidesCount&&this.arrowDebounce(this.activeIndex+1)},previousSlide:function(){0!==this.activeIndex&&this.arrowDebounce(this.activeIndex-1)},goToSlide:function(e){var t=this.$(this.selectors.slides),i=this._getActiveSlide(),s=t.eq(e),n=this.shouldShowAd();this.showingAd?(this.subviews.ad.stopAd(),this.subviews.ad.refreshPosition(),this.showingAd=!1,this.$adSlide.hide(),this.$gallery.removeClass(this.adActiveClass)):(i.removeClass(this.activeClass),i.hide()),n?(this.showingAd=!0,this.subviews.ad.show(),this.subviews.ad.playAd(),this.$gallery.addClass(this.adActiveClass),this.$adSlide.show()):(s.show(),this._setActiveSlide(e),this._updateSlide(),this._selectThumb(this.activeIndex),this.lazyLoadPhotos(),this._trackSlideChange()),e>=t.length-10&&!this.fetchingImages&&this.fetchImages()},_selectThumb:function(e){var t=this.$thumbsList.find(this.selectors.thumb).eq(e);t.addClass(this.thumbActiveClass).siblings().removeClass(this.thumbActiveClass),this.subviews.scrollbar.scrollToElement(t,!0,400,"ease-out")},_updateArrows:function(){0===this.activeIndex?this.$arrowPrev.hide():this.$arrowPrev.show(),this.activeIndex<this.slidesCount-1?this.$arrowNext.show():this.$arrowNext.hide()},_updateCaption:function(){var e=this._getActiveSlide().find(this.selectors.slideImage),t=e.data("caption")+' <span class="tpapgm-gallery-captions-credit">'+e.data("credit")+"</span>";this.$caption.html(t)},_updateSlide:function(){this._updateArrows(),this.options.captionsEnabled&&this._updateCaption()},_trackSlideChange:function(){var e={gallery_id:l.getActivePageInfo().topic,gallery_title:this.$gallery.attr("data-title"),gallery_index:this.activeIndex,slide_id:this._getActiveSlide().find("img").attr("data-id"),ssts:this.$gallery.attr("data-ssts"),cst:this.$gallery.attr("data-cst"),contenttype:l.getActivePageInfo().contenttype+"-gallery",pathName:this.$gallery.attr("data-gallery-path")};n.trigger("slide:change",e),l.fetchData(window.site_static_path+"html/comscorepvcandidate.xml",{cache:!1},!1,!0,!1)},fetchImages:function(){this.fetchingImages=!0;var e=this.$(this.selectors.slides).last();if(e.attr("data-more-photos-path")){var i="/topic/ajax/photos/?path="+encodeURIComponent(e.data("more-photos-path"));l.fetchHtml(i).done(t.bind(function(t){t.appendTo(this.$slidesWrap),this._updateSlidesCount(),this._updateSlide(),this.loadThumbs(),e.removeAttr("data-more-photos-path"),this.fetchingImages=!1},this))}},_isFullScreen:function(){return this.$gallery.hasClass(this.fullscreenClass)},_onClickNext:function(){this.nextSlide()},_onClickPrev:function(){this.previousSlide()},_onClickSlide:function(t){return e(t.currentTarget).closest(".tpapgm-gallery-slide-partner-ad").length?!1:void this.nextSlide()},_onClickMosaic:function(t){this.openGallery(e(t.currentTarget).index())},_onClickClose:function(){this.closeGallery()},_onClickFullScreen:function(){this.openFullScreen()},_onClickThumb:function(t){this.arrowDebounce(e(t.currentTarget).closest(this.selectors.thumb).index())},_bindKeys:function(){this.$gallery.is(":visible")&&this.$doc.on("keydown."+this.cid,this._handleKeyPress)},_handleKeyPress:function(e){return 37===e.keyCode&&this.$arrowPrev.is(":visible")?(this.$arrowPrev.trigger("click"),!1):39===e.keyCode&&this.$arrowNext.is(":visible")?(this.$arrowNext.trigger("click"),!1):27===e.keyCode&&this._isFullScreen()?(this.$closeBtn.trigger("click"),!1):!0},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),i.prototype.destroy.apply(this,arguments)}});return d}),define("modules/sports/sports-team-matchup",["jquery","underscore","backbone","baseview","easing"],function(e,t,i,s){var n=s.extend({initialize:function(){s.prototype.initialize.call(this,this.options);var i=0,n=this.$(".sp-matchup-away-stat-chart-fill"),a=this.$(".sp-matchup-home-stat-chart-fill");n.each(t.bind(function(t,s){this.animBar(e(s),i),this.animBar(a.eq(t),i),i+=100},this))},animBar:function(e,t){e.delay(t).animate({width:e.data("percentage")},175,"easeInQuad")}});return n}),function(e,t){var i,s;typeof exports!=t+""?i=exports:(s=e.L,i={},i.noConflict=function(){return e.L=s,this},e.L=i),i.version="0.4.4",i.Util={extend:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),s=0,n=i.length;n>s;s++){t=i[s]||{};for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])}return e},bind:function(e,t){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,i||arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(i){return i[t]=i[t]||++e,i[t]}}(),limitExecByInterval:function(e,t,i){var s,n;return function a(){var o=arguments;return s?void(n=!0):(s=!0,setTimeout(function(){s=!1,n&&(a.apply(i,o),n=!1)},t),void e.apply(i,o))}},falseFn:function(){return!1},formatNum:function(e,t){var i=Math.pow(10,t||5);return Math.round(e*i)/i},splitWords:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},setOptions:function(e,t){return e.options=i.Util.extend({},e.options,t),e.options},getParamString:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);return"?"+t.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,i){var s=t[i];if(!t.hasOwnProperty(i))throw new Error("No value provided for variable "+e);return s})},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var i,s,n=["webkit","moz","o","ms"];for(i=0;i<n.length&&!s;i++)s=e[n[i]+t];return s}function s(t){return e.setTimeout(t,1e3/60)}var n=e.requestAnimationFrame||t("RequestAnimationFrame")||s,a=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};i.Util.requestAnimFrame=function(t,a,o,r){return t=i.Util.bind(t,a),o&&n===s?void t():n.call(e,t,r)},i.Util.cancelAnimFrame=function(t){t&&a.call(e,t)}}(),i.Class=function(){},i.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments)},s=function(){};s.prototype=this.prototype;var n=new s;n.constructor=t,t.prototype=n;for(var a in this)this.hasOwnProperty(a)&&"prototype"!==a&&(t[a]=this[a]);return e.statics&&(i.Util.extend(t,e.statics),delete e.statics),e.includes&&(i.Util.extend.apply(null,[n].concat(e.includes)),delete e.includes),e.options&&n.options&&(e.options=i.Util.extend({},n.options,e.options)),i.Util.extend(n,e),t},i.Class.include=function(e){i.Util.extend(this.prototype,e)},i.Class.mergeOptions=function(e){i.Util.extend(this.prototype.options,e)};var n="_leaflet_events";i.Mixin={},i.Mixin.Events={addEventListener:function(e,t,s){var a,o,r,l=this[n]=this[n]||{};if("object"==typeof e){for(a in e)e.hasOwnProperty(a)&&this.addEventListener(a,e[a],t);return this}for(e=i.Util.splitWords(e),o=0,r=e.length;r>o;o++)l[e[o]]=l[e[o]]||[],l[e[o]].push({action:t,context:s||this});return this},hasEventListeners:function(e){return n in this&&e in this[n]&&this[n][e].length>0},removeEventListener:function(e,t,s){var a,o,r,l,h,d=this[n];if("object"==typeof e){for(a in e)e.hasOwnProperty(a)&&this.removeEventListener(a,e[a],t);return this}for(e=i.Util.splitWords(e),o=0,r=e.length;r>o;o++)if(this.hasEventListeners(e[o]))for(l=d[e[o]],h=l.length-1;h>=0;h--)t&&l[h].action!==t||s&&l[h].context!==s||l.splice(h,1);return this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;for(var s=i.Util.extend({type:e,target:this},t),a=this[n][e].slice(),o=0,r=a.length;r>o;o++)a[o].action.call(a[o].context||this,s);return this}},i.Mixin.Events.on=i.Mixin.Events.addEventListener,i.Mixin.Events.off=i.Mixin.Events.removeEventListener,i.Mixin.Events.fire=i.Mixin.Events.fireEvent,function(){var s=navigator.userAgent.toLowerCase(),n=!!e.ActiveXObject,a=n&&!e.XMLHttpRequest,o=-1!==s.indexOf("webkit"),r=-1!==s.indexOf("gecko"),l=-1!==s.indexOf("chrome"),h=e.opera,d=-1!==s.indexOf("android"),c=-1!==s.search("android [23]"),u=typeof orientation!=t+""?!0:!1,p=document.documentElement,f=n&&"transition"in p.style,g=o&&"WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix,m=r&&"MozPerspective"in p.style,v=h&&"OTransition"in p.style,b=!e.L_NO_TOUCH&&function(){var e="ontouchstart";if(e in p)return!0;var t=document.createElement("div"),i=!1;return t.setAttribute?(t.setAttribute(e,"return;"),"function"==typeof t[e]&&(i=!0),t.removeAttribute(e),t=null,i):!1}(),y="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)").matches;i.Browser={ua:s,ie:n,ie6:a,webkit:o,gecko:r,opera:h,android:d,android23:c,chrome:l,ie3d:f,webkit3d:g,gecko3d:m,opera3d:v,any3d:!e.L_DISABLE_3D&&(f||g||m||v),mobile:u,mobileWebkit:u&&o,mobileWebkit3d:u&&g,mobileOpera:u&&h,touch:b,retina:y}}(),i.Point=function(e,t,i){this.x=i?Math.round(e):e,this.y=i?Math.round(t):t},i.Point.prototype={add:function(e){return this.clone()._add(i.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(i.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e,t){return new i.Point(this.x/e,this.y/e,t)},multiplyBy:function(e,t){return new i.Point(this.x*e,this.y*e,t)},distanceTo:function(e){e=i.point(e);var t=e.x-this.x,s=e.y-this.y;return Math.sqrt(t*t+s*s)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},clone:function(){return new i.Point(this.x,this.y)},toString:function(){return"Point("+i.Util.formatNum(this.x)+", "+i.Util.formatNum(this.y)+")"}},i.point=function(e,t,s){return e instanceof i.Point?e:e instanceof Array?new i.Point(e[0],e[1]):isNaN(e)?e:new i.Point(e,t,s)},i.Bounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(e){return e=i.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new i.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new i.Point(this.min.x,this.max.y)},getTopRight:function(){return new i.Point(this.max.x,this.min.y)},contains:function(e){var t,s;return e="number"==typeof e[0]||e instanceof i.Point?i.point(e):i.bounds(e),e instanceof i.Bounds?(t=e.min,s=e.max):t=s=e,t.x>=this.min.x&&s.x<=this.max.x&&t.y>=this.min.y&&s.y<=this.max.y},intersects:function(e){e=i.bounds(e);var t=this.min,s=this.max,n=e.min,a=e.max,o=a.x>=t.x&&n.x<=s.x,r=a.y>=t.y&&n.y<=s.y;return o&&r}}),i.bounds=function(e,t){return!e||e instanceof i.Bounds?e:new i.Bounds(e,t)},i.Transformation=i.Class.extend({initialize:function(e,t,i,s){this._a=e,this._b=t,this._c=i,this._d=s},transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new i.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}}),i.DomUtil={get:function(e){return"string"==typeof e?document.getElementById(e):e},getStyle:function(e,t){var i=e.style[t];if(!i&&e.currentStyle&&(i=e.currentStyle[t]),!i||"auto"===i){var s=document.defaultView.getComputedStyle(e,null);i=s?s[t]:null}return"auto"===i?null:i},getViewportOffset:function(e){var t=0,s=0,n=e,a=document.body;do{if(t+=n.offsetTop||0,s+=n.offsetLeft||0,n.offsetParent===a&&"absolute"===i.DomUtil.getStyle(n,"position"))break;if("fixed"===i.DomUtil.getStyle(n,"position")){t+=a.scrollTop||0,s+=a.scrollLeft||0;break}n=n.offsetParent}while(n);n=e;do{if(n===a)break;t-=n.scrollTop||0,s-=n.scrollLeft||0,n=n.parentNode}while(n);return new i.Point(s,t)},create:function(e,t,i){var s=document.createElement(e);return s.className=t,i&&i.appendChild(s),s},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=i.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(e,t){return e.className.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){i.DomUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){function i(e,i){return i===t?"":e}e.className=e.className.replace(/(\S+)\s*/g,i).replace(/(^\s+|\s+$)/,"")},setOpacity:function(e,t){"opacity"in e.style?e.style.opacity=t:i.Browser.ie&&(t=Math.round(100*t),e.style.filter="alpha(opacity="+t+")")},testProp:function(e){for(var t=document.documentElement.style,i=0;i<e.length;i++)if(e[i]in t)return e[i];return!1},getTranslateString:function(e){var t=i.Browser.webkit3d,s="translate"+(t?"3d":"")+"(",n=(t?",0":"")+")";return s+e.x+"px,"+e.y+"px"+n},getScaleString:function(e,t){var s=i.DomUtil.getTranslateString(t),n=" scale("+e+") ",a=i.DomUtil.getTranslateString(t.multiplyBy(-1));return s+n+a},setPosition:function(e,t,s){e._leaflet_pos=t,!s&&i.Browser.any3d?(e.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(t),i.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden")):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},i.Util.extend(i.DomUtil,{TRANSITION:i.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:i.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}),i.LatLng=function(e,t,i){var s=parseFloat(e),n=parseFloat(t);if(isNaN(s)||isNaN(n))throw new Error("Invalid LatLng object: ("+e+", "+t+")");i!==!0&&(s=Math.max(Math.min(s,90),-90),n=(n+180)%360+(-180>n||180===n?180:-180)),this.lat=s,this.lng=n},i.Util.extend(i.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),i.LatLng.prototype={equals:function(e){if(!e)return!1;e=i.latLng(e);var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=i.LatLng.MAX_MARGIN},toString:function(){return"LatLng("+i.Util.formatNum(this.lat)+", "+i.Util.formatNum(this.lng)+")"},distanceTo:function(e){e=i.latLng(e);var t=6378137,s=i.LatLng.DEG_TO_RAD,n=(e.lat-this.lat)*s,a=(e.lng-this.lng)*s,o=this.lat*s,r=e.lat*s,l=Math.sin(n/2),h=Math.sin(a/2),d=l*l+h*h*Math.cos(o)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}},i.latLng=function(e,t,s){return e instanceof i.LatLng?e:e instanceof Array?new i.LatLng(e[0],e[1]):isNaN(e)?e:new i.LatLng(e,t,s)},i.LatLngBounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(e){return e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e),e instanceof i.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):(this._southWest=new i.LatLng(e.lat,e.lng,!0),this._northEast=new i.LatLng(e.lat,e.lng,!0)):e instanceof i.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this},pad:function(e){var t=this._southWest,s=this._northEast,n=Math.abs(t.lat-s.lat)*e,a=Math.abs(t.lng-s.lng)*e;return new i.LatLngBounds(new i.LatLng(t.lat-n,t.lng-a),new i.LatLng(s.lat+n,s.lng+a))},getCenter:function(){return new i.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new i.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new i.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(e){e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e);var t,s,n=this._southWest,a=this._northEast;return e instanceof i.LatLngBounds?(t=e.getSouthWest(),s=e.getNorthEast()):t=s=e,t.lat>=n.lat&&s.lat<=a.lat&&t.lng>=n.lng&&s.lng<=a.lng},intersects:function(e){e=i.latLngBounds(e);var t=this._southWest,s=this._northEast,n=e.getSouthWest(),a=e.getNorthEast(),o=a.lat>=t.lat&&n.lat<=s.lat,r=a.lng>=t.lng&&n.lng<=s.lng;return o&&r},toBBoxString:function(){var e=this._southWest,t=this._northEast;return[e.lng,e.lat,t.lng,t.lat].join(",")},equals:function(e){return e?(e=i.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1}}),i.latLngBounds=function(e,t){return!e||e instanceof i.LatLngBounds?e:new i.LatLngBounds(e,t)},i.Projection={},i.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,e.lat),-s),a=e.lng*t,o=n*t;return o=Math.log(Math.tan(Math.PI/4+o/2)),new i.Point(a,o)},unproject:function(e){var t=i.LatLng.RAD_TO_DEG,s=e.x*t,n=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new i.LatLng(n,s,!0)}},i.Projection.LonLat={project:function(e){return new i.Point(e.lng,e.lat)},unproject:function(e){return new i.LatLng(e.y,e.x,!0)}},i.CRS={latLngToPoint:function(e,t){var i=this.projection.project(e),s=this.scale(t);return this.transformation._transform(i,s)},pointToLatLng:function(e,t){var i=this.scale(t),s=this.transformation.untransform(e,i);return this.projection.unproject(s)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)}},i.CRS.EPSG3857=i.Util.extend({},i.CRS,{code:"EPSG:3857",projection:i.Projection.SphericalMercator,transformation:new i.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),i=6378137;return t.multiplyBy(i)}}),i.CRS.EPSG900913=i.Util.extend({},i.CRS.EPSG3857,{code:"EPSG:900913"}),i.CRS.EPSG4326=i.Util.extend({},i.CRS,{code:"EPSG:4326",projection:i.Projection.LonLat,transformation:new i.Transformation(1/360,.5,-1/360,.5)}),i.Map=i.Class.extend({includes:i.Mixin.Events,options:{crs:i.CRS.EPSG3857,fadeAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23,trackResize:!0,markerZoomAnimation:i.DomUtil.TRANSITION&&i.Browser.any3d},initialize:function(e,s){s=i.Util.setOptions(this,s),this._initContainer(e),this._initLayout(),this._initHooks(),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.center&&s.zoom!==t&&this.setView(i.latLng(s.center),s.zoom,!0),this._initLayers(s.layers)},setView:function(e,t){return this._resetView(i.latLng(e),this._limitZoom(t)),this},setZoom:function(e){return this.setView(this.getCenter(),e)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(e){var t=this.getBoundsZoom(e);return this.setView(i.latLngBounds(e).getCenter(),t)},fitWorld:function(){var e=new i.LatLng(-60,-170),t=new i.LatLng(85,179);return this.fitBounds(new i.LatLngBounds(e,t))},panTo:function(e){return this.setView(e,this._zoom)},panBy:function(e){return this.fire("movestart"),this._rawPanBy(i.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){if(e=i.latLngBounds(e),this.options.maxBounds=e,!e)return this._boundsMinZoom=null,this;var t=this.getBoundsZoom(e,!0);return this._boundsMinZoom=t,this._loaded&&(this._zoom<t?this.setView(e.getCenter(),t):this.panInsideBounds(e)),this},panInsideBounds:function(e){e=i.latLngBounds(e);var t=this.getBounds(),s=this.project(t.getSouthWest()),n=this.project(t.getNorthEast()),a=this.project(e.getSouthWest()),o=this.project(e.getNorthEast()),r=0,l=0;return n.y<o.y&&(l=o.y-n.y),n.x>o.x&&(r=o.x-n.x),s.y>a.y&&(l=a.y-s.y),s.x<a.x&&(r=a.x-s.x),this.panBy(new i.Point(r,l,!0))},addLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return this;this._layers[t]=e,e.options&&!isNaN(e.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,e.options.maxZoom)),e.options&&!isNaN(e.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||1/0,e.options.minZoom)),this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this));var s=function(){e.onAdd(this),this.fire("layeradd",{layer:e})};return this._loaded?s.call(this):this.on("load",s,this),this},removeLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return e.onRemove(this),delete this._layers[t],this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this.fire("layerremove",{layer:e})},hasLayer:function(e){var t=i.Util.stamp(e);return this._layers.hasOwnProperty(t)},invalidateSize:function(e){var t=this.getSize();if(this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),!this._loaded)return this;var s=t.subtract(this.getSize()).divideBy(2,!0);return e===!0?this.panBy(s):(this._rawPanBy(s),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i.Util.bind(this.fire,this,"moveend"),200)),this},addHandler:function(e,t){return t?(this[e]=new t(this),this.options[e]&&this[e].enable(),this):void 0},getCenter:function(){return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),s=this.unproject(e.getTopRight());return new i.LatLngBounds(t,s)},getMinZoom:function(){var e=this.options.minZoom||0,t=this._layersMinZoom||0,i=this._boundsMinZoom||0;return Math.max(e,t,i)},getMaxZoom:function(){var e=this.options.maxZoom===t?1/0:this.options.maxZoom,i=this._layersMaxZoom===t?1/0:this._layersMaxZoom;return Math.min(e,i)},getBoundsZoom:function(e,t){e=i.latLngBounds(e);var s,n,a,o=this.getSize(),r=this.options.minZoom||0,l=this.getMaxZoom(),h=e.getNorthEast(),d=e.getSouthWest(),c=!0;t&&r--;do r++,n=this.project(h,r),a=this.project(d,r),s=new i.Point(Math.abs(n.x-a.x),Math.abs(a.y-n.y)),c=t?s.x<o.x||s.y<o.y:s.x<=o.x&&s.y<=o.y;while(c&&l>=r);return c&&t?null:t?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new i.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size},getPixelBounds:function(){var e=this._getTopLeftPoint();return new i.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,s){return s=s===t?this._zoom:s,this.options.crs.latLngToPoint(i.latLng(e),s)},unproject:function(e,s){return s=s===t?this._zoom:s,this.options.crs.pointToLatLng(i.point(e),s)},layerPointToLatLng:function(e){var t=i.point(e).add(this._initialTopLeftPoint);return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(i.latLng(e))._round();return t._subtract(this._initialTopLeftPoint)},containerPointToLayerPoint:function(e){return i.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return i.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(i.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(e)))},mouseEventToContainerPoint:function(e){return i.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=i.DomUtil.get(e);if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;e.innerHTML="",i.DomUtil.addClass(e,"leaflet-container"),i.Browser.touch&&i.DomUtil.addClass(e,"leaflet-touch"),this.options.fadeAnimation&&i.DomUtil.addClass(e,"leaflet-fade-anim");var t=i.DomUtil.getStyle(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(i.DomUtil.addClass(e.markerPane,t),i.DomUtil.addClass(e.shadowPane,t),i.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return i.DomUtil.create("div",e,t||this._objectsPane)},_initializers:[],_initHooks:function(){var e,t;for(e=0,t=this._initializers.length;t>e;e++)this._initializers[e].call(this)},_initLayers:function(e){e=e?e instanceof Array?e:[e]:[],this._layers={},this._tileLayersNum=0;var t,i;for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},_resetView:function(e,t,s,n){var a=this._zoom!==t;n||(this.fire("movestart"),a&&this.fire("zoomstart")),this._zoom=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),s?this._initialTopLeftPoint._add(this._getMapPanePos()):i.DomUtil.setPosition(this._mapPane,new i.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!s}),this.fire("move"),(a||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!s}),this._loaded||(this._loaded=!0,this.fire("load"))},_rawPanBy:function(e){i.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_initEvents:function(){if(i.DomEvent){i.DomEvent.on(this._container,"click",this._onMouseClick,this);var t,s,n=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(t=0,s=n.length;s>t;t++)i.DomEvent.on(this._container,n[t],this._fireMouseEvent,this);this.options.trackResize&&i.DomEvent.on(e,"resize",this._onResize,this)
}},_onResize:function(){i.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=i.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(e){!this._loaded||this.dragging&&this.dragging.moved()||(this.fire("preclick"),this._fireMouseEvent(e))},_fireMouseEvent:function(e){if(this._loaded){var t=e.type;if(t="mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,this.hasEventListeners(t)){"contextmenu"===t&&i.DomEvent.preventDefault(e);var s=this.mouseEventToContainerPoint(e),n=this.containerPointToLayerPoint(s),a=this.layerPointToLatLng(n);this.fire(t,{latlng:a,layerPoint:n,containerPoint:s,originalEvent:e})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(i.Util.bind(this._clearTileBg,this),500))},_getMapPanePos:function(){return i.DomUtil.getPosition(this._mapPane)},_getTopLeftPoint:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var i=this.getSize().divideBy(2);return this.project(e,t)._subtract(i)._round()},_latLngToNewLayerPoint:function(e,t,i){var s=this._getNewTopLeftPoint(i,t).add(this._getMapPanePos());return this.project(e,t)._subtract(s)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize().divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitZoom:function(e){var t=this.getMinZoom(),i=this.getMaxZoom();return Math.max(t,Math.min(i,e))}}),i.Map.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),i="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initializers.push(i)},i.map=function(e,t){return new i.Map(e,t)},i.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(e){var t=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,e.lat),-s),a=this.R_MAJOR,o=this.R_MINOR,r=e.lng*t*a,l=n*t,h=o/a,d=Math.sqrt(1-h*h),c=d*Math.sin(l);c=Math.pow((1-c)/(1+c),.5*d);var u=Math.tan(.5*(.5*Math.PI-l))/c;return l=-o*Math.log(u),new i.Point(r,l)},unproject:function(e){for(var t,s=i.LatLng.RAD_TO_DEG,n=this.R_MAJOR,a=this.R_MINOR,o=e.x*s/n,r=a/n,l=Math.sqrt(1-r*r),h=Math.exp(-e.y/a),d=Math.PI/2-2*Math.atan(h),c=15,u=1e-7,p=c,f=.1;Math.abs(f)>u&&--p>0;)t=l*Math.sin(d),f=Math.PI/2-2*Math.atan(h*Math.pow((1-t)/(1+t),.5*l))-d,d+=f;return new i.LatLng(d*s,o,!0)}},i.CRS.EPSG3395=i.Util.extend({},i.CRS,{code:"EPSG:3395",projection:i.Projection.Mercator,transformation:function(){var e=i.Projection.Mercator,t=e.R_MAJOR,s=e.R_MINOR;return new i.Transformation(.5/(Math.PI*t),.5,-.5/(Math.PI*s),.5)}()}),i.TileLayer=i.Class.extend({includes:i.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:i.Browser.mobile,updateWhenIdle:i.Browser.mobile},initialize:function(e,t){t=i.Util.setOptions(this,t),t.detectRetina&&i.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),this._url=e;var s=this.options.subdomains;"string"==typeof s&&(this.options.subdomains=s.split(""))},onAdd:function(e){this._map=e,this._initContainer(),this._createTileProto(),e.on({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||(this._limitedUpdate=i.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._panes.tilePane.removeChild(this._container),e.off({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._map._panes.tilePane.empty=!1,this._reset(!0),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==t&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){for(var i,s=e.getElementsByClassName("leaflet-layer"),n=-t(1/0,-1/0),a=0,o=s.length;o>a;a++)s[a]!==this._container&&(i=parseInt(s[a].style.zIndex,10),isNaN(i)||(n=t(n,i)));this._container.style.zIndex=isFinite(n)?n+t(1,-1):""},_updateOpacity:function(){i.DomUtil.setOpacity(this._container,this.options.opacity);var e,t=this._tiles;if(i.Browser.webkit)for(e in t)t.hasOwnProperty(e)&&(t[e].style.webkitTransform+=" translate(0,0)")},_initContainer:function(){var e=this._map._panes.tilePane;(!this._container||e.empty)&&(this._container=i.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity())},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){var t,i=this._tiles;for(t in i)i.hasOwnProperty(t)&&this.fire("tileunload",{tile:i[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),e&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(){if(!this._map._panTransition||!this._map._panTransition._inProgress){var e=this._map.getPixelBounds(),t=this._map.getZoom(),s=this.options.tileSize;if(!(t>this.options.maxZoom||t<this.options.minZoom)){var n=new i.Point(Math.floor(e.min.x/s),Math.floor(e.min.y/s)),a=new i.Point(Math.floor(e.max.x/s),Math.floor(e.max.y/s)),o=new i.Bounds(n,a);this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(e){var t,s,n,a=[],o=e.getCenter();for(t=e.min.y;t<=e.max.y;t++)for(s=e.min.x;s<=e.max.x;s++)n=new i.Point(s,t),this._tileShouldBeLoaded(n)&&a.push(n);var r=a.length;if(0!==r){a.sort(function(e,t){return e.distanceTo(o)-t.distanceTo(o)});var l=document.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=r,s=0;r>s;s++)this._addTile(a[s],l);this._container.appendChild(l)}},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;if(!this.options.continuousWorld){var t=this._getWrapTileNum();if(this.options.noWrap&&(e.x<0||e.x>=t)||e.y<0||e.y>=t)return!1}return!0},_removeOtherTiles:function(e){var t,i,s,n;for(n in this._tiles)this._tiles.hasOwnProperty(n)&&(t=n.split(":"),i=parseInt(t[0],10),s=parseInt(t[1],10),(i<e.min.x||i>e.max.x||s<e.min.y||s>e.max.y)&&this._removeTile(n))},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(i.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._container&&this._container.removeChild(t),i.Browser.android||(t.src=i.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var s=this._getTilePos(e),n=this._getTile();i.DomUtil.setPosition(n,s,i.Browser.chrome||i.Browser.android23),this._tiles[e.x+":"+e.y]=n,this._loadTile(n,e),n.parentNode!==this._container&&t.appendChild(n)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+e.zoomOffset},_getTilePos:function(e){var t=this._map.getPixelOrigin(),i=this.options.tileSize;return e.multiplyBy(i).subtract(t)},getTileUrl:function(e){return this._adjustTilePoint(e),i.Util.template(this._url,i.Util.extend({s:this._getSubdomain(e),z:this._getZoomForUrl(),x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(e){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(e.x=(e.x%t+t)%t),this.options.tms&&(e.y=t-e.y-1)},_getSubdomain:function(e){var t=(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_createTileProto:function(){var e=this._tileImg=i.DomUtil.create("img","leaflet-tile");e.galleryimg="no";var t=this.options.tileSize;e.style.width=t+"px",e.style.height=t+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(){},_createTile:function(){var e=this._tileImg.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,e.src=this.getTileUrl(t)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||this.fire("load")},_tileOnLoad:function(){var e=this._layer;this.src!==i.Util.emptyImageUrl&&(i.DomUtil.addClass(this,"leaflet-tile-loaded"),e.fire("tileload",{tile:this,url:this.src})),e._tileLoaded()},_tileOnError:function(){var e=this._layer;e.fire("tileerror",{tile:this,url:this.src});var t=e.options.errorTileUrl;t&&(this.src=t),e._tileLoaded()}}),i.tileLayer=function(e,t){return new i.TileLayer(e,t)},i.TileLayer.WMS=i.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var s=i.Util.extend({},this.defaultWmsParams);s.width=s.height=t.detectRetina&&i.Browser.retina?2*this.options.tileSize:this.options.tileSize;for(var n in t)this.options.hasOwnProperty(n)||(s[n]=t[n]);this.wmsParams=s,i.Util.setOptions(this,t)},onAdd:function(e){var t=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[t]=e.options.crs.code,i.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var s=this._map,n=s.options.crs,a=this.options.tileSize,o=e.multiplyBy(a),r=o.add(new i.Point(a,a)),l=n.project(s.unproject(o,t)),h=n.project(s.unproject(r,t)),d=[l.x,h.y,h.x,l.y].join(","),c=i.Util.template(this._url,{s:this._getSubdomain(e)});return c+i.Util.getParamString(this.wmsParams)+"&bbox="+d},setParams:function(e,t){return i.Util.extend(this.wmsParams,e),t||this.redraw(),this}}),i.tileLayer.wms=function(e,t){return new i.TileLayer.WMS(e,t)},i.TileLayer.Canvas=i.TileLayer.extend({options:{async:!1},initialize:function(e){i.Util.setOptions(this,e)},redraw:function(){var e,t=this._tiles;for(e in t)t.hasOwnProperty(e)&&this._redrawTile(t[e])},_redrawTile:function(e){this.drawTile(e,e._tilePoint,e._zoom)},_createTileProto:function(){var e=this._canvasProto=i.DomUtil.create("canvas","leaflet-tile"),t=this.options.tileSize;e.width=t,e.height=t},_createTile:function(){var e=this._canvasProto.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t,i){e._layer=this,e._tilePoint=t,e._zoom=i,this.drawTile(e,t,i),this.options.async||this.tileDrawn(e)},drawTile:function(){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),i.tileLayer.canvas=function(e){return new i.TileLayer.Canvas(e)},i.ImageOverlay=i.Class.extend({includes:i.Mixin.Events,options:{opacity:1},initialize:function(e,t,s){this._url=e,this._bounds=i.latLngBounds(t),i.Util.setOptions(this,s)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&i.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},_initImage:function(){this._image=i.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&i.Browser.any3d?i.DomUtil.addClass(this._image,"leaflet-zoom-animated"):i.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),i.Util.extend(this._image,{galleryimg:"no",onselectstart:i.Util.falseFn,onmousemove:i.Util.falseFn,onload:i.Util.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(e){var t=this._map,s=this._image,n=t.getZoomScale(e.zoom),a=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),r=t._latLngToNewLayerPoint(a,e.zoom,e.center),l=t._latLngToNewLayerPoint(o,e.zoom,e.center).subtract(r),h=t.latLngToLayerPoint(o).subtract(t.latLngToLayerPoint(a)),d=r.add(l.subtract(h).divideBy(2));s.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(d)+" scale("+n+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),s=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(t);i.DomUtil.setPosition(e,t),e.style.width=s.x+"px",e.style.height=s.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){i.DomUtil.setOpacity(this._image,this.options.opacity)}}),i.imageOverlay=function(e,t,s){return new i.ImageOverlay(e,t,s)},i.Icon=i.Class.extend({options:{className:""},initialize:function(e){i.Util.setOptions(this,e)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(e){var t=this._getIconUrl(e);if(!t){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(t);return this._setIconStyles(i,e),i},_setIconStyles:function(e,t){var s,n=this.options,a=i.point(n[t+"Size"]);s=i.point("shadow"===t?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!s&&a&&(s=a.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+n.className,s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px"),a&&(e.style.width=a.x+"px",e.style.height=a.y+"px")},_createImg:function(e){var t;return i.Browser.ie6?t=document.createElement("div"):(t=document.createElement("img"),t.src=e),t},_getIconUrl:function(e){return this.options[e+"Url"]}}),i.icon=function(e){return new i.Icon(e)},i.Icon.Default=i.Icon.extend({options:{iconSize:new i.Point(25,41),iconAnchor:new i.Point(13,41),popupAnchor:new i.Point(1,-34),shadowSize:new i.Point(41,41)},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];var s=i.Icon.Default.imagePath;if(!s)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return s+"/marker-"+e+".png"}}),i.Icon.Default.imagePath=function(){var e,t,i,s,n=document.getElementsByTagName("script"),a=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(e=0,t=n.length;t>e;e++)if(i=n[e].src,s=i.match(a))return i.split(a)[0]+"/images"}(),i.Marker=i.Class.extend({includes:i.Mixin.Events,options:{icon:new i.Icon.Default,title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1},initialize:function(e,t){i.Util.setOptions(this,t),this._latlng=i.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._removeIcon(),this.closePopup&&this.closePopup(),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){this._latlng=i.latLng(e),this.update(),this._popup&&this._popup.setLatLng(e)},setZIndexOffset:function(e){this.options.zIndexOffset=e,this.update()},setIcon:function(e){this._map&&this._removeIcon(),this.options.icon=e,this._map&&(this._initIcon(),this.update())},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}},_initIcon:function(){var e=this.options,t=this._map,s=t.options.zoomAnimation&&t.options.markerZoomAnimation,n=s?"leaflet-zoom-animated":"leaflet-zoom-hide",a=!1;this._icon||(this._icon=e.icon.createIcon(),e.title&&(this._icon.title=e.title),this._initInteraction(),a=this.options.opacity<1,i.DomUtil.addClass(this._icon,n)),this._shadow||(this._shadow=e.icon.createShadow(),this._shadow&&(i.DomUtil.addClass(this._shadow,n),a=this.options.opacity<1)),a&&this._updateOpacity();var o=this._map._panes;o.markerPane.appendChild(this._icon),this._shadow&&o.shadowPane.appendChild(this._shadow)},_removeIcon:function(){var e=this._map._panes;e.markerPane.removeChild(this._icon),this._shadow&&e.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_setPos:function(e){i.DomUtil.setPosition(this._icon,e),this._shadow&&i.DomUtil.setPosition(this._shadow,e),this._icon.style.zIndex=e.y+this.options.zIndexOffset},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPos(t)},_initInteraction:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout"];i.DomUtil.addClass(e,"leaflet-clickable"),i.DomEvent.on(e,"click",this._onMouseClick,this);for(var s=0;s<t.length;s++)i.DomEvent.on(e,t[s],this._fireMouseEvent,this);i.Handler.MarkerDrag&&(this.dragging=new i.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(e){i.DomEvent.stopPropagation(e),this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this.fire(e.type,{originalEvent:e})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e}),"mousedown"!==e.type&&i.DomEvent.stopPropagation(e)},setOpacity:function(e){this.options.opacity=e,this._map&&this._updateOpacity()},_updateOpacity:function(){i.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&i.DomUtil.setOpacity(this._shadow,this.options.opacity)}}),i.marker=function(e,t){return new i.Marker(e,t)},i.DivIcon=i.Icon.extend({options:{iconSize:new i.Point(12,12),className:"leaflet-div-icon"},createIcon:function(){var e=document.createElement("div"),t=this.options;return t.html&&(e.innerHTML=t.html),t.bgPos&&(e.style.backgroundPosition=-t.bgPos.x+"px "+-t.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),i.divIcon=function(e){return new i.DivIcon(e)},i.Map.mergeOptions({closePopupOnClick:!0}),i.Popup=i.Class.extend({includes:i.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:new i.Point(0,6),autoPanPadding:new i.Point(5,5),className:""},initialize:function(e,t){i.Util.setOptions(this,e),this._source=t},onAdd:function(e){this._map=e,this._container||this._initLayout(),this._updateContent();var t=e.options.fadeAnimation;t&&i.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on("viewreset",this._updatePosition,this),i.Browser.any3d&&e.on("zoomanim",this._zoomAnimation,this),e.options.closePopupOnClick&&e.on("preclick",this._close,this),this._update(),t&&i.DomUtil.setOpacity(this._container,1)},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),i.Util.falseFn(this._container.offsetWidth),e.off({viewreset:this._updatePosition,preclick:this._close,zoomanim:this._zoomAnimation},this),e.options.fadeAnimation&&i.DomUtil.setOpacity(this._container,0),this._map=null},setLatLng:function(e){return this._latlng=i.latLng(e),this._update(),this},setContent:function(e){return this._content=e,this._update(),this},_close:function(){var e=this._map;e&&(e._popup=null,e.removeLayer(this).fire("popupclose",{popup:this}))},_initLayout:function(){var e,t="leaflet-popup",s=this._container=i.DomUtil.create("div",t+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&(e=this._closeButton=i.DomUtil.create("a",t+"-close-button",s),e.href="#close",e.innerHTML="&#215;",i.DomEvent.on(e,"click",this._onCloseButtonClick,this));var n=this._wrapper=i.DomUtil.create("div",t+"-content-wrapper",s);i.DomEvent.disableClickPropagation(n),this._contentNode=i.DomUtil.create("div",t+"-content",n),i.DomEvent.on(this._contentNode,"mousewheel",i.DomEvent.stopPropagation),this._tipContainer=i.DomUtil.create("div",t+"-tip-container",s),this._tip=i.DomUtil.create("div",t+"-tip",this._tipContainer)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var s=e.offsetWidth;s=Math.min(s,this.options.maxWidth),s=Math.max(s,this.options.minWidth),t.width=s+1+"px",t.whiteSpace="",t.height="";var n=e.offsetHeight,a=this.options.maxHeight,o="leaflet-popup-scrolled";a&&n>a?(t.height=a+"px",i.DomUtil.addClass(e,o)):i.DomUtil.removeClass(e,o),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng),t=i.Browser.any3d,s=this.options.offset;t&&i.DomUtil.setPosition(this._container,e),this._containerBottom=-s.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+s.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);i.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var e=this._map,t=this._container.offsetHeight,s=this._containerWidth,n=new i.Point(this._containerLeft,-t-this._containerBottom);i.Browser.any3d&&n._add(i.DomUtil.getPosition(this._container));var a=e.layerPointToContainerPoint(n),o=this.options.autoPanPadding,r=e.getSize(),l=0,h=0;a.x<0&&(l=a.x-o.x),a.x+s>r.x&&(l=a.x+s-r.x+o.x),a.y<0&&(h=a.y-o.y),a.y+t>r.y&&(h=a.y+t-r.y+o.y),(l||h)&&e.panBy(new i.Point(l,h))}},_onCloseButtonClick:function(e){this._close(),i.DomEvent.stop(e)}}),i.popup=function(e,t){return new i.Popup(e,t)},i.Marker.include({openPopup:function(){return this._popup&&this._map&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(e,t){var s=i.point(this.options.icon.options.popupAnchor)||new i.Point(0,0);return s=s.add(i.Popup.prototype.options.offset),t&&t.offset&&(s=s.add(t.offset)),t=i.Util.extend({offset:s},t),this._popup||this.on("click",this.openPopup,this),this._popup=new i.Popup(t,this).setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),i.Map.include({openPopup:function(e){return this.closePopup(),this._popup=e,this.addLayer(e).fire("popupopen",{popup:this._popup})},closePopup:function(){return this._popup&&this._popup._close(),this}}),i.LayerGroup=i.Class.extend({initialize:function(e){this._layers={};var t,i;if(e)for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},addLayer:function(e){var t=i.Util.stamp(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._map&&this._map.removeLayer(e),this},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t,i,s=Array.prototype.slice.call(arguments,1);for(t in this._layers)this._layers.hasOwnProperty(t)&&(i=this._layers[t],i[e]&&i[e].apply(i,s));return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var i in this._layers)this._layers.hasOwnProperty(i)&&e.call(t,this._layers[i])}}),i.layerGroup=function(e){return new i.LayerGroup(e)},i.FeatureGroup=i.LayerGroup.extend({includes:i.Mixin.Events,addLayer:function(e){return this._layers[i.Util.stamp(e)]?this:(e.on("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent),this)},removeLayer:function(e){return e.off("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent?this.invoke("unbindPopup"):this},bindPopup:function(e){return this._popupContent=e,this.invoke("bindPopup",e)},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new i.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof i.Marker?t.getLatLng():t.getBounds())},this),e},_propagateEvent:function(e){e.layer=e.target,e.target=this,this.fire(e.type,e)}}),i.featureGroup=function(e){return new i.FeatureGroup(e)},i.Path=i.Class.extend({includes:[i.Mixin.Events],statics:{CLIP_PADDING:i.Browser.mobile?Math.max(0,Math.min(.5,(1280/Math.max(e.innerWidth,e.innerHeight)-1)/2)):.5},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){i.Util.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this._map=null,i.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return i.Util.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),i.Map.include({_updatePathViewport:function(){var e=i.Path.CLIP_PADDING,t=this.getSize(),s=i.DomUtil.getPosition(this._mapPane),n=s.multiplyBy(-1)._subtract(t.multiplyBy(e)),a=n.add(t.multiplyBy(1+2*e));this._pathViewport=new i.Bounds(n,a)}}),i.Path.SVG_NS="http://www.w3.org/2000/svg",i.Browser.svg=!(!document.createElementNS||!document.createElementNS(i.Path.SVG_NS,"svg").createSVGRect),i.Path=i.Path.extend({statics:{SVG:i.Browser.svg},bringToFront:function(){return this._container&&this._map._pathRoot.appendChild(this._container),this},bringToBack:function(){if(this._container){var e=this._map._pathRoot;e.insertBefore(this._container,e.firstChild)}return this},getPathString:function(){},_createElement:function(e){return document.createElementNS(i.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){(i.Browser.svg||!i.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),i.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],t=0;t<e.length;t++)i.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){this._map.dragging&&this._map.dragging.moved()||(this._fireMouseEvent(e),i.DomEvent.stopPropagation(e))},_fireMouseEvent:function(e){if(this.hasEventListeners(e.type)){"contextmenu"===e.type&&i.DomEvent.preventDefault(e);var t=this._map,s=t.mouseEventToContainerPoint(e),n=t.containerPointToLayerPoint(s),a=t.layerPointToLatLng(n);this.fire(e.type,{latlng:a,layerPoint:n,containerPoint:s,originalEvent:e})}}}),i.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=i.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&i.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),s=this._getCenterOffset(e.center).divideBy(1-1/t),n=this.containerPointToLayerPoint(this.getSize().multiplyBy(-i.Path.CLIP_PADDING)),a=n.add(s).round();this._pathRoot.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(a.multiplyBy(-1).add(i.DomUtil.getPosition(this._pathRoot)).multiplyBy(t).add(a))+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,s=e.max,n=s.x-t.x,a=s.y-t.y,o=this._pathRoot,r=this._panes.overlayPane;i.Browser.mobileWebkit&&r.removeChild(o),i.DomUtil.setPosition(o,t),o.setAttribute("width",n),o.setAttribute("height",a),o.setAttribute("viewBox",[t.x,t.y,n,a].join(" ")),i.Browser.mobileWebkit&&r.appendChild(o)}}}),i.Path.include({bindPopup:function(e,t){return this._popup&&this._popup.options===t||(this._popup=new i.Popup(t,this)),this._popup.setContent(e),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),i.Browser.vml=function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(i){return!1}}(),i.Path=i.Browser.svg||!i.Browser.vml?i.Path:i.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");i.DomUtil.addClass(e,"leaflet-vml-shape"),this.options.clickable&&i.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)
},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,i=this.options,s=this._container;s.stroked=i.stroke,s.filled=i.fill,i.stroke?(e||(e=this._stroke=this._createElement("stroke"),e.endcap="round",s.appendChild(e)),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,e.dashStyle=i.dashArray?i.dashArray.replace(/ *, */g," "):""):e&&(s.removeChild(e),this._stroke=null),i.fill?(t||(t=this._fill=this._createElement("fill"),s.appendChild(t)),t.color=i.fillColor||i.color,t.opacity=i.fillOpacity):t&&(s.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),i.Map.include(i.Browser.svg||!i.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var e=this._pathRoot=document.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),i.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),i.Path=i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?i.Path:i.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return i.Util.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&(i.Util.cancelAnimFrame(this._fireMapMoveEnd),this._updateRequest=i.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color)},_drawPath:function(){var e,t,s,n,a,o;for(this._ctx.beginPath(),e=0,s=this._parts.length;s>e;e++){for(t=0,n=this._parts[e].length;n>t;t++)a=this._parts[e][t],o=(0===t?"move":"line")+"To",this._ctx[o](a.x,a.y);this instanceof i.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(t.fillOpacity<1&&(e.globalAlpha=t.fillOpacity),e.fill()),t.stroke&&(t.opacity<1&&(e.globalAlpha=t.opacity),e.stroke()),e.restore()}},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)}}),i.Map.include(i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?{}:{_initPathRoot:function(){var e,t=this._pathRoot;t||(t=this._pathRoot=document.createElement("canvas"),t.style.position="absolute",e=this._canvasCtx=t.getContext("2d"),e.lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(t),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,s=e.max.subtract(t),n=this._pathRoot;i.DomUtil.setPosition(n,t),n.width=s.x,n.height=s.y,n.getContext("2d").translate(-t.x,-t.y)}}}),i.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var i=t*t;return e=this._reducePoints(e,i),e=this._simplifyDP(e,i)},pointToSegmentDistance:function(e,t,i){return Math.sqrt(this._sqClosestPointOnSegment(e,t,i,!0))},closestPointOnSegment:function(e,t,i){return this._sqClosestPointOnSegment(e,t,i)},_simplifyDP:function(e,i){var s=e.length,n=typeof Uint8Array!=t+""?Uint8Array:Array,a=new n(s);a[0]=a[s-1]=1,this._simplifyDPStep(e,a,i,0,s-1);var o,r=[];for(o=0;s>o;o++)a[o]&&r.push(e[o]);return r},_simplifyDPStep:function(e,t,i,s,n){var a,o,r,l=0;for(o=s+1;n-1>=o;o++)r=this._sqClosestPointOnSegment(e[o],e[s],e[n],!0),r>l&&(a=o,l=r);l>i&&(t[a]=1,this._simplifyDPStep(e,t,i,s,a),this._simplifyDPStep(e,t,i,a,n))},_reducePoints:function(e,t){for(var i=[e[0]],s=1,n=0,a=e.length;a>s;s++)this._sqDist(e[s],e[n])>t&&(i.push(e[s]),n=s);return a-1>n&&i.push(e[a-1]),i},clipSegment:function(e,t,i,s){var n=(i.min,i.max,s?this._lastCode:this._getBitCode(e,i)),a=this._getBitCode(t,i);for(this._lastCode=a;;){if(!(n|a))return[e,t];if(n&a)return!1;var o=n||a,r=this._getEdgeIntersection(e,t,o,i),l=this._getBitCode(r,i);o===n?(e=r,n=l):(t=r,a=l)}},_getEdgeIntersection:function(e,t,s,n){var a=t.x-e.x,o=t.y-e.y,r=n.min,l=n.max;return 8&s?new i.Point(e.x+a*(l.y-e.y)/o,l.y):4&s?new i.Point(e.x+a*(r.y-e.y)/o,r.y):2&s?new i.Point(l.x,e.y+o*(l.x-e.x)/a):1&s?new i.Point(r.x,e.y+o*(r.x-e.x)/a):void 0},_getBitCode:function(e,t){var i=0;return e.x<t.min.x?i|=1:e.x>t.max.x&&(i|=2),e.y<t.min.y?i|=4:e.y>t.max.y&&(i|=8),i},_sqDist:function(e,t){var i=t.x-e.x,s=t.y-e.y;return i*i+s*s},_sqClosestPointOnSegment:function(e,t,s,n){var a,o=t.x,r=t.y,l=s.x-o,h=s.y-r,d=l*l+h*h;return d>0&&(a=((e.x-o)*l+(e.y-r)*h)/d,a>1?(o=s.x,r=s.y):a>0&&(o+=l*a,r+=h*a)),l=e.x-o,h=e.y-r,n?l*l+h*h:new i.Point(o,r)}},i.Polyline=i.Path.extend({initialize:function(e,t){i.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e),i.Handler.PolyEdit&&(this.editing=new i.Handler.PolyEdit(this),this.options.editable&&this.editing.enable())},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;t>e;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,i="";t>e;e++)i+=this._getPathPartStr(this._parts[e]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(i.latLng(e)),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs),this.redraw(),e},closestLayerPoint:function(e){for(var t,s,n=1/0,a=this._parts,o=null,r=0,l=a.length;l>r;r++)for(var h=a[r],d=1,c=h.length;c>d;d++){t=h[d-1],s=h[d];var u=i.LineUtil._sqClosestPointOnSegment(e,t,s,!0);n>u&&(n=u,o=i.LineUtil._sqClosestPointOnSegment(e,t,s))}return o&&(o.distance=Math.sqrt(n)),o},getBounds:function(){for(var e=new i.LatLngBounds,t=this.getLatLngs(),s=0,n=t.length;n>s;s++)e.extend(t[s]);return e},onAdd:function(e){i.Path.prototype.onAdd.call(this,e),this.editing&&this.editing.enabled()&&this.editing.addHooks()},onRemove:function(e){this.editing&&this.editing.enabled()&&this.editing.removeHooks(),i.Path.prototype.onRemove.call(this,e)},_convertLatLngs:function(e){var t,s;for(t=0,s=e.length;s>t;t++){if(e[t]instanceof Array&&"number"!=typeof e[t][0])return;e[t]=i.latLng(e[t])}return e},_initEvents:function(){i.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){for(var t,s=i.Path.VML,n=0,a=e.length,o="";a>n;n++)t=e[n],s&&t._round(),o+=(n?"L":"M")+t.x+" "+t.y;return o},_clipPoints:function(){var e,t,s,n=this._originalPoints,a=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var o=this._parts,r=this._map._pathViewport,l=i.LineUtil;for(e=0,t=0;a-1>e;e++)s=l.clipSegment(n[e],n[e+1],r,e),s&&(o[t]=o[t]||[],o[t].push(s[0]),(s[1]!==n[e+1]||e===a-2)&&(o[t].push(s[1]),t++))},_simplifyPoints:function(){for(var e=this._parts,t=i.LineUtil,s=0,n=e.length;n>s;s++)e[s]=t.simplify(e[s],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),i.Path.prototype._updatePath.call(this))}}),i.polyline=function(e,t){return new i.Polyline(e,t)},i.PolyUtil={},i.PolyUtil.clipPolygon=function(e,t){var s,n,a,o,r,l,h,d,c,u=(t.min,t.max,[1,4,2,8]),p=i.LineUtil;for(n=0,h=e.length;h>n;n++)e[n]._code=p._getBitCode(e[n],t);for(o=0;4>o;o++){for(d=u[o],s=[],n=0,h=e.length,a=h-1;h>n;a=n++)r=e[n],l=e[a],r._code&d?l._code&d||(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),s.push(c)):(l._code&d&&(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),s.push(c)),s.push(r));e=s}return e},i.Polygon=i.Polyline.extend({options:{fill:!0},initialize:function(e,t){i.Polyline.prototype.initialize.call(this,e,t),e&&e[0]instanceof Array&&"number"!=typeof e[0][0]&&(this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1))},projectLatlngs:function(){if(i.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(var e=0,t=this._holes.length;t>e;e++){this._holePoints[e]=[];for(var s=0,n=this._holes[e].length;n>s;s++)this._holePoints[e][s]=this._map.latLngToLayerPoint(this._holes[e][s])}},_clipPoints:function(){var e=this._originalPoints,t=[];if(this._parts=[e].concat(this._holePoints),!this.options.noClip){for(var s=0,n=this._parts.length;n>s;s++){var a=i.PolyUtil.clipPolygon(this._parts[s],this._map._pathViewport);a.length&&t.push(a)}this._parts=t}},_getPathPartStr:function(e){var t=i.Polyline.prototype._getPathPartStr.call(this,e);return t+(i.Browser.svg?"z":"x")}}),i.polygon=function(e,t){return new i.Polygon(e,t)},function(){function e(e){return i.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var i=0,s=t.length;for(this.eachLayer(function(e){s>i?e.setLatLngs(t[i++]):this.removeLayer(e)},this);s>i;)this.addLayer(new e(t[i++],this._options));return this}})}i.MultiPolyline=e(i.Polyline),i.MultiPolygon=e(i.Polygon),i.multiPolyline=function(e,t){return new i.MultiPolyline(e,t)},i.multiPolygon=function(e,t){return new i.MultiPolygon(e,t)}}(),i.Rectangle=i.Polygon.extend({initialize:function(e,t){i.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=i.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]}}),i.rectangle=function(e,t){return new i.Rectangle(e,t)},i.Circle=i.Path.extend({initialize:function(e,t,s){i.Path.prototype.initialize.call(this,s),this._latlng=i.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=i.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=new i.LatLng(this._latlng.lat,this._latlng.lng-e,!0),s=this._map.latLngToLayerPoint(t);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.max(Math.round(this._point.x-s.x),1)},getBounds:function(){var e=this._map,t=this._radius*Math.cos(Math.PI/4),s=e.project(this._latlng),n=new i.Point(s.x-t,s.y+t),a=new i.Point(s.x+t,s.y-t),o=e.unproject(n),r=e.unproject(a);return new i.LatLngBounds(o,r)},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":i.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,23592600")},getRadius:function(){return this._mRadius},_getLngRadius:function(){var e=40075017,t=e*Math.cos(i.LatLng.DEG_TO_RAD*this._latlng.lat);return this._mRadius/t*360},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,i=this._point;return i.x-t>e.max.x||i.y-t>e.max.y||i.x+t<e.min.x||i.y+t<e.min.y}}),i.circle=function(e,t,s){return new i.Circle(e,t,s)},i.CircleMarker=i.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){i.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(e){return this._radius=e,this.redraw()}}),i.circleMarker=function(e,t){return new i.CircleMarker(e,t)},i.Polyline.include(i.Path.CANVAS?{_containsPoint:function(e,t){var s,n,a,o,r,l,h,d=this.options.weight/2;for(i.Browser.touch&&(d+=10),s=0,o=this._parts.length;o>s;s++)for(h=this._parts[s],n=0,r=h.length,a=r-1;r>n;a=n++)if((t||0!==n)&&(l=i.LineUtil.pointToSegmentDistance(e,h[a],h[n]),d>=l))return!0;return!1}}:{}),i.Polygon.include(i.Path.CANVAS?{_containsPoint:function(e){var t,s,n,a,o,r,l,h,d=!1;if(i.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(a=0,l=this._parts.length;l>a;a++)for(t=this._parts[a],o=0,h=t.length,r=h-1;h>o;r=o++)s=t[o],n=t[r],s.y>e.y!=n.y>e.y&&e.x<(n.x-s.x)*(e.y-s.y)/(n.y-s.y)+s.x&&(d=!d);return d}}:{}),i.Circle.include(i.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(e){var t=this._point,i=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+i}}:{}),i.GeoJSON=i.FeatureGroup.extend({initialize:function(e,t){i.Util.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,s,n=e instanceof Array?e:e.features;if(n){for(t=0,s=n.length;s>t;t++)this.addData(n[t]);return this}var a=this.options;if(!a.filter||a.filter(e)){var o=i.GeoJSON.geometryToLayer(e,a.pointToLayer);return o.feature=e,this.resetStyle(o),a.onEachFeature&&a.onEachFeature(e,o),this.addLayer(o)}},resetStyle:function(e){var t=this.options.style;t&&this._setLayerStyle(e,t)},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){"function"==typeof t&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),i.Util.extend(i.GeoJSON,{geometryToLayer:function(e,t){var s,n,a,o,r,l="Feature"===e.type?e.geometry:e,h=l.coordinates,d=[];switch(l.type){case"Point":return s=this.coordsToLatLng(h),t?t(e,s):new i.Marker(s);case"MultiPoint":for(a=0,o=h.length;o>a;a++)s=this.coordsToLatLng(h[a]),r=t?t(e,s):new i.Marker(s),d.push(r);return new i.FeatureGroup(d);case"LineString":return n=this.coordsToLatLngs(h),new i.Polyline(n);case"Polygon":return n=this.coordsToLatLngs(h,1),new i.Polygon(n);case"MultiLineString":return n=this.coordsToLatLngs(h,1),new i.MultiPolyline(n);case"MultiPolygon":return n=this.coordsToLatLngs(h,2),new i.MultiPolygon(n);case"GeometryCollection":for(a=0,o=l.geometries.length;o>a;a++)r=this.geometryToLayer(l.geometries[a],t),d.push(r);return new i.FeatureGroup(d);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e,t){var s=parseFloat(e[t?0:1]),n=parseFloat(e[t?1:0]);return new i.LatLng(s,n,!0)},coordsToLatLngs:function(e,t,i){var s,n,a,o=[];for(n=0,a=e.length;a>n;n++)s=t?this.coordsToLatLngs(e[n],t-1,i):this.coordsToLatLng(e[n],i),o.push(s);return o}}),i.geoJson=function(e,t){return new i.GeoJSON(e,t)},i.DomEvent={addListener:function(e,t,s,n){var a,o,r,l=i.Util.stamp(s),h="_leaflet_"+t+l;return e[h]?this:(a=function(t){return s.call(n||e,t||i.DomEvent._getEvent())},i.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener?this.addDoubleTapListener(e,a,l):("addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",a,!1),e.addEventListener(t,a,!1)):"mouseenter"===t||"mouseleave"===t?(o=a,r="mouseenter"===t?"mouseover":"mouseout",a=function(t){return i.DomEvent._checkMouse(e,t)?o(t):void 0},e.addEventListener(r,a,!1)):e.addEventListener(t,a,!1):"attachEvent"in e&&e.attachEvent("on"+t,a),e[h]=a,this))},removeListener:function(e,t,s){var n=i.Util.stamp(s),a="_leaflet_"+t+n,o=e[a];if(o)return i.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,n):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",o,!1),e.removeEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",o,!1):e.removeEventListener(t,o,!1):"detachEvent"in e&&e.detachEvent("on"+t,o),e[a]=null,this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this},disableClickPropagation:function(e){var t=i.DomEvent.stopPropagation;return i.DomEvent.addListener(e,i.Draggable.START,t).addListener(e,"click",t).addListener(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return i.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){var s=document.body,n=document.documentElement,a=e.pageX?e.pageX:e.clientX+s.scrollLeft+n.scrollLeft,o=e.pageY?e.pageY:e.clientY+s.scrollTop+n.scrollTop,r=new i.Point(a,o);return t?r._subtract(i.DomUtil.getViewportOffset(t)):r},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_checkMouse:function(e,t){var i=t.relatedTarget;if(!i)return!0;try{for(;i&&i!==e;)i=i.parentNode}catch(s){return!1}return i!==e},_getEvent:function(){var t=e.event;if(!t)for(var i=arguments.callee.caller;i&&(t=i.arguments[0],!t||e.Event!==t.constructor);)i=i.caller;return t}},i.DomEvent.on=i.DomEvent.addListener,i.DomEvent.off=i.DomEvent.removeListener,i.Draggable=i.Class.extend({includes:i.Mixin.Events,statics:{START:i.Browser.touch?"touchstart":"mousedown",END:i.Browser.touch?"touchend":"mouseup",MOVE:i.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){this._enabled||(i.DomEvent.on(this._dragStartTarget,i.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(i.DomEvent.off(this._dragStartTarget,i.Draggable.START,this._onDown),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(!(!i.Browser.touch&&e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)){if(this._simulateClick=!0,e.touches&&e.touches.length>1)return void(this._simulateClick=!1);var t=e.touches&&1===e.touches.length?e.touches[0]:e,s=t.target;i.DomEvent.preventDefault(e),i.Browser.touch&&"a"===s.tagName.toLowerCase()&&i.DomUtil.addClass(s,"leaflet-active"),this._moved=!1,this._moving||(this._startPos=this._newPos=i.DomUtil.getPosition(this._element),this._startPoint=new i.Point(t.clientX,t.clientY),i.DomEvent.on(document,i.Draggable.MOVE,this._onMove,this),i.DomEvent.on(document,i.Draggable.END,this._onUp,this))}},_onMove:function(e){if(!(e.touches&&e.touches.length>1)){var t=e.touches&&1===e.touches.length?e.touches[0]:e,s=new i.Point(t.clientX,t.clientY),n=s.subtract(this._startPoint);(n.x||n.y)&&(i.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,i.Browser.touch||(i.DomUtil.disableTextSelection(),this._setMovingCursor())),this._newPos=this._startPos.add(n),this._moving=!0,i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))}},_updatePosition:function(){this.fire("predrag"),i.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(e){if(this._simulateClick&&e.changedTouches){var t=e.changedTouches[0],s=t.target,n=this._newPos&&this._newPos.distanceTo(this._startPos)||0;"a"===s.tagName.toLowerCase()&&i.DomUtil.removeClass(s,"leaflet-active"),n<i.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",t)}i.Browser.touch||(i.DomUtil.enableTextSelection(),this._restoreCursor()),i.DomEvent.off(document,i.Draggable.MOVE,this._onMove),i.DomEvent.off(document,i.Draggable.END,this._onUp),this._moved&&(i.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1},_setMovingCursor:function(){i.DomUtil.addClass(document.body,"leaflet-dragging")},_restoreCursor:function(){i.DomUtil.removeClass(document.body,"leaflet-dragging")},_simulateEvent:function(t,i){var s=document.createEvent("MouseEvents");s.initMouseEvent(t,!0,!0,e,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(s)}}),i.Handler=i.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),i.Map.mergeOptions({dragging:!0,inertia:!i.Browser.android23,inertiaDeceleration:3e3,inertiaMaxSpeed:1500,inertiaThreshold:i.Browser.touch?32:14,worldCopyJump:!0}),i.Map.Drag=i.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new i.Draggable(this._map._mapPane,this._map._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);var e=this._map.options;e.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e.fire("movestart").fire("dragstart"),e._panTransition&&e._panTransition._onTransitionEnd(!0),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint(new i.LatLng(0,0));this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project(new i.LatLng(0,180)).x},_onPreDrag:function(){var e=(this._map,this._worldWidth),t=Math.round(e/2),i=this._initialWorldOffset,s=this._draggable._newPos.x,n=(s-t+i)%e+t-i,a=(s+t+i)%e-t-i,o=Math.abs(n+i)<Math.abs(a+i)?n:a;this._draggable._newPos.x=o},_onDragEnd:function(){var e=this._map,s=e.options,n=+new Date-this._lastTime,a=!s.inertia||n>s.inertiaThreshold||this._positions[0]===t;if(a)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+n-this._times[0])/1e3,l=o.multiplyBy(.58/r),h=l.distanceTo(new i.Point(0,0)),d=Math.min(s.inertiaMaxSpeed,h),c=l.multiplyBy(d/h),u=d/s.inertiaDeceleration,p=c.multiplyBy(-u/2).round(),f={duration:u,easing:"ease-out"};i.Util.requestAnimFrame(i.Util.bind(function(){this._map.panBy(p,f)},this))}e.fire("dragend"),s.maxBounds&&i.Util.requestAnimFrame(this._panInsideMaxBounds,e,!0,e._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),i.Map.addInitHook("addHandler","dragging",i.Map.Drag),i.Map.mergeOptions({doubleClickZoom:!0}),i.Map.DoubleClickZoom=i.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(e){this.setView(e.latlng,this._zoom+1)}}),i.Map.addInitHook("addHandler","doubleClickZoom",i.Map.DoubleClickZoom),i.Map.mergeOptions({scrollWheelZoom:!i.Browser.touch}),i.Map.ScrollWheelZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){i.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(e){var t=i.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),clearTimeout(this._timer),this._timer=setTimeout(i.Util.bind(this._performZoom,this),40),i.DomEvent.preventDefault(e)},_performZoom:function(){var e=this._map,t=Math.round(this._delta),i=e.getZoom();if(t=Math.max(Math.min(t,4),-4),t=e._limitZoom(i+t)-i,this._delta=0,t){var s=i+t,n=this._getCenterForScrollWheelZoom(this._lastMousePos,s);e.setView(n,s)}},_getCenterForScrollWheelZoom:function(e,t){var i=this._map,s=i.getZoomScale(t),n=i.getSize().divideBy(2),a=e.subtract(n).multiplyBy(1-1/s),o=i._getTopLeftPoint().add(n).add(a);return i.unproject(o)}}),i.Map.addInitHook("addHandler","scrollWheelZoom",i.Map.ScrollWheelZoom),i.Util.extend(i.DomEvent,{addDoubleTapListener:function(e,t,i){function s(e){if(1===e.touches.length){var t=Date.now(),i=t-(a||t);o=e.touches[0],r=i>0&&l>=i,a=t}}function n(){r&&(o.type="dblclick",t(o),a=null)}var a,o,r=!1,l=250,h="_leaflet_",d="touchstart",c="touchend";return e[h+d+i]=s,e[h+c+i]=n,e.addEventListener(d,s,!1),e.addEventListener(c,n,!1),this},removeDoubleTapListener:function(e,t){var i="_leaflet_";return e.removeEventListener(e,e[i+"touchstart"+t],!1),e.removeEventListener(e,e[i+"touchend"+t],!1),this}}),i.Map.mergeOptions({touchZoom:i.Browser.touch&&!i.Browser.android23}),i.Map.TouchZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var s=t.mouseEventToLayerPoint(e.touches[0]),n=t.mouseEventToLayerPoint(e.touches[1]),a=t._getCenterLayerPoint();this._startCenter=s.add(n).divideBy(2,!0),this._startDist=s.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=a.subtract(this._startCenter),i.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),i.DomEvent.preventDefault(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length){var t=this._map,s=t.mouseEventToLayerPoint(e.touches[0]),n=t.mouseEventToLayerPoint(e.touches[1]);this._scale=s.distanceTo(n)/this._startDist,this._delta=s.add(n).divideBy(2,!0).subtract(this._startCenter),1!==this._scale&&(this._moved||(i.DomUtil.addClass(t._mapPane,"leaflet-zoom-anim leaflet-touching"),t.fire("movestart").fire("zoomstart")._prepareTileBg(),this._moved=!0),i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),i.DomEvent.preventDefault(e))}},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),s=e.layerPointToLatLng(t);e.fire("zoomanim",{center:s,zoom:e.getScaleZoom(this._scale)}),e._tileBg.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(this._delta)+" "+i.DomUtil.getScaleString(this._scale,this._startCenter)},_onTouchEnd:function(){if(this._moved&&this._zooming){var e=this._map;this._zooming=!1,i.DomUtil.removeClass(e._mapPane,"leaflet-touching"),i.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._getScaleOrigin(),s=e.layerPointToLatLng(t),n=e.getZoom(),a=e.getScaleZoom(this._scale)-n,o=a>0?Math.ceil(a):Math.floor(a),r=e._limitZoom(n+o);e.fire("zoomanim",{center:s,zoom:r}),e._runAnimation(s,r,e.getZoomScale(r)/this._scale,t,!0)}},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),i.Map.addInitHook("addHandler","touchZoom",i.Map.TouchZoom),i.Map.mergeOptions({boxZoom:!0}),i.Map.BoxZoom=i.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){i.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){i.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(e){return!e.shiftKey||1!==e.which&&1!==e.button?!1:(i.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),this._box=i.DomUtil.create("div","leaflet-zoom-box",this._pane),i.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",i.DomEvent.on(document,"mousemove",this._onMouseMove,this).on(document,"mouseup",this._onMouseUp,this).preventDefault(e),void this._map.fire("boxzoomstart"))},_onMouseMove:function(e){var t=this._startLayerPoint,s=this._box,n=this._map.mouseEventToLayerPoint(e),a=n.subtract(t),o=new i.Point(Math.min(n.x,t.x),Math.min(n.y,t.y));i.DomUtil.setPosition(s,o),s.style.width=Math.abs(a.x)-4+"px",s.style.height=Math.abs(a.y)-4+"px"},_onMouseUp:function(e){this._pane.removeChild(this._box),this._container.style.cursor="",i.DomUtil.enableTextSelection(),i.DomEvent.off(document,"mousemove",this._onMouseMove).off(document,"mouseup",this._onMouseUp);var t=this._map,s=t.mouseEventToLayerPoint(e),n=new i.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(s));t.fitBounds(n),t.fire("boxzoomend",{boxZoomBounds:n})}}),i.Map.addInitHook("addHandler","boxZoom",i.Map.BoxZoom),i.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),i.Map.Keyboard=i.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;-1===e.tabIndex&&(e.tabIndex="0"),i.DomEvent.addListener(e,"focus",this._onFocus,this).addListener(e,"blur",this._onBlur,this).addListener(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;i.DomEvent.removeListener(e,"focus",this._onFocus,this).removeListener(e,"blur",this._onBlur,this).removeListener(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){this._focused||this._map._container.focus()},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t,i,s=this._panKeys={},n=this.keyCodes;for(t=0,i=n.left.length;i>t;t++)s[n.left[t]]=[-1*e,0];for(t=0,i=n.right.length;i>t;t++)s[n.right[t]]=[e,0];for(t=0,i=n.down.length;i>t;t++)s[n.down[t]]=[0,e];for(t=0,i=n.up.length;i>t;t++)s[n.up[t]]=[0,-1*e]},_setZoomOffset:function(e){var t,i,s=this._zoomKeys={},n=this.keyCodes;for(t=0,i=n.zoomIn.length;i>t;t++)s[n.zoomIn[t]]=e;for(t=0,i=n.zoomOut.length;i>t;t++)s[n.zoomOut[t]]=-e},_addHooks:function(){i.DomEvent.addListener(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){i.DomEvent.removeListener(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode;if(this._panKeys.hasOwnProperty(t))this._map.panBy(this._panKeys[t]);else{if(!this._zoomKeys.hasOwnProperty(t))return;this._map.setZoom(this._map.getZoom()+this._zoomKeys[t])}i.DomEvent.stop(e)}}),i.Map.addInitHook("addHandler","keyboard",i.Map.Keyboard),i.Handler.MarkerDrag=i.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new i.Draggable(e,e).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=i.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&i.DomUtil.setPosition(this._marker._shadow,e),this._marker._latlng=this._marker._map.layerPointToLatLng(e),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),i.Handler.PolyEdit=i.Handler.extend({options:{icon:new i.DivIcon({iconSize:new i.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(e,t){this._poly=e,i.Util.setOptions(this,t)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new i.LayerGroup),this._markers=[];var e,t,s,n,a=this._poly._latlngs;for(e=0,s=a.length;s>e;e++)n=this._createMarker(a[e],e),n.on("click",this._onMarkerClick,this),this._markers.push(n);var o,r;for(e=0,t=s-1;s>e;t=e++)(0!==e||i.Polygon&&this._poly instanceof i.Polygon)&&(o=this._markers[t],r=this._markers[e],this._createMiddleMarker(o,r),this._updatePrevNext(o,r))
},_createMarker:function(e,t){var s=new i.Marker(e,{draggable:!0,icon:this.options.icon});return s._origLatLng=e,s._index=t,s.on("drag",this._onMarkerDrag,this),s.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(s),s},_fireEdit:function(){this._poly.fire("edit")},_onMarkerDrag:function(e){var t=e.target;i.Util.extend(t._origLatLng,t._latlng),t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly.redraw()},_onMarkerClick:function(e){if(!(this._poly._latlngs.length<3)){var t=e.target,i=t._index;t._prev&&t._next&&(this._createMiddleMarker(t._prev,t._next),this._updatePrevNext(t._prev,t._next)),this._markerGroup.removeLayer(t),t._middleLeft&&this._markerGroup.removeLayer(t._middleLeft),t._middleRight&&this._markerGroup.removeLayer(t._middleRight),this._markers.splice(i,1),this._poly.spliceLatLngs(i,1),this._updateIndexes(i,-1),this._poly.fire("edit")}},_updateIndexes:function(e,t){this._markerGroup.eachLayer(function(i){i._index>e&&(i._index+=t)})},_createMiddleMarker:function(e,t){var i,s,n,a=this._getMiddleLatLng(e,t),o=this._createMarker(a);o.setOpacity(.6),e._middleRight=t._middleLeft=o,s=function(){var s=t._index;o._index=s,o.off("click",i).on("click",this._onMarkerClick,this),a.lat=o.getLatLng().lat,a.lng=o.getLatLng().lng,this._poly.spliceLatLngs(s,0,a),this._markers.splice(s,0,o),o.setOpacity(1),this._updateIndexes(s,1),t._index++,this._updatePrevNext(e,o),this._updatePrevNext(o,t)},n=function(){o.off("dragstart",s,this),o.off("dragend",n,this),this._createMiddleMarker(e,o),this._createMiddleMarker(o,t)},i=function(){s.call(this),n.call(this),this._poly.fire("edit")},o.on("click",i,this).on("dragstart",s,this).on("dragend",n,this),this._markerGroup.addLayer(o)},_updatePrevNext:function(e,t){e._next=t,t._prev=e},_getMiddleLatLng:function(e,t){var i=this._poly._map,s=i.latLngToLayerPoint(e.getLatLng()),n=i.latLngToLayerPoint(t.getLatLng());return i.layerPointToLatLng(s._add(n).divideBy(2))}}),i.Control=i.Class.extend({options:{position:"topright"},initialize:function(e){i.Util.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),s=this.getPosition(),n=e._controlCorners[s];return i.DomUtil.addClass(t,"leaflet-control"),-1!==s.indexOf("bottom")?n.insertBefore(t,n.firstChild):n.appendChild(t),this},removeFrom:function(e){var t=this.getPosition(),i=e._controlCorners[t];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this}}),i.control=function(e){return new i.Control(e)},i.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){function e(e,a){var o=s+e+" "+s+a;t[e+a]=i.DomUtil.create("div",o,n)}var t=this._controlCorners={},s="leaflet-",n=this._controlContainer=i.DomUtil.create("div",s+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")}}),i.Control.Zoom=i.Control.extend({options:{position:"topleft"},onAdd:function(e){var t="leaflet-control-zoom",s=i.DomUtil.create("div",t);return this._createButton("Zoom in",t+"-in",s,e.zoomIn,e),this._createButton("Zoom out",t+"-out",s,e.zoomOut,e),s},_createButton:function(e,t,s,n,a){var o=i.DomUtil.create("a",t,s);return o.href="#",o.title=e,i.DomEvent.on(o,"click",i.DomEvent.stopPropagation).on(o,"click",i.DomEvent.preventDefault).on(o,"click",n,a).on(o,"dblclick",i.DomEvent.stopPropagation),o}}),i.Map.mergeOptions({zoomControl:!0}),i.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new i.Control.Zoom,this.addControl(this.zoomControl))}),i.control.zoom=function(e){return new i.Control.Zoom(e)},i.Control.Attribution=i.Control.extend({options:{position:"bottomright",prefix:'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>'},initialize:function(e){i.Util.setOptions(this,e),this._attributions={}},onAdd:function(e){return this._container=i.DomUtil.create("div","leaflet-control-attribution"),i.DomEvent.disableClickPropagation(this._container),e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):void 0},removeAttribution:function(e){return e?(this._attributions[e]--,this._update(),this):void 0},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions.hasOwnProperty(t)&&this._attributions[t]&&e.push(t);var i=[];this.options.prefix&&i.push(this.options.prefix),e.length&&i.push(e.join(", ")),this._container.innerHTML=i.join(" &#8212; ")}},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),i.Map.mergeOptions({attributionControl:!0}),i.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new i.Control.Attribution).addTo(this))}),i.control.attribution=function(e){return new i.Control.Attribution(e)},i.Control.Scale=i.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t="leaflet-control-scale",s=i.DomUtil.create("div",t),n=this.options;return this._addScales(n,t,s),e.on(n.updateWhenIdle?"moveend":"move",this._update,this),this._update(),s},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,s){e.metric&&(this._mScale=i.DomUtil.create("div",t+"-line",s)),e.imperial&&(this._iScale=i.DomUtil.create("div",t+"-line",s))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,i=6378137*Math.PI*Math.cos(t*Math.PI/180),s=i*(e.getNorthEast().lng-e.getSouthWest().lng)/180,n=this._map.getSize(),a=this.options,o=0;n.x>0&&(o=s*(a.maxWidth/n.x)),this._updateScales(a,o)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=1e3>t?t+" m":t/1e3+" km"},_updateImperial:function(e){var t,i,s,n=3.2808399*e,a=this._iScale;n>5280?(t=n/5280,i=this._getRoundNum(t),a.style.width=this._getScaleWidth(i/t)+"px",a.innerHTML=i+" mi"):(s=this._getRoundNum(n),a.style.width=this._getScaleWidth(s/n)+"px",a.innerHTML=s+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,t*i}}),i.control.scale=function(e){return new i.Control.Scale(e)},i.Control.Layers=i.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,s){i.Util.setOptions(this,s),this._layers={},this._lastZIndex=0;for(var n in e)e.hasOwnProperty(n)&&this._addLayer(e[n],n);for(n in t)t.hasOwnProperty(n)&&this._addLayer(t[n],n,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=i.DomUtil.create("div",e);i.Browser.touch?i.DomEvent.on(t,"click",i.DomEvent.stopPropagation):i.DomEvent.disableClickPropagation(t);var s=this._form=i.DomUtil.create("form",e+"-list");if(this.options.collapsed){i.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var n=this._layersLink=i.DomUtil.create("a",e+"-toggle",t);n.href="#",n.title="Layers",i.Browser.touch?i.DomEvent.on(n,"click",i.DomEvent.stopPropagation).on(n,"click",i.DomEvent.preventDefault).on(n,"click",this._expand,this):i.DomEvent.on(n,"focus",this._expand,this),this._map.on("movestart",this._collapse,this)}else this._expand();this._baseLayersList=i.DomUtil.create("div",e+"-base",s),this._separator=i.DomUtil.create("div",e+"-separator",s),this._overlaysList=i.DomUtil.create("div",e+"-overlays",s),t.appendChild(s)},_addLayer:function(e,t,s){var n=i.Util.stamp(e);this._layers[n]={layer:e,name:t,overlay:s},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e=!1,t=!1;for(var i in this._layers)if(this._layers.hasOwnProperty(i)){var s=this._layers[i];this._addItem(s),t=t||s.overlay,e=e||!s.overlay}this._separator.style.display=t&&e?"":"none"}},_createRadioElement:function(e,t){var i='<input type="radio" name="'+e+'"';t&&(i+=' checked="checked"'),i+="/>";var s=document.createElement("div");return s.innerHTML=i,s.firstChild},_addItem:function(e){var t,s=document.createElement("label"),n=this._map.hasLayer(e.layer);e.overlay?(t=document.createElement("input"),t.type="checkbox",t.defaultChecked=n):t=this._createRadioElement("leaflet-base-layers",n),t.layerId=i.Util.stamp(e.layer),i.DomEvent.on(t,"click",this._onInputClick,this);var a=document.createTextNode(" "+e.name);s.appendChild(t),s.appendChild(a);var o=e.overlay?this._overlaysList:this._baseLayersList;o.appendChild(s)},_onInputClick:function(){var e,t,i,s=this._form.getElementsByTagName("input"),n=s.length;for(e=0;n>e;e++)t=s[e],i=this._layers[t.layerId],t.checked?this._map.addLayer(i.layer,!i.overlay):this._map.removeLayer(i.layer)},_expand:function(){i.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),i.control.layers=function(e,t,s){return new i.Control.Layers(e,t,s)},i.Transition=i.Class.extend({includes:i.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:i.DomUtil.setPosition},implemented:function(){return i.Transition.NATIVE||i.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(e,t){var s=i.Transition.CUSTOM_PROPS_SETTERS;e in s?s[e](this._el,t):this._el.style[e]=t}}),i.Transition=i.Transition.extend({statics:function(){var e=i.DomUtil.TRANSITION,t="webkitTransition"===e||"OTransition"===e?e+"End":"transitionend";return{NATIVE:!!e,TRANSITION:e,PROPERTY:e+"Property",DURATION:e+"Duration",EASING:e+"TimingFunction",END:t,CUSTOM_PROPS_PROPERTIES:{position:i.Browser.any3d?i.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(e,t){this._el=e,i.Util.setOptions(this,t),i.DomEvent.on(e,i.Transition.END,this._onTransitionEnd,this),this._onFakeStep=i.Util.bind(this._onFakeStep,this)},run:function(e){var t,s=[],n=i.Transition.CUSTOM_PROPS_PROPERTIES;for(t in e)e.hasOwnProperty(t)&&(t=n[t]?n[t]:t,t=this._dasherize(t),s.push(t));this._el.style[i.Transition.DURATION]=this.options.duration+"s",this._el.style[i.Transition.EASING]=this.options.easing,this._el.style[i.Transition.PROPERTY]="all";for(t in e)e.hasOwnProperty(t)&&this._setProperty(t,e[t]);i.Util.falseFn(this._el.offsetWidth),this._inProgress=!0,i.Browser.mobileWebkit&&(this.backupEventFire=setTimeout(i.Util.bind(this._onBackupFireEnd,this),1.2*this.options.duration*1e3)),i.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function e(e){return"-"+e.toLowerCase()}var t=/([A-Z])/g;return function(i){return i.replace(t,e)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(e){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[i.Transition.TRANSITION]="",clearTimeout(this.backupEventFire),delete this.backupEventFire,this.fire("step"),e&&e.type&&this.fire("end"))},_onBackupFireEnd:function(){var e=document.createEvent("Event");e.initEvent(i.Transition.END,!0,!1),this._el.dispatchEvent(e)}}),i.Transition=i.Transition.NATIVE?i.Transition:i.Transition.extend({statics:{getTime:Date.now||function(){return+new Date},TIMER:!0,EASINGS:{linear:function(e){return e},"ease-out":function(e){return e*(2-e)}},CUSTOM_PROPS_GETTERS:{position:i.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(e,t){this._el=e,i.Util.extend(this.options,t),this._easing=i.Transition.EASINGS[this.options.easing]||i.Transition.EASINGS["ease-out"],this._step=i.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(e){this._props={};var t=i.Transition.CUSTOM_PROPS_GETTERS,s=i.Transition.UNIT_RE;this.fire("start");for(var n in e)if(e.hasOwnProperty(n)){var a={};if(n in t)a.from=t[n](this._el);else{var o=this._el.style[n].match(s);a.from=parseFloat(o[0]),a.unit=o[1]}a.to=e[n],this._props[n]=a}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=i.Transition.getTime()},_step:function(){var e=i.Transition.getTime(),t=e-this._startTime,s=1e3*this.options.duration;s>t?this._runFrame(this._easing(t/s)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t,s,n,a=i.Transition.CUSTOM_PROPS_SETTERS;for(t in this._props)this._props.hasOwnProperty(t)&&(s=this._props[t],t in a?(n=s.to.subtract(s.from).multiplyBy(e).add(s.from),a[t](this._el,n)):this._el.style[t]=(s.to-s.from)*e+s.from+s.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")}}),i.Map.include(i.Transition&&i.Transition.implemented()?{setView:function(e,t,i){t=this._limitZoom(t);var s=this._zoom!==t;if(this._loaded&&!i&&this._layers){var n=s?this._zoomToIfClose&&this._zoomToIfClose(e,t):this._panByIfClose(e);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){return e=i.point(e),e.x||e.y?(this._panTransition||(this._panTransition=new i.Transition(this._mapPane),this._panTransition.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.Util.setOptions(this._panTransition,i.Util.extend({duration:.25},t)),this.fire("movestart"),i.DomUtil.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:i.DomUtil.getPosition(this._mapPane).subtract(e)}),this):this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){i.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_panByIfClose:function(e){var t=this._getCenterOffset(e)._floor();return this._offsetIsWithinView(t)?(this.panBy(t),!0):!1},_offsetIsWithinView:function(e,t){var i=t||1,s=this.getSize();return Math.abs(e.x)<=s.x*i&&Math.abs(e.y)<=s.y*i}}:{}),i.Map.mergeOptions({zoomAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23&&!i.Browser.mobileOpera}),i.DomUtil.TRANSITION&&i.Map.addInitHook(function(){i.DomEvent.on(this._mapPane,i.Transition.END,this._catchTransitionEnd,this)}),i.Map.include(i.DomUtil.TRANSITION?{_zoomToIfClose:function(e,t){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var s=this.getZoomScale(t),n=this._getCenterOffset(e).divideBy(1-1/s);if(!this._offsetIsWithinView(n,1))return!1;i.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this.fire("movestart").fire("zoomstart"),this.fire("zoomanim",{center:e,zoom:t});var a=this._getCenterLayerPoint().add(n);return this._prepareTileBg(),this._runAnimation(e,t,s,a),!0},_catchTransitionEnd:function(){this._animatingZoom&&this._onZoomTransitionEnd()},_runAnimation:function(t,s,n,a,o){this._animateToCenter=t,this._animateToZoom=s,this._animatingZoom=!0;var r=i.DomUtil.TRANSFORM,l=this._tileBg;clearTimeout(this._clearTileBgTimer),(i.Browser.gecko||e.opera)&&(l.style[r]+=" translate(0,0)"),i.Util.falseFn(l.offsetWidth);var h=i.DomUtil.getScaleString(n,a),d=l.style[r];l.style[r]=o?d+" "+h:h+" "+d},_prepareTileBg:function(){var e=this._tilePane,t=this._tileBg;if(t&&this._getLoadedTilesPercentage(t)>.5&&this._getLoadedTilesPercentage(e)<.5)return e.style.visibility="hidden",e.empty=!0,void this._stopLoadingImages(e);t||(t=this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),t.style.zIndex=1),t.style[i.DomUtil.TRANSFORM]="",t.style.visibility="hidden",t.empty=!0,e.empty=!1,this._tilePane=this._panes.tilePane=t;var s=this._tileBg=e;i.DomUtil.addClass(s,"leaflet-zoom-animated"),this._stopLoadingImages(s)},_getLoadedTilesPercentage:function(e){var t,i,s=e.getElementsByTagName("img"),n=0;for(t=0,i=s.length;i>t;t++)s[t].complete&&n++;return n/i},_stopLoadingImages:function(e){var t,s,n,a=Array.prototype.slice.call(e.getElementsByTagName("img"));for(t=0,s=a.length;s>t;t++)n=a[t],n.complete||(n.onload=i.Util.falseFn,n.onerror=i.Util.falseFn,n.src=i.Util.emptyImageUrl,n.parentNode.removeChild(n))},_onZoomTransitionEnd:function(){this._restoreTileFront(),i.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),i.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){this._animatingZoom||this.touchZoom._zooming||(this._tileBg.innerHTML="")}}:{}),i.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){if(e=this._locationOptions=i.Util.extend(this._defaultLocateOptions,e),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i.Util.bind(this._handleGeolocationResponse,this),s=i.Util.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,s,e):navigator.geolocation.getCurrentPosition(t,s,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this},_handleGeolocationError:function(e){var t=e.code,i=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(e){var t=180*e.coords.accuracy/4e7,s=2*t,n=e.coords.latitude,a=e.coords.longitude,o=new i.LatLng(n,a),r=new i.LatLng(n-t,a-s),l=new i.LatLng(n+t,a+s),h=new i.LatLngBounds(r,l),d=this._locationOptions;if(d.setView){var c=Math.min(this.getBoundsZoom(h),d.maxZoom);this.setView(o,c)}this.fire("locationfound",{latlng:o,bounds:h,accuracy:e.coords.accuracy})}})}(this),define("leaflet",function(){}),define("modules/map/map",["jquery","underscore","state","baseview","leaflet"],function(e,t,i,s){"use strict";var n=s.extend({initialize:function(i){i=e.extend(!0,{latitude:0,longitude:0,currentLocationMarker:!0,addMapLabel:!1,mapLabelClass:null,defaultZoom:null,mapUrl:null,mapOptions:{trackResize:!1,scrollWheelZoom:!1,zoomControl:!1,attributionControl:!1}},i),s.prototype.initialize.call(this,i),t.bindAll(this,"_onGetMapTilesSuccess"),this.createMap(i.latitude,i.longitude)},createMap:function(e,t){var i,s=this.$el.data()||{},n=s.attrMapurl||this.options.mapUrl,a=parseFloat(s.latitude)||e,o=parseFloat(s.longitude)||t;n&&(i=parseInt(s.attrZoom,10)||this.options.defaultZoom,"L"===s.attrSize&&(this.options.mapOptions.zoomControl=!0),this.map=this.buildMap(),this.setLocation(a,o,i),this.getMapTiles(n))},buildMap:function(){return this.$mapEl=e('<div class="standard-app-map"></div>'),this.$el.html(this.$mapEl),this.options.addMapLabel&&(this.$mapLabel=this.buildMapLabel(),this.$el.append(this.$mapLabel)),new L.Map(this.$mapEl[0],this.options.mapOptions)},buildMapLabel:function(){var t=e('<span class="standard-app-map-location-label">');return this.options.mapLabelClass&&t.addClass(this.options.mapLabelClass),t},setCurrentLocationMarker:function(e,t){if(this.options.currentLocationMarker){var i=new L.LatLng(e,t);if(this.currentLocationMarker)this.currentLocationMarker.setLatLng(i);else{var s=window.site_static_url,n=L.Icon.extend({options:{iconUrl:s+"/images/modules/maps/marker.png",shadowUrl:s+"/images/modules/maps/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[11,41],shadowAnchor:[11,41]}}),a=new n;this.currentLocationMarker=new L.Marker(i,{icon:a,zIndexOffset:1e3}),this.map.addLayer(this.currentLocationMarker)}}},removeCurrentLocationMarker:function(){this.currentLocationMarker&&(this.map.removeLayer(this.currentLocationMarker),this.currentLocationMarker=null)},setLocation:function(e,t,i){var s=new L.LatLng(e,t);i=i||this.map.getZoom(),this.map.setView(s,i,!0),this.setCurrentLocationMarker(e,t)},getMapTiles:function(e){i.fetchData(e,{dataType:"jsonp"}).done(this._onGetMapTilesSuccess)},_onGetMapTilesSuccess:function(e){var t=L.TileLayer.extend({initialize:function(e){e=e||{},e.minZoom=e.minzoom||0,e.maxZoom=e.maxzoom||22,L.TileLayer.prototype.initialize.call(this,e.tiles[0],e)}});this.tiles=new t(e),this.map.addLayer(this.tiles)},setMapLabel:function(e){this.$mapLabel&&this.$mapLabel.text(e)},destroy:function(e){this.tiles&&(this.map.removeLayer(this.tiles),this.tiles=null),this.$mapLabel&&this.$mapLabel.remove(),this.$mapEl&&this.$mapEl.remove(),this.map=null,s.prototype.destroy.call(this,e)}});return n}),define("modules/travel/travel-experience-promo",["jquery","baseview","ui/dropdown"],function(e,t,i){"use strict";var s=t.extend({initialize:function(e){t.prototype.initialize.call(this,e),this.subviews.dropdown=new i({el:this.$(".tep-list")})}});return s}),define("modules/horoscope",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","form/dropdown"],function(e,t,i,s,n,a,o){"use strict";var r=i.extend({el:".hpm-wrapper",events:{"submit #horo-form":"formSubmit"},initialize:function(e){t.bindAll(this,"monthSelect","daySelect"),i.prototype.initialize.call(this,e),this.dropdownMonth=this.$("#horo-month-select"),this.dropdownDay=this.$("#horo-day-select"),this.selectedMonth=0,this.selectedDay=0,this.errorMessage=this.$("#horo-error"),this.dateAmounts=[31,29,31,30,31,30,31,31,30,31,30,31],this.horoscopeSigns=[{title:"aries",range:{months:[3,4],days:[21,20]}},{title:"taurus",range:{months:[4,5],days:[21,20]}},{title:"gemini",range:{months:[5,6],days:[21,20]}},{title:"cancer",range:{months:[6,7],days:[21,22]}},{title:"leo",range:{months:[7,8],days:[23,23]}},{title:"virgo",range:{months:[8,9],days:[24,22]}},{title:"libra",range:{months:[9,10],days:[23,23]}},{title:"scorpio",range:{months:[10,11],days:[24,22]}},{title:"sagittarius",range:{months:[11,12],days:[23,21]}},{title:"capricorn",range:{months:[12,1],days:[22,19]}},{title:"aquarius",range:{months:[1,2],days:[20,18]}},{title:"pisces",range:{months:[2,3],days:[19,20]}}],this._setupForm()},_setupForm:function(){this.subviews.monthDropdown=new o({el:this.dropdownMonth,onSelect:this.monthSelect}),this.subviews.dayDropdown=new o({el:this.dropdownDay,onSelect:this.daySelect})},formSubmit:function(e){e.preventDefault(),0!==this.selectedMonth&&0!==this.selectedDay&&this.dateAmounts[this.selectedMonth-1]>=this.selectedDay?this._determineSign(this.selectedMonth,this.selectedDay):this.errorMessage.removeClass("hidden")},monthSelect:function(e){this.selectedMonth=e},daySelect:function(e){this.selectedDay=e},_determineSign:function(t,i){this.errorMessage.addClass("hidden");var s;e.each(this.horoscopeSigns,function(){return t==this.range.months[0]&&i>=this.range.days[0]||t==this.range.months[1]&&i<=this.range.days[1]?(s=this.title,!1):void 0}),this.subviews.dayDropdown.reset(),this.subviews.monthDropdown.reset(),n.goTo("/horoscope/"+s+"/")}});return r}),define("modules/interactives/timeline",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable","modules/global/brightcove-video","touchswipe"],function(e,t,i,s,n,a){var o=n.extend({events:{"click .interactive-timeline-marker":"goToMarker","click .slide-nav.prev, .slide-nav.next":"renderArrowClick"},initialize:function(e){n.prototype.initialize.call(this,e),t.bindAll(this,"snapToMarker"),this.subviews.template=new a({el:this.$el,interactiveType:"timeline",isFramed:e.isFramed,standAlone:e.standAlone}),this.$leftArrow=this.subviews.template.$leftArrow,this.$rightArrow=this.subviews.template.$rightArrow,this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$viewport=this.subviews.template.$viewport,this.$timeslider=this.$(".interactive-timeline-timeslider"),this.$timesliderBelt=this.$timeslider.find(".interactive-timeline-belt"),this.$timesliderBuckle=this.$timeslider.find(".interactive-timeline-buckle"),this.$timesliderLabelContainer=this.$timeslider.find(".interactive-timeline-labels"),this.$timesliderLabels=this.$timesliderLabelContainer.find(".interactive-timeline-label"),this.$contentBox=this.$slideContainer.find(".timeline-slide-content"),this.$gridLines=this.$viewport.find(".grid-line"),this.arrEventPositions=[],this.maxSlides=this.subviews.template.maxSlides,this.arrayPanelMax=850,this.numPanelMinLefts=6,this.numMarkerWidth=9,this.strDateBegin="",this.strDateEnd="",this.currentSlideIndex=this.subviews.template.currentSlideIndex;var i={containment:".buckle-box",cursor:"move",axis:"x",stop:this.snapToMarker};if(Modernizr.touch){i.delay=200,this.$(".stage").swipe({self:this,swipe:function(e,t,i,s,n,a){"right"===t||"down"===t?a.self.previousSlide():a.self.nextSlide()}});var s=this;require(["touchpunch"],function(){s.destroyed||s.setup(i)})}else this.setup(i)},destroy:function(){this.$timesliderBuckle.draggable("destroy"),n.prototype.destroy.apply(this,arguments)},setup:function(t){var i="",s=this.$viewport.data()||{},n=this;this.strDateBegin=s.graphstart,this.strDateEnd=s.graphend,this.$slides.each(function(t){var s=e(this).find(".timeline-slide-content").data().tlpercent,a=parseInt(n.arrayPanelMax,10),o=Math.round(s*a+27);n.arrEventPositions[t]=o,i+='<div class="interactive-timeline-marker" style="left:'+o+'px;"></div>'}),this.$timesliderBelt.append(i),this.maxEvents=this.arrEventPositions.length,this.setUpLabels(),this.goTo(0),this.$timesliderBuckle.draggable(t)},setUpLabels:function(){var t=this.strDateBegin,i=this.strDateEnd,s=i-t,n=this,a=n.arrayPanelMax;this.$timesliderLabels.each(function(){var i=e(this).data().labelms,n=Math.round((i-t)/s*a);e(this).css("left",n)}),this.$gridLines.each(function(t){var i=n.$timesliderLabels.eq(t).position().left+33+"px";e(this).css("left",i)}),this.$timesliderLabels.find(".interactive-timeline-time").fadeIn("slow")},goToMarker:function(e){var t=this.$timesliderBelt.children(".interactive-timeline-marker").index(e.currentTarget);this.goTo(t),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},renderArrowClick:function(t){e(t.currentTarget).is(this.$leftArrow)?this.previousSlide():this.nextSlide(),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},goTo:function(e){var t;this.currentSlideIndex=e;var i=parseInt(this.$contentBox.eq(e).width(),10),s=this.arrayPanelMax-i;this.$timesliderBuckle.css("left",(this.arrEventPositions[e]-19).toString()+"px"),t=Math.round(this.arrEventPositions[e]+this.numMarkerWidth/2-i/2),t>s?t=s:t<this.numPanelMinLefts&&(t=this.numPanelMinLefts),this.$slides.eq(e).find(".indicator").css("left",this.arrEventPositions[e]-8-t.toString()+"px"),this.$slides.removeClass("active").eq(e).css("left",t.toString()+"px").addClass("active"),this.$contentBox.find(".text a").attr("target","_blank"),this.subviews.template.goTo(e),this.currentSlideIndex=e},previousSlide:function(){this.goTo(Math.max(this.currentSlideIndex-1,0))},nextSlide:function(){this.goTo(Math.min(this.currentSlideIndex+1,this.maxSlides-1))},snapToMarker:function(t){var i,s,n=850,a=e(t.target),o=parseInt(a.css("left"),10);for(s=0;s<this.arrEventPositions.length;s++)Math.abs(o+19-this.arrEventPositions[s])<n&&(i=s,n=Math.abs(o+19-this.arrEventPositions[s]));this.options.isFramed!==!0&&this.subviews.template.trackPageView(),this.goTo(i)}});return o}),define("modules/stories/oembed",["jquery","baseview","utils"],function(e,t,i){var s=t.extend({initialize:function(e){"rich"===this.$el.attr("data-oembed-type")&&"twitter"===this.$el.attr("data-oembed-provider")&&i.loadScript("http://platform.twitter.com/widgets.js","twttr",function(e){e.widgets.load()}),t.prototype.initialize.call(this,e)}});return s}),define("modules/stories/utility-bar-module-print",["jquery","underscore","backbone","pubsub","baseview"],function(e,t,i,s,n){var a=n.extend({open:function(){s.trigger("uotrack","UtilityBarPrint"),window.print(),this.destroy()},close:function(){this.destroy()},destroy:function(e){n.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return a}),define("modules/fronts/super-hero",["jquery","underscore","baseview","state","managers/routemanager"],function(e,t,i,s,n){var a=i.extend({el:".super-hero-module-wrapper",events:{"click .super-hero":"open"},open:function(t){if("a"!=e(t.target).prop("tagName").toLowerCase()){var i=e(t.currentTarget);n.goTo(i.find(".hero-story > h1 > a").attr("href"))}}});return a}),define("modules/travel/travel-experience-featured",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,a){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer","click .travel-experience-featured-carousel-nav":"step"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo","step","toggleArrows"),this.subviews={},this.$moveMe=this.$(".travel-experienced-featured-wrapper"),this.$slides=this.$(".travel-experience-featured-link"),this.$navPrev=this.$(".travel-experience-featured-carousel-prev"),this.$navNext=this.$(".travel-experience-featured-carousel-next"),this.$viewport=this.$moveMe.parent(),this.indexActive=this.$moveMe.data("active")||0,this.$moveMe.width(this.$moveMe.width()*this.$moveMe.children().length),this.subviews.paginator=new a({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),this.toggleArrows(),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.$viewport.outerWidth(),i=t*e;this.$moveMe.data("active",e),this.indexActive=e,this.animate(this.$moveMe,"left","-"+(i+1)+"px",450,"ease-in-out"),this.toggleArrows()},step:function(t){e(t.currentTarget).hasClass("prev")?this.subviews.paginator.goToPrevPage(!0):this.subviews.paginator.goToNextPage(!0)},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},toggleArrows:function(){this.$navPrev.fadeIn(),this.$navNext.fadeIn(),"0"==this.indexActive&&this.$navPrev.fadeOut(),this.indexActive==this.$slides.length-1&&this.$navNext.fadeOut()}});return o}),define("modules/book-reviews/booklist",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","ui/dropdown","directAdPosition"],function(e,t,i,s,n,a,o,r){"use strict";var l=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(s){i.prototype.initialize.call(this,s),t.bindAll(this,"booklistAdReady");var n=this._getMostRecentWeek();this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.$filterFields=this.$('select[name="sort"], select[name="genreId"], select[name="classId"]',this.$searchForm),this.$weekFilter=this.$("#booklist-datepicker"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new a({el:this.$("#ListFilter"),formOptions:[{el:this.$("#booklist-sortby"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-classpicker"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-genrepicker"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-datepicker"),selectWeek:!0,showOtherMonths:!0,showMonthAfterYear:!0,changeMonth:!0,changeYear:!0,defaultDate:0,dateFormat:"mm/dd/yy",maxDate:n,onSelect:t.bind(this.changeWeek,this)}]}),this.$(".books-buy-button").each(t.bind(function(t,i){this.subviews["dropdown"+t]=new o({el:e(i)})
},this))},renderCardInfo:function(e){if(this.booklistPosterAd=this.$(".booklist-poster-ad-module"),this.booklistPosterAd.length)if(e.belowHeroAd){var t={el:this.booklistPosterAd.find(".booklist-poster-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.booklistAdReady};this.subviews.booklistPosterAd=new r(t)}else this.booklistPosterAd.hide()},booklistAdReady:function(){this.$el.addClass("has-poster-ad"),this.subviews.booklistPosterAd.playAd()},submitBooklistSearchForm:function(e){e.preventDefault();var t=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+t+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;n.goTo(s)},filterBooklist:function(){n.goTo(window.location.pathname+"?"+this.$filterFields.serialize())},changeWeek:function(e,t){var i=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),s=this._getWeek(i);n.goTo(this.booklistBaseUrl+"week/"+t.selectedYear+"/"+s+"/")},_getWeek:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},_getMostRecentWeek:function(){var e=new Date,t=e.getDay();return 4>t&&e.setDate(e.getDate()-7+(4-t)),e}});return l}),define("modules/interactives/line-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base"],function(e,t,i,s,n){"use strict";var a=n.extend({getFlotData:function(e){return void 0===e?null:(t.isArray(e)||(e=[e]),t.map(e,function(e,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:n,data:t.map(e.value,function(e,t){return[t,e]}),points:{fillColor:n}}},this))},_getMinValue:function(e){var i=Number.MAX_VALUE,s=Number.MIN_VALUE;if(t.each(e,function(e){t.each(e.data,function(e){e=parseFloat(e[1]),i>e&&(i=e),e>s&&(s=e)})}),i===Number.MAX_VALUE)i=s=0;else{i>0&&(i=0);var n=.1*(s-i);s+=n,0>i&&(i-=n)}return[i,s]},getFlotOptions:function(){var e=s.getNested(this.flotData,0,"data","length")||0,t=this._getMinValue(this.flotData),i=n.prototype.getFlotOptions.apply(this,arguments);return i.legend={show:!1,noColumns:1},i.xaxis={ticks:this._createTicks(this.chartData.xaxisvalues||""),autoscaleMargin:.03,position:"bottom",borderColor:"rgb(237,236,236)"},i.yaxis={position:"left",labelHeight:25,borderColor:"rgb(237,236,236)",min:t[0],max:t[1],tickFormatter:this.numberWithCommas},i.series={lines:{show:!0}},i.grid={borderWidth:1,borderColor:"rgb(237,236,236)",labelMargin:5,axisMargin:0,clickable:!0,hoverable:!0,autoHighlight:!0},i.colors=this.colors,13>e?i.series.points={show:!0,radius:5,fill:!0}:e>13&&(i.series.points={show:!1}),i},_getHoverBody:function(e){return[this.getHoverPrefix(),s.addCommas(s.getNested(e,"datapoint","1"))||"",this.getHoverSuffix()].join(" ")}});return a}),define("buildfiles/common",function(){}),define("framework-config",[],function(){return window.use_minified_css&&require.config({baseUrl:window.site_static_url+"jsb"}),{paths:{jquery:"libs/jquery/jquery.require",jquery_modern:"libs/jquery/jquery-2.1.4",jquery_legacy:"libs/jquery/jquery-1.11.3",underscore:"libs/underscore/underscore",backbone:"libs/backbone/backbone-dev",utils:"global/utils",baseview:"global/base-view","base-app":"apps/base-app",pubsub:"global/pubsub","site-manager":"managers/sitemanager",state:"managers/statemanager","user-manager":"managers/usermanager",cookie:"libs/jquery/plugins/jquery.cookie",easing:"libs/jquery/plugins/jquery.easing.1.3",animatecolors:"libs/jquery/plugins/jquery.animate-colors-min",mousewheel:"libs/jquery/plugins/jquery.mousewheel",uiPageTurn:"libs/jquery/plugins/jquery.ui-page-turn",uiFlip:"libs/jquery/plugins/jquery.ui-flip",transformSupport:"libs/jquery/plugins/jquery.transformSupport",touchpunch:"libs/jquery/plugins/jquery-ui.touch-punch.min",admanager:"managers/admanager",sharedAdPosition:"partner/shared-ad-position",meteredAdPosition:"partner/metered-ad-position",directAdPosition:"partner/direct-ad-position",leaflet:"libs/leaflet/leaflet-0.4.4",base64:"libs/base64/base64",mergedSiteConfig:"/services/config/site-config",adLogger:"partner/ad-logger","file-upload":"libs/jquery/plugins/file-upload/jquery.fileupload"},shim:{jquery_modern:["console.setup"],jquery_legacy:["console.setup"],easing:["jquery"],animatecolors:["jquery"],mousewheel:["jquery"],touchpunch:["libs/jqueryui/mouse"],backbone:["underscore","jquery"],"file-upload":["libs/jquery/plugins/file-upload/jquery.iframe-transport"]}}}),require(["framework-config"],function(e){require.config(e),require(["site-manager","modules/global/header","user-accounts/facebook-user-account","user-accounts/googleplus-user-account","analytics/settealium"],function(e,t){e.start(!window.chromeless&&t,!0)})}),define("main",function(){});
//# sourceMappingURL=main.min.js
//# sourceMappingURL=main.min.js.map